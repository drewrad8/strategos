import{c as E,f as v,j as e,a as d,G as x,K as h,N as S,b as F,U as I}from"./index-ClVyAEKc.js";import{r}from"./vendor-react-wGySg1uH.js";import{T}from"./tag-CGcYBmHj.js";import"./vendor-socket-TjCxX7sJ.js";import"./vendor-terminal-CyaXSNWE.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=E("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),A={proposed:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",accepted:"bg-green-500/20 text-green-400 border-green-500/30",deprecated:"bg-red-500/20 text-red-400 border-red-500/30",superseded:"bg-gray-500/20 text-gray-400 border-gray-500/30"};function q({className:i,limit:m=5}){const[n,C]=r.useState([]),[g,p]=r.useState(!0),[j,f]=r.useState(null),[o,u]=r.useState(null),[s,N]=r.useState(null),c=r.useCallback(async t=>{p(!0),f(null);try{const a=await v(`/api/adrs?limit=${m}`,{signal:t});if(!a.ok)throw new Error("Failed to fetch ADRs");const l=await a.json();C(l)}catch(a){if(a.name==="AbortError")return;f(a.message)}finally{p(!1)}},[m]),R=async t=>{try{const a=await v(`/api/adrs/${t}`);if(!a.ok)throw new Error("Failed to fetch ADR");const l=await a.json();N(l)}catch{}};r.useEffect(()=>{const t=new AbortController;return c(t.signal),()=>t.abort()},[c]);const b=r.useCallback(()=>c(),[c]),D=t=>{o===t?(u(null),N(null)):(u(t),R(t))};return g&&n.length===0?e.jsxs("div",{className:d("thea-card p-4",i),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(x,{className:"w-4 h-4 text-thea-gold"}),e.jsx("h3",{className:"font-rajdhani font-bold text-thea-gold-bright uppercase tracking-wider text-sm",children:"Architecture Decisions"})]}),e.jsx("div",{className:"flex items-center justify-center py-8 text-thea-gold-dark",children:e.jsx(h,{className:"w-5 h-5 animate-spin"})})]}):j?e.jsxs("div",{className:d("thea-card p-4",i),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(x,{className:"w-4 h-4 text-thea-gold"}),e.jsx("h3",{className:"font-rajdhani font-bold text-thea-gold-bright uppercase tracking-wider text-sm",children:"Architecture Decisions"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:j})]}),e.jsx("button",{onClick:b,className:"mt-2 text-xs text-thea-gold-dark hover:text-thea-gold",children:"Retry"})]}):e.jsxs("div",{className:d("thea-card",i),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-thea-gold-dark/30",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-thea-gold"}),e.jsx("h3",{className:"font-rajdhani font-bold text-thea-gold-bright uppercase tracking-wider text-sm",children:"Architecture Decisions"}),e.jsxs("span",{className:"text-xs text-thea-gold-dark",children:["(",n.length,")"]})]}),e.jsx("button",{onClick:b,className:"p-1 text-thea-gold-dark hover:text-thea-gold transition-colors",title:"Refresh",children:e.jsx(h,{className:d("w-3.5 h-3.5",g&&"animate-spin")})})]}),e.jsx("div",{className:"divide-y divide-thea-gold-dark/20",children:n.length===0?e.jsx("div",{className:"p-4 text-center text-thea-gold-dark text-sm",children:"No architecture decisions recorded yet."}):n.map(t=>{var a,l,k,y;return e.jsxs("div",{className:"group",children:[e.jsxs("button",{onClick:()=>D(t.id),className:"w-full px-4 py-3 flex items-start gap-3 hover:bg-thea-gold/5 transition-colors text-left",children:[e.jsx(F,{className:d("w-4 h-4 text-thea-gold-dark mt-0.5 transition-transform",o===t.id&&"rotate-90")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"font-mono text-xs text-thea-gold-dark",children:["ADR-",t.id]}),e.jsx("span",{className:d("px-1.5 py-0.5 text-xxs font-mono uppercase rounded border",A[t.status]||A.proposed),children:t.status})]}),e.jsx("h4",{className:"text-sm text-thea-gold-bright font-medium truncate group-hover:text-thea-gold",children:t.title}),t.date&&e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-thea-gold-dark",children:[e.jsx(L,{className:"w-3 h-3"}),e.jsx("span",{children:t.date})]})]})]}),o===t.id&&e.jsx("div",{className:"px-4 pb-4 pl-11 border-t border-thea-gold-dark/10 bg-black/20",children:s?e.jsxs("div",{className:"pt-3 space-y-3",children:[((l=(a=s.frontmatter)==null?void 0:a.tags)==null?void 0:l.length)>0&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(T,{className:"w-3 h-3 text-thea-gold-dark"}),s.frontmatter.tags.map(w=>e.jsx("span",{className:"px-2 py-0.5 text-xxs bg-thea-gold/10 text-thea-gold-dark rounded border border-thea-gold-dark/20",children:w},w))]}),((y=(k=s.frontmatter)==null?void 0:k.deciders)==null?void 0:y.length)>0&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-thea-gold-dark",children:[e.jsx(I,{className:"w-3 h-3"}),e.jsx("span",{children:s.frontmatter.deciders.join(", ")})]}),s.context&&e.jsxs("div",{className:"text-xs text-thea-gold-dark/80 leading-relaxed",children:[e.jsx("span",{className:"font-semibold text-thea-gold-dark",children:"Context: "}),s.context.slice(0,300),s.context.length>300&&"..."]}),s.decision&&e.jsxs("div",{className:"text-xs text-thea-gold-dark/80 leading-relaxed",children:[e.jsx("span",{className:"font-semibold text-thea-gold-dark",children:"Decision: "}),s.decision.slice(0,200),s.decision.length>200&&"..."]})]}):e.jsx("div",{className:"pt-3 flex items-center justify-center",children:e.jsx(h,{className:"w-4 h-4 text-thea-gold-dark animate-spin"})})})]},t.id)})})]})}export{q as ADRPanel};
