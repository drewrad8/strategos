function Pf(e,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const o in s)if(o!=="default"&&!(o in e)){const g=Object.getOwnPropertyDescriptor(s,o);g&&Object.defineProperty(e,o,g.get?g:{enumerable:!0,get:()=>s[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const g of o)if(g.type==="childList")for(const S of g.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&s(S)}).observe(document,{childList:!0,subtree:!0});function r(o){const g={};return o.integrity&&(g.integrity=o.integrity),o.referrerPolicy&&(g.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?g.credentials="include":o.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function s(o){if(o.ep)return;o.ep=!0;const g=r(o);fetch(o.href,g)}})();function Bf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ah={exports:{}},jn={},Th={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ui=Symbol.for("react.element"),Of=Symbol.for("react.portal"),If=Symbol.for("react.fragment"),Ff=Symbol.for("react.strict_mode"),Hf=Symbol.for("react.profiler"),zf=Symbol.for("react.provider"),$f=Symbol.for("react.context"),Uf=Symbol.for("react.forward_ref"),Wf=Symbol.for("react.suspense"),Vf=Symbol.for("react.memo"),qf=Symbol.for("react.lazy"),ql=Symbol.iterator;function Kf(e){return e===null||typeof e!="object"?null:(e=ql&&e[ql]||e["@@iterator"],typeof e=="function"?e:null)}var Dh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Mh=Object.assign,Nh={};function _s(e,t,r){this.props=e,this.context=t,this.refs=Nh,this.updater=r||Dh}_s.prototype.isReactComponent={};_s.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_s.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jh(){}jh.prototype=_s.prototype;function Fa(e,t,r){this.props=e,this.context=t,this.refs=Nh,this.updater=r||Dh}var Ha=Fa.prototype=new jh;Ha.constructor=Fa;Mh(Ha,_s.prototype);Ha.isPureReactComponent=!0;var Kl=Array.isArray,Ph=Object.prototype.hasOwnProperty,za={current:null},Bh={key:!0,ref:!0,__self:!0,__source:!0};function Oh(e,t,r){var s,o={},g=null,S=null;if(t!=null)for(s in t.ref!==void 0&&(S=t.ref),t.key!==void 0&&(g=""+t.key),t)Ph.call(t,s)&&!Bh.hasOwnProperty(s)&&(o[s]=t[s]);var i=arguments.length-2;if(i===1)o.children=r;else if(1<i){for(var a=Array(i),d=0;d<i;d++)a[d]=arguments[d+2];o.children=a}if(e&&e.defaultProps)for(s in i=e.defaultProps,i)o[s]===void 0&&(o[s]=i[s]);return{$$typeof:ui,type:e,key:g,ref:S,props:o,_owner:za.current}}function Gf(e,t){return{$$typeof:ui,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function $a(e){return typeof e=="object"&&e!==null&&e.$$typeof===ui}function Xf(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Gl=/\/+/g;function Zn(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Xf(""+e.key):t.toString(36)}function zi(e,t,r,s,o){var g=typeof e;(g==="undefined"||g==="boolean")&&(e=null);var S=!1;if(e===null)S=!0;else switch(g){case"string":case"number":S=!0;break;case"object":switch(e.$$typeof){case ui:case Of:S=!0}}if(S)return S=e,o=o(S),e=s===""?"."+Zn(S,0):s,Kl(o)?(r="",e!=null&&(r=e.replace(Gl,"$&/")+"/"),zi(o,t,r,"",function(d){return d})):o!=null&&($a(o)&&(o=Gf(o,r+(!o.key||S&&S.key===o.key?"":(""+o.key).replace(Gl,"$&/")+"/")+e)),t.push(o)),1;if(S=0,s=s===""?".":s+":",Kl(e))for(var i=0;i<e.length;i++){g=e[i];var a=s+Zn(g,i);S+=zi(g,t,r,a,o)}else if(a=Kf(e),typeof a=="function")for(e=a.call(e),i=0;!(g=e.next()).done;)g=g.value,a=s+Zn(g,i++),S+=zi(g,t,r,a,o);else if(g==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return S}function yi(e,t,r){if(e==null)return e;var s=[],o=0;return zi(e,s,"","",function(g){return t.call(r,g,o++)}),s}function Yf(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ze={current:null},$i={transition:null},Qf={ReactCurrentDispatcher:Ze,ReactCurrentBatchConfig:$i,ReactCurrentOwner:za};function Ih(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:yi,forEach:function(e,t,r){yi(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return yi(e,function(){t++}),t},toArray:function(e){return yi(e,function(t){return t})||[]},only:function(e){if(!$a(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};fe.Component=_s;fe.Fragment=If;fe.Profiler=Hf;fe.PureComponent=Fa;fe.StrictMode=Ff;fe.Suspense=Wf;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qf;fe.act=Ih;fe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=Mh({},e.props),o=e.key,g=e.ref,S=e._owner;if(t!=null){if(t.ref!==void 0&&(g=t.ref,S=za.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(a in t)Ph.call(t,a)&&!Bh.hasOwnProperty(a)&&(s[a]=t[a]===void 0&&i!==void 0?i[a]:t[a])}var a=arguments.length-2;if(a===1)s.children=r;else if(1<a){i=Array(a);for(var d=0;d<a;d++)i[d]=arguments[d+2];s.children=i}return{$$typeof:ui,type:e.type,key:o,ref:g,props:s,_owner:S}};fe.createContext=function(e){return e={$$typeof:$f,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:zf,_context:e},e.Consumer=e};fe.createElement=Oh;fe.createFactory=function(e){var t=Oh.bind(null,e);return t.type=e,t};fe.createRef=function(){return{current:null}};fe.forwardRef=function(e){return{$$typeof:Uf,render:e}};fe.isValidElement=$a;fe.lazy=function(e){return{$$typeof:qf,_payload:{_status:-1,_result:e},_init:Yf}};fe.memo=function(e,t){return{$$typeof:Vf,type:e,compare:t===void 0?null:t}};fe.startTransition=function(e){var t=$i.transition;$i.transition={};try{e()}finally{$i.transition=t}};fe.unstable_act=Ih;fe.useCallback=function(e,t){return Ze.current.useCallback(e,t)};fe.useContext=function(e){return Ze.current.useContext(e)};fe.useDebugValue=function(){};fe.useDeferredValue=function(e){return Ze.current.useDeferredValue(e)};fe.useEffect=function(e,t){return Ze.current.useEffect(e,t)};fe.useId=function(){return Ze.current.useId()};fe.useImperativeHandle=function(e,t,r){return Ze.current.useImperativeHandle(e,t,r)};fe.useInsertionEffect=function(e,t){return Ze.current.useInsertionEffect(e,t)};fe.useLayoutEffect=function(e,t){return Ze.current.useLayoutEffect(e,t)};fe.useMemo=function(e,t){return Ze.current.useMemo(e,t)};fe.useReducer=function(e,t,r){return Ze.current.useReducer(e,t,r)};fe.useRef=function(e){return Ze.current.useRef(e)};fe.useState=function(e){return Ze.current.useState(e)};fe.useSyncExternalStore=function(e,t,r){return Ze.current.useSyncExternalStore(e,t,r)};fe.useTransition=function(){return Ze.current.useTransition()};fe.version="18.3.1";Th.exports=fe;var I=Th.exports;const Fh=Bf(I),Jf=Pf({__proto__:null,default:Fh},[I]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zf=I,ep=Symbol.for("react.element"),tp=Symbol.for("react.fragment"),rp=Object.prototype.hasOwnProperty,sp=Zf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ip={key:!0,ref:!0,__self:!0,__source:!0};function Hh(e,t,r){var s,o={},g=null,S=null;r!==void 0&&(g=""+r),t.key!==void 0&&(g=""+t.key),t.ref!==void 0&&(S=t.ref);for(s in t)rp.call(t,s)&&!ip.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)o[s]===void 0&&(o[s]=t[s]);return{$$typeof:ep,type:e,key:g,ref:S,props:o,_owner:sp.current}}jn.Fragment=tp;jn.jsx=Hh;jn.jsxs=Hh;Ah.exports=jn;var p=Ah.exports,jo={},zh={exports:{}},pt={},$h={exports:{}},Uh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,j){var M=R.length;R.push(j);e:for(;0<M;){var B=M-1>>>1,$=R[B];if(0<o($,j))R[B]=j,R[M]=$,M=B;else break e}}function r(R){return R.length===0?null:R[0]}function s(R){if(R.length===0)return null;var j=R[0],M=R.pop();if(M!==j){R[0]=M;e:for(var B=0,$=R.length,q=$>>>1;B<q;){var K=2*(B+1)-1,Y=R[K],se=K+1,N=R[se];if(0>o(Y,M))se<$&&0>o(N,Y)?(R[B]=N,R[se]=M,B=se):(R[B]=Y,R[K]=M,B=K);else if(se<$&&0>o(N,M))R[B]=N,R[se]=M,B=se;else break e}}return j}function o(R,j){var M=R.sortIndex-j.sortIndex;return M!==0?M:R.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var g=performance;e.unstable_now=function(){return g.now()}}else{var S=Date,i=S.now();e.unstable_now=function(){return S.now()-i}}var a=[],d=[],v=1,u=null,_=3,b=!1,w=!1,f=!1,n=typeof setTimeout=="function"?setTimeout:null,c=typeof clearTimeout=="function"?clearTimeout:null,l=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function h(R){for(var j=r(d);j!==null;){if(j.callback===null)s(d);else if(j.startTime<=R)s(d),j.sortIndex=j.expirationTime,t(a,j);else break;j=r(d)}}function m(R){if(f=!1,h(R),!w)if(r(a)!==null)w=!0,F(y);else{var j=r(d);j!==null&&H(m,j.startTime-R)}}function y(R,j){w=!1,f&&(f=!1,c(x),x=-1),b=!0;var M=_;try{for(h(j),u=r(a);u!==null&&(!(u.expirationTime>j)||R&&!T());){var B=u.callback;if(typeof B=="function"){u.callback=null,_=u.priorityLevel;var $=B(u.expirationTime<=j);j=e.unstable_now(),typeof $=="function"?u.callback=$:u===r(a)&&s(a),h(j)}else s(a);u=r(a)}if(u!==null)var q=!0;else{var K=r(d);K!==null&&H(m,K.startTime-j),q=!1}return q}finally{u=null,_=M,b=!1}}var C=!1,L=null,x=-1,E=5,k=-1;function T(){return!(e.unstable_now()-k<E)}function A(){if(L!==null){var R=e.unstable_now();k=R;var j=!0;try{j=L(!0,R)}finally{j?D():(C=!1,L=null)}}else C=!1}var D;if(typeof l=="function")D=function(){l(A)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,O=P.port2;P.port1.onmessage=A,D=function(){O.postMessage(null)}}else D=function(){n(A,0)};function F(R){L=R,C||(C=!0,D())}function H(R,j){x=n(function(){R(e.unstable_now())},j)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){w||b||(w=!0,F(y))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return r(a)},e.unstable_next=function(R){switch(_){case 1:case 2:case 3:var j=3;break;default:j=_}var M=_;_=j;try{return R()}finally{_=M}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,j){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var M=_;_=R;try{return j()}finally{_=M}},e.unstable_scheduleCallback=function(R,j,M){var B=e.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?B+M:B):M=B,R){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=M+$,R={id:v++,callback:j,priorityLevel:R,startTime:M,expirationTime:$,sortIndex:-1},M>B?(R.sortIndex=M,t(d,R),r(a)===null&&R===r(d)&&(f?(c(x),x=-1):f=!0,H(m,M-B))):(R.sortIndex=$,t(a,R),w||b||(w=!0,F(y))),R},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(R){var j=_;return function(){var M=_;_=j;try{return R.apply(this,arguments)}finally{_=M}}}})(Uh);$h.exports=Uh;var np=$h.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var op=I,ft=np;function X(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Wh=new Set,qs={};function Ir(e,t){as(e,t),as(e+"Capture",t)}function as(e,t){for(qs[e]=t,e=0;e<t.length;e++)Wh.add(t[e])}var Kt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Po=Object.prototype.hasOwnProperty,ap=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Xl={},Yl={};function lp(e){return Po.call(Yl,e)?!0:Po.call(Xl,e)?!1:ap.test(e)?Yl[e]=!0:(Xl[e]=!0,!1)}function cp(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function hp(e,t,r,s){if(t===null||typeof t>"u"||cp(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function et(e,t,r,s,o,g,S){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=g,this.removeEmptyString=S}var We={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){We[e]=new et(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];We[t]=new et(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){We[e]=new et(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){We[e]=new et(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){We[e]=new et(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){We[e]=new et(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){We[e]=new et(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){We[e]=new et(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){We[e]=new et(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ua=/[\-:]([a-z])/g;function Wa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ua,Wa);We[t]=new et(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ua,Wa);We[t]=new et(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ua,Wa);We[t]=new et(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){We[e]=new et(e,1,!1,e.toLowerCase(),null,!1,!1)});We.xlinkHref=new et("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){We[e]=new et(e,1,!1,e.toLowerCase(),null,!0,!0)});function Va(e,t,r,s){var o=We.hasOwnProperty(t)?We[t]:null;(o!==null?o.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(hp(t,r,o,s)&&(r=null),s||o===null?lp(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=r===null?o.type===3?!1:"":r:(t=o.attributeName,s=o.attributeNamespace,r===null?e.removeAttribute(t):(o=o.type,r=o===3||o===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var Zt=op.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xi=Symbol.for("react.element"),$r=Symbol.for("react.portal"),Ur=Symbol.for("react.fragment"),qa=Symbol.for("react.strict_mode"),Bo=Symbol.for("react.profiler"),Vh=Symbol.for("react.provider"),qh=Symbol.for("react.context"),Ka=Symbol.for("react.forward_ref"),Oo=Symbol.for("react.suspense"),Io=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),sr=Symbol.for("react.lazy"),Kh=Symbol.for("react.offscreen"),Ql=Symbol.iterator;function ws(e){return e===null||typeof e!="object"?null:(e=Ql&&e[Ql]||e["@@iterator"],typeof e=="function"?e:null)}var De=Object.assign,eo;function Ds(e){if(eo===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);eo=t&&t[1]||""}return`
`+eo+e}var to=!1;function ro(e,t){if(!e||to)return"";to=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var s=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){s=d}e.call(t.prototype)}else{try{throw Error()}catch(d){s=d}e()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var o=d.stack.split(`
`),g=s.stack.split(`
`),S=o.length-1,i=g.length-1;1<=S&&0<=i&&o[S]!==g[i];)i--;for(;1<=S&&0<=i;S--,i--)if(o[S]!==g[i]){if(S!==1||i!==1)do if(S--,i--,0>i||o[S]!==g[i]){var a=`
`+o[S].replace(" at new "," at ");return e.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",e.displayName)),a}while(1<=S&&0<=i);break}}}finally{to=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ds(e):""}function up(e){switch(e.tag){case 5:return Ds(e.type);case 16:return Ds("Lazy");case 13:return Ds("Suspense");case 19:return Ds("SuspenseList");case 0:case 2:case 15:return e=ro(e.type,!1),e;case 11:return e=ro(e.type.render,!1),e;case 1:return e=ro(e.type,!0),e;default:return""}}function Fo(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ur:return"Fragment";case $r:return"Portal";case Bo:return"Profiler";case qa:return"StrictMode";case Oo:return"Suspense";case Io:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case qh:return(e.displayName||"Context")+".Consumer";case Vh:return(e._context.displayName||"Context")+".Provider";case Ka:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return t=e.displayName||null,t!==null?t:Fo(e.type)||"Memo";case sr:t=e._payload,e=e._init;try{return Fo(e(t))}catch{}}return null}function dp(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fo(t);case 8:return t===qa?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function vr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Gh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function fp(e){var t=Gh(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,g=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(S){s=""+S,g.call(this,S)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(S){s=""+S},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function wi(e){e._valueTracker||(e._valueTracker=fp(e))}function Xh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=Gh(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function nn(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ho(e,t){var r=t.checked;return De({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Jl(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=vr(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Yh(e,t){t=t.checked,t!=null&&Va(e,"checked",t,!1)}function zo(e,t){Yh(e,t);var r=vr(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?$o(e,t.type,r):t.hasOwnProperty("defaultValue")&&$o(e,t.type,vr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Zl(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function $o(e,t,r){(t!=="number"||nn(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ms=Array.isArray;function es(e,t,r,s){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&s&&(e[r].defaultSelected=!0)}else{for(r=""+vr(r),t=null,o=0;o<e.length;o++){if(e[o].value===r){e[o].selected=!0,s&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function Uo(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(X(91));return De({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ec(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(X(92));if(Ms(r)){if(1<r.length)throw Error(X(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:vr(r)}}function Qh(e,t){var r=vr(t.value),s=vr(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function tc(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Jh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wo(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Jh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Si,Zh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,o){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Si=Si||document.createElement("div"),Si.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Si.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ks(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Bs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pp=["Webkit","ms","Moz","O"];Object.keys(Bs).forEach(function(e){pp.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Bs[t]=Bs[e]})});function eu(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Bs.hasOwnProperty(e)&&Bs[e]?(""+t).trim():t+"px"}function tu(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,o=eu(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,o):e[r]=o}}var gp=De({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vo(e,t){if(t){if(gp[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(X(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(X(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(X(61))}if(t.style!=null&&typeof t.style!="object")throw Error(X(62))}}function qo(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ko=null;function Xa(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Go=null,ts=null,rs=null;function rc(e){if(e=pi(e)){if(typeof Go!="function")throw Error(X(280));var t=e.stateNode;t&&(t=Fn(t),Go(e.stateNode,e.type,t))}}function ru(e){ts?rs?rs.push(e):rs=[e]:ts=e}function su(){if(ts){var e=ts,t=rs;if(rs=ts=null,rc(e),t)for(e=0;e<t.length;e++)rc(t[e])}}function iu(e,t){return e(t)}function nu(){}var so=!1;function ou(e,t,r){if(so)return e(t,r);so=!0;try{return iu(e,t,r)}finally{so=!1,(ts!==null||rs!==null)&&(nu(),su())}}function Gs(e,t){var r=e.stateNode;if(r===null)return null;var s=Fn(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(X(231,t,typeof r));return r}var Xo=!1;if(Kt)try{var Ss={};Object.defineProperty(Ss,"passive",{get:function(){Xo=!0}}),window.addEventListener("test",Ss,Ss),window.removeEventListener("test",Ss,Ss)}catch{Xo=!1}function _p(e,t,r,s,o,g,S,i,a){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(v){this.onError(v)}}var Os=!1,on=null,an=!1,Yo=null,mp={onError:function(e){Os=!0,on=e}};function vp(e,t,r,s,o,g,S,i,a){Os=!1,on=null,_p.apply(mp,arguments)}function yp(e,t,r,s,o,g,S,i,a){if(vp.apply(this,arguments),Os){if(Os){var d=on;Os=!1,on=null}else throw Error(X(198));an||(an=!0,Yo=d)}}function Fr(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function au(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function sc(e){if(Fr(e)!==e)throw Error(X(188))}function xp(e){var t=e.alternate;if(!t){if(t=Fr(e),t===null)throw Error(X(188));return t!==e?null:e}for(var r=e,s=t;;){var o=r.return;if(o===null)break;var g=o.alternate;if(g===null){if(s=o.return,s!==null){r=s;continue}break}if(o.child===g.child){for(g=o.child;g;){if(g===r)return sc(o),e;if(g===s)return sc(o),t;g=g.sibling}throw Error(X(188))}if(r.return!==s.return)r=o,s=g;else{for(var S=!1,i=o.child;i;){if(i===r){S=!0,r=o,s=g;break}if(i===s){S=!0,s=o,r=g;break}i=i.sibling}if(!S){for(i=g.child;i;){if(i===r){S=!0,r=g,s=o;break}if(i===s){S=!0,s=g,r=o;break}i=i.sibling}if(!S)throw Error(X(189))}}if(r.alternate!==s)throw Error(X(190))}if(r.tag!==3)throw Error(X(188));return r.stateNode.current===r?e:t}function lu(e){return e=xp(e),e!==null?cu(e):null}function cu(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=cu(e);if(t!==null)return t;e=e.sibling}return null}var hu=ft.unstable_scheduleCallback,ic=ft.unstable_cancelCallback,wp=ft.unstable_shouldYield,Sp=ft.unstable_requestPaint,je=ft.unstable_now,Cp=ft.unstable_getCurrentPriorityLevel,Ya=ft.unstable_ImmediatePriority,uu=ft.unstable_UserBlockingPriority,ln=ft.unstable_NormalPriority,bp=ft.unstable_LowPriority,du=ft.unstable_IdlePriority,Pn=null,Bt=null;function kp(e){if(Bt&&typeof Bt.onCommitFiberRoot=="function")try{Bt.onCommitFiberRoot(Pn,e,void 0,(e.current.flags&128)===128)}catch{}}var Tt=Math.clz32?Math.clz32:Rp,Ep=Math.log,Lp=Math.LN2;function Rp(e){return e>>>=0,e===0?32:31-(Ep(e)/Lp|0)|0}var Ci=64,bi=4194304;function Ns(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function cn(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,o=e.suspendedLanes,g=e.pingedLanes,S=r&268435455;if(S!==0){var i=S&~o;i!==0?s=Ns(i):(g&=S,g!==0&&(s=Ns(g)))}else S=r&~o,S!==0?s=Ns(S):g!==0&&(s=Ns(g));if(s===0)return 0;if(t!==0&&t!==s&&!(t&o)&&(o=s&-s,g=t&-t,o>=g||o===16&&(g&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-Tt(t),o=1<<r,s|=e[r],t&=~o;return s}function Ap(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tp(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,o=e.expirationTimes,g=e.pendingLanes;0<g;){var S=31-Tt(g),i=1<<S,a=o[S];a===-1?(!(i&r)||i&s)&&(o[S]=Ap(i,t)):a<=t&&(e.expiredLanes|=i),g&=~i}}function Qo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function fu(){var e=Ci;return Ci<<=1,!(Ci&4194240)&&(Ci=64),e}function io(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function di(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Tt(t),e[t]=r}function Dp(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-Tt(r),g=1<<o;t[o]=0,s[o]=-1,e[o]=-1,r&=~g}}function Qa(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-Tt(r),o=1<<s;o&t|e[s]&t&&(e[s]|=t),r&=~o}}var ye=0;function pu(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var gu,Ja,_u,mu,vu,Jo=!1,ki=[],cr=null,hr=null,ur=null,Xs=new Map,Ys=new Map,nr=[],Mp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nc(e,t){switch(e){case"focusin":case"focusout":cr=null;break;case"dragenter":case"dragleave":hr=null;break;case"mouseover":case"mouseout":ur=null;break;case"pointerover":case"pointerout":Xs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ys.delete(t.pointerId)}}function Cs(e,t,r,s,o,g){return e===null||e.nativeEvent!==g?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:g,targetContainers:[o]},t!==null&&(t=pi(t),t!==null&&Ja(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function Np(e,t,r,s,o){switch(t){case"focusin":return cr=Cs(cr,e,t,r,s,o),!0;case"dragenter":return hr=Cs(hr,e,t,r,s,o),!0;case"mouseover":return ur=Cs(ur,e,t,r,s,o),!0;case"pointerover":var g=o.pointerId;return Xs.set(g,Cs(Xs.get(g)||null,e,t,r,s,o)),!0;case"gotpointercapture":return g=o.pointerId,Ys.set(g,Cs(Ys.get(g)||null,e,t,r,s,o)),!0}return!1}function yu(e){var t=Er(e.target);if(t!==null){var r=Fr(t);if(r!==null){if(t=r.tag,t===13){if(t=au(r),t!==null){e.blockedOn=t,vu(e.priority,function(){_u(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ui(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Zo(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);Ko=s,r.target.dispatchEvent(s),Ko=null}else return t=pi(r),t!==null&&Ja(t),e.blockedOn=r,!1;t.shift()}return!0}function oc(e,t,r){Ui(e)&&r.delete(t)}function jp(){Jo=!1,cr!==null&&Ui(cr)&&(cr=null),hr!==null&&Ui(hr)&&(hr=null),ur!==null&&Ui(ur)&&(ur=null),Xs.forEach(oc),Ys.forEach(oc)}function bs(e,t){e.blockedOn===t&&(e.blockedOn=null,Jo||(Jo=!0,ft.unstable_scheduleCallback(ft.unstable_NormalPriority,jp)))}function Qs(e){function t(o){return bs(o,e)}if(0<ki.length){bs(ki[0],e);for(var r=1;r<ki.length;r++){var s=ki[r];s.blockedOn===e&&(s.blockedOn=null)}}for(cr!==null&&bs(cr,e),hr!==null&&bs(hr,e),ur!==null&&bs(ur,e),Xs.forEach(t),Ys.forEach(t),r=0;r<nr.length;r++)s=nr[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<nr.length&&(r=nr[0],r.blockedOn===null);)yu(r),r.blockedOn===null&&nr.shift()}var ss=Zt.ReactCurrentBatchConfig,hn=!0;function Pp(e,t,r,s){var o=ye,g=ss.transition;ss.transition=null;try{ye=1,Za(e,t,r,s)}finally{ye=o,ss.transition=g}}function Bp(e,t,r,s){var o=ye,g=ss.transition;ss.transition=null;try{ye=4,Za(e,t,r,s)}finally{ye=o,ss.transition=g}}function Za(e,t,r,s){if(hn){var o=Zo(e,t,r,s);if(o===null)go(e,t,s,un,r),nc(e,s);else if(Np(o,e,t,r,s))s.stopPropagation();else if(nc(e,s),t&4&&-1<Mp.indexOf(e)){for(;o!==null;){var g=pi(o);if(g!==null&&gu(g),g=Zo(e,t,r,s),g===null&&go(e,t,s,un,r),g===o)break;o=g}o!==null&&s.stopPropagation()}else go(e,t,s,null,r)}}var un=null;function Zo(e,t,r,s){if(un=null,e=Xa(s),e=Er(e),e!==null)if(t=Fr(e),t===null)e=null;else if(r=t.tag,r===13){if(e=au(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return un=e,null}function xu(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Cp()){case Ya:return 1;case uu:return 4;case ln:case bp:return 16;case du:return 536870912;default:return 16}default:return 16}}var ar=null,el=null,Wi=null;function wu(){if(Wi)return Wi;var e,t=el,r=t.length,s,o="value"in ar?ar.value:ar.textContent,g=o.length;for(e=0;e<r&&t[e]===o[e];e++);var S=r-e;for(s=1;s<=S&&t[r-s]===o[g-s];s++);return Wi=o.slice(e,1<s?1-s:void 0)}function Vi(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ei(){return!0}function ac(){return!1}function gt(e){function t(r,s,o,g,S){this._reactName=r,this._targetInst=o,this.type=s,this.nativeEvent=g,this.target=S,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(r=e[i],this[i]=r?r(g):g[i]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Ei:ac,this.isPropagationStopped=ac,this}return De(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ei)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ei)},persist:function(){},isPersistent:Ei}),t}var ms={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tl=gt(ms),fi=De({},ms,{view:0,detail:0}),Op=gt(fi),no,oo,ks,Bn=De({},fi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ks&&(ks&&e.type==="mousemove"?(no=e.screenX-ks.screenX,oo=e.screenY-ks.screenY):oo=no=0,ks=e),no)},movementY:function(e){return"movementY"in e?e.movementY:oo}}),lc=gt(Bn),Ip=De({},Bn,{dataTransfer:0}),Fp=gt(Ip),Hp=De({},fi,{relatedTarget:0}),ao=gt(Hp),zp=De({},ms,{animationName:0,elapsedTime:0,pseudoElement:0}),$p=gt(zp),Up=De({},ms,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Wp=gt(Up),Vp=De({},ms,{data:0}),cc=gt(Vp),qp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Kp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Gp[e])?!!t[e]:!1}function rl(){return Xp}var Yp=De({},fi,{key:function(e){if(e.key){var t=qp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Vi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Kp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rl,charCode:function(e){return e.type==="keypress"?Vi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Vi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Qp=gt(Yp),Jp=De({},Bn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hc=gt(Jp),Zp=De({},fi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rl}),eg=gt(Zp),tg=De({},ms,{propertyName:0,elapsedTime:0,pseudoElement:0}),rg=gt(tg),sg=De({},Bn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ig=gt(sg),ng=[9,13,27,32],sl=Kt&&"CompositionEvent"in window,Is=null;Kt&&"documentMode"in document&&(Is=document.documentMode);var og=Kt&&"TextEvent"in window&&!Is,Su=Kt&&(!sl||Is&&8<Is&&11>=Is),uc=" ",dc=!1;function Cu(e,t){switch(e){case"keyup":return ng.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Wr=!1;function ag(e,t){switch(e){case"compositionend":return bu(t);case"keypress":return t.which!==32?null:(dc=!0,uc);case"textInput":return e=t.data,e===uc&&dc?null:e;default:return null}}function lg(e,t){if(Wr)return e==="compositionend"||!sl&&Cu(e,t)?(e=wu(),Wi=el=ar=null,Wr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Su&&t.locale!=="ko"?null:t.data;default:return null}}var cg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!cg[e.type]:t==="textarea"}function ku(e,t,r,s){ru(s),t=dn(t,"onChange"),0<t.length&&(r=new tl("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var Fs=null,Js=null;function hg(e){Bu(e,0)}function On(e){var t=Kr(e);if(Xh(t))return e}function ug(e,t){if(e==="change")return t}var Eu=!1;if(Kt){var lo;if(Kt){var co="oninput"in document;if(!co){var pc=document.createElement("div");pc.setAttribute("oninput","return;"),co=typeof pc.oninput=="function"}lo=co}else lo=!1;Eu=lo&&(!document.documentMode||9<document.documentMode)}function gc(){Fs&&(Fs.detachEvent("onpropertychange",Lu),Js=Fs=null)}function Lu(e){if(e.propertyName==="value"&&On(Js)){var t=[];ku(t,Js,e,Xa(e)),ou(hg,t)}}function dg(e,t,r){e==="focusin"?(gc(),Fs=t,Js=r,Fs.attachEvent("onpropertychange",Lu)):e==="focusout"&&gc()}function fg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return On(Js)}function pg(e,t){if(e==="click")return On(t)}function gg(e,t){if(e==="input"||e==="change")return On(t)}function _g(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Mt=typeof Object.is=="function"?Object.is:_g;function Zs(e,t){if(Mt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var o=r[s];if(!Po.call(t,o)||!Mt(e[o],t[o]))return!1}return!0}function _c(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function mc(e,t){var r=_c(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=_c(r)}}function Ru(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ru(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Au(){for(var e=window,t=nn();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=nn(e.document)}return t}function il(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function mg(e){var t=Au(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Ru(r.ownerDocument.documentElement,r)){if(s!==null&&il(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=r.textContent.length,g=Math.min(s.start,o);s=s.end===void 0?g:Math.min(s.end,o),!e.extend&&g>s&&(o=s,s=g,g=o),o=mc(r,g);var S=mc(r,s);o&&S&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==S.node||e.focusOffset!==S.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),g>s?(e.addRange(t),e.extend(S.node,S.offset)):(t.setEnd(S.node,S.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vg=Kt&&"documentMode"in document&&11>=document.documentMode,Vr=null,ea=null,Hs=null,ta=!1;function vc(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ta||Vr==null||Vr!==nn(s)||(s=Vr,"selectionStart"in s&&il(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Hs&&Zs(Hs,s)||(Hs=s,s=dn(ea,"onSelect"),0<s.length&&(t=new tl("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=Vr)))}function Li(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var qr={animationend:Li("Animation","AnimationEnd"),animationiteration:Li("Animation","AnimationIteration"),animationstart:Li("Animation","AnimationStart"),transitionend:Li("Transition","TransitionEnd")},ho={},Tu={};Kt&&(Tu=document.createElement("div").style,"AnimationEvent"in window||(delete qr.animationend.animation,delete qr.animationiteration.animation,delete qr.animationstart.animation),"TransitionEvent"in window||delete qr.transitionend.transition);function In(e){if(ho[e])return ho[e];if(!qr[e])return e;var t=qr[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Tu)return ho[e]=t[r];return e}var Du=In("animationend"),Mu=In("animationiteration"),Nu=In("animationstart"),ju=In("transitionend"),Pu=new Map,yc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xr(e,t){Pu.set(e,t),Ir(t,[e])}for(var uo=0;uo<yc.length;uo++){var fo=yc[uo],yg=fo.toLowerCase(),xg=fo[0].toUpperCase()+fo.slice(1);xr(yg,"on"+xg)}xr(Du,"onAnimationEnd");xr(Mu,"onAnimationIteration");xr(Nu,"onAnimationStart");xr("dblclick","onDoubleClick");xr("focusin","onFocus");xr("focusout","onBlur");xr(ju,"onTransitionEnd");as("onMouseEnter",["mouseout","mouseover"]);as("onMouseLeave",["mouseout","mouseover"]);as("onPointerEnter",["pointerout","pointerover"]);as("onPointerLeave",["pointerout","pointerover"]);Ir("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ir("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ir("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ir("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ir("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ir("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var js="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wg=new Set("cancel close invalid load scroll toggle".split(" ").concat(js));function xc(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,yp(s,t,void 0,e),e.currentTarget=null}function Bu(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],o=s.event;s=s.listeners;e:{var g=void 0;if(t)for(var S=s.length-1;0<=S;S--){var i=s[S],a=i.instance,d=i.currentTarget;if(i=i.listener,a!==g&&o.isPropagationStopped())break e;xc(o,i,d),g=a}else for(S=0;S<s.length;S++){if(i=s[S],a=i.instance,d=i.currentTarget,i=i.listener,a!==g&&o.isPropagationStopped())break e;xc(o,i,d),g=a}}}if(an)throw e=Yo,an=!1,Yo=null,e}function Ce(e,t){var r=t[oa];r===void 0&&(r=t[oa]=new Set);var s=e+"__bubble";r.has(s)||(Ou(t,e,2,!1),r.add(s))}function po(e,t,r){var s=0;t&&(s|=4),Ou(r,e,s,t)}var Ri="_reactListening"+Math.random().toString(36).slice(2);function ei(e){if(!e[Ri]){e[Ri]=!0,Wh.forEach(function(r){r!=="selectionchange"&&(wg.has(r)||po(r,!1,e),po(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ri]||(t[Ri]=!0,po("selectionchange",!1,t))}}function Ou(e,t,r,s){switch(xu(t)){case 1:var o=Pp;break;case 4:o=Bp;break;default:o=Za}r=o.bind(null,t,r,e),o=void 0,!Xo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),s?o!==void 0?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):o!==void 0?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function go(e,t,r,s,o){var g=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var S=s.tag;if(S===3||S===4){var i=s.stateNode.containerInfo;if(i===o||i.nodeType===8&&i.parentNode===o)break;if(S===4)for(S=s.return;S!==null;){var a=S.tag;if((a===3||a===4)&&(a=S.stateNode.containerInfo,a===o||a.nodeType===8&&a.parentNode===o))return;S=S.return}for(;i!==null;){if(S=Er(i),S===null)return;if(a=S.tag,a===5||a===6){s=g=S;continue e}i=i.parentNode}}s=s.return}ou(function(){var d=g,v=Xa(r),u=[];e:{var _=Pu.get(e);if(_!==void 0){var b=tl,w=e;switch(e){case"keypress":if(Vi(r)===0)break e;case"keydown":case"keyup":b=Qp;break;case"focusin":w="focus",b=ao;break;case"focusout":w="blur",b=ao;break;case"beforeblur":case"afterblur":b=ao;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=lc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=Fp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=eg;break;case Du:case Mu:case Nu:b=$p;break;case ju:b=rg;break;case"scroll":b=Op;break;case"wheel":b=ig;break;case"copy":case"cut":case"paste":b=Wp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=hc}var f=(t&4)!==0,n=!f&&e==="scroll",c=f?_!==null?_+"Capture":null:_;f=[];for(var l=d,h;l!==null;){h=l;var m=h.stateNode;if(h.tag===5&&m!==null&&(h=m,c!==null&&(m=Gs(l,c),m!=null&&f.push(ti(l,m,h)))),n)break;l=l.return}0<f.length&&(_=new b(_,w,null,r,v),u.push({event:_,listeners:f}))}}if(!(t&7)){e:{if(_=e==="mouseover"||e==="pointerover",b=e==="mouseout"||e==="pointerout",_&&r!==Ko&&(w=r.relatedTarget||r.fromElement)&&(Er(w)||w[Gt]))break e;if((b||_)&&(_=v.window===v?v:(_=v.ownerDocument)?_.defaultView||_.parentWindow:window,b?(w=r.relatedTarget||r.toElement,b=d,w=w?Er(w):null,w!==null&&(n=Fr(w),w!==n||w.tag!==5&&w.tag!==6)&&(w=null)):(b=null,w=d),b!==w)){if(f=lc,m="onMouseLeave",c="onMouseEnter",l="mouse",(e==="pointerout"||e==="pointerover")&&(f=hc,m="onPointerLeave",c="onPointerEnter",l="pointer"),n=b==null?_:Kr(b),h=w==null?_:Kr(w),_=new f(m,l+"leave",b,r,v),_.target=n,_.relatedTarget=h,m=null,Er(v)===d&&(f=new f(c,l+"enter",w,r,v),f.target=h,f.relatedTarget=n,m=f),n=m,b&&w)t:{for(f=b,c=w,l=0,h=f;h;h=zr(h))l++;for(h=0,m=c;m;m=zr(m))h++;for(;0<l-h;)f=zr(f),l--;for(;0<h-l;)c=zr(c),h--;for(;l--;){if(f===c||c!==null&&f===c.alternate)break t;f=zr(f),c=zr(c)}f=null}else f=null;b!==null&&wc(u,_,b,f,!1),w!==null&&n!==null&&wc(u,n,w,f,!0)}}e:{if(_=d?Kr(d):window,b=_.nodeName&&_.nodeName.toLowerCase(),b==="select"||b==="input"&&_.type==="file")var y=ug;else if(fc(_))if(Eu)y=gg;else{y=fg;var C=dg}else(b=_.nodeName)&&b.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(y=pg);if(y&&(y=y(e,d))){ku(u,y,r,v);break e}C&&C(e,_,d),e==="focusout"&&(C=_._wrapperState)&&C.controlled&&_.type==="number"&&$o(_,"number",_.value)}switch(C=d?Kr(d):window,e){case"focusin":(fc(C)||C.contentEditable==="true")&&(Vr=C,ea=d,Hs=null);break;case"focusout":Hs=ea=Vr=null;break;case"mousedown":ta=!0;break;case"contextmenu":case"mouseup":case"dragend":ta=!1,vc(u,r,v);break;case"selectionchange":if(vg)break;case"keydown":case"keyup":vc(u,r,v)}var L;if(sl)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Wr?Cu(e,r)&&(x="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(x="onCompositionStart");x&&(Su&&r.locale!=="ko"&&(Wr||x!=="onCompositionStart"?x==="onCompositionEnd"&&Wr&&(L=wu()):(ar=v,el="value"in ar?ar.value:ar.textContent,Wr=!0)),C=dn(d,x),0<C.length&&(x=new cc(x,e,null,r,v),u.push({event:x,listeners:C}),L?x.data=L:(L=bu(r),L!==null&&(x.data=L)))),(L=og?ag(e,r):lg(e,r))&&(d=dn(d,"onBeforeInput"),0<d.length&&(v=new cc("onBeforeInput","beforeinput",null,r,v),u.push({event:v,listeners:d}),v.data=L))}Bu(u,t)})}function ti(e,t,r){return{instance:e,listener:t,currentTarget:r}}function dn(e,t){for(var r=t+"Capture",s=[];e!==null;){var o=e,g=o.stateNode;o.tag===5&&g!==null&&(o=g,g=Gs(e,r),g!=null&&s.unshift(ti(e,g,o)),g=Gs(e,t),g!=null&&s.push(ti(e,g,o))),e=e.return}return s}function zr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wc(e,t,r,s,o){for(var g=t._reactName,S=[];r!==null&&r!==s;){var i=r,a=i.alternate,d=i.stateNode;if(a!==null&&a===s)break;i.tag===5&&d!==null&&(i=d,o?(a=Gs(r,g),a!=null&&S.unshift(ti(r,a,i))):o||(a=Gs(r,g),a!=null&&S.push(ti(r,a,i)))),r=r.return}S.length!==0&&e.push({event:t,listeners:S})}var Sg=/\r\n?/g,Cg=/\u0000|\uFFFD/g;function Sc(e){return(typeof e=="string"?e:""+e).replace(Sg,`
`).replace(Cg,"")}function Ai(e,t,r){if(t=Sc(t),Sc(e)!==t&&r)throw Error(X(425))}function fn(){}var ra=null,sa=null;function ia(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var na=typeof setTimeout=="function"?setTimeout:void 0,bg=typeof clearTimeout=="function"?clearTimeout:void 0,Cc=typeof Promise=="function"?Promise:void 0,kg=typeof queueMicrotask=="function"?queueMicrotask:typeof Cc<"u"?function(e){return Cc.resolve(null).then(e).catch(Eg)}:na;function Eg(e){setTimeout(function(){throw e})}function _o(e,t){var r=t,s=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(s===0){e.removeChild(o),Qs(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=o}while(r);Qs(t)}function dr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function bc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var vs=Math.random().toString(36).slice(2),Pt="__reactFiber$"+vs,ri="__reactProps$"+vs,Gt="__reactContainer$"+vs,oa="__reactEvents$"+vs,Lg="__reactListeners$"+vs,Rg="__reactHandles$"+vs;function Er(e){var t=e[Pt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Gt]||r[Pt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=bc(e);e!==null;){if(r=e[Pt])return r;e=bc(e)}return t}e=r,r=e.parentNode}return null}function pi(e){return e=e[Pt]||e[Gt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Kr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(X(33))}function Fn(e){return e[ri]||null}var aa=[],Gr=-1;function wr(e){return{current:e}}function be(e){0>Gr||(e.current=aa[Gr],aa[Gr]=null,Gr--)}function Se(e,t){Gr++,aa[Gr]=e.current,e.current=t}var yr={},Xe=wr(yr),it=wr(!1),Mr=yr;function ls(e,t){var r=e.type.contextTypes;if(!r)return yr;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var o={},g;for(g in r)o[g]=t[g];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function nt(e){return e=e.childContextTypes,e!=null}function pn(){be(it),be(Xe)}function kc(e,t,r){if(Xe.current!==yr)throw Error(X(168));Se(Xe,t),Se(it,r)}function Iu(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var o in s)if(!(o in t))throw Error(X(108,dp(e)||"Unknown",o));return De({},r,s)}function gn(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||yr,Mr=Xe.current,Se(Xe,e),Se(it,it.current),!0}function Ec(e,t,r){var s=e.stateNode;if(!s)throw Error(X(169));r?(e=Iu(e,t,Mr),s.__reactInternalMemoizedMergedChildContext=e,be(it),be(Xe),Se(Xe,e)):be(it),Se(it,r)}var Ut=null,Hn=!1,mo=!1;function Fu(e){Ut===null?Ut=[e]:Ut.push(e)}function Ag(e){Hn=!0,Fu(e)}function Sr(){if(!mo&&Ut!==null){mo=!0;var e=0,t=ye;try{var r=Ut;for(ye=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}Ut=null,Hn=!1}catch(o){throw Ut!==null&&(Ut=Ut.slice(e+1)),hu(Ya,Sr),o}finally{ye=t,mo=!1}}return null}var Xr=[],Yr=0,_n=null,mn=0,vt=[],yt=0,Nr=null,Wt=1,Vt="";function br(e,t){Xr[Yr++]=mn,Xr[Yr++]=_n,_n=e,mn=t}function Hu(e,t,r){vt[yt++]=Wt,vt[yt++]=Vt,vt[yt++]=Nr,Nr=e;var s=Wt;e=Vt;var o=32-Tt(s)-1;s&=~(1<<o),r+=1;var g=32-Tt(t)+o;if(30<g){var S=o-o%5;g=(s&(1<<S)-1).toString(32),s>>=S,o-=S,Wt=1<<32-Tt(t)+o|r<<o|s,Vt=g+e}else Wt=1<<g|r<<o|s,Vt=e}function nl(e){e.return!==null&&(br(e,1),Hu(e,1,0))}function ol(e){for(;e===_n;)_n=Xr[--Yr],Xr[Yr]=null,mn=Xr[--Yr],Xr[Yr]=null;for(;e===Nr;)Nr=vt[--yt],vt[yt]=null,Vt=vt[--yt],vt[yt]=null,Wt=vt[--yt],vt[yt]=null}var dt=null,ut=null,Le=!1,At=null;function zu(e,t){var r=wt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Lc(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,dt=e,ut=dr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,dt=e,ut=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Nr!==null?{id:Wt,overflow:Vt}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=wt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,dt=e,ut=null,!0):!1;default:return!1}}function la(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ca(e){if(Le){var t=ut;if(t){var r=t;if(!Lc(e,t)){if(la(e))throw Error(X(418));t=dr(r.nextSibling);var s=dt;t&&Lc(e,t)?zu(s,r):(e.flags=e.flags&-4097|2,Le=!1,dt=e)}}else{if(la(e))throw Error(X(418));e.flags=e.flags&-4097|2,Le=!1,dt=e}}}function Rc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;dt=e}function Ti(e){if(e!==dt)return!1;if(!Le)return Rc(e),Le=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ia(e.type,e.memoizedProps)),t&&(t=ut)){if(la(e))throw $u(),Error(X(418));for(;t;)zu(e,t),t=dr(t.nextSibling)}if(Rc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(X(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ut=dr(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ut=null}}else ut=dt?dr(e.stateNode.nextSibling):null;return!0}function $u(){for(var e=ut;e;)e=dr(e.nextSibling)}function cs(){ut=dt=null,Le=!1}function al(e){At===null?At=[e]:At.push(e)}var Tg=Zt.ReactCurrentBatchConfig;function Es(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(X(309));var s=r.stateNode}if(!s)throw Error(X(147,e));var o=s,g=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===g?t.ref:(t=function(S){var i=o.refs;S===null?delete i[g]:i[g]=S},t._stringRef=g,t)}if(typeof e!="string")throw Error(X(284));if(!r._owner)throw Error(X(290,e))}return e}function Di(e,t){throw e=Object.prototype.toString.call(t),Error(X(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ac(e){var t=e._init;return t(e._payload)}function Uu(e){function t(c,l){if(e){var h=c.deletions;h===null?(c.deletions=[l],c.flags|=16):h.push(l)}}function r(c,l){if(!e)return null;for(;l!==null;)t(c,l),l=l.sibling;return null}function s(c,l){for(c=new Map;l!==null;)l.key!==null?c.set(l.key,l):c.set(l.index,l),l=l.sibling;return c}function o(c,l){return c=_r(c,l),c.index=0,c.sibling=null,c}function g(c,l,h){return c.index=h,e?(h=c.alternate,h!==null?(h=h.index,h<l?(c.flags|=2,l):h):(c.flags|=2,l)):(c.flags|=1048576,l)}function S(c){return e&&c.alternate===null&&(c.flags|=2),c}function i(c,l,h,m){return l===null||l.tag!==6?(l=bo(h,c.mode,m),l.return=c,l):(l=o(l,h),l.return=c,l)}function a(c,l,h,m){var y=h.type;return y===Ur?v(c,l,h.props.children,m,h.key):l!==null&&(l.elementType===y||typeof y=="object"&&y!==null&&y.$$typeof===sr&&Ac(y)===l.type)?(m=o(l,h.props),m.ref=Es(c,l,h),m.return=c,m):(m=Ji(h.type,h.key,h.props,null,c.mode,m),m.ref=Es(c,l,h),m.return=c,m)}function d(c,l,h,m){return l===null||l.tag!==4||l.stateNode.containerInfo!==h.containerInfo||l.stateNode.implementation!==h.implementation?(l=ko(h,c.mode,m),l.return=c,l):(l=o(l,h.children||[]),l.return=c,l)}function v(c,l,h,m,y){return l===null||l.tag!==7?(l=Dr(h,c.mode,m,y),l.return=c,l):(l=o(l,h),l.return=c,l)}function u(c,l,h){if(typeof l=="string"&&l!==""||typeof l=="number")return l=bo(""+l,c.mode,h),l.return=c,l;if(typeof l=="object"&&l!==null){switch(l.$$typeof){case xi:return h=Ji(l.type,l.key,l.props,null,c.mode,h),h.ref=Es(c,null,l),h.return=c,h;case $r:return l=ko(l,c.mode,h),l.return=c,l;case sr:var m=l._init;return u(c,m(l._payload),h)}if(Ms(l)||ws(l))return l=Dr(l,c.mode,h,null),l.return=c,l;Di(c,l)}return null}function _(c,l,h,m){var y=l!==null?l.key:null;if(typeof h=="string"&&h!==""||typeof h=="number")return y!==null?null:i(c,l,""+h,m);if(typeof h=="object"&&h!==null){switch(h.$$typeof){case xi:return h.key===y?a(c,l,h,m):null;case $r:return h.key===y?d(c,l,h,m):null;case sr:return y=h._init,_(c,l,y(h._payload),m)}if(Ms(h)||ws(h))return y!==null?null:v(c,l,h,m,null);Di(c,h)}return null}function b(c,l,h,m,y){if(typeof m=="string"&&m!==""||typeof m=="number")return c=c.get(h)||null,i(l,c,""+m,y);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case xi:return c=c.get(m.key===null?h:m.key)||null,a(l,c,m,y);case $r:return c=c.get(m.key===null?h:m.key)||null,d(l,c,m,y);case sr:var C=m._init;return b(c,l,h,C(m._payload),y)}if(Ms(m)||ws(m))return c=c.get(h)||null,v(l,c,m,y,null);Di(l,m)}return null}function w(c,l,h,m){for(var y=null,C=null,L=l,x=l=0,E=null;L!==null&&x<h.length;x++){L.index>x?(E=L,L=null):E=L.sibling;var k=_(c,L,h[x],m);if(k===null){L===null&&(L=E);break}e&&L&&k.alternate===null&&t(c,L),l=g(k,l,x),C===null?y=k:C.sibling=k,C=k,L=E}if(x===h.length)return r(c,L),Le&&br(c,x),y;if(L===null){for(;x<h.length;x++)L=u(c,h[x],m),L!==null&&(l=g(L,l,x),C===null?y=L:C.sibling=L,C=L);return Le&&br(c,x),y}for(L=s(c,L);x<h.length;x++)E=b(L,c,x,h[x],m),E!==null&&(e&&E.alternate!==null&&L.delete(E.key===null?x:E.key),l=g(E,l,x),C===null?y=E:C.sibling=E,C=E);return e&&L.forEach(function(T){return t(c,T)}),Le&&br(c,x),y}function f(c,l,h,m){var y=ws(h);if(typeof y!="function")throw Error(X(150));if(h=y.call(h),h==null)throw Error(X(151));for(var C=y=null,L=l,x=l=0,E=null,k=h.next();L!==null&&!k.done;x++,k=h.next()){L.index>x?(E=L,L=null):E=L.sibling;var T=_(c,L,k.value,m);if(T===null){L===null&&(L=E);break}e&&L&&T.alternate===null&&t(c,L),l=g(T,l,x),C===null?y=T:C.sibling=T,C=T,L=E}if(k.done)return r(c,L),Le&&br(c,x),y;if(L===null){for(;!k.done;x++,k=h.next())k=u(c,k.value,m),k!==null&&(l=g(k,l,x),C===null?y=k:C.sibling=k,C=k);return Le&&br(c,x),y}for(L=s(c,L);!k.done;x++,k=h.next())k=b(L,c,x,k.value,m),k!==null&&(e&&k.alternate!==null&&L.delete(k.key===null?x:k.key),l=g(k,l,x),C===null?y=k:C.sibling=k,C=k);return e&&L.forEach(function(A){return t(c,A)}),Le&&br(c,x),y}function n(c,l,h,m){if(typeof h=="object"&&h!==null&&h.type===Ur&&h.key===null&&(h=h.props.children),typeof h=="object"&&h!==null){switch(h.$$typeof){case xi:e:{for(var y=h.key,C=l;C!==null;){if(C.key===y){if(y=h.type,y===Ur){if(C.tag===7){r(c,C.sibling),l=o(C,h.props.children),l.return=c,c=l;break e}}else if(C.elementType===y||typeof y=="object"&&y!==null&&y.$$typeof===sr&&Ac(y)===C.type){r(c,C.sibling),l=o(C,h.props),l.ref=Es(c,C,h),l.return=c,c=l;break e}r(c,C);break}else t(c,C);C=C.sibling}h.type===Ur?(l=Dr(h.props.children,c.mode,m,h.key),l.return=c,c=l):(m=Ji(h.type,h.key,h.props,null,c.mode,m),m.ref=Es(c,l,h),m.return=c,c=m)}return S(c);case $r:e:{for(C=h.key;l!==null;){if(l.key===C)if(l.tag===4&&l.stateNode.containerInfo===h.containerInfo&&l.stateNode.implementation===h.implementation){r(c,l.sibling),l=o(l,h.children||[]),l.return=c,c=l;break e}else{r(c,l);break}else t(c,l);l=l.sibling}l=ko(h,c.mode,m),l.return=c,c=l}return S(c);case sr:return C=h._init,n(c,l,C(h._payload),m)}if(Ms(h))return w(c,l,h,m);if(ws(h))return f(c,l,h,m);Di(c,h)}return typeof h=="string"&&h!==""||typeof h=="number"?(h=""+h,l!==null&&l.tag===6?(r(c,l.sibling),l=o(l,h),l.return=c,c=l):(r(c,l),l=bo(h,c.mode,m),l.return=c,c=l),S(c)):r(c,l)}return n}var hs=Uu(!0),Wu=Uu(!1),vn=wr(null),yn=null,Qr=null,ll=null;function cl(){ll=Qr=yn=null}function hl(e){var t=vn.current;be(vn),e._currentValue=t}function ha(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function is(e,t){yn=e,ll=Qr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(st=!0),e.firstContext=null)}function Ct(e){var t=e._currentValue;if(ll!==e)if(e={context:e,memoizedValue:t,next:null},Qr===null){if(yn===null)throw Error(X(308));Qr=e,yn.dependencies={lanes:0,firstContext:e}}else Qr=Qr.next=e;return t}var Lr=null;function ul(e){Lr===null?Lr=[e]:Lr.push(e)}function Vu(e,t,r,s){var o=t.interleaved;return o===null?(r.next=r,ul(t)):(r.next=o.next,o.next=r),t.interleaved=r,Xt(e,s)}function Xt(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ir=!1;function dl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qu(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fr(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,me&2){var o=s.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),s.pending=t,Xt(e,r)}return o=s.interleaved,o===null?(t.next=t,ul(s)):(t.next=o.next,o.next=t),s.interleaved=t,Xt(e,r)}function qi(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Qa(e,r)}}function Tc(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var o=null,g=null;if(r=r.firstBaseUpdate,r!==null){do{var S={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};g===null?o=g=S:g=g.next=S,r=r.next}while(r!==null);g===null?o=g=t:g=g.next=t}else o=g=t;r={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:g,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function xn(e,t,r,s){var o=e.updateQueue;ir=!1;var g=o.firstBaseUpdate,S=o.lastBaseUpdate,i=o.shared.pending;if(i!==null){o.shared.pending=null;var a=i,d=a.next;a.next=null,S===null?g=d:S.next=d,S=a;var v=e.alternate;v!==null&&(v=v.updateQueue,i=v.lastBaseUpdate,i!==S&&(i===null?v.firstBaseUpdate=d:i.next=d,v.lastBaseUpdate=a))}if(g!==null){var u=o.baseState;S=0,v=d=a=null,i=g;do{var _=i.lane,b=i.eventTime;if((s&_)===_){v!==null&&(v=v.next={eventTime:b,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var w=e,f=i;switch(_=t,b=r,f.tag){case 1:if(w=f.payload,typeof w=="function"){u=w.call(b,u,_);break e}u=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=f.payload,_=typeof w=="function"?w.call(b,u,_):w,_==null)break e;u=De({},u,_);break e;case 2:ir=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,_=o.effects,_===null?o.effects=[i]:_.push(i))}else b={eventTime:b,lane:_,tag:i.tag,payload:i.payload,callback:i.callback,next:null},v===null?(d=v=b,a=u):v=v.next=b,S|=_;if(i=i.next,i===null){if(i=o.shared.pending,i===null)break;_=i,i=_.next,_.next=null,o.lastBaseUpdate=_,o.shared.pending=null}}while(!0);if(v===null&&(a=u),o.baseState=a,o.firstBaseUpdate=d,o.lastBaseUpdate=v,t=o.shared.interleaved,t!==null){o=t;do S|=o.lane,o=o.next;while(o!==t)}else g===null&&(o.shared.lanes=0);Pr|=S,e.lanes=S,e.memoizedState=u}}function Dc(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],o=s.callback;if(o!==null){if(s.callback=null,s=r,typeof o!="function")throw Error(X(191,o));o.call(s)}}}var gi={},Ot=wr(gi),si=wr(gi),ii=wr(gi);function Rr(e){if(e===gi)throw Error(X(174));return e}function fl(e,t){switch(Se(ii,t),Se(si,e),Se(Ot,gi),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Wo(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Wo(t,e)}be(Ot),Se(Ot,t)}function us(){be(Ot),be(si),be(ii)}function Ku(e){Rr(ii.current);var t=Rr(Ot.current),r=Wo(t,e.type);t!==r&&(Se(si,e),Se(Ot,r))}function pl(e){si.current===e&&(be(Ot),be(si))}var Ae=wr(0);function wn(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var vo=[];function gl(){for(var e=0;e<vo.length;e++)vo[e]._workInProgressVersionPrimary=null;vo.length=0}var Ki=Zt.ReactCurrentDispatcher,yo=Zt.ReactCurrentBatchConfig,jr=0,Te=null,Ie=null,He=null,Sn=!1,zs=!1,ni=0,Dg=0;function qe(){throw Error(X(321))}function _l(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Mt(e[r],t[r]))return!1;return!0}function ml(e,t,r,s,o,g){if(jr=g,Te=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ki.current=e===null||e.memoizedState===null?Pg:Bg,e=r(s,o),zs){g=0;do{if(zs=!1,ni=0,25<=g)throw Error(X(301));g+=1,He=Ie=null,t.updateQueue=null,Ki.current=Og,e=r(s,o)}while(zs)}if(Ki.current=Cn,t=Ie!==null&&Ie.next!==null,jr=0,He=Ie=Te=null,Sn=!1,t)throw Error(X(300));return e}function vl(){var e=ni!==0;return ni=0,e}function jt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return He===null?Te.memoizedState=He=e:He=He.next=e,He}function bt(){if(Ie===null){var e=Te.alternate;e=e!==null?e.memoizedState:null}else e=Ie.next;var t=He===null?Te.memoizedState:He.next;if(t!==null)He=t,Ie=e;else{if(e===null)throw Error(X(310));Ie=e,e={memoizedState:Ie.memoizedState,baseState:Ie.baseState,baseQueue:Ie.baseQueue,queue:Ie.queue,next:null},He===null?Te.memoizedState=He=e:He=He.next=e}return He}function oi(e,t){return typeof t=="function"?t(e):t}function xo(e){var t=bt(),r=t.queue;if(r===null)throw Error(X(311));r.lastRenderedReducer=e;var s=Ie,o=s.baseQueue,g=r.pending;if(g!==null){if(o!==null){var S=o.next;o.next=g.next,g.next=S}s.baseQueue=o=g,r.pending=null}if(o!==null){g=o.next,s=s.baseState;var i=S=null,a=null,d=g;do{var v=d.lane;if((jr&v)===v)a!==null&&(a=a.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:e(s,d.action);else{var u={lane:v,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};a===null?(i=a=u,S=s):a=a.next=u,Te.lanes|=v,Pr|=v}d=d.next}while(d!==null&&d!==g);a===null?S=s:a.next=i,Mt(s,t.memoizedState)||(st=!0),t.memoizedState=s,t.baseState=S,t.baseQueue=a,r.lastRenderedState=s}if(e=r.interleaved,e!==null){o=e;do g=o.lane,Te.lanes|=g,Pr|=g,o=o.next;while(o!==e)}else o===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function wo(e){var t=bt(),r=t.queue;if(r===null)throw Error(X(311));r.lastRenderedReducer=e;var s=r.dispatch,o=r.pending,g=t.memoizedState;if(o!==null){r.pending=null;var S=o=o.next;do g=e(g,S.action),S=S.next;while(S!==o);Mt(g,t.memoizedState)||(st=!0),t.memoizedState=g,t.baseQueue===null&&(t.baseState=g),r.lastRenderedState=g}return[g,s]}function Gu(){}function Xu(e,t){var r=Te,s=bt(),o=t(),g=!Mt(s.memoizedState,o);if(g&&(s.memoizedState=o,st=!0),s=s.queue,yl(Ju.bind(null,r,s,e),[e]),s.getSnapshot!==t||g||He!==null&&He.memoizedState.tag&1){if(r.flags|=2048,ai(9,Qu.bind(null,r,s,o,t),void 0,null),ze===null)throw Error(X(349));jr&30||Yu(r,t,o)}return o}function Yu(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Te.updateQueue,t===null?(t={lastEffect:null,stores:null},Te.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Qu(e,t,r,s){t.value=r,t.getSnapshot=s,Zu(t)&&ed(e)}function Ju(e,t,r){return r(function(){Zu(t)&&ed(e)})}function Zu(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Mt(e,r)}catch{return!0}}function ed(e){var t=Xt(e,1);t!==null&&Dt(t,e,1,-1)}function Mc(e){var t=jt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:e},t.queue=e,e=e.dispatch=jg.bind(null,Te,e),[t.memoizedState,e]}function ai(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=Te.updateQueue,t===null?(t={lastEffect:null,stores:null},Te.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function td(){return bt().memoizedState}function Gi(e,t,r,s){var o=jt();Te.flags|=e,o.memoizedState=ai(1|t,r,void 0,s===void 0?null:s)}function zn(e,t,r,s){var o=bt();s=s===void 0?null:s;var g=void 0;if(Ie!==null){var S=Ie.memoizedState;if(g=S.destroy,s!==null&&_l(s,S.deps)){o.memoizedState=ai(t,r,g,s);return}}Te.flags|=e,o.memoizedState=ai(1|t,r,g,s)}function Nc(e,t){return Gi(8390656,8,e,t)}function yl(e,t){return zn(2048,8,e,t)}function rd(e,t){return zn(4,2,e,t)}function sd(e,t){return zn(4,4,e,t)}function id(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function nd(e,t,r){return r=r!=null?r.concat([e]):null,zn(4,4,id.bind(null,t,e),r)}function xl(){}function od(e,t){var r=bt();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&_l(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function ad(e,t){var r=bt();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&_l(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function ld(e,t,r){return jr&21?(Mt(r,t)||(r=fu(),Te.lanes|=r,Pr|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,st=!0),e.memoizedState=r)}function Mg(e,t){var r=ye;ye=r!==0&&4>r?r:4,e(!0);var s=yo.transition;yo.transition={};try{e(!1),t()}finally{ye=r,yo.transition=s}}function cd(){return bt().memoizedState}function Ng(e,t,r){var s=gr(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},hd(e))ud(t,r);else if(r=Vu(e,t,r,s),r!==null){var o=Je();Dt(r,e,s,o),dd(r,t,s)}}function jg(e,t,r){var s=gr(e),o={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(hd(e))ud(t,o);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=t.lastRenderedReducer,g!==null))try{var S=t.lastRenderedState,i=g(S,r);if(o.hasEagerState=!0,o.eagerState=i,Mt(i,S)){var a=t.interleaved;a===null?(o.next=o,ul(t)):(o.next=a.next,a.next=o),t.interleaved=o;return}}catch{}finally{}r=Vu(e,t,o,s),r!==null&&(o=Je(),Dt(r,e,s,o),dd(r,t,s))}}function hd(e){var t=e.alternate;return e===Te||t!==null&&t===Te}function ud(e,t){zs=Sn=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function dd(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Qa(e,r)}}var Cn={readContext:Ct,useCallback:qe,useContext:qe,useEffect:qe,useImperativeHandle:qe,useInsertionEffect:qe,useLayoutEffect:qe,useMemo:qe,useReducer:qe,useRef:qe,useState:qe,useDebugValue:qe,useDeferredValue:qe,useTransition:qe,useMutableSource:qe,useSyncExternalStore:qe,useId:qe,unstable_isNewReconciler:!1},Pg={readContext:Ct,useCallback:function(e,t){return jt().memoizedState=[e,t===void 0?null:t],e},useContext:Ct,useEffect:Nc,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Gi(4194308,4,id.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Gi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Gi(4,2,e,t)},useMemo:function(e,t){var r=jt();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=jt();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=Ng.bind(null,Te,e),[s.memoizedState,e]},useRef:function(e){var t=jt();return e={current:e},t.memoizedState=e},useState:Mc,useDebugValue:xl,useDeferredValue:function(e){return jt().memoizedState=e},useTransition:function(){var e=Mc(!1),t=e[0];return e=Mg.bind(null,e[1]),jt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=Te,o=jt();if(Le){if(r===void 0)throw Error(X(407));r=r()}else{if(r=t(),ze===null)throw Error(X(349));jr&30||Yu(s,t,r)}o.memoizedState=r;var g={value:r,getSnapshot:t};return o.queue=g,Nc(Ju.bind(null,s,g,e),[e]),s.flags|=2048,ai(9,Qu.bind(null,s,g,r,t),void 0,null),r},useId:function(){var e=jt(),t=ze.identifierPrefix;if(Le){var r=Vt,s=Wt;r=(s&~(1<<32-Tt(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=ni++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Dg++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Bg={readContext:Ct,useCallback:od,useContext:Ct,useEffect:yl,useImperativeHandle:nd,useInsertionEffect:rd,useLayoutEffect:sd,useMemo:ad,useReducer:xo,useRef:td,useState:function(){return xo(oi)},useDebugValue:xl,useDeferredValue:function(e){var t=bt();return ld(t,Ie.memoizedState,e)},useTransition:function(){var e=xo(oi)[0],t=bt().memoizedState;return[e,t]},useMutableSource:Gu,useSyncExternalStore:Xu,useId:cd,unstable_isNewReconciler:!1},Og={readContext:Ct,useCallback:od,useContext:Ct,useEffect:yl,useImperativeHandle:nd,useInsertionEffect:rd,useLayoutEffect:sd,useMemo:ad,useReducer:wo,useRef:td,useState:function(){return wo(oi)},useDebugValue:xl,useDeferredValue:function(e){var t=bt();return Ie===null?t.memoizedState=e:ld(t,Ie.memoizedState,e)},useTransition:function(){var e=wo(oi)[0],t=bt().memoizedState;return[e,t]},useMutableSource:Gu,useSyncExternalStore:Xu,useId:cd,unstable_isNewReconciler:!1};function Et(e,t){if(e&&e.defaultProps){t=De({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ua(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:De({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var $n={isMounted:function(e){return(e=e._reactInternals)?Fr(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=Je(),o=gr(e),g=qt(s,o);g.payload=t,r!=null&&(g.callback=r),t=fr(e,g,o),t!==null&&(Dt(t,e,o,s),qi(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=Je(),o=gr(e),g=qt(s,o);g.tag=1,g.payload=t,r!=null&&(g.callback=r),t=fr(e,g,o),t!==null&&(Dt(t,e,o,s),qi(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Je(),s=gr(e),o=qt(r,s);o.tag=2,t!=null&&(o.callback=t),t=fr(e,o,s),t!==null&&(Dt(t,e,s,r),qi(t,e,s))}};function jc(e,t,r,s,o,g,S){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,g,S):t.prototype&&t.prototype.isPureReactComponent?!Zs(r,s)||!Zs(o,g):!0}function fd(e,t,r){var s=!1,o=yr,g=t.contextType;return typeof g=="object"&&g!==null?g=Ct(g):(o=nt(t)?Mr:Xe.current,s=t.contextTypes,g=(s=s!=null)?ls(e,o):yr),t=new t(r,g),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=$n,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=g),t}function Pc(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&$n.enqueueReplaceState(t,t.state,null)}function da(e,t,r,s){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs={},dl(e);var g=t.contextType;typeof g=="object"&&g!==null?o.context=Ct(g):(g=nt(t)?Mr:Xe.current,o.context=ls(e,g)),o.state=e.memoizedState,g=t.getDerivedStateFromProps,typeof g=="function"&&(ua(e,t,g,r),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&$n.enqueueReplaceState(o,o.state,null),xn(e,r,o,s),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function ds(e,t){try{var r="",s=t;do r+=up(s),s=s.return;while(s);var o=r}catch(g){o=`
Error generating stack: `+g.message+`
`+g.stack}return{value:e,source:t,stack:o,digest:null}}function So(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function fa(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Ig=typeof WeakMap=="function"?WeakMap:Map;function pd(e,t,r){r=qt(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){kn||(kn=!0,Ca=s),fa(e,t)},r}function gd(e,t,r){r=qt(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var o=t.value;r.payload=function(){return s(o)},r.callback=function(){fa(e,t)}}var g=e.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(r.callback=function(){fa(e,t),typeof s!="function"&&(pr===null?pr=new Set([this]):pr.add(this));var S=t.stack;this.componentDidCatch(t.value,{componentStack:S!==null?S:""})}),r}function Bc(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new Ig;var o=new Set;s.set(t,o)}else o=s.get(t),o===void 0&&(o=new Set,s.set(t,o));o.has(r)||(o.add(r),e=Jg.bind(null,e,t,r),t.then(e,e))}function Oc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ic(e,t,r,s,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=qt(-1,1),t.tag=2,fr(r,t,1))),r.lanes|=1),e)}var Fg=Zt.ReactCurrentOwner,st=!1;function Qe(e,t,r,s){t.child=e===null?Wu(t,null,r,s):hs(t,e.child,r,s)}function Fc(e,t,r,s,o){r=r.render;var g=t.ref;return is(t,o),s=ml(e,t,r,s,g,o),r=vl(),e!==null&&!st?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Yt(e,t,o)):(Le&&r&&nl(t),t.flags|=1,Qe(e,t,s,o),t.child)}function Hc(e,t,r,s,o){if(e===null){var g=r.type;return typeof g=="function"&&!Rl(g)&&g.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=g,_d(e,t,g,s,o)):(e=Ji(r.type,null,s,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(g=e.child,!(e.lanes&o)){var S=g.memoizedProps;if(r=r.compare,r=r!==null?r:Zs,r(S,s)&&e.ref===t.ref)return Yt(e,t,o)}return t.flags|=1,e=_r(g,s),e.ref=t.ref,e.return=t,t.child=e}function _d(e,t,r,s,o){if(e!==null){var g=e.memoizedProps;if(Zs(g,s)&&e.ref===t.ref)if(st=!1,t.pendingProps=s=g,(e.lanes&o)!==0)e.flags&131072&&(st=!0);else return t.lanes=e.lanes,Yt(e,t,o)}return pa(e,t,r,s,o)}function md(e,t,r){var s=t.pendingProps,o=s.children,g=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Se(Zr,ht),ht|=r;else{if(!(r&1073741824))return e=g!==null?g.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Se(Zr,ht),ht|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=g!==null?g.baseLanes:r,Se(Zr,ht),ht|=s}else g!==null?(s=g.baseLanes|r,t.memoizedState=null):s=r,Se(Zr,ht),ht|=s;return Qe(e,t,o,r),t.child}function vd(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function pa(e,t,r,s,o){var g=nt(r)?Mr:Xe.current;return g=ls(t,g),is(t,o),r=ml(e,t,r,s,g,o),s=vl(),e!==null&&!st?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Yt(e,t,o)):(Le&&s&&nl(t),t.flags|=1,Qe(e,t,r,o),t.child)}function zc(e,t,r,s,o){if(nt(r)){var g=!0;gn(t)}else g=!1;if(is(t,o),t.stateNode===null)Xi(e,t),fd(t,r,s),da(t,r,s,o),s=!0;else if(e===null){var S=t.stateNode,i=t.memoizedProps;S.props=i;var a=S.context,d=r.contextType;typeof d=="object"&&d!==null?d=Ct(d):(d=nt(r)?Mr:Xe.current,d=ls(t,d));var v=r.getDerivedStateFromProps,u=typeof v=="function"||typeof S.getSnapshotBeforeUpdate=="function";u||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(i!==s||a!==d)&&Pc(t,S,s,d),ir=!1;var _=t.memoizedState;S.state=_,xn(t,s,S,o),a=t.memoizedState,i!==s||_!==a||it.current||ir?(typeof v=="function"&&(ua(t,r,v,s),a=t.memoizedState),(i=ir||jc(t,r,i,s,_,a,d))?(u||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(t.flags|=4194308)):(typeof S.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=a),S.props=s,S.state=a,S.context=d,s=i):(typeof S.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{S=t.stateNode,qu(e,t),i=t.memoizedProps,d=t.type===t.elementType?i:Et(t.type,i),S.props=d,u=t.pendingProps,_=S.context,a=r.contextType,typeof a=="object"&&a!==null?a=Ct(a):(a=nt(r)?Mr:Xe.current,a=ls(t,a));var b=r.getDerivedStateFromProps;(v=typeof b=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(i!==u||_!==a)&&Pc(t,S,s,a),ir=!1,_=t.memoizedState,S.state=_,xn(t,s,S,o);var w=t.memoizedState;i!==u||_!==w||it.current||ir?(typeof b=="function"&&(ua(t,r,b,s),w=t.memoizedState),(d=ir||jc(t,r,d,s,_,w,a)||!1)?(v||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(s,w,a),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(s,w,a)),typeof S.componentDidUpdate=="function"&&(t.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof S.componentDidUpdate!="function"||i===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=w),S.props=s,S.state=w,S.context=a,s=d):(typeof S.componentDidUpdate!="function"||i===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),s=!1)}return ga(e,t,r,s,g,o)}function ga(e,t,r,s,o,g){vd(e,t);var S=(t.flags&128)!==0;if(!s&&!S)return o&&Ec(t,r,!1),Yt(e,t,g);s=t.stateNode,Fg.current=t;var i=S&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&S?(t.child=hs(t,e.child,null,g),t.child=hs(t,null,i,g)):Qe(e,t,i,g),t.memoizedState=s.state,o&&Ec(t,r,!0),t.child}function yd(e){var t=e.stateNode;t.pendingContext?kc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&kc(e,t.context,!1),fl(e,t.containerInfo)}function $c(e,t,r,s,o){return cs(),al(o),t.flags|=256,Qe(e,t,r,s),t.child}var _a={dehydrated:null,treeContext:null,retryLane:0};function ma(e){return{baseLanes:e,cachePool:null,transitions:null}}function xd(e,t,r){var s=t.pendingProps,o=Ae.current,g=!1,S=(t.flags&128)!==0,i;if((i=S)||(i=e!==null&&e.memoizedState===null?!1:(o&2)!==0),i?(g=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Se(Ae,o&1),e===null)return ca(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(S=s.children,e=s.fallback,g?(s=t.mode,g=t.child,S={mode:"hidden",children:S},!(s&1)&&g!==null?(g.childLanes=0,g.pendingProps=S):g=Vn(S,s,0,null),e=Dr(e,s,r,null),g.return=t,e.return=t,g.sibling=e,t.child=g,t.child.memoizedState=ma(r),t.memoizedState=_a,e):wl(t,S));if(o=e.memoizedState,o!==null&&(i=o.dehydrated,i!==null))return Hg(e,t,S,s,i,o,r);if(g){g=s.fallback,S=t.mode,o=e.child,i=o.sibling;var a={mode:"hidden",children:s.children};return!(S&1)&&t.child!==o?(s=t.child,s.childLanes=0,s.pendingProps=a,t.deletions=null):(s=_r(o,a),s.subtreeFlags=o.subtreeFlags&14680064),i!==null?g=_r(i,g):(g=Dr(g,S,r,null),g.flags|=2),g.return=t,s.return=t,s.sibling=g,t.child=s,s=g,g=t.child,S=e.child.memoizedState,S=S===null?ma(r):{baseLanes:S.baseLanes|r,cachePool:null,transitions:S.transitions},g.memoizedState=S,g.childLanes=e.childLanes&~r,t.memoizedState=_a,s}return g=e.child,e=g.sibling,s=_r(g,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function wl(e,t){return t=Vn({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Mi(e,t,r,s){return s!==null&&al(s),hs(t,e.child,null,r),e=wl(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Hg(e,t,r,s,o,g,S){if(r)return t.flags&256?(t.flags&=-257,s=So(Error(X(422))),Mi(e,t,S,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(g=s.fallback,o=t.mode,s=Vn({mode:"visible",children:s.children},o,0,null),g=Dr(g,o,S,null),g.flags|=2,s.return=t,g.return=t,s.sibling=g,t.child=s,t.mode&1&&hs(t,e.child,null,S),t.child.memoizedState=ma(S),t.memoizedState=_a,g);if(!(t.mode&1))return Mi(e,t,S,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var i=s.dgst;return s=i,g=Error(X(419)),s=So(g,s,void 0),Mi(e,t,S,s)}if(i=(S&e.childLanes)!==0,st||i){if(s=ze,s!==null){switch(S&-S){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(s.suspendedLanes|S)?0:o,o!==0&&o!==g.retryLane&&(g.retryLane=o,Xt(e,o),Dt(s,e,o,-1))}return Ll(),s=So(Error(X(421))),Mi(e,t,S,s)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=Zg.bind(null,e),o._reactRetry=t,null):(e=g.treeContext,ut=dr(o.nextSibling),dt=t,Le=!0,At=null,e!==null&&(vt[yt++]=Wt,vt[yt++]=Vt,vt[yt++]=Nr,Wt=e.id,Vt=e.overflow,Nr=t),t=wl(t,s.children),t.flags|=4096,t)}function Uc(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),ha(e.return,t,r)}function Co(e,t,r,s,o){var g=e.memoizedState;g===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:o}:(g.isBackwards=t,g.rendering=null,g.renderingStartTime=0,g.last=s,g.tail=r,g.tailMode=o)}function wd(e,t,r){var s=t.pendingProps,o=s.revealOrder,g=s.tail;if(Qe(e,t,s.children,r),s=Ae.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Uc(e,r,t);else if(e.tag===19)Uc(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Se(Ae,s),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(r=t.child,o=null;r!==null;)e=r.alternate,e!==null&&wn(e)===null&&(o=r),r=r.sibling;r=o,r===null?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),Co(t,!1,o,r,g);break;case"backwards":for(r=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&wn(e)===null){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}Co(t,!0,r,null,g);break;case"together":Co(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Xi(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Yt(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Pr|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(X(153));if(t.child!==null){for(e=t.child,r=_r(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=_r(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function zg(e,t,r){switch(t.tag){case 3:yd(t),cs();break;case 5:Ku(t);break;case 1:nt(t.type)&&gn(t);break;case 4:fl(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,o=t.memoizedProps.value;Se(vn,s._currentValue),s._currentValue=o;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(Se(Ae,Ae.current&1),t.flags|=128,null):r&t.child.childLanes?xd(e,t,r):(Se(Ae,Ae.current&1),e=Yt(e,t,r),e!==null?e.sibling:null);Se(Ae,Ae.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return wd(e,t,r);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Se(Ae,Ae.current),s)break;return null;case 22:case 23:return t.lanes=0,md(e,t,r)}return Yt(e,t,r)}var Sd,va,Cd,bd;Sd=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};va=function(){};Cd=function(e,t,r,s){var o=e.memoizedProps;if(o!==s){e=t.stateNode,Rr(Ot.current);var g=null;switch(r){case"input":o=Ho(e,o),s=Ho(e,s),g=[];break;case"select":o=De({},o,{value:void 0}),s=De({},s,{value:void 0}),g=[];break;case"textarea":o=Uo(e,o),s=Uo(e,s),g=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=fn)}Vo(r,s);var S;r=null;for(d in o)if(!s.hasOwnProperty(d)&&o.hasOwnProperty(d)&&o[d]!=null)if(d==="style"){var i=o[d];for(S in i)i.hasOwnProperty(S)&&(r||(r={}),r[S]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(qs.hasOwnProperty(d)?g||(g=[]):(g=g||[]).push(d,null));for(d in s){var a=s[d];if(i=o!=null?o[d]:void 0,s.hasOwnProperty(d)&&a!==i&&(a!=null||i!=null))if(d==="style")if(i){for(S in i)!i.hasOwnProperty(S)||a&&a.hasOwnProperty(S)||(r||(r={}),r[S]="");for(S in a)a.hasOwnProperty(S)&&i[S]!==a[S]&&(r||(r={}),r[S]=a[S])}else r||(g||(g=[]),g.push(d,r)),r=a;else d==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,i=i?i.__html:void 0,a!=null&&i!==a&&(g=g||[]).push(d,a)):d==="children"?typeof a!="string"&&typeof a!="number"||(g=g||[]).push(d,""+a):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(qs.hasOwnProperty(d)?(a!=null&&d==="onScroll"&&Ce("scroll",e),g||i===a||(g=[])):(g=g||[]).push(d,a))}r&&(g=g||[]).push("style",r);var d=g;(t.updateQueue=d)&&(t.flags|=4)}};bd=function(e,t,r,s){r!==s&&(t.flags|=4)};function Ls(e,t){if(!Le)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Ke(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var o=e.child;o!==null;)r|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)r|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function $g(e,t,r){var s=t.pendingProps;switch(ol(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ke(t),null;case 1:return nt(t.type)&&pn(),Ke(t),null;case 3:return s=t.stateNode,us(),be(it),be(Xe),gl(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Ti(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,At!==null&&(Ea(At),At=null))),va(e,t),Ke(t),null;case 5:pl(t);var o=Rr(ii.current);if(r=t.type,e!==null&&t.stateNode!=null)Cd(e,t,r,s,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(X(166));return Ke(t),null}if(e=Rr(Ot.current),Ti(t)){s=t.stateNode,r=t.type;var g=t.memoizedProps;switch(s[Pt]=t,s[ri]=g,e=(t.mode&1)!==0,r){case"dialog":Ce("cancel",s),Ce("close",s);break;case"iframe":case"object":case"embed":Ce("load",s);break;case"video":case"audio":for(o=0;o<js.length;o++)Ce(js[o],s);break;case"source":Ce("error",s);break;case"img":case"image":case"link":Ce("error",s),Ce("load",s);break;case"details":Ce("toggle",s);break;case"input":Jl(s,g),Ce("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!g.multiple},Ce("invalid",s);break;case"textarea":ec(s,g),Ce("invalid",s)}Vo(r,g),o=null;for(var S in g)if(g.hasOwnProperty(S)){var i=g[S];S==="children"?typeof i=="string"?s.textContent!==i&&(g.suppressHydrationWarning!==!0&&Ai(s.textContent,i,e),o=["children",i]):typeof i=="number"&&s.textContent!==""+i&&(g.suppressHydrationWarning!==!0&&Ai(s.textContent,i,e),o=["children",""+i]):qs.hasOwnProperty(S)&&i!=null&&S==="onScroll"&&Ce("scroll",s)}switch(r){case"input":wi(s),Zl(s,g,!0);break;case"textarea":wi(s),tc(s);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(s.onclick=fn)}s=o,t.updateQueue=s,s!==null&&(t.flags|=4)}else{S=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Jh(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=S.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=S.createElement(r,{is:s.is}):(e=S.createElement(r),r==="select"&&(S=e,s.multiple?S.multiple=!0:s.size&&(S.size=s.size))):e=S.createElementNS(e,r),e[Pt]=t,e[ri]=s,Sd(e,t,!1,!1),t.stateNode=e;e:{switch(S=qo(r,s),r){case"dialog":Ce("cancel",e),Ce("close",e),o=s;break;case"iframe":case"object":case"embed":Ce("load",e),o=s;break;case"video":case"audio":for(o=0;o<js.length;o++)Ce(js[o],e);o=s;break;case"source":Ce("error",e),o=s;break;case"img":case"image":case"link":Ce("error",e),Ce("load",e),o=s;break;case"details":Ce("toggle",e),o=s;break;case"input":Jl(e,s),o=Ho(e,s),Ce("invalid",e);break;case"option":o=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},o=De({},s,{value:void 0}),Ce("invalid",e);break;case"textarea":ec(e,s),o=Uo(e,s),Ce("invalid",e);break;default:o=s}Vo(r,o),i=o;for(g in i)if(i.hasOwnProperty(g)){var a=i[g];g==="style"?tu(e,a):g==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&Zh(e,a)):g==="children"?typeof a=="string"?(r!=="textarea"||a!=="")&&Ks(e,a):typeof a=="number"&&Ks(e,""+a):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(qs.hasOwnProperty(g)?a!=null&&g==="onScroll"&&Ce("scroll",e):a!=null&&Va(e,g,a,S))}switch(r){case"input":wi(e),Zl(e,s,!1);break;case"textarea":wi(e),tc(e);break;case"option":s.value!=null&&e.setAttribute("value",""+vr(s.value));break;case"select":e.multiple=!!s.multiple,g=s.value,g!=null?es(e,!!s.multiple,g,!1):s.defaultValue!=null&&es(e,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=fn)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ke(t),null;case 6:if(e&&t.stateNode!=null)bd(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(X(166));if(r=Rr(ii.current),Rr(Ot.current),Ti(t)){if(s=t.stateNode,r=t.memoizedProps,s[Pt]=t,(g=s.nodeValue!==r)&&(e=dt,e!==null))switch(e.tag){case 3:Ai(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ai(s.nodeValue,r,(e.mode&1)!==0)}g&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[Pt]=t,t.stateNode=s}return Ke(t),null;case 13:if(be(Ae),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Le&&ut!==null&&t.mode&1&&!(t.flags&128))$u(),cs(),t.flags|=98560,g=!1;else if(g=Ti(t),s!==null&&s.dehydrated!==null){if(e===null){if(!g)throw Error(X(318));if(g=t.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(X(317));g[Pt]=t}else cs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ke(t),g=!1}else At!==null&&(Ea(At),At=null),g=!0;if(!g)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||Ae.current&1?Fe===0&&(Fe=3):Ll())),t.updateQueue!==null&&(t.flags|=4),Ke(t),null);case 4:return us(),va(e,t),e===null&&ei(t.stateNode.containerInfo),Ke(t),null;case 10:return hl(t.type._context),Ke(t),null;case 17:return nt(t.type)&&pn(),Ke(t),null;case 19:if(be(Ae),g=t.memoizedState,g===null)return Ke(t),null;if(s=(t.flags&128)!==0,S=g.rendering,S===null)if(s)Ls(g,!1);else{if(Fe!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(S=wn(e),S!==null){for(t.flags|=128,Ls(g,!1),s=S.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)g=r,e=s,g.flags&=14680066,S=g.alternate,S===null?(g.childLanes=0,g.lanes=e,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=S.childLanes,g.lanes=S.lanes,g.child=S.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=S.memoizedProps,g.memoizedState=S.memoizedState,g.updateQueue=S.updateQueue,g.type=S.type,e=S.dependencies,g.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Se(Ae,Ae.current&1|2),t.child}e=e.sibling}g.tail!==null&&je()>fs&&(t.flags|=128,s=!0,Ls(g,!1),t.lanes=4194304)}else{if(!s)if(e=wn(S),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ls(g,!0),g.tail===null&&g.tailMode==="hidden"&&!S.alternate&&!Le)return Ke(t),null}else 2*je()-g.renderingStartTime>fs&&r!==1073741824&&(t.flags|=128,s=!0,Ls(g,!1),t.lanes=4194304);g.isBackwards?(S.sibling=t.child,t.child=S):(r=g.last,r!==null?r.sibling=S:t.child=S,g.last=S)}return g.tail!==null?(t=g.tail,g.rendering=t,g.tail=t.sibling,g.renderingStartTime=je(),t.sibling=null,r=Ae.current,Se(Ae,s?r&1|2:r&1),t):(Ke(t),null);case 22:case 23:return El(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?ht&1073741824&&(Ke(t),t.subtreeFlags&6&&(t.flags|=8192)):Ke(t),null;case 24:return null;case 25:return null}throw Error(X(156,t.tag))}function Ug(e,t){switch(ol(t),t.tag){case 1:return nt(t.type)&&pn(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return us(),be(it),be(Xe),gl(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return pl(t),null;case 13:if(be(Ae),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(X(340));cs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return be(Ae),null;case 4:return us(),null;case 10:return hl(t.type._context),null;case 22:case 23:return El(),null;case 24:return null;default:return null}}var Ni=!1,Ge=!1,Wg=typeof WeakSet=="function"?WeakSet:Set,re=null;function Jr(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Ne(e,t,s)}else r.current=null}function ya(e,t,r){try{r()}catch(s){Ne(e,t,s)}}var Wc=!1;function Vg(e,t){if(ra=hn,e=Au(),il(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var o=s.anchorOffset,g=s.focusNode;s=s.focusOffset;try{r.nodeType,g.nodeType}catch{r=null;break e}var S=0,i=-1,a=-1,d=0,v=0,u=e,_=null;t:for(;;){for(var b;u!==r||o!==0&&u.nodeType!==3||(i=S+o),u!==g||s!==0&&u.nodeType!==3||(a=S+s),u.nodeType===3&&(S+=u.nodeValue.length),(b=u.firstChild)!==null;)_=u,u=b;for(;;){if(u===e)break t;if(_===r&&++d===o&&(i=S),_===g&&++v===s&&(a=S),(b=u.nextSibling)!==null)break;u=_,_=u.parentNode}u=b}r=i===-1||a===-1?null:{start:i,end:a}}else r=null}r=r||{start:0,end:0}}else r=null;for(sa={focusedElem:e,selectionRange:r},hn=!1,re=t;re!==null;)if(t=re,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,re=e;else for(;re!==null;){t=re;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var f=w.memoizedProps,n=w.memoizedState,c=t.stateNode,l=c.getSnapshotBeforeUpdate(t.elementType===t.type?f:Et(t.type,f),n);c.__reactInternalSnapshotBeforeUpdate=l}break;case 3:var h=t.stateNode.containerInfo;h.nodeType===1?h.textContent="":h.nodeType===9&&h.documentElement&&h.removeChild(h.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(m){Ne(t,t.return,m)}if(e=t.sibling,e!==null){e.return=t.return,re=e;break}re=t.return}return w=Wc,Wc=!1,w}function $s(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&e)===e){var g=o.destroy;o.destroy=void 0,g!==void 0&&ya(t,r,g)}o=o.next}while(o!==s)}}function Un(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function xa(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function kd(e){var t=e.alternate;t!==null&&(e.alternate=null,kd(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Pt],delete t[ri],delete t[oa],delete t[Lg],delete t[Rg])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ed(e){return e.tag===5||e.tag===3||e.tag===4}function Vc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ed(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wa(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=fn));else if(s!==4&&(e=e.child,e!==null))for(wa(e,t,r),e=e.sibling;e!==null;)wa(e,t,r),e=e.sibling}function Sa(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Sa(e,t,r),e=e.sibling;e!==null;)Sa(e,t,r),e=e.sibling}var $e=null,Lt=!1;function rr(e,t,r){for(r=r.child;r!==null;)Ld(e,t,r),r=r.sibling}function Ld(e,t,r){if(Bt&&typeof Bt.onCommitFiberUnmount=="function")try{Bt.onCommitFiberUnmount(Pn,r)}catch{}switch(r.tag){case 5:Ge||Jr(r,t);case 6:var s=$e,o=Lt;$e=null,rr(e,t,r),$e=s,Lt=o,$e!==null&&(Lt?(e=$e,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):$e.removeChild(r.stateNode));break;case 18:$e!==null&&(Lt?(e=$e,r=r.stateNode,e.nodeType===8?_o(e.parentNode,r):e.nodeType===1&&_o(e,r),Qs(e)):_o($e,r.stateNode));break;case 4:s=$e,o=Lt,$e=r.stateNode.containerInfo,Lt=!0,rr(e,t,r),$e=s,Lt=o;break;case 0:case 11:case 14:case 15:if(!Ge&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var g=o,S=g.destroy;g=g.tag,S!==void 0&&(g&2||g&4)&&ya(r,t,S),o=o.next}while(o!==s)}rr(e,t,r);break;case 1:if(!Ge&&(Jr(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(i){Ne(r,t,i)}rr(e,t,r);break;case 21:rr(e,t,r);break;case 22:r.mode&1?(Ge=(s=Ge)||r.memoizedState!==null,rr(e,t,r),Ge=s):rr(e,t,r);break;default:rr(e,t,r)}}function qc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Wg),t.forEach(function(s){var o=e_.bind(null,e,s);r.has(s)||(r.add(s),s.then(o,o))})}}function kt(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var o=r[s];try{var g=e,S=t,i=S;e:for(;i!==null;){switch(i.tag){case 5:$e=i.stateNode,Lt=!1;break e;case 3:$e=i.stateNode.containerInfo,Lt=!0;break e;case 4:$e=i.stateNode.containerInfo,Lt=!0;break e}i=i.return}if($e===null)throw Error(X(160));Ld(g,S,o),$e=null,Lt=!1;var a=o.alternate;a!==null&&(a.return=null),o.return=null}catch(d){Ne(o,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Rd(t,e),t=t.sibling}function Rd(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(kt(t,e),Nt(e),s&4){try{$s(3,e,e.return),Un(3,e)}catch(f){Ne(e,e.return,f)}try{$s(5,e,e.return)}catch(f){Ne(e,e.return,f)}}break;case 1:kt(t,e),Nt(e),s&512&&r!==null&&Jr(r,r.return);break;case 5:if(kt(t,e),Nt(e),s&512&&r!==null&&Jr(r,r.return),e.flags&32){var o=e.stateNode;try{Ks(o,"")}catch(f){Ne(e,e.return,f)}}if(s&4&&(o=e.stateNode,o!=null)){var g=e.memoizedProps,S=r!==null?r.memoizedProps:g,i=e.type,a=e.updateQueue;if(e.updateQueue=null,a!==null)try{i==="input"&&g.type==="radio"&&g.name!=null&&Yh(o,g),qo(i,S);var d=qo(i,g);for(S=0;S<a.length;S+=2){var v=a[S],u=a[S+1];v==="style"?tu(o,u):v==="dangerouslySetInnerHTML"?Zh(o,u):v==="children"?Ks(o,u):Va(o,v,u,d)}switch(i){case"input":zo(o,g);break;case"textarea":Qh(o,g);break;case"select":var _=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!g.multiple;var b=g.value;b!=null?es(o,!!g.multiple,b,!1):_!==!!g.multiple&&(g.defaultValue!=null?es(o,!!g.multiple,g.defaultValue,!0):es(o,!!g.multiple,g.multiple?[]:"",!1))}o[ri]=g}catch(f){Ne(e,e.return,f)}}break;case 6:if(kt(t,e),Nt(e),s&4){if(e.stateNode===null)throw Error(X(162));o=e.stateNode,g=e.memoizedProps;try{o.nodeValue=g}catch(f){Ne(e,e.return,f)}}break;case 3:if(kt(t,e),Nt(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Qs(t.containerInfo)}catch(f){Ne(e,e.return,f)}break;case 4:kt(t,e),Nt(e);break;case 13:kt(t,e),Nt(e),o=e.child,o.flags&8192&&(g=o.memoizedState!==null,o.stateNode.isHidden=g,!g||o.alternate!==null&&o.alternate.memoizedState!==null||(bl=je())),s&4&&qc(e);break;case 22:if(v=r!==null&&r.memoizedState!==null,e.mode&1?(Ge=(d=Ge)||v,kt(t,e),Ge=d):kt(t,e),Nt(e),s&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!v&&e.mode&1)for(re=e,v=e.child;v!==null;){for(u=re=v;re!==null;){switch(_=re,b=_.child,_.tag){case 0:case 11:case 14:case 15:$s(4,_,_.return);break;case 1:Jr(_,_.return);var w=_.stateNode;if(typeof w.componentWillUnmount=="function"){s=_,r=_.return;try{t=s,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(f){Ne(s,r,f)}}break;case 5:Jr(_,_.return);break;case 22:if(_.memoizedState!==null){Gc(u);continue}}b!==null?(b.return=_,re=b):Gc(u)}v=v.sibling}e:for(v=null,u=e;;){if(u.tag===5){if(v===null){v=u;try{o=u.stateNode,d?(g=o.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(i=u.stateNode,a=u.memoizedProps.style,S=a!=null&&a.hasOwnProperty("display")?a.display:null,i.style.display=eu("display",S))}catch(f){Ne(e,e.return,f)}}}else if(u.tag===6){if(v===null)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(f){Ne(e,e.return,f)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;v===u&&(v=null),u=u.return}v===u&&(v=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:kt(t,e),Nt(e),s&4&&qc(e);break;case 21:break;default:kt(t,e),Nt(e)}}function Nt(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Ed(r)){var s=r;break e}r=r.return}throw Error(X(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(Ks(o,""),s.flags&=-33);var g=Vc(e);Sa(e,g,o);break;case 3:case 4:var S=s.stateNode.containerInfo,i=Vc(e);wa(e,i,S);break;default:throw Error(X(161))}}catch(a){Ne(e,e.return,a)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function qg(e,t,r){re=e,Ad(e)}function Ad(e,t,r){for(var s=(e.mode&1)!==0;re!==null;){var o=re,g=o.child;if(o.tag===22&&s){var S=o.memoizedState!==null||Ni;if(!S){var i=o.alternate,a=i!==null&&i.memoizedState!==null||Ge;i=Ni;var d=Ge;if(Ni=S,(Ge=a)&&!d)for(re=o;re!==null;)S=re,a=S.child,S.tag===22&&S.memoizedState!==null?Xc(o):a!==null?(a.return=S,re=a):Xc(o);for(;g!==null;)re=g,Ad(g),g=g.sibling;re=o,Ni=i,Ge=d}Kc(e)}else o.subtreeFlags&8772&&g!==null?(g.return=o,re=g):Kc(e)}}function Kc(e){for(;re!==null;){var t=re;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ge||Un(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Ge)if(r===null)s.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:Et(t.type,r.memoizedProps);s.componentDidUpdate(o,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var g=t.updateQueue;g!==null&&Dc(t,g,s);break;case 3:var S=t.updateQueue;if(S!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Dc(t,S,r)}break;case 5:var i=t.stateNode;if(r===null&&t.flags&4){r=i;var a=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&r.focus();break;case"img":a.src&&(r.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var v=d.memoizedState;if(v!==null){var u=v.dehydrated;u!==null&&Qs(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}Ge||t.flags&512&&xa(t)}catch(_){Ne(t,t.return,_)}}if(t===e){re=null;break}if(r=t.sibling,r!==null){r.return=t.return,re=r;break}re=t.return}}function Gc(e){for(;re!==null;){var t=re;if(t===e){re=null;break}var r=t.sibling;if(r!==null){r.return=t.return,re=r;break}re=t.return}}function Xc(e){for(;re!==null;){var t=re;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Un(4,t)}catch(a){Ne(t,r,a)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var o=t.return;try{s.componentDidMount()}catch(a){Ne(t,o,a)}}var g=t.return;try{xa(t)}catch(a){Ne(t,g,a)}break;case 5:var S=t.return;try{xa(t)}catch(a){Ne(t,S,a)}}}catch(a){Ne(t,t.return,a)}if(t===e){re=null;break}var i=t.sibling;if(i!==null){i.return=t.return,re=i;break}re=t.return}}var Kg=Math.ceil,bn=Zt.ReactCurrentDispatcher,Sl=Zt.ReactCurrentOwner,St=Zt.ReactCurrentBatchConfig,me=0,ze=null,Pe=null,Ue=0,ht=0,Zr=wr(0),Fe=0,li=null,Pr=0,Wn=0,Cl=0,Us=null,rt=null,bl=0,fs=1/0,$t=null,kn=!1,Ca=null,pr=null,ji=!1,lr=null,En=0,Ws=0,ba=null,Yi=-1,Qi=0;function Je(){return me&6?je():Yi!==-1?Yi:Yi=je()}function gr(e){return e.mode&1?me&2&&Ue!==0?Ue&-Ue:Tg.transition!==null?(Qi===0&&(Qi=fu()),Qi):(e=ye,e!==0||(e=window.event,e=e===void 0?16:xu(e.type)),e):1}function Dt(e,t,r,s){if(50<Ws)throw Ws=0,ba=null,Error(X(185));di(e,r,s),(!(me&2)||e!==ze)&&(e===ze&&(!(me&2)&&(Wn|=r),Fe===4&&or(e,Ue)),ot(e,s),r===1&&me===0&&!(t.mode&1)&&(fs=je()+500,Hn&&Sr()))}function ot(e,t){var r=e.callbackNode;Tp(e,t);var s=cn(e,e===ze?Ue:0);if(s===0)r!==null&&ic(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&ic(r),t===1)e.tag===0?Ag(Yc.bind(null,e)):Fu(Yc.bind(null,e)),kg(function(){!(me&6)&&Sr()}),r=null;else{switch(pu(s)){case 1:r=Ya;break;case 4:r=uu;break;case 16:r=ln;break;case 536870912:r=du;break;default:r=ln}r=Od(r,Td.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Td(e,t){if(Yi=-1,Qi=0,me&6)throw Error(X(327));var r=e.callbackNode;if(ns()&&e.callbackNode!==r)return null;var s=cn(e,e===ze?Ue:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Ln(e,s);else{t=s;var o=me;me|=2;var g=Md();(ze!==e||Ue!==t)&&($t=null,fs=je()+500,Tr(e,t));do try{Yg();break}catch(i){Dd(e,i)}while(!0);cl(),bn.current=g,me=o,Pe!==null?t=0:(ze=null,Ue=0,t=Fe)}if(t!==0){if(t===2&&(o=Qo(e),o!==0&&(s=o,t=ka(e,o))),t===1)throw r=li,Tr(e,0),or(e,s),ot(e,je()),r;if(t===6)or(e,s);else{if(o=e.current.alternate,!(s&30)&&!Gg(o)&&(t=Ln(e,s),t===2&&(g=Qo(e),g!==0&&(s=g,t=ka(e,g))),t===1))throw r=li,Tr(e,0),or(e,s),ot(e,je()),r;switch(e.finishedWork=o,e.finishedLanes=s,t){case 0:case 1:throw Error(X(345));case 2:kr(e,rt,$t);break;case 3:if(or(e,s),(s&130023424)===s&&(t=bl+500-je(),10<t)){if(cn(e,0)!==0)break;if(o=e.suspendedLanes,(o&s)!==s){Je(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=na(kr.bind(null,e,rt,$t),t);break}kr(e,rt,$t);break;case 4:if(or(e,s),(s&4194240)===s)break;for(t=e.eventTimes,o=-1;0<s;){var S=31-Tt(s);g=1<<S,S=t[S],S>o&&(o=S),s&=~g}if(s=o,s=je()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Kg(s/1960))-s,10<s){e.timeoutHandle=na(kr.bind(null,e,rt,$t),s);break}kr(e,rt,$t);break;case 5:kr(e,rt,$t);break;default:throw Error(X(329))}}}return ot(e,je()),e.callbackNode===r?Td.bind(null,e):null}function ka(e,t){var r=Us;return e.current.memoizedState.isDehydrated&&(Tr(e,t).flags|=256),e=Ln(e,t),e!==2&&(t=rt,rt=r,t!==null&&Ea(t)),e}function Ea(e){rt===null?rt=e:rt.push.apply(rt,e)}function Gg(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var o=r[s],g=o.getSnapshot;o=o.value;try{if(!Mt(g(),o))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function or(e,t){for(t&=~Cl,t&=~Wn,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Tt(t),s=1<<r;e[r]=-1,t&=~s}}function Yc(e){if(me&6)throw Error(X(327));ns();var t=cn(e,0);if(!(t&1))return ot(e,je()),null;var r=Ln(e,t);if(e.tag!==0&&r===2){var s=Qo(e);s!==0&&(t=s,r=ka(e,s))}if(r===1)throw r=li,Tr(e,0),or(e,t),ot(e,je()),r;if(r===6)throw Error(X(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kr(e,rt,$t),ot(e,je()),null}function kl(e,t){var r=me;me|=1;try{return e(t)}finally{me=r,me===0&&(fs=je()+500,Hn&&Sr())}}function Br(e){lr!==null&&lr.tag===0&&!(me&6)&&ns();var t=me;me|=1;var r=St.transition,s=ye;try{if(St.transition=null,ye=1,e)return e()}finally{ye=s,St.transition=r,me=t,!(me&6)&&Sr()}}function El(){ht=Zr.current,be(Zr)}function Tr(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,bg(r)),Pe!==null)for(r=Pe.return;r!==null;){var s=r;switch(ol(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&pn();break;case 3:us(),be(it),be(Xe),gl();break;case 5:pl(s);break;case 4:us();break;case 13:be(Ae);break;case 19:be(Ae);break;case 10:hl(s.type._context);break;case 22:case 23:El()}r=r.return}if(ze=e,Pe=e=_r(e.current,null),Ue=ht=t,Fe=0,li=null,Cl=Wn=Pr=0,rt=Us=null,Lr!==null){for(t=0;t<Lr.length;t++)if(r=Lr[t],s=r.interleaved,s!==null){r.interleaved=null;var o=s.next,g=r.pending;if(g!==null){var S=g.next;g.next=o,s.next=S}r.pending=s}Lr=null}return e}function Dd(e,t){do{var r=Pe;try{if(cl(),Ki.current=Cn,Sn){for(var s=Te.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Sn=!1}if(jr=0,He=Ie=Te=null,zs=!1,ni=0,Sl.current=null,r===null||r.return===null){Fe=1,li=t,Pe=null;break}e:{var g=e,S=r.return,i=r,a=t;if(t=Ue,i.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var d=a,v=i,u=v.tag;if(!(v.mode&1)&&(u===0||u===11||u===15)){var _=v.alternate;_?(v.updateQueue=_.updateQueue,v.memoizedState=_.memoizedState,v.lanes=_.lanes):(v.updateQueue=null,v.memoizedState=null)}var b=Oc(S);if(b!==null){b.flags&=-257,Ic(b,S,i,g,t),b.mode&1&&Bc(g,d,t),t=b,a=d;var w=t.updateQueue;if(w===null){var f=new Set;f.add(a),t.updateQueue=f}else w.add(a);break e}else{if(!(t&1)){Bc(g,d,t),Ll();break e}a=Error(X(426))}}else if(Le&&i.mode&1){var n=Oc(S);if(n!==null){!(n.flags&65536)&&(n.flags|=256),Ic(n,S,i,g,t),al(ds(a,i));break e}}g=a=ds(a,i),Fe!==4&&(Fe=2),Us===null?Us=[g]:Us.push(g),g=S;do{switch(g.tag){case 3:g.flags|=65536,t&=-t,g.lanes|=t;var c=pd(g,a,t);Tc(g,c);break e;case 1:i=a;var l=g.type,h=g.stateNode;if(!(g.flags&128)&&(typeof l.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(pr===null||!pr.has(h)))){g.flags|=65536,t&=-t,g.lanes|=t;var m=gd(g,i,t);Tc(g,m);break e}}g=g.return}while(g!==null)}jd(r)}catch(y){t=y,Pe===r&&r!==null&&(Pe=r=r.return);continue}break}while(!0)}function Md(){var e=bn.current;return bn.current=Cn,e===null?Cn:e}function Ll(){(Fe===0||Fe===3||Fe===2)&&(Fe=4),ze===null||!(Pr&268435455)&&!(Wn&268435455)||or(ze,Ue)}function Ln(e,t){var r=me;me|=2;var s=Md();(ze!==e||Ue!==t)&&($t=null,Tr(e,t));do try{Xg();break}catch(o){Dd(e,o)}while(!0);if(cl(),me=r,bn.current=s,Pe!==null)throw Error(X(261));return ze=null,Ue=0,Fe}function Xg(){for(;Pe!==null;)Nd(Pe)}function Yg(){for(;Pe!==null&&!wp();)Nd(Pe)}function Nd(e){var t=Bd(e.alternate,e,ht);e.memoizedProps=e.pendingProps,t===null?jd(e):Pe=t,Sl.current=null}function jd(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Ug(r,t),r!==null){r.flags&=32767,Pe=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Fe=6,Pe=null;return}}else if(r=$g(r,t,ht),r!==null){Pe=r;return}if(t=t.sibling,t!==null){Pe=t;return}Pe=t=e}while(t!==null);Fe===0&&(Fe=5)}function kr(e,t,r){var s=ye,o=St.transition;try{St.transition=null,ye=1,Qg(e,t,r,s)}finally{St.transition=o,ye=s}return null}function Qg(e,t,r,s){do ns();while(lr!==null);if(me&6)throw Error(X(327));r=e.finishedWork;var o=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(X(177));e.callbackNode=null,e.callbackPriority=0;var g=r.lanes|r.childLanes;if(Dp(e,g),e===ze&&(Pe=ze=null,Ue=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ji||(ji=!0,Od(ln,function(){return ns(),null})),g=(r.flags&15990)!==0,r.subtreeFlags&15990||g){g=St.transition,St.transition=null;var S=ye;ye=1;var i=me;me|=4,Sl.current=null,Vg(e,r),Rd(r,e),mg(sa),hn=!!ra,sa=ra=null,e.current=r,qg(r),Sp(),me=i,ye=S,St.transition=g}else e.current=r;if(ji&&(ji=!1,lr=e,En=o),g=e.pendingLanes,g===0&&(pr=null),kp(r.stateNode),ot(e,je()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)o=t[r],s(o.value,{componentStack:o.stack,digest:o.digest});if(kn)throw kn=!1,e=Ca,Ca=null,e;return En&1&&e.tag!==0&&ns(),g=e.pendingLanes,g&1?e===ba?Ws++:(Ws=0,ba=e):Ws=0,Sr(),null}function ns(){if(lr!==null){var e=pu(En),t=St.transition,r=ye;try{if(St.transition=null,ye=16>e?16:e,lr===null)var s=!1;else{if(e=lr,lr=null,En=0,me&6)throw Error(X(331));var o=me;for(me|=4,re=e.current;re!==null;){var g=re,S=g.child;if(re.flags&16){var i=g.deletions;if(i!==null){for(var a=0;a<i.length;a++){var d=i[a];for(re=d;re!==null;){var v=re;switch(v.tag){case 0:case 11:case 15:$s(8,v,g)}var u=v.child;if(u!==null)u.return=v,re=u;else for(;re!==null;){v=re;var _=v.sibling,b=v.return;if(kd(v),v===d){re=null;break}if(_!==null){_.return=b,re=_;break}re=b}}}var w=g.alternate;if(w!==null){var f=w.child;if(f!==null){w.child=null;do{var n=f.sibling;f.sibling=null,f=n}while(f!==null)}}re=g}}if(g.subtreeFlags&2064&&S!==null)S.return=g,re=S;else e:for(;re!==null;){if(g=re,g.flags&2048)switch(g.tag){case 0:case 11:case 15:$s(9,g,g.return)}var c=g.sibling;if(c!==null){c.return=g.return,re=c;break e}re=g.return}}var l=e.current;for(re=l;re!==null;){S=re;var h=S.child;if(S.subtreeFlags&2064&&h!==null)h.return=S,re=h;else e:for(S=l;re!==null;){if(i=re,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:Un(9,i)}}catch(y){Ne(i,i.return,y)}if(i===S){re=null;break e}var m=i.sibling;if(m!==null){m.return=i.return,re=m;break e}re=i.return}}if(me=o,Sr(),Bt&&typeof Bt.onPostCommitFiberRoot=="function")try{Bt.onPostCommitFiberRoot(Pn,e)}catch{}s=!0}return s}finally{ye=r,St.transition=t}}return!1}function Qc(e,t,r){t=ds(r,t),t=pd(e,t,1),e=fr(e,t,1),t=Je(),e!==null&&(di(e,1,t),ot(e,t))}function Ne(e,t,r){if(e.tag===3)Qc(e,e,r);else for(;t!==null;){if(t.tag===3){Qc(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(pr===null||!pr.has(s))){e=ds(r,e),e=gd(t,e,1),t=fr(t,e,1),e=Je(),t!==null&&(di(t,1,e),ot(t,e));break}}t=t.return}}function Jg(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=Je(),e.pingedLanes|=e.suspendedLanes&r,ze===e&&(Ue&r)===r&&(Fe===4||Fe===3&&(Ue&130023424)===Ue&&500>je()-bl?Tr(e,0):Cl|=r),ot(e,t)}function Pd(e,t){t===0&&(e.mode&1?(t=bi,bi<<=1,!(bi&130023424)&&(bi=4194304)):t=1);var r=Je();e=Xt(e,t),e!==null&&(di(e,t,r),ot(e,r))}function Zg(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Pd(e,r)}function e_(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,o=e.memoizedState;o!==null&&(r=o.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(X(314))}s!==null&&s.delete(t),Pd(e,r)}var Bd;Bd=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||it.current)st=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return st=!1,zg(e,t,r);st=!!(e.flags&131072)}else st=!1,Le&&t.flags&1048576&&Hu(t,mn,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Xi(e,t),e=t.pendingProps;var o=ls(t,Xe.current);is(t,r),o=ml(null,t,s,e,o,r);var g=vl();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,nt(s)?(g=!0,gn(t)):g=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,dl(t),o.updater=$n,t.stateNode=o,o._reactInternals=t,da(t,s,e,r),t=ga(null,t,s,!0,g,r)):(t.tag=0,Le&&g&&nl(t),Qe(null,t,o,r),t=t.child),t;case 16:s=t.elementType;e:{switch(Xi(e,t),e=t.pendingProps,o=s._init,s=o(s._payload),t.type=s,o=t.tag=r_(s),e=Et(s,e),o){case 0:t=pa(null,t,s,e,r);break e;case 1:t=zc(null,t,s,e,r);break e;case 11:t=Fc(null,t,s,e,r);break e;case 14:t=Hc(null,t,s,Et(s.type,e),r);break e}throw Error(X(306,s,""))}return t;case 0:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Et(s,o),pa(e,t,s,o,r);case 1:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Et(s,o),zc(e,t,s,o,r);case 3:e:{if(yd(t),e===null)throw Error(X(387));s=t.pendingProps,g=t.memoizedState,o=g.element,qu(e,t),xn(t,s,null,r);var S=t.memoizedState;if(s=S.element,g.isDehydrated)if(g={element:s,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},t.updateQueue.baseState=g,t.memoizedState=g,t.flags&256){o=ds(Error(X(423)),t),t=$c(e,t,s,r,o);break e}else if(s!==o){o=ds(Error(X(424)),t),t=$c(e,t,s,r,o);break e}else for(ut=dr(t.stateNode.containerInfo.firstChild),dt=t,Le=!0,At=null,r=Wu(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(cs(),s===o){t=Yt(e,t,r);break e}Qe(e,t,s,r)}t=t.child}return t;case 5:return Ku(t),e===null&&ca(t),s=t.type,o=t.pendingProps,g=e!==null?e.memoizedProps:null,S=o.children,ia(s,o)?S=null:g!==null&&ia(s,g)&&(t.flags|=32),vd(e,t),Qe(e,t,S,r),t.child;case 6:return e===null&&ca(t),null;case 13:return xd(e,t,r);case 4:return fl(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=hs(t,null,s,r):Qe(e,t,s,r),t.child;case 11:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Et(s,o),Fc(e,t,s,o,r);case 7:return Qe(e,t,t.pendingProps,r),t.child;case 8:return Qe(e,t,t.pendingProps.children,r),t.child;case 12:return Qe(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,o=t.pendingProps,g=t.memoizedProps,S=o.value,Se(vn,s._currentValue),s._currentValue=S,g!==null)if(Mt(g.value,S)){if(g.children===o.children&&!it.current){t=Yt(e,t,r);break e}}else for(g=t.child,g!==null&&(g.return=t);g!==null;){var i=g.dependencies;if(i!==null){S=g.child;for(var a=i.firstContext;a!==null;){if(a.context===s){if(g.tag===1){a=qt(-1,r&-r),a.tag=2;var d=g.updateQueue;if(d!==null){d=d.shared;var v=d.pending;v===null?a.next=a:(a.next=v.next,v.next=a),d.pending=a}}g.lanes|=r,a=g.alternate,a!==null&&(a.lanes|=r),ha(g.return,r,t),i.lanes|=r;break}a=a.next}}else if(g.tag===10)S=g.type===t.type?null:g.child;else if(g.tag===18){if(S=g.return,S===null)throw Error(X(341));S.lanes|=r,i=S.alternate,i!==null&&(i.lanes|=r),ha(S,r,t),S=g.sibling}else S=g.child;if(S!==null)S.return=g;else for(S=g;S!==null;){if(S===t){S=null;break}if(g=S.sibling,g!==null){g.return=S.return,S=g;break}S=S.return}g=S}Qe(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,s=t.pendingProps.children,is(t,r),o=Ct(o),s=s(o),t.flags|=1,Qe(e,t,s,r),t.child;case 14:return s=t.type,o=Et(s,t.pendingProps),o=Et(s.type,o),Hc(e,t,s,o,r);case 15:return _d(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Et(s,o),Xi(e,t),t.tag=1,nt(s)?(e=!0,gn(t)):e=!1,is(t,r),fd(t,s,o),da(t,s,o,r),ga(null,t,s,!0,e,r);case 19:return wd(e,t,r);case 22:return md(e,t,r)}throw Error(X(156,t.tag))};function Od(e,t){return hu(e,t)}function t_(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wt(e,t,r,s){return new t_(e,t,r,s)}function Rl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function r_(e){if(typeof e=="function")return Rl(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ka)return 11;if(e===Ga)return 14}return 2}function _r(e,t){var r=e.alternate;return r===null?(r=wt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ji(e,t,r,s,o,g){var S=2;if(s=e,typeof e=="function")Rl(e)&&(S=1);else if(typeof e=="string")S=5;else e:switch(e){case Ur:return Dr(r.children,o,g,t);case qa:S=8,o|=8;break;case Bo:return e=wt(12,r,t,o|2),e.elementType=Bo,e.lanes=g,e;case Oo:return e=wt(13,r,t,o),e.elementType=Oo,e.lanes=g,e;case Io:return e=wt(19,r,t,o),e.elementType=Io,e.lanes=g,e;case Kh:return Vn(r,o,g,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Vh:S=10;break e;case qh:S=9;break e;case Ka:S=11;break e;case Ga:S=14;break e;case sr:S=16,s=null;break e}throw Error(X(130,e==null?e:typeof e,""))}return t=wt(S,r,t,o),t.elementType=e,t.type=s,t.lanes=g,t}function Dr(e,t,r,s){return e=wt(7,e,s,t),e.lanes=r,e}function Vn(e,t,r,s){return e=wt(22,e,s,t),e.elementType=Kh,e.lanes=r,e.stateNode={isHidden:!1},e}function bo(e,t,r){return e=wt(6,e,null,t),e.lanes=r,e}function ko(e,t,r){return t=wt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function s_(e,t,r,s,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=io(0),this.expirationTimes=io(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=io(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Al(e,t,r,s,o,g,S,i,a){return e=new s_(e,t,r,i,a),t===1?(t=1,g===!0&&(t|=8)):t=0,g=wt(3,null,null,t),e.current=g,g.stateNode=e,g.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},dl(g),e}function i_(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$r,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function Id(e){if(!e)return yr;e=e._reactInternals;e:{if(Fr(e)!==e||e.tag!==1)throw Error(X(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(nt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(X(171))}if(e.tag===1){var r=e.type;if(nt(r))return Iu(e,r,t)}return t}function Fd(e,t,r,s,o,g,S,i,a){return e=Al(r,s,!0,e,o,g,S,i,a),e.context=Id(null),r=e.current,s=Je(),o=gr(r),g=qt(s,o),g.callback=t??null,fr(r,g,o),e.current.lanes=o,di(e,o,s),ot(e,s),e}function qn(e,t,r,s){var o=t.current,g=Je(),S=gr(o);return r=Id(r),t.context===null?t.context=r:t.pendingContext=r,t=qt(g,S),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=fr(o,t,S),e!==null&&(Dt(e,o,S,g),qi(e,o,S)),S}function Rn(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Jc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Tl(e,t){Jc(e,t),(e=e.alternate)&&Jc(e,t)}function n_(){return null}var Hd=typeof reportError=="function"?reportError:function(e){console.error(e)};function Dl(e){this._internalRoot=e}Kn.prototype.render=Dl.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(X(409));qn(e,t,null,null)};Kn.prototype.unmount=Dl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Br(function(){qn(null,e,null,null)}),t[Gt]=null}};function Kn(e){this._internalRoot=e}Kn.prototype.unstable_scheduleHydration=function(e){if(e){var t=mu();e={blockedOn:null,target:e,priority:t};for(var r=0;r<nr.length&&t!==0&&t<nr[r].priority;r++);nr.splice(r,0,e),r===0&&yu(e)}};function Ml(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Gn(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Zc(){}function o_(e,t,r,s,o){if(o){if(typeof s=="function"){var g=s;s=function(){var d=Rn(S);g.call(d)}}var S=Fd(t,s,e,0,null,!1,!1,"",Zc);return e._reactRootContainer=S,e[Gt]=S.current,ei(e.nodeType===8?e.parentNode:e),Br(),S}for(;o=e.lastChild;)e.removeChild(o);if(typeof s=="function"){var i=s;s=function(){var d=Rn(a);i.call(d)}}var a=Al(e,0,!1,null,null,!1,!1,"",Zc);return e._reactRootContainer=a,e[Gt]=a.current,ei(e.nodeType===8?e.parentNode:e),Br(function(){qn(t,a,r,s)}),a}function Xn(e,t,r,s,o){var g=r._reactRootContainer;if(g){var S=g;if(typeof o=="function"){var i=o;o=function(){var a=Rn(S);i.call(a)}}qn(t,S,e,o)}else S=o_(r,t,e,o,s);return Rn(S)}gu=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ns(t.pendingLanes);r!==0&&(Qa(t,r|1),ot(t,je()),!(me&6)&&(fs=je()+500,Sr()))}break;case 13:Br(function(){var s=Xt(e,1);if(s!==null){var o=Je();Dt(s,e,1,o)}}),Tl(e,1)}};Ja=function(e){if(e.tag===13){var t=Xt(e,134217728);if(t!==null){var r=Je();Dt(t,e,134217728,r)}Tl(e,134217728)}};_u=function(e){if(e.tag===13){var t=gr(e),r=Xt(e,t);if(r!==null){var s=Je();Dt(r,e,t,s)}Tl(e,t)}};mu=function(){return ye};vu=function(e,t){var r=ye;try{return ye=e,t()}finally{ye=r}};Go=function(e,t,r){switch(t){case"input":if(zo(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var o=Fn(s);if(!o)throw Error(X(90));Xh(s),zo(s,o)}}}break;case"textarea":Qh(e,r);break;case"select":t=r.value,t!=null&&es(e,!!r.multiple,t,!1)}};iu=kl;nu=Br;var a_={usingClientEntryPoint:!1,Events:[pi,Kr,Fn,ru,su,kl]},Rs={findFiberByHostInstance:Er,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},l_={bundleType:Rs.bundleType,version:Rs.version,rendererPackageName:Rs.rendererPackageName,rendererConfig:Rs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zt.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=lu(e),e===null?null:e.stateNode},findFiberByHostInstance:Rs.findFiberByHostInstance||n_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pi.isDisabled&&Pi.supportsFiber)try{Pn=Pi.inject(l_),Bt=Pi}catch{}}pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=a_;pt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ml(t))throw Error(X(200));return i_(e,t,null,r)};pt.createRoot=function(e,t){if(!Ml(e))throw Error(X(299));var r=!1,s="",o=Hd;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=Al(e,1,!1,null,null,r,!1,s,o),e[Gt]=t.current,ei(e.nodeType===8?e.parentNode:e),new Dl(t)};pt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(X(188)):(e=Object.keys(e).join(","),Error(X(268,e)));return e=lu(t),e=e===null?null:e.stateNode,e};pt.flushSync=function(e){return Br(e)};pt.hydrate=function(e,t,r){if(!Gn(t))throw Error(X(200));return Xn(null,e,t,!0,r)};pt.hydrateRoot=function(e,t,r){if(!Ml(e))throw Error(X(405));var s=r!=null&&r.hydratedSources||null,o=!1,g="",S=Hd;if(r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(g=r.identifierPrefix),r.onRecoverableError!==void 0&&(S=r.onRecoverableError)),t=Fd(t,null,e,1,r??null,o,!1,g,S),e[Gt]=t.current,ei(e),s)for(e=0;e<s.length;e++)r=s[e],o=r._getVersion,o=o(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new Kn(t)};pt.render=function(e,t,r){if(!Gn(t))throw Error(X(200));return Xn(null,e,t,!1,r)};pt.unmountComponentAtNode=function(e){if(!Gn(e))throw Error(X(40));return e._reactRootContainer?(Br(function(){Xn(null,null,e,!1,function(){e._reactRootContainer=null,e[Gt]=null})}),!0):!1};pt.unstable_batchedUpdates=kl;pt.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!Gn(r))throw Error(X(200));if(e==null||e._reactInternals===void 0)throw Error(X(38));return Xn(e,t,r,!1,s)};pt.version="18.3.1-next-f1338f8080-20240426";function zd(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zd)}catch(e){console.error(e)}}zd(),zh.exports=pt;var c_=zh.exports,eh=c_;jo.createRoot=eh.createRoot,jo.hydrateRoot=eh.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function An(){return An=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},An.apply(this,arguments)}var Ar;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ar||(Ar={}));const th="popstate";function h_(e){e===void 0&&(e={});function t(s,o){let{pathname:g,search:S,hash:i}=s.location;return La("",{pathname:g,search:S,hash:i},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(s,o){return typeof o=="string"?o:Ud(o)}return d_(t,r,null,e)}function $d(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function u_(){return Math.random().toString(36).substr(2,8)}function rh(e,t){return{usr:e.state,key:e.key,idx:t}}function La(e,t,r,s){return r===void 0&&(r=null),An({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Wd(t):t,{state:r,key:t&&t.key||s||u_()})}function Ud(e){let{pathname:t="/",search:r="",hash:s=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function Wd(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function d_(e,t,r,s){s===void 0&&(s={});let{window:o=document.defaultView,v5Compat:g=!1}=s,S=o.history,i=Ar.Pop,a=null,d=v();d==null&&(d=0,S.replaceState(An({},S.state,{idx:d}),""));function v(){return(S.state||{idx:null}).idx}function u(){i=Ar.Pop;let n=v(),c=n==null?null:n-d;d=n,a&&a({action:i,location:f.location,delta:c})}function _(n,c){i=Ar.Push;let l=La(f.location,n,c);d=v()+1;let h=rh(l,d),m=f.createHref(l);try{S.pushState(h,"",m)}catch(y){if(y instanceof DOMException&&y.name==="DataCloneError")throw y;o.location.assign(m)}g&&a&&a({action:i,location:f.location,delta:1})}function b(n,c){i=Ar.Replace;let l=La(f.location,n,c);d=v();let h=rh(l,d),m=f.createHref(l);S.replaceState(h,"",m),g&&a&&a({action:i,location:f.location,delta:0})}function w(n){let c=o.location.origin!=="null"?o.location.origin:o.location.href,l=typeof n=="string"?n:Ud(n);return l=l.replace(/ $/,"%20"),$d(c,"No window.location.(origin|href) available to create URL for href: "+l),new URL(l,c)}let f={get action(){return i},get location(){return e(o,S)},listen(n){if(a)throw new Error("A history only accepts one active listener");return o.addEventListener(th,u),a=n,()=>{o.removeEventListener(th,u),a=null}},createHref(n){return t(o,n)},createURL:w,encodeLocation(n){let c=w(n);return{pathname:c.pathname,search:c.search,hash:c.hash}},push:_,replace:b,go(n){return S.go(n)}};return f}var sh;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(sh||(sh={}));function f_(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&s!=="/"?null:e.slice(r)||"/"}const Vd=["post","put","patch","delete"];new Set(Vd);const p_=["get",...Vd];new Set(p_);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ra(){return Ra=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ra.apply(this,arguments)}const g_=I.createContext(null),qd=I.createContext(null);function __(){return I.useContext(qd)!=null}function m_(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function v_(e){let{basename:t="/",children:r=null,location:s,navigationType:o=Ar.Pop,navigator:g,static:S=!1,future:i}=e;__()&&$d(!1);let a=t.replace(/^\/*/,"/"),d=I.useMemo(()=>({basename:a,navigator:g,static:S,future:Ra({v7_relativeSplatPath:!1},i)}),[a,i,g,S]);typeof s=="string"&&(s=Wd(s));let{pathname:v="/",search:u="",hash:_="",state:b=null,key:w="default"}=s,f=I.useMemo(()=>{let n=f_(v,a);return n==null?null:{location:{pathname:n,search:u,hash:_,state:b,key:w},navigationType:o}},[a,v,u,_,b,w,o]);return f==null?null:I.createElement(g_.Provider,{value:d},I.createElement(qd.Provider,{children:r,value:f}))}new Promise(()=>{});/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const y_="6";try{window.__reactRouterVersion=y_}catch{}const x_="startTransition",ih=Jf[x_];function w_(e){let{basename:t,children:r,future:s,window:o}=e,g=I.useRef();g.current==null&&(g.current=h_({window:o,v5Compat:!0}));let S=g.current,[i,a]=I.useState({action:S.action,location:S.location}),{v7_startTransition:d}=s||{},v=I.useCallback(u=>{d&&ih?ih(()=>a(u)):a(u)},[a,d]);return I.useLayoutEffect(()=>S.listen(v),[S,v]),I.useEffect(()=>m_(s),[s]),I.createElement(v_,{basename:t,children:r,location:i.location,navigationType:i.action,navigator:S,future:s})}var nh;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(nh||(nh={}));var oh;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(oh||(oh={}));const zt=Object.create(null);zt.open="0";zt.close="1";zt.ping="2";zt.pong="3";zt.message="4";zt.upgrade="5";zt.noop="6";const Zi=Object.create(null);Object.keys(zt).forEach(e=>{Zi[zt[e]]=e});const Aa={type:"error",data:"parser error"},Kd=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Gd=typeof ArrayBuffer=="function",Xd=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Nl=({type:e,data:t},r,s)=>Kd&&t instanceof Blob?r?s(t):ah(t,s):Gd&&(t instanceof ArrayBuffer||Xd(t))?r?s(t):ah(new Blob([t]),s):s(zt[e]+(t||"")),ah=(e,t)=>{const r=new FileReader;return r.onload=function(){const s=r.result.split(",")[1];t("b"+(s||""))},r.readAsDataURL(e)};function lh(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Eo;function S_(e,t){if(Kd&&e.data instanceof Blob)return e.data.arrayBuffer().then(lh).then(t);if(Gd&&(e.data instanceof ArrayBuffer||Xd(e.data)))return t(lh(e.data));Nl(e,!1,r=>{Eo||(Eo=new TextEncoder),t(Eo.encode(r))})}const ch="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ps=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<ch.length;e++)Ps[ch.charCodeAt(e)]=e;const C_=e=>{let t=e.length*.75,r=e.length,s,o=0,g,S,i,a;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const d=new ArrayBuffer(t),v=new Uint8Array(d);for(s=0;s<r;s+=4)g=Ps[e.charCodeAt(s)],S=Ps[e.charCodeAt(s+1)],i=Ps[e.charCodeAt(s+2)],a=Ps[e.charCodeAt(s+3)],v[o++]=g<<2|S>>4,v[o++]=(S&15)<<4|i>>2,v[o++]=(i&3)<<6|a&63;return d},b_=typeof ArrayBuffer=="function",jl=(e,t)=>{if(typeof e!="string")return{type:"message",data:Yd(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:k_(e.substring(1),t)}:Zi[r]?e.length>1?{type:Zi[r],data:e.substring(1)}:{type:Zi[r]}:Aa},k_=(e,t)=>{if(b_){const r=C_(e);return Yd(r,t)}else return{base64:!0,data:e}},Yd=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Qd="",E_=(e,t)=>{const r=e.length,s=new Array(r);let o=0;e.forEach((g,S)=>{Nl(g,!1,i=>{s[S]=i,++o===r&&t(s.join(Qd))})})},L_=(e,t)=>{const r=e.split(Qd),s=[];for(let o=0;o<r.length;o++){const g=jl(r[o],t);if(s.push(g),g.type==="error")break}return s};function R_(){return new TransformStream({transform(e,t){S_(e,r=>{const s=r.length;let o;if(s<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,s);else if(s<65536){o=new Uint8Array(3);const g=new DataView(o.buffer);g.setUint8(0,126),g.setUint16(1,s)}else{o=new Uint8Array(9);const g=new DataView(o.buffer);g.setUint8(0,127),g.setBigUint64(1,BigInt(s))}e.data&&typeof e.data!="string"&&(o[0]|=128),t.enqueue(o),t.enqueue(r)})}})}let Lo;function Bi(e){return e.reduce((t,r)=>t+r.length,0)}function Oi(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let s=0;for(let o=0;o<t;o++)r[o]=e[0][s++],s===e[0].length&&(e.shift(),s=0);return e.length&&s<e[0].length&&(e[0]=e[0].slice(s)),r}function A_(e,t){Lo||(Lo=new TextDecoder);const r=[];let s=0,o=-1,g=!1;return new TransformStream({transform(S,i){for(r.push(S);;){if(s===0){if(Bi(r)<1)break;const a=Oi(r,1);g=(a[0]&128)===128,o=a[0]&127,o<126?s=3:o===126?s=1:s=2}else if(s===1){if(Bi(r)<2)break;const a=Oi(r,2);o=new DataView(a.buffer,a.byteOffset,a.length).getUint16(0),s=3}else if(s===2){if(Bi(r)<8)break;const a=Oi(r,8),d=new DataView(a.buffer,a.byteOffset,a.length),v=d.getUint32(0);if(v>Math.pow(2,21)-1){i.enqueue(Aa);break}o=v*Math.pow(2,32)+d.getUint32(4),s=3}else{if(Bi(r)<o)break;const a=Oi(r,o);i.enqueue(jl(g?a:Lo.decode(a),t)),s=0}if(o===0||o>e){i.enqueue(Aa);break}}}})}const Jd=4;function Be(e){if(e)return T_(e)}function T_(e){for(var t in Be.prototype)e[t]=Be.prototype[t];return e}Be.prototype.on=Be.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Be.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};Be.prototype.off=Be.prototype.removeListener=Be.prototype.removeAllListeners=Be.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var s,o=0;o<r.length;o++)if(s=r[o],s===t||s.fn===t){r.splice(o,1);break}return r.length===0&&delete this._callbacks["$"+e],this};Be.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(r){r=r.slice(0);for(var s=0,o=r.length;s<o;++s)r[s].apply(this,t)}return this};Be.prototype.emitReserved=Be.prototype.emit;Be.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Be.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Yn=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),xt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),D_="arraybuffer";function Zd(e,...t){return t.reduce((r,s)=>(e.hasOwnProperty(s)&&(r[s]=e[s]),r),{})}const M_=xt.setTimeout,N_=xt.clearTimeout;function Qn(e,t){t.useNativeTimers?(e.setTimeoutFn=M_.bind(xt),e.clearTimeoutFn=N_.bind(xt)):(e.setTimeoutFn=xt.setTimeout.bind(xt),e.clearTimeoutFn=xt.clearTimeout.bind(xt))}const j_=1.33;function P_(e){return typeof e=="string"?B_(e):Math.ceil((e.byteLength||e.size)*j_)}function B_(e){let t=0,r=0;for(let s=0,o=e.length;s<o;s++)t=e.charCodeAt(s),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(s++,r+=4);return r}function ef(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function O_(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function I_(e){let t={},r=e.split("&");for(let s=0,o=r.length;s<o;s++){let g=r[s].split("=");t[decodeURIComponent(g[0])]=decodeURIComponent(g[1])}return t}class F_ extends Error{constructor(t,r,s){super(t),this.description=r,this.context=s,this.type="TransportError"}}class Pl extends Be{constructor(t){super(),this.writable=!1,Qn(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,s){return super.emitReserved("error",new F_(t,r,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=jl(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=O_(t);return r.length?"?"+r:""}}class H_ extends Pl{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||r()})),this.writable||(s++,this.once("drain",function(){--s||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};L_(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,E_(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=ef()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let tf=!1;try{tf=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const z_=tf;function $_(){}class U_ extends H_{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let s=location.port;s||(s=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,r){const s=this.request({method:"POST",data:t});s.on("success",r),s.on("error",(o,g)=>{this.onError("xhr post error",o,g)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,s)=>{this.onError("xhr poll error",r,s)}),this.pollXhr=t}}class It extends Be{constructor(t,r,s){super(),this.createRequest=t,Qn(this,s),this._opts=s,this._method=s.method||"GET",this._uri=r,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const r=Zd(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(r);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let o in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&s.setRequestHeader(o,this._opts.extraHeaders[o])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var o;s.readyState===3&&((o=this._opts.cookieJar)===null||o===void 0||o.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(o){this.setTimeoutFn(()=>{this._onError(o)},0);return}typeof document<"u"&&(this._index=It.requestsCount++,It.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=$_,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete It.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}It.requestsCount=0;It.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",hh);else if(typeof addEventListener=="function"){const e="onpagehide"in xt?"pagehide":"unload";addEventListener(e,hh,!1)}}function hh(){for(let e in It.requests)It.requests.hasOwnProperty(e)&&It.requests[e].abort()}const W_=function(){const e=rf({xdomain:!1});return e&&e.responseType!==null}();class V_ extends U_{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=W_&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new It(rf,this.uri(),t)}}function rf(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||z_))return new XMLHttpRequest}catch{}if(!t)try{return new xt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const sf=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class q_ extends Pl{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,s=sf?{}:Zd(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,s)}catch(o){return this.emitReserved("error",o)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const s=t[r],o=r===t.length-1;Nl(s,this.supportsBinary,g=>{try{this.doWrite(s,g)}catch{}o&&Yn(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=ef()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const Ro=xt.WebSocket||xt.MozWebSocket;class K_ extends q_{createSocket(t,r,s){return sf?new Ro(t,r,s):r?new Ro(t,r):new Ro(t)}doWrite(t,r){this.ws.send(r)}}class G_ extends Pl{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=A_(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(r).getReader(),o=R_();o.readable.pipeTo(t.writable),this._writer=o.writable.getWriter();const g=()=>{s.read().then(({done:i,value:a})=>{i||(this.onPacket(a),g())}).catch(i=>{})};g();const S={type:"open"};this.query.sid&&(S.data=`{"sid":"${this.query.sid}"}`),this._writer.write(S).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const s=t[r],o=r===t.length-1;this._writer.write(s).then(()=>{o&&Yn(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const X_={websocket:K_,webtransport:G_,polling:V_},Y_=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Q_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ta(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),s=e.indexOf("]");r!=-1&&s!=-1&&(e=e.substring(0,r)+e.substring(r,s).replace(/:/g,";")+e.substring(s,e.length));let o=Y_.exec(e||""),g={},S=14;for(;S--;)g[Q_[S]]=o[S]||"";return r!=-1&&s!=-1&&(g.source=t,g.host=g.host.substring(1,g.host.length-1).replace(/;/g,":"),g.authority=g.authority.replace("[","").replace("]","").replace(/;/g,":"),g.ipv6uri=!0),g.pathNames=J_(g,g.path),g.queryKey=Z_(g,g.query),g}function J_(e,t){const r=/\/{2,9}/g,s=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function Z_(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,o,g){o&&(r[o]=g)}),r}const Da=typeof addEventListener=="function"&&typeof removeEventListener=="function",en=[];Da&&addEventListener("offline",()=>{en.forEach(e=>e())},!1);class mr extends Be{constructor(t,r){if(super(),this.binaryType=D_,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const s=Ta(t);r.hostname=s.host,r.secure=s.protocol==="https"||s.protocol==="wss",r.port=s.port,s.query&&(r.query=s.query)}else r.host&&(r.hostname=Ta(r.host).host);Qn(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(s=>{const o=s.prototype.name;this.transports.push(o),this._transportsByName[o]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=I_(this.opts.query)),Da&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},en.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=Jd,r.transport=t,this.id&&(r.sid=this.id);const s=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&mr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",mr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let s=0;s<this.writeBuffer.length;s++){const o=this.writeBuffer[s].data;if(o&&(r+=P_(o)),s>0&&r>this._maxPayload)return this.writeBuffer.slice(0,s);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Yn(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,s){return this._sendPacket("message",t,r,s),this}send(t,r,s){return this._sendPacket("message",t,r,s),this}_sendPacket(t,r,s,o){if(typeof r=="function"&&(o=r,r=void 0),typeof s=="function"&&(o=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const g={type:t,data:r,options:s};this.emitReserved("packetCreate",g),this.writeBuffer.push(g),o&&this.once("flush",o),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},s=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(mr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Da&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=en.indexOf(this._offlineEventListener);s!==-1&&en.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}mr.protocol=Jd;class em extends mr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),s=!1;mr.priorWebsocketSuccess=!1;const o=()=>{s||(r.send([{type:"ping",data:"probe"}]),r.once("packet",u=>{if(!s)if(u.type==="pong"&&u.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;mr.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(v(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const _=new Error("probe error");_.transport=r.name,this.emitReserved("upgradeError",_)}}))};function g(){s||(s=!0,v(),r.close(),r=null)}const S=u=>{const _=new Error("probe error: "+u);_.transport=r.name,g(),this.emitReserved("upgradeError",_)};function i(){S("transport closed")}function a(){S("socket closed")}function d(u){r&&u.name!==r.name&&g()}const v=()=>{r.removeListener("open",o),r.removeListener("error",S),r.removeListener("close",i),this.off("close",a),this.off("upgrading",d)};r.once("open",o),r.once("error",S),r.once("close",i),this.once("close",a),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&r.push(t[s]);return r}}let tm=class extends em{constructor(t,r={}){const s=typeof t=="object"?t:r;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(o=>X_[o]).filter(o=>!!o)),super(t,s)}};function rm(e,t="",r){let s=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),s=Ta(e)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const g=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+g+":"+s.port+t,s.href=s.protocol+"://"+g+(r&&r.port===s.port?"":":"+s.port),s}const sm=typeof ArrayBuffer=="function",im=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,nf=Object.prototype.toString,nm=typeof Blob=="function"||typeof Blob<"u"&&nf.call(Blob)==="[object BlobConstructor]",om=typeof File=="function"||typeof File<"u"&&nf.call(File)==="[object FileConstructor]";function Bl(e){return sm&&(e instanceof ArrayBuffer||im(e))||nm&&e instanceof Blob||om&&e instanceof File}function tn(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,s=e.length;r<s;r++)if(tn(e[r]))return!0;return!1}if(Bl(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return tn(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&tn(e[r]))return!0;return!1}function am(e){const t=[],r=e.data,s=e;return s.data=Ma(r,t),s.attachments=t.length,{packet:s,buffers:t}}function Ma(e,t){if(!e)return e;if(Bl(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let s=0;s<e.length;s++)r[s]=Ma(e[s],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=Ma(e[s],t));return r}return e}function lm(e,t){return e.data=Na(e.data,t),delete e.attachments,e}function Na(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=Na(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=Na(e[r],t));return e}const cm=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],hm=5;var ge;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(ge||(ge={}));class um{constructor(t){this.replacer=t}encode(t){return(t.type===ge.EVENT||t.type===ge.ACK)&&tn(t)?this.encodeAsBinary({type:t.type===ge.EVENT?ge.BINARY_EVENT:ge.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===ge.BINARY_EVENT||t.type===ge.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=am(t),s=this.encodeAsString(r.packet),o=r.buffers;return o.unshift(s),o}}function uh(e){return Object.prototype.toString.call(e)==="[object Object]"}class Ol extends Be{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const s=r.type===ge.BINARY_EVENT;s||r.type===ge.BINARY_ACK?(r.type=s?ge.EVENT:ge.ACK,this.reconstructor=new dm(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Bl(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const s={type:Number(t.charAt(0))};if(ge[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===ge.BINARY_EVENT||s.type===ge.BINARY_ACK){const g=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const S=t.substring(g,r);if(S!=Number(S)||t.charAt(r)!=="-")throw new Error("Illegal attachments");s.attachments=Number(S)}if(t.charAt(r+1)==="/"){const g=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););s.nsp=t.substring(g,r)}else s.nsp="/";const o=t.charAt(r+1);if(o!==""&&Number(o)==o){const g=r+1;for(;++r;){const S=t.charAt(r);if(S==null||Number(S)!=S){--r;break}if(r===t.length)break}s.id=Number(t.substring(g,r+1))}if(t.charAt(++r)){const g=this.tryParse(t.substr(r));if(Ol.isPayloadValid(s.type,g))s.data=g;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case ge.CONNECT:return uh(r);case ge.DISCONNECT:return r===void 0;case ge.CONNECT_ERROR:return typeof r=="string"||uh(r);case ge.EVENT:case ge.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&cm.indexOf(r[0])===-1);case ge.ACK:case ge.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class dm{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=lm(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const fm=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Ol,Encoder:um,get PacketType(){return ge},protocol:hm},Symbol.toStringTag,{value:"Module"}));function Rt(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const pm=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class of extends Be{constructor(t,r,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Rt(t,"open",this.onopen.bind(this)),Rt(t,"packet",this.onpacket.bind(this)),Rt(t,"error",this.onerror.bind(this)),Rt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var s,o,g;if(pm.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const S={type:ge.EVENT,data:r};if(S.options={},S.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const v=this.ids++,u=r.pop();this._registerAckCallback(v,u),S.id=v}const i=(o=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||o===void 0?void 0:o.writable,a=this.connected&&!(!((g=this.io.engine)===null||g===void 0)&&g._hasPingExpired());return this.flags.volatile&&!i||(a?(this.notifyOutgoingListeners(S),this.packet(S)):this.sendBuffer.push(S)),this.flags={},this}_registerAckCallback(t,r){var s;const o=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(o===void 0){this.acks[t]=r;return}const g=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let i=0;i<this.sendBuffer.length;i++)this.sendBuffer[i].id===t&&this.sendBuffer.splice(i,1);r.call(this,new Error("operation has timed out"))},o),S=(...i)=>{this.io.clearTimeoutFn(g),r.apply(this,i)};S.withError=!0,this.acks[t]=S}emitWithAck(t,...r){return new Promise((s,o)=>{const g=(S,i)=>S?o(S):s(i);g.withError=!0,r.push(g),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((o,...g)=>s!==this._queue[0]?void 0:(o!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(o)):(this._queue.shift(),r&&r(null,...g)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:ge.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case ge.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ge.EVENT:case ge.BINARY_EVENT:this.onevent(t);break;case ge.ACK:case ge.BINARY_ACK:this.onack(t);break;case ge.DISCONNECT:this.ondisconnect();break;case ge.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const s of r)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let s=!1;return function(...o){s||(s=!0,r.packet({type:ge.ACK,id:t,data:o}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ge.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let s=0;s<r.length;s++)if(t===r[s])return r.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let s=0;s<r.length;s++)if(t===r[s])return r.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const s of r)s.apply(this,t.data)}}}function ys(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}ys.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};ys.prototype.reset=function(){this.attempts=0};ys.prototype.setMin=function(e){this.ms=e};ys.prototype.setMax=function(e){this.max=e};ys.prototype.setJitter=function(e){this.jitter=e};class ja extends Be{constructor(t,r){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,Qn(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((s=r.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new ys({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const o=r.parser||fm;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new tm(this.uri,this.opts);const r=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const o=Rt(r,"open",function(){s.onopen(),t&&t()}),g=i=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",i),t?t(i):this.maybeReconnectOnOpen()},S=Rt(r,"error",g);if(this._timeout!==!1){const i=this._timeout,a=this.setTimeoutFn(()=>{o(),g(new Error("timeout")),r.close()},i);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}return this.subs.push(o),this.subs.push(S),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Rt(t,"ping",this.onping.bind(this)),Rt(t,"data",this.ondata.bind(this)),Rt(t,"error",this.onerror.bind(this)),Rt(t,"close",this.onclose.bind(this)),Rt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){Yn(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new of(this,t,r),this.nsps[t]=s),s}_destroy(t){const r=Object.keys(this.nsps);for(const s of r)if(this.nsps[s].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let s=0;s<r.length;s++)this.engine.write(r[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(o=>{o?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",o)):t.onreconnect()}))},r);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const As={};function rn(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=rm(e,t.path||"/socket.io"),s=r.source,o=r.id,g=r.path,S=As[o]&&g in As[o].nsps,i=t.forceNew||t["force new connection"]||t.multiplex===!1||S;let a;return i?a=new ja(s,t):(As[o]||(As[o]=new ja(s,t)),a=As[o]),r.query&&!t.query&&(t.query=r.queryKey),a.socket(r.path,t)}Object.assign(rn,{Manager:ja,Socket:of,io:rn,connect:rn});const gm="";function af(){const[e,t]=I.useState(null),[r,s]=I.useState(!1),o=I.useRef(null);I.useEffect(()=>{const i=rn(gm,{transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:1e4,randomizationFactor:.5,timeout:45e3});return i.on("connect",()=>{console.log("Socket connected"),s(!0)}),i.on("disconnect",a=>{console.log("Socket disconnected:",a),s(!1),a==="io server disconnect"&&i.connect()}),i.on("connect_error",a=>{console.error("Socket connection error:",a.message||a),s(!1)}),i.on("reconnect",a=>{console.log(`Socket reconnected after ${a} attempts`)}),i.on("reconnect_error",a=>{console.warn("Socket reconnection error:",a.message||a)}),o.current=i,t(i),()=>{i.disconnect()}},[]);const g=I.useCallback((i,a)=>{var d;(d=o.current)!=null&&d.connected&&o.current.emit(i,a)},[]),S=I.useCallback((i,a)=>o.current?(o.current.on(i,a),()=>{var d;return(d=o.current)==null?void 0:d.off(i,a)}):()=>{},[]);return{socket:e,connected:r,emit:g,on:S}}const Ao={},lf=I.createContext(null),_m=50;let mm=0,vm=0;const dh=(Ao==null?void 0:Ao.VITE_API_URL)||"",Re={SINGLE:"single",SPLIT_H:"split-h",SPLIT_V:"split-v",GRID_2X2:"grid-2x2",GRID_3X2:"grid-3x2",CUSTOM:"custom"},Ii=()=>`pane-${++vm}`;function ym({children:e}){const{socket:t,connected:r,emit:s,on:o}=af(),[g,S]=I.useState([]),[i,a]=I.useState([]),[d,v]=I.useState([]),[u,_]=I.useState({}),[b,w]=I.useState(null),[f,n]=I.useState(null),[c,l]=I.useState([]),[h,m]=I.useState(null),[y,C]=I.useState({}),[L,x]=I.useState(!1),[E,k]=I.useState([]),[T,A]=I.useState([]),D=I.useRef({}),P=I.useRef(g),O=I.useRef(f);I.useEffect(()=>{P.current=g},[g]),I.useEffect(()=>{O.current=f},[f]);const[F,H]=I.useState(Re.SINGLE),[R,j]=I.useState([{id:Ii(),workerId:null,viewMode:"terminal"}]),[M,B]=I.useState(null),[$,q]=I.useState(null),K=I.useCallback(Z=>{const ie=++mm;return l(G=>[...G,{...Z,id:ie}]),ie},[]),Y=I.useCallback(Z=>{l(ie=>ie.filter(G=>G.id!==Z))},[]),se=I.useRef(!1);I.useEffect(()=>{if(r){const Z=se.current;se.current=!0,N(),Z&&t&&(console.log("[Orchestrator] Reconnected - refreshing worker data"),t.emit("worker:attach",{})),K({type:"success",title:Z?"Reconnected to Strategos":"Connected to Strategos",message:Z?"Connection restored":"Real-time updates enabled",duration:3e3})}else se.current&&K({type:"warning",title:"Connection Lost",message:"Attempting to reconnect...",duration:5e3})},[r,t]),I.useEffect(()=>{if(!t)return;const ie=Object.entries({"workers:list":G=>S(G),"worker:created":G=>{S(te=>[...te,G]),K({type:"success",title:"Worker Spawned",message:`${G.label} is now running`,duration:4e3})},"worker:updated":G=>{S(te=>te.map(le=>le.id===G.id?G:le))},"worker:deleted":({workerId:G})=>{const te=P.current.find(le=>le.id===G);S(le=>le.filter(we=>we.id!==G)),O.current===G&&n(null),K({type:"info",title:"Worker Stopped",message:(te==null?void 0:te.label)||G,duration:3e3})},"worker:output":({workerId:G,output:te})=>{clearTimeout(D.current[G]),D.current[G]=setTimeout(()=>{_(le=>({...le,[G]:te}))},_m)},"activity:list":G=>v(G),"activity:new":G=>v(te=>[G,...te].slice(0,100)),"metrics:update":G=>{G.system&&m(G.system),G.worker&&C(te=>({...te,[G.worker.workerId]:G.worker}))},error:G=>{console.error("Socket error:",G),K({type:"error",title:"Error",message:G.message||"An error occurred",duration:5e3})},"ralph:prds:list":G=>k(G),"ralph:runs:list":G=>A(G),"ralph:prd:created":({prd:G})=>k(te=>[...te,G]),"ralph:prd:updated":({prd:G})=>k(te=>te.map(le=>le.id===G.id?G:le)),"ralph:prd:deleted":({prdId:G})=>k(te=>te.filter(le=>le.id!==G)),"ralph:run:started":({runId:G,prdId:te,prdName:le})=>{K({type:"success",title:"Ralph Run Started",message:`Running PRD: ${le||te}`,duration:4e3}),s("ralph:runs:refresh")},"ralph:run:paused":({runId:G})=>{A(te=>te.map(le=>le.id===G?{...le,status:"paused"}:le))},"ralph:run:resumed":({runId:G})=>{A(te=>te.map(le=>le.id===G?{...le,status:"running"}:le))},"ralph:run:cancelled":({runId:G})=>{A(te=>te.map(le=>le.id===G?{...le,status:"cancelled"}:le))},"ralph:run:completed":({runId:G,success:te,message:le})=>{A(we=>we.map(Oe=>Oe.id===G?{...Oe,status:te?"completed":"failed"}:Oe)),K({type:te?"success":"warning",title:te?"Ralph Run Completed":"Ralph Run Ended",message:le,duration:5e3})},"ralph:story:started":({runId:G,storyIndex:te,storyTitle:le})=>{A(we=>we.map(Oe=>{if(Oe.id!==G)return Oe;const Ye=[...Oe.stories||[]];return Ye[te]&&(Ye[te]={...Ye[te],status:"in_progress"}),{...Oe,stories:Ye}}))},"ralph:story:complete":({runId:G,storyIndex:te,success:le})=>{A(we=>we.map(Oe=>{if(Oe.id!==G)return Oe;const Ye=[...Oe.stories||[]];return Ye[te]&&(Ye[te]={...Ye[te],status:le?"completed":"failed"}),{...Oe,stories:Ye}}))},"ralph:run:progress":({runId:G,iteration:te})=>{A(le=>le.map(we=>we.id===G?{...we,current_iteration:te}:we))}}).map(([G,te])=>o(G,te));return()=>ie.forEach(G=>G())},[t,o,K]);const N=async()=>{try{const ie=await(await fetch("/api/projects")).json();a(ie)}catch(Z){console.error("Failed to fetch projects:",Z),K({type:"error",title:"Failed to fetch projects",message:Z.message,duration:5e3})}},z=I.useCallback((Z,ie)=>(s("worker:spawn",{projectPath:Z,label:ie}),new Promise(G=>{setTimeout(G,100)})),[s]),U=I.useCallback(Z=>{s("worker:kill",{workerId:Z})},[s]),W=I.useCallback((Z,ie)=>{s("worker:input",{workerId:Z,input:ie})},[s]),ne=I.useCallback((Z,ie)=>{s("worker:rawInput",{workerId:Z,keys:ie})},[s]),Q=I.useCallback((Z,ie,G)=>{s("worker:resize",{workerId:Z,cols:ie,rows:G})},[s]),ce=I.useCallback((Z,ie)=>{s("worker:updateLabel",{workerId:Z,label:ie})},[s]),oe=I.useCallback((Z,ie)=>{s("worker:settings",{workerId:Z,settings:ie})},[s]),ke=I.useCallback((Z,ie)=>{s("project:broadcast",{projectName:Z,input:ie})},[s]),tt=I.useCallback(Z=>{s("worker:attach",{workerId:Z}),n(Z)},[s]),ae=I.useCallback(()=>{n(null)},[]),mt=I.useCallback(()=>{L||!t||(s("metrics:subscribe"),x(!0))},[s,L,t]),er=I.useCallback(()=>{!L||!t||(s("metrics:unsubscribe"),x(!1))},[s,L,t]),_e=I.useCallback(async Z=>{try{const ie=await fetch(`${dh}/api/metrics/worker/${Z}`);if(!ie.ok){if(ie.status===404)return null;throw new Error("Failed to fetch worker metrics")}const G=await ie.json();return C(te=>({...te,[Z]:G})),G}catch(ie){return console.error("Failed to fetch worker metrics:",ie),null}},[]),ue=I.useCallback(async()=>{try{const Z=await fetch(`${dh}/api/metrics/system`);if(!Z.ok){if(Z.status===404)return null;throw new Error("Failed to fetch system metrics")}const ie=await Z.json();return m(ie),ie}catch(Z){return console.error("Failed to fetch system metrics:",Z),null}},[]),de=I.useCallback((Z,ie=10)=>{s("ralph:startRun",{prdId:Z,maxIterations:ie})},[s]),ee=I.useCallback(Z=>{s("ralph:pauseRun",{runId:Z})},[s]),pe=I.useCallback(Z=>{s("ralph:resumeRun",{runId:Z})},[s]),Ee=I.useCallback(Z=>{s("ralph:cancelRun",{runId:Z})},[s]),xe=I.useCallback(()=>{s("ralph:prds:refresh"),s("ralph:runs:refresh")},[s]),lt=I.useCallback((Z=null)=>{const ie={id:Ii(),workerId:Z,viewMode:"terminal"};return j(G=>[...G,ie]),B(ie.id),F===Re.SINGLE&&H(Re.SPLIT_H),ie.id},[F]),Ve=I.useCallback(Z=>{j(ie=>{const G=ie.filter(te=>te.id!==Z);return G.length===0?[{id:Ii(),workerId:null,viewMode:"terminal"}]:G}),B(ie=>{if(ie===Z){const G=R.filter(te=>te.id!==Z);return G.length>0?G[0].id:null}return ie})},[R]),ct=I.useCallback((Z,ie)=>{j(G=>G.map(te=>te.id===Z?{...te,workerId:ie}:te)),ie&&s("worker:attach",{workerId:ie})},[s]),Me=I.useCallback((Z,ie)=>{j(G=>G.map(te=>te.id===Z?{...te,viewMode:ie}:te))},[]),ve=I.useCallback(Z=>{H(Z);const G={[Re.SINGLE]:1,[Re.SPLIT_H]:2,[Re.SPLIT_V]:2,[Re.GRID_2X2]:4,[Re.GRID_3X2]:6,[Re.CUSTOM]:R.length}[Z]||1,te=R.length;if(G>te){const le=new Set(R.map(tr=>tr.workerId).filter(Boolean)),we=g.filter(tr=>!le.has(tr.id)),Oe=[...R];let Ye=0;for(let tr=te;tr<G;tr++){const vi=we[Ye];Oe.push({id:Ii(),workerId:(vi==null?void 0:vi.id)||null,viewMode:"terminal"}),vi&&Ye++}j(Oe)}else G<te&&Z!==Re.CUSTOM&&j(R.slice(0,G));q(null)},[R,g]),he=I.useCallback(Z=>{const ie=lt(Z);return F===Re.SINGLE&&ve(Re.SPLIT_H),ie},[lt,F,ve]),Cr=I.useCallback((Z,ie)=>{j(G=>{const te=G.find(we=>we.id===Z),le=G.find(we=>we.id===ie);return!te||!le?G:G.map(we=>we.id===Z?{...we,workerId:le.workerId}:we.id===ie?{...we,workerId:te.workerId}:we)})},[]),Hr={connected:r,workers:g,projects:i,activity:d,outputs:u,selectedProject:b,focusedWorker:f,toasts:c,systemMetrics:h,workerMetrics:y,metricsSubscribed:L,ralphPrds:E,ralphRuns:T,layoutMode:F,panes:R,activePaneId:M,paneSizes:$,setSelectedProject:w,setFocusedWorker:n,setActivePaneId:B,setPaneSizes:q,fetchProjects:N,spawnWorker:z,killWorker:U,sendInput:W,sendRawInput:ne,resizeTerminal:Q,updateWorkerLabel:ce,updateWorkerSettings:oe,broadcastToProject:ke,attachToWorker:tt,detachFromWorker:ae,addToast:K,dismissToast:Y,subscribeToMetrics:mt,unsubscribeFromMetrics:er,fetchWorkerMetrics:_e,fetchSystemMetrics:ue,startRalphRun:de,pauseRalphRun:ee,resumeRalphRun:pe,cancelRalphRun:Ee,refreshRalphData:xe,addPane:lt,removePane:Ve,setPaneWorker:ct,setPaneViewMode:Me,changeLayoutMode:ve,openWorkerInNewPane:he,swapPaneWorkers:Cr};return p.jsx(lf.Provider,{value:Hr,children:e})}function _t(){const e=I.useContext(lf);if(!e)throw new Error("useOrchestrator must be used within OrchestratorProvider");return e}function xm(){const e=()=>{if(typeof window>"u")return"lg";const g=window.innerWidth;return g<640?"xs":g<768?"sm":g<1024?"md":g<1280?"lg":"xl"},[t,r]=I.useState(e),[s,o]=I.useState(typeof window<"u"?window.innerWidth:1024);return I.useEffect(()=>{let g;const S=()=>{clearTimeout(g),g=setTimeout(()=>{const i=e(),a=window.innerWidth;i!==t&&r(i),Math.abs(a-s)>50&&o(a)},100)};return window.addEventListener("resize",S),window.addEventListener("orientationchange",S),S(),()=>{clearTimeout(g),window.removeEventListener("resize",S),window.removeEventListener("orientationchange",S)}},[t,s]),{breakpoint:t,windowWidth:s,isMobile:t==="xs"||t==="sm",isTablet:t==="md",isDesktop:t==="lg"||t==="xl",isLargeDesktop:t==="xl"}}/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var wm={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sm=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),J=(e,t)=>{const r=I.forwardRef(({color:s="currentColor",size:o=24,strokeWidth:g=2,absoluteStrokeWidth:S,className:i="",children:a,...d},v)=>I.createElement("svg",{ref:v,...wm,width:o,height:o,stroke:s,strokeWidth:S?Number(g)*24/Number(o):g,className:["lucide",`lucide-${Sm(e)}`,i].join(" "),...d},[...t.map(([u,_])=>I.createElement(u,_)),...Array.isArray(a)?a:[a]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=J("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=J("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=J("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=J("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=J("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=J("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cm=J("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bm=J("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=J("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=J("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=J("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=J("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const km=J("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hf=J("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=J("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=J("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Em=J("Columns2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lm=J("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rm=J("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Am=J("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=J("FileCode",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=J("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const df=J("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fh=J("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=J("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dm=J("Grid2x2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=J("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nm=J("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jm=J("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ph=J("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pf=J("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pm=J("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=J("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bm=J("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Om=J("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=J("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=J("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hl=J("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zl=J("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=J("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Im=J("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gf=J("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=J("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _f=J("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=J("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hi=J("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $l=J("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ul=J("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=J("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=J("Rows2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mf=J("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $m=J("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=J("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Um=J("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=J("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=J("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=J("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vm=J("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=J("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=J("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=J("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=J("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Km=J("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=J("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=J("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=J("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=J("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=J("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gm=J("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xm=J("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ym=J("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=J("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=J("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=J("ZapOff",[["polyline",{points:"12.41 6.75 13 2 10.57 4.92",key:"122m05"}],["polyline",{points:"18.57 12.91 21 10 15.66 10",key:"16r43o"}],["polyline",{points:"8 8 3 14 12 14 11 22 16 16",key:"tmh4bc"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=J("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function wf(e){var t,r,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=wf(e[t]))&&(s&&(s+=" "),s+=r)}else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function V(){for(var e,t,r=0,s="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=wf(e))&&(s&&(s+=" "),s+=t);return s}const Sf=[{group:"Strategic",color:"text-yellow-400",bgColor:"bg-yellow-400/10",borderColor:"border-yellow-400/50",roles:[{prefix:"GENERAL",label:"General",icon:Wm,description:"Strategic orchestrator"}]},{group:"Operational",color:"text-blue-400",bgColor:"bg-blue-400/10",borderColor:"border-blue-400/50",roles:[{prefix:"COLONEL",label:"Colonel",icon:Um,description:"Domain supervisor"}]},{group:"Tactical",color:"text-green-400",bgColor:"bg-green-400/10",borderColor:"border-green-400/50",roles:[{prefix:"RESEARCH",label:"Research",icon:mf,description:"Information gathering"},{prefix:"IMPL",label:"Implement",icon:uf,description:"Implementation"},{prefix:"TEST",label:"Test",icon:df,description:"Testing"},{prefix:"REVIEW",label:"Review",icon:Am,description:"Code review"},{prefix:"FIX",label:"Fix",icon:Ym,description:"Bug fixes"}]},{group:"Other",color:"text-thea-gold",bgColor:"bg-thea-gold/10",borderColor:"border-thea-gold/50",roles:[{prefix:"",label:"Default",icon:Jn,description:"Standard worker"}]}];function Jm(e){for(const t of Sf)for(const r of t.roles)if(r.prefix===e||e&&r.prefix&&e.startsWith(r.prefix))return{...r,groupColor:t.color,bgColor:t.bgColor,borderColor:t.borderColor};return null}function Cf(e){if(!e)return{prefix:"",displayName:e||""};const t=e.match(/^([A-Z]+):\s*(.*)$/);return t?{prefix:t[1],displayName:t[2]}:{prefix:"",displayName:e}}function bf({onSelect:e,position:t="below",triggerRef:r,isOpen:s,onClose:o}){const g=I.useRef(null);I.useEffect(()=>{function i(a){g.current&&!g.current.contains(a.target)&&(r!=null&&r.current)&&!r.current.contains(a.target)&&(o==null||o())}if(s)return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[s,r,o]),I.useEffect(()=>{function i(a){a.key==="Escape"&&(o==null||o())}if(s)return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[s,o]);const S=i=>{e(i),o==null||o()};return s?p.jsxs("div",{ref:g,className:V("absolute z-50 min-w-[200px] max-w-[280px]","bg-black/95 border border-thea-gold/50 shadow-lg shadow-black/50","backdrop-blur-sm",t==="below"?"top-full mt-1":"bottom-full mb-1","right-0"),style:{clipPath:"polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px))"},onClick:i=>i.stopPropagation(),children:[p.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 border-t border-r border-thea-gold-bright opacity-70"}),p.jsx("div",{className:"py-1",children:Sf.map(i=>p.jsxs("div",{children:[p.jsx("div",{className:V("px-3 py-1.5 text-[10px] font-orbitron uppercase tracking-wider",i.color,"border-b border-thea-gold-dark/20"),children:i.group}),i.roles.map(a=>{const d=a.icon;return p.jsxs("button",{onClick:()=>S(a.prefix),className:V("w-full flex items-center gap-3 px-3 py-2","hover:bg-thea-gold/10 transition-colors","text-left"),children:[p.jsx(d,{className:V("w-4 h-4 flex-shrink-0",i.color)}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("div",{className:"text-sm font-rajdhani text-white",children:a.label}),p.jsx("div",{className:"text-[10px] text-thea-gold-dark truncate",children:a.description})]})]},a.prefix||"default")})]},i.group))})]}):null}function Zm({label:e,size:t="sm"}){const{prefix:r}=Cf(e),s=Jm(r);if(!s||!r)return null;const o=s.icon,g={sm:"text-[10px] px-1.5 py-0.5 gap-1",md:"text-xs px-2 py-1 gap-1.5"};return p.jsxs("span",{className:V("inline-flex items-center font-mono uppercase tracking-wider","border",s.bgColor,s.borderColor,s.groupColor,g[t]),children:[p.jsx(o,{className:V(t==="sm"?"w-3 h-3":"w-3.5 h-3.5")}),r]})}const ev={crown:Rm,brain:Cm,"layout-grid":gs,server:Pa,flask:df,folder:ff};function tv({project:e,isSelected:t,onSelect:r,editMode:s,onDragStart:o,onDragOver:g,onDrop:S,isDragging:i}){var n,c,l;const{spawnWorker:a}=_t(),[d,v]=I.useState(!1),[u,_]=I.useState(!1),b=I.useRef(null);(n=e.workers)!=null&&n.length;const w=((c=e.workers)==null?void 0:c.filter(h=>h.status==="running").length)||0,f=async h=>{_(!1),v(!0);try{const m=h?`${h}: ${e.name}`:`${e.name} Worker`;await a(e.path,m)}finally{setTimeout(()=>v(!1),500)}};return p.jsxs("div",{"data-testid":`project-card-${e.name}`,draggable:s,onDragStart:h=>s&&o(h,e),onDragOver:h=>s&&g(h),onDrop:h=>s&&S(h,e),onClick:()=>!s&&r(e.name),className:V("group flex items-center justify-between py-2 px-3 ml-6 border-l border-thea-gold-dark/30","transition-all",!s&&"hover:bg-thea-gold/5 hover:border-thea-gold/50 cursor-pointer",s&&"hover:bg-thea-gold/10 cursor-grab active:cursor-grabbing",t&&!s&&"bg-thea-gold/10 border-thea-gold",i&&"opacity-50 bg-thea-gold/20"),children:[p.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s&&p.jsx(Nm,{className:"w-3.5 h-3.5 text-thea-gold-dark flex-shrink-0"}),p.jsx("span",{className:V("font-rajdhani text-sm truncate",t&&!s?"text-thea-gold-bright":"text-white/80 group-hover:text-white"),children:e.name}),w>0&&!s&&p.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-thea-gold font-mono",children:[p.jsx(Ul,{className:"w-2.5 h-2.5 animate-pulse"}),w]}),((l=e.tags)==null?void 0:l.length)>0&&!s&&p.jsx("div",{className:"hidden sm:flex gap-1",children:e.tags.slice(0,2).map(h=>p.jsx("span",{className:"text-[9px] px-1.5 py-0.5 bg-thea-gold/10 text-thea-gold-dark border border-thea-gold-dark/30 font-mono uppercase",children:h},h))})]}),!s&&p.jsxs("div",{className:"relative",children:[p.jsx("button",{ref:b,"data-testid":`spawn-worker-${e.name}`,onClick:h=>{h.stopPropagation(),d||_(!u)},disabled:d,className:V("opacity-0 group-hover:opacity-100 transition-opacity","p-1.5 hover:bg-thea-gold/20 border border-transparent hover:border-thea-gold/50","flex items-center gap-0.5",(d||u)&&"opacity-100"),children:d?p.jsx(Qt,{className:"w-3.5 h-3.5 text-status-success animate-spin"}):p.jsxs(p.Fragment,{children:[p.jsx($l,{className:"w-3.5 h-3.5 text-thea-gold"}),p.jsx(mi,{className:V("w-2.5 h-2.5 text-thea-gold transition-transform",u&&"rotate-180")})]})}),p.jsx(bf,{isOpen:u,onClose:()=>_(!1),onSelect:f,triggerRef:b,position:"below"})]})]})}function rv({folder:e,selectedProject:t,onSelectProject:r,editMode:s,onFolderLabelChange:o,onProjectDragStart:g,onProjectDragOver:S,onProjectDrop:i,onFolderDrop:a,draggingProject:d}){const[v,u]=I.useState(!1),[_,b]=I.useState(!1),[w,f]=I.useState(e.label),n=I.useRef(null),c=ev[e.icon]||ff,l=e.projects.reduce((k,T)=>{var A;return k+(((A=T.workers)==null?void 0:A.filter(D=>D.status==="running").length)||0)},0),h=k=>{k.stopPropagation(),f(e.label),b(!0),setTimeout(()=>{var T;return(T=n.current)==null?void 0:T.select()},0)},m=()=>{w.trim()&&w!==e.label&&o(e.id,w.trim()),b(!1)},y=()=>{f(e.label),b(!1)},C=k=>{k.key==="Enter"&&m(),k.key==="Escape"&&y()},L=k=>{d&&(k.preventDefault(),k.currentTarget.classList.add("bg-thea-gold/10"))},x=k=>{k.currentTarget.classList.remove("bg-thea-gold/10")},E=k=>{k.currentTarget.classList.remove("bg-thea-gold/10"),d&&a(e.id)};return p.jsxs("div",{className:"mb-1",onDragOver:L,onDragLeave:x,onDrop:E,children:[p.jsxs("div",{onClick:()=>!_&&u(!v),className:V("w-full flex items-center gap-2 py-2.5 px-3","hover:bg-thea-gold/5 transition-all group cursor-pointer"),children:[v?p.jsx(mi,{className:"w-4 h-4 text-thea-gold-dark"}):p.jsx(Il,{className:"w-4 h-4 text-thea-gold-dark"}),p.jsx(c,{className:"w-4 h-4 flex-shrink-0",style:{color:e.color}}),_?p.jsxs("div",{className:"flex items-center gap-1 flex-1",onClick:k=>k.stopPropagation(),children:[p.jsx("input",{ref:n,type:"text",value:w,onChange:k=>f(k.target.value),onKeyDown:C,onBlur:m,className:"flex-1 bg-black/50 border border-thea-gold px-2 py-0.5 text-xs font-orbitron uppercase tracking-wider text-thea-gold-bright outline-none",autoFocus:!0}),p.jsx("button",{onClick:m,className:"p-1 hover:bg-thea-gold/20",children:p.jsx(os,{className:"w-3.5 h-3.5 text-status-success"})}),p.jsx("button",{onClick:y,className:"p-1 hover:bg-thea-gold/20",children:p.jsx(Jt,{className:"w-3.5 h-3.5 text-thea-maroon-light"})})]}):p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"font-orbitron text-xs uppercase tracking-wider text-thea-gold-bright flex-1 text-left",children:e.label}),s&&e.id!=="_uncategorized"&&p.jsx("button",{onClick:h,className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-thea-gold/20 transition-opacity",children:p.jsx(_f,{className:"w-3 h-3 text-thea-gold-dark"})})]}),p.jsx("span",{className:"text-[10px] font-mono text-thea-gold-dark",children:e.projects.length}),l>0&&p.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-status-success font-mono",children:[p.jsx(Ul,{className:"w-2.5 h-2.5 animate-pulse"}),l]})]}),v&&p.jsx("div",{className:"pb-1",children:e.projects.length===0?p.jsx("div",{className:"py-2 px-3 ml-6 border-l border-thea-gold-dark/20 text-thea-gold-dark/50 text-xs italic",children:"Drop projects here"}):e.projects.map(k=>p.jsx(tv,{project:k,isSelected:t===k.name,onSelect:r,editMode:s,onDragStart:g,onDragOver:S,onDrop:i,isDragging:(d==null?void 0:d.name)===k.name},k.name))})]})}function sv({tree:e,selectedProject:t,onSelectProject:r,editMode:s,onConfigChange:o}){const[g,S]=I.useState(null),[i,a]=I.useState(null);if(!e||e.length===0)return p.jsx("div",{className:"text-center py-8 text-thea-gold-dark/50 text-sm",children:"No projects found"});const d=(w,f)=>{o&&o({type:"renameFolder",folderId:w,newLabel:f})},v=(w,f)=>{S(f),a(f.folder),w.dataTransfer.effectAllowed="move",w.dataTransfer.setData("text/plain",f.name)},u=w=>{w.preventDefault()},_=(w,f)=>{w.preventDefault(),S(null),a(null)},b=w=>{g&&i!==w&&o&&o({type:"moveProject",projectName:g.name,fromFolder:i,toFolder:w}),S(null),a(null)};return p.jsx("div",{className:"divide-y divide-thea-gold-dark/20",onDragEnd:()=>{S(null),a(null)},children:e.map(w=>p.jsx(rv,{folder:w,selectedProject:t,onSelectProject:r,editMode:s,onFolderLabelChange:d,onProjectDragStart:v,onProjectDragOver:u,onProjectDrop:_,onFolderDrop:b,draggingProject:g},w.id))})}function iv({project:e,isSelected:t,onSelect:r}){var _,b;const{spawnWorker:s}=_t(),[o,g]=I.useState(!1),[S,i]=I.useState(!1),a=I.useRef(null),d=((_=e.workers)==null?void 0:_.length)||0,v=((b=e.workers)==null?void 0:b.filter(w=>w.status==="running").length)||0,u=async w=>{i(!1),g(!0);try{const f=w?`${w}: ${e.name}`:`${e.name} Worker`;await s(e.path,f)}finally{setTimeout(()=>g(!1),500)}};return p.jsxs("div",{"data-testid":`project-card-${e.name}`,onClick:()=>r(e.name),className:V("thea-card group cursor-pointer p-4",t&&"border-thea-gold shadow-gold-md",o&&"border-status-success shadow-[0_0_20px_rgba(78,201,176,0.4)]"),style:{clipPath:"polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px))"},children:[p.jsx("div",{className:V("absolute top-0 right-0 w-2.5 h-2.5 border-t-2 border-r-2 transition-all",o?"border-status-success opacity-100":"border-thea-gold-bright opacity-50 group-hover:opacity-100 animate-corner-pulse")}),o&&p.jsx("div",{className:"absolute inset-0 bg-status-success/10 flex items-center justify-center z-10 backdrop-blur-[1px]",children:p.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-black/80 border border-status-success rounded-sm",children:[p.jsx(Qt,{className:"w-4 h-4 text-status-success animate-spin"}),p.jsx("span",{className:"text-status-success text-xs font-mono uppercase tracking-wider",children:"Spawning Claude..."})]})}),p.jsx("div",{className:"flex items-start justify-between mb-2",children:p.jsxs("div",{children:[p.jsx("h3",{className:"font-orbitron font-bold text-thea-gold-bright uppercase tracking-wider text-sm",children:e.name}),p.jsx("p",{className:"text-[10px] text-thea-gold-dark font-mono truncate max-w-[180px]",children:e.path})]})}),p.jsxs("div",{className:"flex items-center justify-between mt-3",children:[p.jsx("div",{className:"flex items-center gap-2",children:p.jsxs("span",{className:V("thea-tag flex items-center gap-1.5",v>0?"bg-thea-gold/15 text-thea-gold border-thea-gold/40":"bg-gray-900/50 text-gray-500 border-gray-700/30"),children:[p.jsx(Ul,{className:V("w-3 h-3",v>0&&"animate-pulse-gold")}),v,"/",d]})}),p.jsxs("div",{className:"relative",children:[p.jsxs("button",{ref:a,"data-testid":`spawn-worker-${e.name}`,onClick:w=>{w.stopPropagation(),o||i(!S)},disabled:o,className:V("thea-btn flex items-center gap-1 px-3 py-1.5 text-xs",o&&"opacity-50 cursor-not-allowed"),children:[o?p.jsx(Qt,{className:"w-3 h-3 animate-spin"}):p.jsx($l,{className:"w-3 h-3"}),o?"Spawning...":"New",!o&&p.jsx(mi,{className:V("w-3 h-3 transition-transform",S&&"rotate-180")})]}),p.jsx(bf,{isOpen:S,onClose:()=>i(!1),onSelect:u,triggerRef:a,position:"below"})]})]})]})}function nv(){const{projects:e,selectedProject:t,setSelectedProject:r,addToast:s}=_t(),[o,g]=I.useState("tree"),[S,i]=I.useState(!1),[a,d]=I.useState([]),[v,u]=I.useState(null),[_,b]=I.useState([]),[w,f]=I.useState([]),[n,c]=I.useState(""),[l,h]=I.useState(!0),[m,y]=I.useState(!1),[C,L]=I.useState(!1),x=I.useCallback(async()=>{var O;try{const[F,H]=await Promise.all([fetch("/api/projects?view=full"),fetch("/api/projects/config")]),R=await F.json(),j=await H.json(),M=R.folders||{},B=R.projects||[],$=[],q=new Set;for(const[Y,se]of Object.entries(M)){const N=B.filter(z=>z.folder===Y);N.forEach(z=>q.add(z.name)),$.push({type:"folder",id:Y,label:se.label,icon:se.icon,color:se.color,projects:N,collapsed:!1})}const K=B.filter(Y=>!q.has(Y.name));K.length>0&&$.push({type:"folder",id:"_uncategorized",label:((O=R.settings)==null?void 0:O.uncategorizedLabel)||"Other Projects",icon:"folder",color:"#888888",projects:K,collapsed:!1}),d($),u(j),b(R.tags||[])}catch(F){console.error("Failed to fetch project tree:",F),s({type:"error",title:"Failed to load projects",message:F.message,duration:5e3})}finally{h(!1)}},[s]);I.useEffect(()=>{x()},[x,e]);const E=O=>{S||r(O===t?null:O)},k=O=>{f(F=>F.includes(O)?F.filter(H=>H!==O):[...F,O])},T=I.useCallback(async O=>{if(!v)return;let F={...v};switch(O.type){case"renameFolder":F.folders[O.folderId]&&(F.folders[O.folderId]={...F.folders[O.folderId],label:O.newLabel});break;case"moveProject":O.fromFolder&&F.folders[O.fromFolder]&&(F.folders[O.fromFolder].projects=F.folders[O.fromFolder].projects.filter(H=>H!==O.projectName)),O.toFolder!=="_uncategorized"&&(F.folders[O.toFolder]||(F.folders[O.toFolder]={label:O.toFolder,icon:"folder",color:"#888888",projects:[]}),F.folders[O.toFolder].projects.includes(O.projectName)||F.folders[O.toFolder].projects.push(O.projectName));break;default:return}y(!0);try{if((await fetch("/api/projects/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)})).ok)u(F),await x(),s({type:"success",title:"Config saved",message:O.type==="renameFolder"?"Folder renamed":"Project moved",duration:2e3});else throw new Error("Failed to save")}catch(H){s({type:"error",title:"Failed to save",message:H.message,duration:3e3})}finally{y(!1)}},[v,x,s]),A=I.useCallback(O=>{if(!n.trim())return!0;const F=n.toLowerCase(),H=(O.name||"").toLowerCase(),R=(O.path||"").toLowerCase(),j=(O.description||"").toLowerCase(),M=(O.tags||[]).join(" ").toLowerCase(),B=(O.aliases||[]).join(" ").toLowerCase();return H.includes(F)||R.includes(F)||j.includes(F)||M.includes(F)||B.includes(F)},[n]),D=I.useMemo(()=>{let O=e;return w.length>0&&(O=O.filter(F=>w.some(H=>{var R;return(R=F.tags)==null?void 0:R.includes(H)}))),n.trim()&&(O=O.filter(A)),O},[e,w,n,A]),P=I.useMemo(()=>w.length===0&&!n.trim()?a:a.map(O=>({...O,projects:O.projects.filter(F=>{const H=w.length===0||w.some(j=>{var M;return(M=F.tags)==null?void 0:M.includes(j)}),R=A(F);return H&&R})})).filter(O=>O.projects.length>0),[a,w,n,A]);return l?p.jsx("div",{className:"p-4 flex items-center justify-center",children:p.jsx("div",{className:"text-thea-gold-dark text-sm font-mono animate-pulse",children:"Loading projects..."})}):p.jsxs("div",{className:"h-full flex flex-col",children:[p.jsxs("div",{className:"p-4 border-b border-thea-gold-dark/30 bg-black/20",children:[p.jsxs("div",{className:"flex items-center justify-between mb-3",children:[p.jsx("h2",{className:"font-orbitron text-sm uppercase tracking-wider text-thea-gold",children:"Projects"}),p.jsxs("div",{className:"flex items-center gap-2",children:[t&&!S&&p.jsx("button",{onClick:()=>r(null),className:"text-xs text-thea-gold-dark hover:text-thea-gold transition-colors mr-2",children:"Clear filter"}),o==="tree"&&p.jsxs("button",{onClick:()=>i(!S),disabled:m,className:V("flex items-center gap-1.5 px-3 py-1.5 text-xs font-rajdhani uppercase tracking-wider transition-all border",S?"bg-thea-gold/20 text-thea-gold border-thea-gold shadow-gold-sm":"text-thea-gold-dark border-thea-gold-dark/30 hover:border-thea-gold/50 hover:text-thea-gold"),children:[m?p.jsx(Qt,{className:"w-3.5 h-3.5 animate-spin"}):S?p.jsx(os,{className:"w-3.5 h-3.5"}):p.jsx(_f,{className:"w-3.5 h-3.5"}),S?"Done":"Edit"]}),p.jsxs("div",{className:"flex border border-thea-gold-dark/50",children:[p.jsx("button",{onClick:()=>{g("tree")},className:V("p-1.5 transition-colors",o==="tree"?"bg-thea-gold/20 text-thea-gold":"text-thea-gold-dark hover:text-thea-gold"),title:"Tree view",children:p.jsx(Om,{className:"w-4 h-4"})}),p.jsx("button",{onClick:()=>{g("grid"),i(!1)},className:V("p-1.5 transition-colors border-l border-thea-gold-dark/50",o==="grid"?"bg-thea-gold/20 text-thea-gold":"text-thea-gold-dark hover:text-thea-gold"),title:"Grid view",children:p.jsx(gs,{className:"w-4 h-4"})})]})]})]}),!S&&p.jsxs("div",{className:"mb-3 relative",children:[p.jsx(mf,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-thea-gold-dark pointer-events-none"}),p.jsx("input",{type:"text",value:n,onChange:O=>c(O.target.value),placeholder:"Search projects...",className:"w-full bg-black/50 border border-thea-gold-dark/30 pl-10 pr-10 py-2 text-sm text-thea-gold placeholder-thea-gold-dark/50 focus:outline-none focus:border-thea-gold/50 transition-colors font-mono"}),n&&p.jsx("button",{onClick:()=>c(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-thea-gold-dark hover:text-thea-gold transition-colors",children:p.jsx(Jt,{className:"w-4 h-4"})})]}),S&&p.jsxs("div",{className:"mb-3 px-3 py-2 bg-thea-gold/10 border border-thea-gold/30 text-xs text-thea-gold",children:[p.jsx("span",{className:"font-bold",children:"Edit Mode:"})," Drag projects between folders. Click folder names to rename."]}),_.length>0&&!S&&p.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[p.jsx(vf,{className:"w-3.5 h-3.5 text-thea-gold-dark"}),_.map(O=>p.jsx("button",{onClick:()=>k(O),className:V("text-[10px] px-2 py-1 font-mono uppercase tracking-wider transition-all","border",w.includes(O)?"bg-thea-gold/20 text-thea-gold border-thea-gold shadow-gold-sm":"text-thea-gold-dark border-thea-gold-dark/30 hover:border-thea-gold/50 hover:text-thea-gold"),children:O},O)),w.length>0&&p.jsxs("button",{onClick:()=>f([]),className:"text-[10px] px-2 py-1 text-thea-maroon-light hover:text-thea-maroon-light/80 transition-colors flex items-center gap-1",children:[p.jsx(Jt,{className:"w-3 h-3"}),"Clear"]})]})]}),p.jsx("div",{className:"flex-1 overflow-auto",children:o==="tree"?p.jsx(sv,{tree:P,selectedProject:t,onSelectProject:E,editMode:S,onConfigChange:T}):p.jsx("div",{className:"p-4",children:D.length===0?p.jsx("div",{className:"text-center py-8 text-thea-gold-dark/50 text-sm",children:n?`No projects match "${n}"`:"No projects match the selected filters"}):p.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:D.map(O=>p.jsx(iv,{project:O,isSelected:t===O.name,onSelect:E},O.name))})})})]})}var kf={exports:{}};(function(e,t){(function(r,s){e.exports=s()})(self,()=>(()=>{var r={4567:function(S,i,a){var d=this&&this.__decorate||function(h,m,y,C){var L,x=arguments.length,E=x<3?m:C===null?C=Object.getOwnPropertyDescriptor(m,y):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(h,m,y,C);else for(var k=h.length-1;k>=0;k--)(L=h[k])&&(E=(x<3?L(E):x>3?L(m,y,E):L(m,y))||E);return x>3&&E&&Object.defineProperty(m,y,E),E},v=this&&this.__param||function(h,m){return function(y,C){m(y,C,h)}};Object.defineProperty(i,"__esModule",{value:!0}),i.AccessibilityManager=void 0;const u=a(9042),_=a(6114),b=a(9924),w=a(844),f=a(5596),n=a(4725),c=a(3656);let l=i.AccessibilityManager=class extends w.Disposable{constructor(h,m){super(),this._terminal=h,this._renderService=m,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let y=0;y<this._terminal.rows;y++)this._rowElements[y]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[y]);if(this._topBoundaryFocusListener=y=>this._handleBoundaryFocus(y,0),this._bottomBoundaryFocusListener=y=>this._handleBoundaryFocus(y,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new b.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(y=>this._handleResize(y.rows))),this.register(this._terminal.onRender(y=>this._refreshRows(y.start,y.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(y=>this._handleChar(y))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(y=>this._handleTab(y))),this.register(this._terminal.onKey(y=>this._handleKey(y.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new f.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,c.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,w.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(h){for(let m=0;m<h;m++)this._handleChar(" ")}_handleChar(h){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==h&&(this._charsToAnnounce+=h):this._charsToAnnounce+=h,h===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=u.tooMuchOutput)),_.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,_.isMac&&this._liveRegion.remove()}_handleKey(h){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(h)||this._charsToConsume.push(h)}_refreshRows(h,m){this._liveRegionDebouncer.refresh(h,m,this._terminal.rows)}_renderRows(h,m){const y=this._terminal.buffer,C=y.lines.length.toString();for(let L=h;L<=m;L++){const x=y.translateBufferLineToString(y.ydisp+L,!0),E=(y.ydisp+L+1).toString(),k=this._rowElements[L];k&&(x.length===0?k.innerText="":k.textContent=x,k.setAttribute("aria-posinset",E),k.setAttribute("aria-setsize",C))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(h,m){const y=h.target,C=this._rowElements[m===0?1:this._rowElements.length-2];if(y.getAttribute("aria-posinset")===(m===0?"1":`${this._terminal.buffer.lines.length}`)||h.relatedTarget!==C)return;let L,x;if(m===0?(L=y,x=this._rowElements.pop(),this._rowContainer.removeChild(x)):(L=this._rowElements.shift(),x=y,this._rowContainer.removeChild(L)),L.removeEventListener("focus",this._topBoundaryFocusListener),x.removeEventListener("focus",this._bottomBoundaryFocusListener),m===0){const E=this._createAccessibilityTreeNode();this._rowElements.unshift(E),this._rowContainer.insertAdjacentElement("afterbegin",E)}else{const E=this._createAccessibilityTreeNode();this._rowElements.push(E),this._rowContainer.appendChild(E)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(m===0?-1:1),this._rowElements[m===0?1:this._rowElements.length-2].focus(),h.preventDefault(),h.stopImmediatePropagation()}_handleResize(h){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let m=this._rowContainer.children.length;m<this._terminal.rows;m++)this._rowElements[m]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[m]);for(;this._rowElements.length>h;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const h=document.createElement("div");return h.setAttribute("role","listitem"),h.tabIndex=-1,this._refreshRowDimensions(h),h}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let h=0;h<this._terminal.rows;h++)this._refreshRowDimensions(this._rowElements[h])}}_refreshRowDimensions(h){h.style.height=`${this._renderService.dimensions.css.cell.height}px`}};i.AccessibilityManager=l=d([v(1,n.IRenderService)],l)},3614:(S,i)=>{function a(_){return _.replace(/\r?\n/g,"\r")}function d(_,b){return b?"\x1B[200~"+_+"\x1B[201~":_}function v(_,b,w,f){_=d(_=a(_),w.decPrivateModes.bracketedPasteMode&&f.rawOptions.ignoreBracketedPasteMode!==!0),w.triggerDataEvent(_,!0),b.value=""}function u(_,b,w){const f=w.getBoundingClientRect(),n=_.clientX-f.left-10,c=_.clientY-f.top-10;b.style.width="20px",b.style.height="20px",b.style.left=`${n}px`,b.style.top=`${c}px`,b.style.zIndex="1000",b.focus()}Object.defineProperty(i,"__esModule",{value:!0}),i.rightClickHandler=i.moveTextAreaUnderMouseCursor=i.paste=i.handlePasteEvent=i.copyHandler=i.bracketTextForPaste=i.prepareTextForTerminal=void 0,i.prepareTextForTerminal=a,i.bracketTextForPaste=d,i.copyHandler=function(_,b){_.clipboardData&&_.clipboardData.setData("text/plain",b.selectionText),_.preventDefault()},i.handlePasteEvent=function(_,b,w,f){_.stopPropagation(),_.clipboardData&&v(_.clipboardData.getData("text/plain"),b,w,f)},i.paste=v,i.moveTextAreaUnderMouseCursor=u,i.rightClickHandler=function(_,b,w,f,n){u(_,b,w),n&&f.rightClickSelect(_),b.value=f.selectionText,b.select()}},7239:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorContrastCache=void 0;const d=a(1505);i.ColorContrastCache=class{constructor(){this._color=new d.TwoKeyMap,this._css=new d.TwoKeyMap}setCss(v,u,_){this._css.set(v,u,_)}getCss(v,u){return this._css.get(v,u)}setColor(v,u,_){this._color.set(v,u,_)}getColor(v,u){return this._color.get(v,u)}clear(){this._color.clear(),this._css.clear()}}},3656:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.addDisposableDomListener=void 0,i.addDisposableDomListener=function(a,d,v,u){a.addEventListener(d,v,u);let _=!1;return{dispose:()=>{_||(_=!0,a.removeEventListener(d,v,u))}}}},6465:function(S,i,a){var d=this&&this.__decorate||function(n,c,l,h){var m,y=arguments.length,C=y<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,l):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(n,c,l,h);else for(var L=n.length-1;L>=0;L--)(m=n[L])&&(C=(y<3?m(C):y>3?m(c,l,C):m(c,l))||C);return y>3&&C&&Object.defineProperty(c,l,C),C},v=this&&this.__param||function(n,c){return function(l,h){c(l,h,n)}};Object.defineProperty(i,"__esModule",{value:!0}),i.Linkifier2=void 0;const u=a(3656),_=a(8460),b=a(844),w=a(2585);let f=i.Linkifier2=class extends b.Disposable{get currentLink(){return this._currentLink}constructor(n){super(),this._bufferService=n,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new _.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new _.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,b.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,b.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(n){return this._linkProviders.push(n),{dispose:()=>{const c=this._linkProviders.indexOf(n);c!==-1&&this._linkProviders.splice(c,1)}}}attachToDom(n,c,l){this._element=n,this._mouseService=c,this._renderService=l,this.register((0,u.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,u.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,u.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,u.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(n){if(this._lastMouseEvent=n,!this._element||!this._mouseService)return;const c=this._positionFromMouseEvent(n,this._element,this._mouseService);if(!c)return;this._isMouseOut=!1;const l=n.composedPath();for(let h=0;h<l.length;h++){const m=l[h];if(m.classList.contains("xterm"))break;if(m.classList.contains("xterm-hover"))return}this._lastBufferCell&&c.x===this._lastBufferCell.x&&c.y===this._lastBufferCell.y||(this._handleHover(c),this._lastBufferCell=c)}_handleHover(n){if(this._activeLine!==n.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(n,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,n)||(this._clearCurrentLink(),this._askForLink(n,!0))}_askForLink(n,c){var l,h;this._activeProviderReplies&&c||((l=this._activeProviderReplies)===null||l===void 0||l.forEach(y=>{y==null||y.forEach(C=>{C.link.dispose&&C.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=n.y);let m=!1;for(const[y,C]of this._linkProviders.entries())c?!((h=this._activeProviderReplies)===null||h===void 0)&&h.get(y)&&(m=this._checkLinkProviderResult(y,n,m)):C.provideLinks(n.y,L=>{var x,E;if(this._isMouseOut)return;const k=L==null?void 0:L.map(T=>({link:T}));(x=this._activeProviderReplies)===null||x===void 0||x.set(y,k),m=this._checkLinkProviderResult(y,n,m),((E=this._activeProviderReplies)===null||E===void 0?void 0:E.size)===this._linkProviders.length&&this._removeIntersectingLinks(n.y,this._activeProviderReplies)})}_removeIntersectingLinks(n,c){const l=new Set;for(let h=0;h<c.size;h++){const m=c.get(h);if(m)for(let y=0;y<m.length;y++){const C=m[y],L=C.link.range.start.y<n?0:C.link.range.start.x,x=C.link.range.end.y>n?this._bufferService.cols:C.link.range.end.x;for(let E=L;E<=x;E++){if(l.has(E)){m.splice(y--,1);break}l.add(E)}}}}_checkLinkProviderResult(n,c,l){var h;if(!this._activeProviderReplies)return l;const m=this._activeProviderReplies.get(n);let y=!1;for(let C=0;C<n;C++)this._activeProviderReplies.has(C)&&!this._activeProviderReplies.get(C)||(y=!0);if(!y&&m){const C=m.find(L=>this._linkAtPosition(L.link,c));C&&(l=!0,this._handleNewLink(C))}if(this._activeProviderReplies.size===this._linkProviders.length&&!l)for(let C=0;C<this._activeProviderReplies.size;C++){const L=(h=this._activeProviderReplies.get(C))===null||h===void 0?void 0:h.find(x=>this._linkAtPosition(x.link,c));if(L){l=!0,this._handleNewLink(L);break}}return l}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(n){if(!this._element||!this._mouseService||!this._currentLink)return;const c=this._positionFromMouseEvent(n,this._element,this._mouseService);c&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,c)&&this._currentLink.link.activate(n,this._currentLink.link.text)}_clearCurrentLink(n,c){this._element&&this._currentLink&&this._lastMouseEvent&&(!n||!c||this._currentLink.link.range.start.y>=n&&this._currentLink.link.range.end.y<=c)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,b.disposeArray)(this._linkCacheDisposables))}_handleNewLink(n){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const c=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);c&&this._linkAtPosition(n.link,c)&&(this._currentLink=n,this._currentLink.state={decorations:{underline:n.link.decorations===void 0||n.link.decorations.underline,pointerCursor:n.link.decorations===void 0||n.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,n.link,this._lastMouseEvent),n.link.decorations={},Object.defineProperties(n.link.decorations,{pointerCursor:{get:()=>{var l,h;return(h=(l=this._currentLink)===null||l===void 0?void 0:l.state)===null||h===void 0?void 0:h.decorations.pointerCursor},set:l=>{var h,m;!((h=this._currentLink)===null||h===void 0)&&h.state&&this._currentLink.state.decorations.pointerCursor!==l&&(this._currentLink.state.decorations.pointerCursor=l,this._currentLink.state.isHovered&&((m=this._element)===null||m===void 0||m.classList.toggle("xterm-cursor-pointer",l)))}},underline:{get:()=>{var l,h;return(h=(l=this._currentLink)===null||l===void 0?void 0:l.state)===null||h===void 0?void 0:h.decorations.underline},set:l=>{var h,m,y;!((h=this._currentLink)===null||h===void 0)&&h.state&&((y=(m=this._currentLink)===null||m===void 0?void 0:m.state)===null||y===void 0?void 0:y.decorations.underline)!==l&&(this._currentLink.state.decorations.underline=l,this._currentLink.state.isHovered&&this._fireUnderlineEvent(n.link,l))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(l=>{if(!this._currentLink)return;const h=l.start===0?0:l.start+1+this._bufferService.buffer.ydisp,m=this._bufferService.buffer.ydisp+1+l.end;if(this._currentLink.link.range.start.y>=h&&this._currentLink.link.range.end.y<=m&&(this._clearCurrentLink(h,m),this._lastMouseEvent&&this._element)){const y=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);y&&this._askForLink(y,!1)}})))}_linkHover(n,c,l){var h;!((h=this._currentLink)===null||h===void 0)&&h.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(c,!0),this._currentLink.state.decorations.pointerCursor&&n.classList.add("xterm-cursor-pointer")),c.hover&&c.hover(l,c.text)}_fireUnderlineEvent(n,c){const l=n.range,h=this._bufferService.buffer.ydisp,m=this._createLinkUnderlineEvent(l.start.x-1,l.start.y-h-1,l.end.x,l.end.y-h-1,void 0);(c?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(m)}_linkLeave(n,c,l){var h;!((h=this._currentLink)===null||h===void 0)&&h.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(c,!1),this._currentLink.state.decorations.pointerCursor&&n.classList.remove("xterm-cursor-pointer")),c.leave&&c.leave(l,c.text)}_linkAtPosition(n,c){const l=n.range.start.y*this._bufferService.cols+n.range.start.x,h=n.range.end.y*this._bufferService.cols+n.range.end.x,m=c.y*this._bufferService.cols+c.x;return l<=m&&m<=h}_positionFromMouseEvent(n,c,l){const h=l.getCoords(n,c,this._bufferService.cols,this._bufferService.rows);if(h)return{x:h[0],y:h[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(n,c,l,h,m){return{x1:n,y1:c,x2:l,y2:h,cols:this._bufferService.cols,fg:m}}};i.Linkifier2=f=d([v(0,w.IBufferService)],f)},9042:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.tooMuchOutput=i.promptLabel=void 0,i.promptLabel="Terminal input",i.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(S,i,a){var d=this&&this.__decorate||function(f,n,c,l){var h,m=arguments.length,y=m<3?n:l===null?l=Object.getOwnPropertyDescriptor(n,c):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(f,n,c,l);else for(var C=f.length-1;C>=0;C--)(h=f[C])&&(y=(m<3?h(y):m>3?h(n,c,y):h(n,c))||y);return m>3&&y&&Object.defineProperty(n,c,y),y},v=this&&this.__param||function(f,n){return function(c,l){n(c,l,f)}};Object.defineProperty(i,"__esModule",{value:!0}),i.OscLinkProvider=void 0;const u=a(511),_=a(2585);let b=i.OscLinkProvider=class{constructor(f,n,c){this._bufferService=f,this._optionsService=n,this._oscLinkService=c}provideLinks(f,n){var c;const l=this._bufferService.buffer.lines.get(f-1);if(!l)return void n(void 0);const h=[],m=this._optionsService.rawOptions.linkHandler,y=new u.CellData,C=l.getTrimmedLength();let L=-1,x=-1,E=!1;for(let k=0;k<C;k++)if(x!==-1||l.hasContent(k)){if(l.loadCell(k,y),y.hasExtendedAttrs()&&y.extended.urlId){if(x===-1){x=k,L=y.extended.urlId;continue}E=y.extended.urlId!==L}else x!==-1&&(E=!0);if(E||x!==-1&&k===C-1){const T=(c=this._oscLinkService.getLinkData(L))===null||c===void 0?void 0:c.uri;if(T){const A={start:{x:x+1,y:f},end:{x:k+(E||k!==C-1?0:1),y:f}};let D=!1;if(!(m!=null&&m.allowNonHttpProtocols))try{const P=new URL(T);["http:","https:"].includes(P.protocol)||(D=!0)}catch{D=!0}D||h.push({text:T,range:A,activate:(P,O)=>m?m.activate(P,O,A):w(0,O),hover:(P,O)=>{var F;return(F=m==null?void 0:m.hover)===null||F===void 0?void 0:F.call(m,P,O,A)},leave:(P,O)=>{var F;return(F=m==null?void 0:m.leave)===null||F===void 0?void 0:F.call(m,P,O,A)}})}E=!1,y.hasExtendedAttrs()&&y.extended.urlId?(x=k,L=y.extended.urlId):(x=-1,L=-1)}}n(h)}};function w(f,n){if(confirm(`Do you want to navigate to ${n}?

WARNING: This link could potentially be dangerous`)){const c=window.open();if(c){try{c.opener=null}catch{}c.location.href=n}else console.warn("Opening link blocked as opener could not be cleared")}}i.OscLinkProvider=b=d([v(0,_.IBufferService),v(1,_.IOptionsService),v(2,_.IOscLinkService)],b)},6193:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.RenderDebouncer=void 0,i.RenderDebouncer=class{constructor(a,d){this._parentWindow=a,this._renderCallback=d,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(a){return this._refreshCallbacks.push(a),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(a,d,v){this._rowCount=v,a=a!==void 0?a:0,d=d!==void 0?d:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,d):d,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const a=Math.max(this._rowStart,0),d=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,d),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const a of this._refreshCallbacks)a(0);this._refreshCallbacks=[]}}},5596:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ScreenDprMonitor=void 0;const d=a(844);class v extends d.Disposable{constructor(_){super(),this._parentWindow=_,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,d.toDisposable)(()=>{this.clearListener()}))}setListener(_){this._listener&&this.clearListener(),this._listener=_,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var _;this._outerListener&&((_=this._resolutionMediaMatchList)===null||_===void 0||_.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}i.ScreenDprMonitor=v},3236:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Terminal=void 0;const d=a(3614),v=a(3656),u=a(6465),_=a(9042),b=a(3730),w=a(1680),f=a(3107),n=a(5744),c=a(2950),l=a(1296),h=a(428),m=a(4269),y=a(5114),C=a(8934),L=a(3230),x=a(9312),E=a(4725),k=a(6731),T=a(8055),A=a(8969),D=a(8460),P=a(844),O=a(6114),F=a(8437),H=a(2584),R=a(7399),j=a(5941),M=a(9074),B=a(2585),$=a(5435),q=a(4567),K=typeof window<"u"?window.document:null;class Y extends A.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(N={}){super(N),this.browser=O,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new P.MutableDisposable),this._onCursorMove=this.register(new D.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new D.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new D.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new D.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new D.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new D.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new D.EventEmitter),this._onBlur=this.register(new D.EventEmitter),this._onA11yCharEmitter=this.register(new D.EventEmitter),this._onA11yTabEmitter=this.register(new D.EventEmitter),this._onWillOpen=this.register(new D.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(u.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(b.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(M.DecorationService),this._instantiationService.setService(B.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((z,U)=>this.refresh(z,U))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(z=>this._reportWindowsOptions(z))),this.register(this._inputHandler.onColor(z=>this._handleColorEvent(z))),this.register((0,D.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,D.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(z=>this._afterResize(z.cols,z.rows))),this.register((0,P.toDisposable)(()=>{var z,U;this._customKeyEventHandler=void 0,(U=(z=this.element)===null||z===void 0?void 0:z.parentNode)===null||U===void 0||U.removeChild(this.element)}))}_handleColorEvent(N){if(this._themeService)for(const z of N){let U,W="";switch(z.index){case 256:U="foreground",W="10";break;case 257:U="background",W="11";break;case 258:U="cursor",W="12";break;default:U="ansi",W="4;"+z.index}switch(z.type){case 0:const ne=T.color.toColorRGB(U==="ansi"?this._themeService.colors.ansi[z.index]:this._themeService.colors[U]);this.coreService.triggerDataEvent(`${H.C0.ESC}]${W};${(0,j.toRgbString)(ne)}${H.C1_ESCAPED.ST}`);break;case 1:if(U==="ansi")this._themeService.modifyColors(Q=>Q.ansi[z.index]=T.rgba.toColor(...z.color));else{const Q=U;this._themeService.modifyColors(ce=>ce[Q]=T.rgba.toColor(...z.color))}break;case 2:this._themeService.restoreColor(z.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(N){N?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(q.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(N){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(H.C0.ESC+"[I"),this.updateCursorStyle(N),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var N;return(N=this.textarea)===null||N===void 0?void 0:N.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(H.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const N=this.buffer.ybase+this.buffer.y,z=this.buffer.lines.get(N);if(!z)return;const U=Math.min(this.buffer.x,this.cols-1),W=this._renderService.dimensions.css.cell.height,ne=z.getWidth(U),Q=this._renderService.dimensions.css.cell.width*ne,ce=this.buffer.y*this._renderService.dimensions.css.cell.height,oe=U*this._renderService.dimensions.css.cell.width;this.textarea.style.left=oe+"px",this.textarea.style.top=ce+"px",this.textarea.style.width=Q+"px",this.textarea.style.height=W+"px",this.textarea.style.lineHeight=W+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,v.addDisposableDomListener)(this.element,"copy",z=>{this.hasSelection()&&(0,d.copyHandler)(z,this._selectionService)}));const N=z=>(0,d.handlePasteEvent)(z,this.textarea,this.coreService,this.optionsService);this.register((0,v.addDisposableDomListener)(this.textarea,"paste",N)),this.register((0,v.addDisposableDomListener)(this.element,"paste",N)),O.isFirefox?this.register((0,v.addDisposableDomListener)(this.element,"mousedown",z=>{z.button===2&&(0,d.rightClickHandler)(z,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,v.addDisposableDomListener)(this.element,"contextmenu",z=>{(0,d.rightClickHandler)(z,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),O.isLinux&&this.register((0,v.addDisposableDomListener)(this.element,"auxclick",z=>{z.button===1&&(0,d.moveTextAreaUnderMouseCursor)(z,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,v.addDisposableDomListener)(this.textarea,"keyup",N=>this._keyUp(N),!0)),this.register((0,v.addDisposableDomListener)(this.textarea,"keydown",N=>this._keyDown(N),!0)),this.register((0,v.addDisposableDomListener)(this.textarea,"keypress",N=>this._keyPress(N),!0)),this.register((0,v.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,v.addDisposableDomListener)(this.textarea,"compositionupdate",N=>this._compositionHelper.compositionupdate(N))),this.register((0,v.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,v.addDisposableDomListener)(this.textarea,"input",N=>this._inputEvent(N),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(N){var z;if(!N)throw new Error("Terminal requires a parent element.");N.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=N.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),N.appendChild(this.element);const U=K.createDocumentFragment();this._viewportElement=K.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),U.appendChild(this._viewportElement),this._viewportScrollArea=K.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=K.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=K.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),U.appendChild(this.screenElement),this.textarea=K.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",_.promptLabel),O.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(y.CoreBrowserService,this.textarea,(z=this._document.defaultView)!==null&&z!==void 0?z:window),this._instantiationService.setService(E.ICoreBrowserService,this._coreBrowserService),this.register((0,v.addDisposableDomListener)(this.textarea,"focus",W=>this._handleTextAreaFocus(W))),this.register((0,v.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(h.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(E.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(k.ThemeService),this._instantiationService.setService(E.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(m.CharacterJoinerService),this._instantiationService.setService(E.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(L.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(E.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(W=>this._onRender.fire(W))),this.onResize(W=>this._renderService.resize(W.cols,W.rows)),this._compositionView=K.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(c.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(U);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(C.MouseService),this._instantiationService.setService(E.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(w.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(W=>this.scrollLines(W.amount,W.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(x.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(E.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(W=>this.scrollLines(W.amount,W.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(W=>this._renderService.handleSelectionChanged(W.start,W.end,W.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(W=>{this.textarea.value=W,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(W=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,v.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(f.BufferDecorationRenderer,this.screenElement)),this.register((0,v.addDisposableDomListener)(this.element,"mousedown",W=>this._selectionService.handleMouseDown(W))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(q.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",W=>this._handleScreenReaderModeOptionChange(W))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",W=>{!this._overviewRulerRenderer&&W&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(l.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const N=this,z=this.element;function U(Q){const ce=N._mouseService.getMouseReportCoords(Q,N.screenElement);if(!ce)return!1;let oe,ke;switch(Q.overrideType||Q.type){case"mousemove":ke=32,Q.buttons===void 0?(oe=3,Q.button!==void 0&&(oe=Q.button<3?Q.button:3)):oe=1&Q.buttons?0:4&Q.buttons?1:2&Q.buttons?2:3;break;case"mouseup":ke=0,oe=Q.button<3?Q.button:3;break;case"mousedown":ke=1,oe=Q.button<3?Q.button:3;break;case"wheel":if(N.viewport.getLinesScrolled(Q)===0)return!1;ke=Q.deltaY<0?0:1,oe=4;break;default:return!1}return!(ke===void 0||oe===void 0||oe>4)&&N.coreMouseService.triggerMouseEvent({col:ce.col,row:ce.row,x:ce.x,y:ce.y,button:oe,action:ke,ctrl:Q.ctrlKey,alt:Q.altKey,shift:Q.shiftKey})}const W={mouseup:null,wheel:null,mousedrag:null,mousemove:null},ne={mouseup:Q=>(U(Q),Q.buttons||(this._document.removeEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.removeEventListener("mousemove",W.mousedrag)),this.cancel(Q)),wheel:Q=>(U(Q),this.cancel(Q,!0)),mousedrag:Q=>{Q.buttons&&U(Q)},mousemove:Q=>{Q.buttons||U(Q)}};this.register(this.coreMouseService.onProtocolChange(Q=>{Q?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(Q)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&Q?W.mousemove||(z.addEventListener("mousemove",ne.mousemove),W.mousemove=ne.mousemove):(z.removeEventListener("mousemove",W.mousemove),W.mousemove=null),16&Q?W.wheel||(z.addEventListener("wheel",ne.wheel,{passive:!1}),W.wheel=ne.wheel):(z.removeEventListener("wheel",W.wheel),W.wheel=null),2&Q?W.mouseup||(z.addEventListener("mouseup",ne.mouseup),W.mouseup=ne.mouseup):(this._document.removeEventListener("mouseup",W.mouseup),z.removeEventListener("mouseup",W.mouseup),W.mouseup=null),4&Q?W.mousedrag||(W.mousedrag=ne.mousedrag):(this._document.removeEventListener("mousemove",W.mousedrag),W.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,v.addDisposableDomListener)(z,"mousedown",Q=>{if(Q.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(Q))return U(Q),W.mouseup&&this._document.addEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.addEventListener("mousemove",W.mousedrag),this.cancel(Q)})),this.register((0,v.addDisposableDomListener)(z,"wheel",Q=>{if(!W.wheel){if(!this.buffer.hasScrollback){const ce=this.viewport.getLinesScrolled(Q);if(ce===0)return;const oe=H.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(Q.deltaY<0?"A":"B");let ke="";for(let tt=0;tt<Math.abs(ce);tt++)ke+=oe;return this.coreService.triggerDataEvent(ke,!0),this.cancel(Q,!0)}return this.viewport.handleWheel(Q)?this.cancel(Q):void 0}},{passive:!1})),this.register((0,v.addDisposableDomListener)(z,"touchstart",Q=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(Q),this.cancel(Q)},{passive:!0})),this.register((0,v.addDisposableDomListener)(z,"touchmove",Q=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(Q)?void 0:this.cancel(Q)},{passive:!1}))}refresh(N,z){var U;(U=this._renderService)===null||U===void 0||U.refreshRows(N,z)}updateCursorStyle(N){var z;!((z=this._selectionService)===null||z===void 0)&&z.shouldColumnSelect(N)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(N,z,U=0){var W;U===1?(super.scrollLines(N,z,U),this.refresh(0,this.rows-1)):(W=this.viewport)===null||W===void 0||W.scrollLines(N)}paste(N){(0,d.paste)(N,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(N){this._customKeyEventHandler=N}registerLinkProvider(N){return this.linkifier2.registerLinkProvider(N)}registerCharacterJoiner(N){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const z=this._characterJoinerService.register(N);return this.refresh(0,this.rows-1),z}deregisterCharacterJoiner(N){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(N)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(N){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+N)}registerDecoration(N){return this._decorationService.registerDecoration(N)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(N,z,U){this._selectionService.setSelection(N,z,U)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var N;(N=this._selectionService)===null||N===void 0||N.clearSelection()}selectAll(){var N;(N=this._selectionService)===null||N===void 0||N.selectAll()}selectLines(N,z){var U;(U=this._selectionService)===null||U===void 0||U.selectLines(N,z)}_keyDown(N){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(N)===!1)return!1;const z=this.browser.isMac&&this.options.macOptionIsMeta&&N.altKey;if(!z&&!this._compositionHelper.keydown(N))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;z||N.key!=="Dead"&&N.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const U=(0,R.evaluateKeyboardEvent)(N,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(N),U.type===3||U.type===2){const W=this.rows-1;return this.scrollLines(U.type===2?-W:W),this.cancel(N,!0)}return U.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,N)||(U.cancel&&this.cancel(N,!0),!U.key||!!(N.key&&!N.ctrlKey&&!N.altKey&&!N.metaKey&&N.key.length===1&&N.key.charCodeAt(0)>=65&&N.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(U.key!==H.C0.ETX&&U.key!==H.C0.CR||(this.textarea.value=""),this._onKey.fire({key:U.key,domEvent:N}),this._showCursor(),this.coreService.triggerDataEvent(U.key,!0),!this.optionsService.rawOptions.screenReaderMode||N.altKey||N.ctrlKey?this.cancel(N,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(N,z){const U=N.isMac&&!this.options.macOptionIsMeta&&z.altKey&&!z.ctrlKey&&!z.metaKey||N.isWindows&&z.altKey&&z.ctrlKey&&!z.metaKey||N.isWindows&&z.getModifierState("AltGraph");return z.type==="keypress"?U:U&&(!z.keyCode||z.keyCode>47)}_keyUp(N){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(N)===!1||(function(z){return z.keyCode===16||z.keyCode===17||z.keyCode===18}(N)||this.focus(),this.updateCursorStyle(N),this._keyPressHandled=!1)}_keyPress(N){let z;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(N)===!1)return!1;if(this.cancel(N),N.charCode)z=N.charCode;else if(N.which===null||N.which===void 0)z=N.keyCode;else{if(N.which===0||N.charCode===0)return!1;z=N.which}return!(!z||(N.altKey||N.ctrlKey||N.metaKey)&&!this._isThirdLevelShift(this.browser,N)||(z=String.fromCharCode(z),this._onKey.fire({key:z,domEvent:N}),this._showCursor(),this.coreService.triggerDataEvent(z,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(N){if(N.data&&N.inputType==="insertText"&&(!N.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const z=N.data;return this.coreService.triggerDataEvent(z,!0),this.cancel(N),!0}return!1}resize(N,z){N!==this.cols||z!==this.rows?super.resize(N,z):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(N,z){var U,W;(U=this._charSizeService)===null||U===void 0||U.measure(),(W=this.viewport)===null||W===void 0||W.syncScrollArea(!0)}clear(){var N;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let z=1;z<this.rows;z++)this.buffer.lines.push(this.buffer.getBlankLine(F.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(N=this.viewport)===null||N===void 0||N.reset(),this.refresh(0,this.rows-1)}}reset(){var N,z;this.options.rows=this.rows,this.options.cols=this.cols;const U=this._customKeyEventHandler;this._setup(),super.reset(),(N=this._selectionService)===null||N===void 0||N.reset(),this._decorationService.reset(),(z=this.viewport)===null||z===void 0||z.reset(),this._customKeyEventHandler=U,this.refresh(0,this.rows-1)}clearTextureAtlas(){var N;(N=this._renderService)===null||N===void 0||N.clearTextureAtlas()}_reportFocus(){var N;!((N=this.element)===null||N===void 0)&&N.classList.contains("focus")?this.coreService.triggerDataEvent(H.C0.ESC+"[I"):this.coreService.triggerDataEvent(H.C0.ESC+"[O")}_reportWindowsOptions(N){if(this._renderService)switch(N){case $.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const z=this._renderService.dimensions.css.canvas.width.toFixed(0),U=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${H.C0.ESC}[4;${U};${z}t`);break;case $.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const W=this._renderService.dimensions.css.cell.width.toFixed(0),ne=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${H.C0.ESC}[6;${ne};${W}t`)}}cancel(N,z){if(this.options.cancelEvents||z)return N.preventDefault(),N.stopPropagation(),!1}}i.Terminal=Y},9924:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TimeBasedDebouncer=void 0,i.TimeBasedDebouncer=class{constructor(a,d=1e3){this._renderCallback=a,this._debounceThresholdMS=d,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(a,d,v){this._rowCount=v,a=a!==void 0?a:0,d=d!==void 0?d:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,d):d;const u=Date.now();if(u-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=u,this._innerRefresh();else if(!this._additionalRefreshRequested){const _=u-this._lastRefreshMs,b=this._debounceThresholdMS-_;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},b)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const a=Math.max(this._rowStart,0),d=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,d)}}},1680:function(S,i,a){var d=this&&this.__decorate||function(c,l,h,m){var y,C=arguments.length,L=C<3?l:m===null?m=Object.getOwnPropertyDescriptor(l,h):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(c,l,h,m);else for(var x=c.length-1;x>=0;x--)(y=c[x])&&(L=(C<3?y(L):C>3?y(l,h,L):y(l,h))||L);return C>3&&L&&Object.defineProperty(l,h,L),L},v=this&&this.__param||function(c,l){return function(h,m){l(h,m,c)}};Object.defineProperty(i,"__esModule",{value:!0}),i.Viewport=void 0;const u=a(3656),_=a(4725),b=a(8460),w=a(844),f=a(2585);let n=i.Viewport=class extends w.Disposable{constructor(c,l,h,m,y,C,L,x){super(),this._viewportElement=c,this._scrollArea=l,this._bufferService=h,this._optionsService=m,this._charSizeService=y,this._renderService=C,this._coreBrowserService=L,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new b.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,u.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(E=>this._activeBuffer=E.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(E=>this._renderDimensions=E)),this._handleThemeChange(x.colors),this.register(x.onChangeColors(E=>this._handleThemeChange(E))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(c){this._viewportElement.style.backgroundColor=c.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(c){if(c)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const l=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==l&&(this._lastRecordedBufferHeight=l,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const c=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==c&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=c),this._refreshAnimationFrame=null}syncScrollArea(c=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(c);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(c)}_handleScroll(c){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const l=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:l,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const c=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(c*(this._smoothScrollState.target-this._smoothScrollState.origin)),c<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(c,l){const h=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(l<0&&this._viewportElement.scrollTop!==0||l>0&&h<this._lastRecordedBufferHeight)||(c.cancelable&&c.preventDefault(),!1)}handleWheel(c){const l=this._getPixelsScrolled(c);return l!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+l:this._smoothScrollState.target+=l,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=l,this._bubbleScroll(c,l))}scrollLines(c){if(c!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const l=c*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+l,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:c,suppressScrollEvent:!1})}_getPixelsScrolled(c){if(c.deltaY===0||c.shiftKey)return 0;let l=this._applyScrollModifier(c.deltaY,c);return c.deltaMode===WheelEvent.DOM_DELTA_LINE?l*=this._currentRowHeight:c.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(l*=this._currentRowHeight*this._bufferService.rows),l}getBufferElements(c,l){var h;let m,y="";const C=[],L=l??this._bufferService.buffer.lines.length,x=this._bufferService.buffer.lines;for(let E=c;E<L;E++){const k=x.get(E);if(!k)continue;const T=(h=x.get(E+1))===null||h===void 0?void 0:h.isWrapped;if(y+=k.translateToString(!T),!T||E===x.length-1){const A=document.createElement("div");A.textContent=y,C.push(A),y.length>0&&(m=A),y=""}}return{bufferElements:C,cursorElement:m}}getLinesScrolled(c){if(c.deltaY===0||c.shiftKey)return 0;let l=this._applyScrollModifier(c.deltaY,c);return c.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(l/=this._currentRowHeight+0,this._wheelPartialScroll+=l,l=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):c.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(l*=this._bufferService.rows),l}_applyScrollModifier(c,l){const h=this._optionsService.rawOptions.fastScrollModifier;return h==="alt"&&l.altKey||h==="ctrl"&&l.ctrlKey||h==="shift"&&l.shiftKey?c*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:c*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(c){this._lastTouchY=c.touches[0].pageY}handleTouchMove(c){const l=this._lastTouchY-c.touches[0].pageY;return this._lastTouchY=c.touches[0].pageY,l!==0&&(this._viewportElement.scrollTop+=l,this._bubbleScroll(c,l))}};i.Viewport=n=d([v(2,f.IBufferService),v(3,f.IOptionsService),v(4,_.ICharSizeService),v(5,_.IRenderService),v(6,_.ICoreBrowserService),v(7,_.IThemeService)],n)},3107:function(S,i,a){var d=this&&this.__decorate||function(n,c,l,h){var m,y=arguments.length,C=y<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,l):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(n,c,l,h);else for(var L=n.length-1;L>=0;L--)(m=n[L])&&(C=(y<3?m(C):y>3?m(c,l,C):m(c,l))||C);return y>3&&C&&Object.defineProperty(c,l,C),C},v=this&&this.__param||function(n,c){return function(l,h){c(l,h,n)}};Object.defineProperty(i,"__esModule",{value:!0}),i.BufferDecorationRenderer=void 0;const u=a(3656),_=a(4725),b=a(844),w=a(2585);let f=i.BufferDecorationRenderer=class extends b.Disposable{constructor(n,c,l,h){super(),this._screenElement=n,this._bufferService=c,this._decorationService=l,this._renderService=h,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,u.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(m=>this._removeDecoration(m))),this.register((0,b.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const n of this._decorationService.decorations)this._renderDecoration(n);this._dimensionsChanged=!1}_renderDecoration(n){this._refreshStyle(n),this._dimensionsChanged&&this._refreshXPosition(n)}_createElement(n){var c,l;const h=document.createElement("div");h.classList.add("xterm-decoration"),h.classList.toggle("xterm-decoration-top-layer",((c=n==null?void 0:n.options)===null||c===void 0?void 0:c.layer)==="top"),h.style.width=`${Math.round((n.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,h.style.height=(n.options.height||1)*this._renderService.dimensions.css.cell.height+"px",h.style.top=(n.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",h.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const m=(l=n.options.x)!==null&&l!==void 0?l:0;return m&&m>this._bufferService.cols&&(h.style.display="none"),this._refreshXPosition(n,h),h}_refreshStyle(n){const c=n.marker.line-this._bufferService.buffers.active.ydisp;if(c<0||c>=this._bufferService.rows)n.element&&(n.element.style.display="none",n.onRenderEmitter.fire(n.element));else{let l=this._decorationElements.get(n);l||(l=this._createElement(n),n.element=l,this._decorationElements.set(n,l),this._container.appendChild(l),n.onDispose(()=>{this._decorationElements.delete(n),l.remove()})),l.style.top=c*this._renderService.dimensions.css.cell.height+"px",l.style.display=this._altBufferIsActive?"none":"block",n.onRenderEmitter.fire(l)}}_refreshXPosition(n,c=n.element){var l;if(!c)return;const h=(l=n.options.x)!==null&&l!==void 0?l:0;(n.options.anchor||"left")==="right"?c.style.right=h?h*this._renderService.dimensions.css.cell.width+"px":"":c.style.left=h?h*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(n){var c;(c=this._decorationElements.get(n))===null||c===void 0||c.remove(),this._decorationElements.delete(n),n.dispose()}};i.BufferDecorationRenderer=f=d([v(1,w.IBufferService),v(2,w.IDecorationService),v(3,_.IRenderService)],f)},5871:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorZoneStore=void 0,i.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(a){if(a.options.overviewRulerOptions){for(const d of this._zones)if(d.color===a.options.overviewRulerOptions.color&&d.position===a.options.overviewRulerOptions.position){if(this._lineIntersectsZone(d,a.marker.line))return;if(this._lineAdjacentToZone(d,a.marker.line,a.options.overviewRulerOptions.position))return void this._addLineToZone(d,a.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=a.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=a.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=a.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=a.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:a.options.overviewRulerOptions.color,position:a.options.overviewRulerOptions.position,startBufferLine:a.marker.line,endBufferLine:a.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(a){this._linePadding=a}_lineIntersectsZone(a,d){return d>=a.startBufferLine&&d<=a.endBufferLine}_lineAdjacentToZone(a,d,v){return d>=a.startBufferLine-this._linePadding[v||"full"]&&d<=a.endBufferLine+this._linePadding[v||"full"]}_addLineToZone(a,d){a.startBufferLine=Math.min(a.startBufferLine,d),a.endBufferLine=Math.max(a.endBufferLine,d)}}},5744:function(S,i,a){var d=this&&this.__decorate||function(m,y,C,L){var x,E=arguments.length,k=E<3?y:L===null?L=Object.getOwnPropertyDescriptor(y,C):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(m,y,C,L);else for(var T=m.length-1;T>=0;T--)(x=m[T])&&(k=(E<3?x(k):E>3?x(y,C,k):x(y,C))||k);return E>3&&k&&Object.defineProperty(y,C,k),k},v=this&&this.__param||function(m,y){return function(C,L){y(C,L,m)}};Object.defineProperty(i,"__esModule",{value:!0}),i.OverviewRulerRenderer=void 0;const u=a(5871),_=a(3656),b=a(4725),w=a(844),f=a(2585),n={full:0,left:0,center:0,right:0},c={full:0,left:0,center:0,right:0},l={full:0,left:0,center:0,right:0};let h=i.OverviewRulerRenderer=class extends w.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(m,y,C,L,x,E,k){var T;super(),this._viewportElement=m,this._screenElement=y,this._bufferService=C,this._decorationService=L,this._renderService=x,this._optionsService=E,this._coreBrowseService=k,this._colorZoneStore=new u.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(T=this._viewportElement.parentElement)===null||T===void 0||T.insertBefore(this._canvas,this._viewportElement);const A=this._canvas.getContext("2d");if(!A)throw new Error("Ctx cannot be null");this._ctx=A,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,w.toDisposable)(()=>{var D;(D=this._canvas)===null||D===void 0||D.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,_.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const m=Math.floor(this._canvas.width/3),y=Math.ceil(this._canvas.width/3);c.full=this._canvas.width,c.left=m,c.center=y,c.right=m,this._refreshDrawHeightConstants(),l.full=0,l.left=0,l.center=c.left,l.right=c.left+c.center}_refreshDrawHeightConstants(){n.full=Math.round(2*this._coreBrowseService.dpr);const m=this._canvas.height/this._bufferService.buffer.lines.length,y=Math.round(Math.max(Math.min(m,12),6)*this._coreBrowseService.dpr);n.left=y,n.center=y,n.right=y}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*n.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*n.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*n.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*n.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const y of this._decorationService.decorations)this._colorZoneStore.addDecoration(y);this._ctx.lineWidth=1;const m=this._colorZoneStore.zones;for(const y of m)y.position!=="full"&&this._renderColorZone(y);for(const y of m)y.position==="full"&&this._renderColorZone(y);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(m){this._ctx.fillStyle=m.color,this._ctx.fillRect(l[m.position||"full"],Math.round((this._canvas.height-1)*(m.startBufferLine/this._bufferService.buffers.active.lines.length)-n[m.position||"full"]/2),c[m.position||"full"],Math.round((this._canvas.height-1)*((m.endBufferLine-m.startBufferLine)/this._bufferService.buffers.active.lines.length)+n[m.position||"full"]))}_queueRefresh(m,y){this._shouldUpdateDimensions=m||this._shouldUpdateDimensions,this._shouldUpdateAnchor=y||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};i.OverviewRulerRenderer=h=d([v(2,f.IBufferService),v(3,f.IDecorationService),v(4,b.IRenderService),v(5,f.IOptionsService),v(6,b.ICoreBrowserService)],h)},2950:function(S,i,a){var d=this&&this.__decorate||function(f,n,c,l){var h,m=arguments.length,y=m<3?n:l===null?l=Object.getOwnPropertyDescriptor(n,c):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(f,n,c,l);else for(var C=f.length-1;C>=0;C--)(h=f[C])&&(y=(m<3?h(y):m>3?h(n,c,y):h(n,c))||y);return m>3&&y&&Object.defineProperty(n,c,y),y},v=this&&this.__param||function(f,n){return function(c,l){n(c,l,f)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CompositionHelper=void 0;const u=a(4725),_=a(2585),b=a(2584);let w=i.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(f,n,c,l,h,m){this._textarea=f,this._compositionView=n,this._bufferService=c,this._optionsService=l,this._coreService=h,this._renderService=m,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(f){this._compositionView.textContent=f.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(f){if(this._isComposing||this._isSendingComposition){if(f.keyCode===229||f.keyCode===16||f.keyCode===17||f.keyCode===18)return!1;this._finalizeComposition(!1)}return f.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(f){if(this._compositionView.classList.remove("active"),this._isComposing=!1,f){const n={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let c;this._isSendingComposition=!1,n.start+=this._dataAlreadySent.length,c=this._isComposing?this._textarea.value.substring(n.start,n.end):this._textarea.value.substring(n.start),c.length>0&&this._coreService.triggerDataEvent(c,!0)}},0)}else{this._isSendingComposition=!1;const n=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(n,!0)}}_handleAnyTextareaChanges(){const f=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const n=this._textarea.value,c=n.replace(f,"");this._dataAlreadySent=c,n.length>f.length?this._coreService.triggerDataEvent(c,!0):n.length<f.length?this._coreService.triggerDataEvent(`${b.C0.DEL}`,!0):n.length===f.length&&n!==f&&this._coreService.triggerDataEvent(n,!0)}},0)}updateCompositionElements(f){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const n=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),c=this._renderService.dimensions.css.cell.height,l=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,h=n*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=h+"px",this._compositionView.style.top=l+"px",this._compositionView.style.height=c+"px",this._compositionView.style.lineHeight=c+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const m=this._compositionView.getBoundingClientRect();this._textarea.style.left=h+"px",this._textarea.style.top=l+"px",this._textarea.style.width=Math.max(m.width,1)+"px",this._textarea.style.height=Math.max(m.height,1)+"px",this._textarea.style.lineHeight=m.height+"px"}f||setTimeout(()=>this.updateCompositionElements(!0),0)}}};i.CompositionHelper=w=d([v(2,_.IBufferService),v(3,_.IOptionsService),v(4,_.ICoreService),v(5,u.IRenderService)],w)},9806:(S,i)=>{function a(d,v,u){const _=u.getBoundingClientRect(),b=d.getComputedStyle(u),w=parseInt(b.getPropertyValue("padding-left")),f=parseInt(b.getPropertyValue("padding-top"));return[v.clientX-_.left-w,v.clientY-_.top-f]}Object.defineProperty(i,"__esModule",{value:!0}),i.getCoords=i.getCoordsRelativeToElement=void 0,i.getCoordsRelativeToElement=a,i.getCoords=function(d,v,u,_,b,w,f,n,c){if(!w)return;const l=a(d,v,u);return l?(l[0]=Math.ceil((l[0]+(c?f/2:0))/f),l[1]=Math.ceil(l[1]/n),l[0]=Math.min(Math.max(l[0],1),_+(c?1:0)),l[1]=Math.min(Math.max(l[1],1),b),l):void 0}},9504:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.moveToCellSequence=void 0;const d=a(2584);function v(n,c,l,h){const m=n-u(n,l),y=c-u(c,l),C=Math.abs(m-y)-function(L,x,E){let k=0;const T=L-u(L,E),A=x-u(x,E);for(let D=0;D<Math.abs(T-A);D++){const P=_(L,x)==="A"?-1:1,O=E.buffer.lines.get(T+P*D);O!=null&&O.isWrapped&&k++}return k}(n,c,l);return f(C,w(_(n,c),h))}function u(n,c){let l=0,h=c.buffer.lines.get(n),m=h==null?void 0:h.isWrapped;for(;m&&n>=0&&n<c.rows;)l++,h=c.buffer.lines.get(--n),m=h==null?void 0:h.isWrapped;return l}function _(n,c){return n>c?"A":"B"}function b(n,c,l,h,m,y){let C=n,L=c,x="";for(;C!==l||L!==h;)C+=m?1:-1,m&&C>y.cols-1?(x+=y.buffer.translateBufferLineToString(L,!1,n,C),C=0,n=0,L++):!m&&C<0&&(x+=y.buffer.translateBufferLineToString(L,!1,0,n+1),C=y.cols-1,n=C,L--);return x+y.buffer.translateBufferLineToString(L,!1,n,C)}function w(n,c){const l=c?"O":"[";return d.C0.ESC+l+n}function f(n,c){n=Math.floor(n);let l="";for(let h=0;h<n;h++)l+=c;return l}i.moveToCellSequence=function(n,c,l,h){const m=l.buffer.x,y=l.buffer.y;if(!l.buffer.hasScrollback)return function(x,E,k,T,A,D){return v(E,T,A,D).length===0?"":f(b(x,E,x,E-u(E,A),!1,A).length,w("D",D))}(m,y,0,c,l,h)+v(y,c,l,h)+function(x,E,k,T,A,D){let P;P=v(E,T,A,D).length>0?T-u(T,A):E;const O=T,F=function(H,R,j,M,B,$){let q;return q=v(j,M,B,$).length>0?M-u(M,B):R,H<j&&q<=M||H>=j&&q<M?"C":"D"}(x,E,k,T,A,D);return f(b(x,P,k,O,F==="C",A).length,w(F,D))}(m,y,n,c,l,h);let C;if(y===c)return C=m>n?"D":"C",f(Math.abs(m-n),w(C,h));C=y>c?"D":"C";const L=Math.abs(y-c);return f(function(x,E){return E.cols-x}(y>c?n:m,l)+(L-1)*l.cols+1+((y>c?m:n)-1),w(C,h))}},1296:function(S,i,a){var d=this&&this.__decorate||function(A,D,P,O){var F,H=arguments.length,R=H<3?D:O===null?O=Object.getOwnPropertyDescriptor(D,P):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(A,D,P,O);else for(var j=A.length-1;j>=0;j--)(F=A[j])&&(R=(H<3?F(R):H>3?F(D,P,R):F(D,P))||R);return H>3&&R&&Object.defineProperty(D,P,R),R},v=this&&this.__param||function(A,D){return function(P,O){D(P,O,A)}};Object.defineProperty(i,"__esModule",{value:!0}),i.DomRenderer=void 0;const u=a(3787),_=a(2550),b=a(2223),w=a(6171),f=a(4725),n=a(8055),c=a(8460),l=a(844),h=a(2585),m="xterm-dom-renderer-owner-",y="xterm-rows",C="xterm-fg-",L="xterm-bg-",x="xterm-focus",E="xterm-selection";let k=1,T=i.DomRenderer=class extends l.Disposable{constructor(A,D,P,O,F,H,R,j,M,B){super(),this._element=A,this._screenElement=D,this._viewportElement=P,this._linkifier2=O,this._charSizeService=H,this._optionsService=R,this._bufferService=j,this._coreBrowserService=M,this._themeService=B,this._terminalClass=k++,this._rowElements=[],this.onRequestRedraw=this.register(new c.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(y),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(E),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,w.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors($=>this._injectCss($))),this._injectCss(this._themeService.colors),this._rowFactory=F.createInstance(u.DomRendererRowFactory,document),this._element.classList.add(m+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline($=>this._handleLinkHover($))),this.register(this._linkifier2.onHideLinkUnderline($=>this._handleLinkLeave($))),this.register((0,l.toDisposable)(()=>{this._element.classList.remove(m+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new _.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const A=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*A,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*A),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/A),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/A),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const P of this._rowElements)P.style.width=`${this.dimensions.css.canvas.width}px`,P.style.height=`${this.dimensions.css.cell.height}px`,P.style.lineHeight=`${this.dimensions.css.cell.height}px`,P.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const D=`${this._terminalSelector} .${y} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=D,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(A){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let D=`${this._terminalSelector} .${y} { color: ${A.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;D+=`${this._terminalSelector} .${y} .xterm-dim { color: ${n.color.multiplyOpacity(A.foreground,.5).css};}`,D+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,D+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",D+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${A.cursor.css};  color: ${A.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${A.cursor.css}; }}`,D+=`${this._terminalSelector} .${y}.${x} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${y}.${x} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-block { background-color: ${A.cursor.css}; color: ${A.cursorAccent.css};}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${A.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${A.cursor.css} inset;}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${A.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,D+=`${this._terminalSelector} .${E} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${E} div { position: absolute; background-color: ${A.selectionBackgroundOpaque.css};}${this._terminalSelector} .${E} div { position: absolute; background-color: ${A.selectionInactiveBackgroundOpaque.css};}`;for(const[P,O]of A.ansi.entries())D+=`${this._terminalSelector} .${C}${P} { color: ${O.css}; }${this._terminalSelector} .${C}${P}.xterm-dim { color: ${n.color.multiplyOpacity(O,.5).css}; }${this._terminalSelector} .${L}${P} { background-color: ${O.css}; }`;D+=`${this._terminalSelector} .${C}${b.INVERTED_DEFAULT_COLOR} { color: ${n.color.opaque(A.background).css}; }${this._terminalSelector} .${C}${b.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${n.color.multiplyOpacity(n.color.opaque(A.background),.5).css}; }${this._terminalSelector} .${L}${b.INVERTED_DEFAULT_COLOR} { background-color: ${A.foreground.css}; }`,this._themeStyleElement.textContent=D}_setDefaultSpacing(){const A=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${A}px`,this._rowFactory.defaultSpacing=A}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(A,D){for(let P=this._rowElements.length;P<=D;P++){const O=document.createElement("div");this._rowContainer.appendChild(O),this._rowElements.push(O)}for(;this._rowElements.length>D;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(A,D){this._refreshRowElements(A,D),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(x)}handleFocus(){this._rowContainer.classList.add(x),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(A,D,P){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(A,D,P),this.renderRows(0,this._bufferService.rows-1),!A||!D)return;const O=A[1]-this._bufferService.buffer.ydisp,F=D[1]-this._bufferService.buffer.ydisp,H=Math.max(O,0),R=Math.min(F,this._bufferService.rows-1);if(H>=this._bufferService.rows||R<0)return;const j=document.createDocumentFragment();if(P){const M=A[0]>D[0];j.appendChild(this._createSelectionElement(H,M?D[0]:A[0],M?A[0]:D[0],R-H+1))}else{const M=O===H?A[0]:0,B=H===F?D[0]:this._bufferService.cols;j.appendChild(this._createSelectionElement(H,M,B));const $=R-H-1;if(j.appendChild(this._createSelectionElement(H+1,0,this._bufferService.cols,$)),H!==R){const q=F===R?D[0]:this._bufferService.cols;j.appendChild(this._createSelectionElement(R,0,q))}}this._selectionContainer.appendChild(j)}_createSelectionElement(A,D,P,O=1){const F=document.createElement("div");return F.style.height=O*this.dimensions.css.cell.height+"px",F.style.top=A*this.dimensions.css.cell.height+"px",F.style.left=D*this.dimensions.css.cell.width+"px",F.style.width=this.dimensions.css.cell.width*(P-D)+"px",F}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const A of this._rowElements)A.replaceChildren()}renderRows(A,D){const P=this._bufferService.buffer,O=P.ybase+P.y,F=Math.min(P.x,this._bufferService.cols-1),H=this._optionsService.rawOptions.cursorBlink,R=this._optionsService.rawOptions.cursorStyle,j=this._optionsService.rawOptions.cursorInactiveStyle;for(let M=A;M<=D;M++){const B=M+P.ydisp,$=this._rowElements[M],q=P.lines.get(B);if(!$||!q)break;$.replaceChildren(...this._rowFactory.createRow(q,B,B===O,R,j,F,H,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${m}${this._terminalClass}`}_handleLinkHover(A){this._setCellUnderline(A.x1,A.x2,A.y1,A.y2,A.cols,!0)}_handleLinkLeave(A){this._setCellUnderline(A.x1,A.x2,A.y1,A.y2,A.cols,!1)}_setCellUnderline(A,D,P,O,F,H){P<0&&(A=0),O<0&&(D=0);const R=this._bufferService.rows-1;P=Math.max(Math.min(P,R),0),O=Math.max(Math.min(O,R),0),F=Math.min(F,this._bufferService.cols);const j=this._bufferService.buffer,M=j.ybase+j.y,B=Math.min(j.x,F-1),$=this._optionsService.rawOptions.cursorBlink,q=this._optionsService.rawOptions.cursorStyle,K=this._optionsService.rawOptions.cursorInactiveStyle;for(let Y=P;Y<=O;++Y){const se=Y+j.ydisp,N=this._rowElements[Y],z=j.lines.get(se);if(!N||!z)break;N.replaceChildren(...this._rowFactory.createRow(z,se,se===M,q,K,B,$,this.dimensions.css.cell.width,this._widthCache,H?Y===P?A:0:-1,H?(Y===O?D:F)-1:-1))}}};i.DomRenderer=T=d([v(4,h.IInstantiationService),v(5,f.ICharSizeService),v(6,h.IOptionsService),v(7,h.IBufferService),v(8,f.ICoreBrowserService),v(9,f.IThemeService)],T)},3787:function(S,i,a){var d=this&&this.__decorate||function(C,L,x,E){var k,T=arguments.length,A=T<3?L:E===null?E=Object.getOwnPropertyDescriptor(L,x):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(C,L,x,E);else for(var D=C.length-1;D>=0;D--)(k=C[D])&&(A=(T<3?k(A):T>3?k(L,x,A):k(L,x))||A);return T>3&&A&&Object.defineProperty(L,x,A),A},v=this&&this.__param||function(C,L){return function(x,E){L(x,E,C)}};Object.defineProperty(i,"__esModule",{value:!0}),i.DomRendererRowFactory=void 0;const u=a(2223),_=a(643),b=a(511),w=a(2585),f=a(8055),n=a(4725),c=a(4269),l=a(6171),h=a(3734);let m=i.DomRendererRowFactory=class{constructor(C,L,x,E,k,T,A){this._document=C,this._characterJoinerService=L,this._optionsService=x,this._coreBrowserService=E,this._coreService=k,this._decorationService=T,this._themeService=A,this._workCell=new b.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(C,L,x){this._selectionStart=C,this._selectionEnd=L,this._columnSelectMode=x}createRow(C,L,x,E,k,T,A,D,P,O,F){const H=[],R=this._characterJoinerService.getJoinedCharacters(L),j=this._themeService.colors;let M,B=C.getNoBgTrimmedLength();x&&B<T+1&&(B=T+1);let $=0,q="",K=0,Y=0,se=0,N=!1,z=0,U=!1,W=0;const ne=[],Q=O!==-1&&F!==-1;for(let ce=0;ce<B;ce++){C.loadCell(ce,this._workCell);let oe=this._workCell.getWidth();if(oe===0)continue;let ke=!1,tt=ce,ae=this._workCell;if(R.length>0&&ce===R[0][0]){ke=!0;const he=R.shift();ae=new c.JoinedCellData(this._workCell,C.translateToString(!0,he[0],he[1]),he[1]-he[0]),tt=he[1]-1,oe=ae.getWidth()}const mt=this._isCellInSelection(ce,L),er=x&&ce===T,_e=Q&&ce>=O&&ce<=F;let ue=!1;this._decorationService.forEachDecorationAtCell(ce,L,void 0,he=>{ue=!0});let de=ae.getChars()||_.WHITESPACE_CELL_CHAR;if(de===" "&&(ae.isUnderline()||ae.isOverline())&&(de=""),W=oe*D-P.get(de,ae.isBold(),ae.isItalic()),M){if($&&(mt&&U||!mt&&!U&&ae.bg===K)&&(mt&&U&&j.selectionForeground||ae.fg===Y)&&ae.extended.ext===se&&_e===N&&W===z&&!er&&!ke&&!ue){q+=de,$++;continue}$&&(M.textContent=q),M=this._document.createElement("span"),$=0,q=""}else M=this._document.createElement("span");if(K=ae.bg,Y=ae.fg,se=ae.extended.ext,N=_e,z=W,U=mt,ke&&T>=ce&&T<=tt&&(T=ce),!this._coreService.isCursorHidden&&er){if(ne.push("xterm-cursor"),this._coreBrowserService.isFocused)A&&ne.push("xterm-cursor-blink"),ne.push(E==="bar"?"xterm-cursor-bar":E==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(k)switch(k){case"outline":ne.push("xterm-cursor-outline");break;case"block":ne.push("xterm-cursor-block");break;case"bar":ne.push("xterm-cursor-bar");break;case"underline":ne.push("xterm-cursor-underline")}}if(ae.isBold()&&ne.push("xterm-bold"),ae.isItalic()&&ne.push("xterm-italic"),ae.isDim()&&ne.push("xterm-dim"),q=ae.isInvisible()?_.WHITESPACE_CELL_CHAR:ae.getChars()||_.WHITESPACE_CELL_CHAR,ae.isUnderline()&&(ne.push(`xterm-underline-${ae.extended.underlineStyle}`),q===" "&&(q=""),!ae.isUnderlineColorDefault()))if(ae.isUnderlineColorRGB())M.style.textDecorationColor=`rgb(${h.AttributeData.toColorRGB(ae.getUnderlineColor()).join(",")})`;else{let he=ae.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&ae.isBold()&&he<8&&(he+=8),M.style.textDecorationColor=j.ansi[he].css}ae.isOverline()&&(ne.push("xterm-overline"),q===" "&&(q="")),ae.isStrikethrough()&&ne.push("xterm-strikethrough"),_e&&(M.style.textDecoration="underline");let ee=ae.getFgColor(),pe=ae.getFgColorMode(),Ee=ae.getBgColor(),xe=ae.getBgColorMode();const lt=!!ae.isInverse();if(lt){const he=ee;ee=Ee,Ee=he;const Cr=pe;pe=xe,xe=Cr}let Ve,ct,Me,ve=!1;switch(this._decorationService.forEachDecorationAtCell(ce,L,void 0,he=>{he.options.layer!=="top"&&ve||(he.backgroundColorRGB&&(xe=50331648,Ee=he.backgroundColorRGB.rgba>>8&16777215,Ve=he.backgroundColorRGB),he.foregroundColorRGB&&(pe=50331648,ee=he.foregroundColorRGB.rgba>>8&16777215,ct=he.foregroundColorRGB),ve=he.options.layer==="top")}),!ve&&mt&&(Ve=this._coreBrowserService.isFocused?j.selectionBackgroundOpaque:j.selectionInactiveBackgroundOpaque,Ee=Ve.rgba>>8&16777215,xe=50331648,ve=!0,j.selectionForeground&&(pe=50331648,ee=j.selectionForeground.rgba>>8&16777215,ct=j.selectionForeground)),ve&&ne.push("xterm-decoration-top"),xe){case 16777216:case 33554432:Me=j.ansi[Ee],ne.push(`xterm-bg-${Ee}`);break;case 50331648:Me=f.rgba.toColor(Ee>>16,Ee>>8&255,255&Ee),this._addStyle(M,`background-color:#${y((Ee>>>0).toString(16),"0",6)}`);break;default:lt?(Me=j.foreground,ne.push(`xterm-bg-${u.INVERTED_DEFAULT_COLOR}`)):Me=j.background}switch(Ve||ae.isDim()&&(Ve=f.color.multiplyOpacity(Me,.5)),pe){case 16777216:case 33554432:ae.isBold()&&ee<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(ee+=8),this._applyMinimumContrast(M,Me,j.ansi[ee],ae,Ve,void 0)||ne.push(`xterm-fg-${ee}`);break;case 50331648:const he=f.rgba.toColor(ee>>16&255,ee>>8&255,255&ee);this._applyMinimumContrast(M,Me,he,ae,Ve,ct)||this._addStyle(M,`color:#${y(ee.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(M,Me,j.foreground,ae,Ve,void 0)||lt&&ne.push(`xterm-fg-${u.INVERTED_DEFAULT_COLOR}`)}ne.length&&(M.className=ne.join(" "),ne.length=0),er||ke||ue?M.textContent=q:$++,W!==this.defaultSpacing&&(M.style.letterSpacing=`${W}px`),H.push(M),ce=tt}return M&&$&&(M.textContent=q),H}_applyMinimumContrast(C,L,x,E,k,T){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,l.excludeFromContrastRatioDemands)(E.getCode()))return!1;const A=this._getContrastCache(E);let D;if(k||T||(D=A.getColor(L.rgba,x.rgba)),D===void 0){const P=this._optionsService.rawOptions.minimumContrastRatio/(E.isDim()?2:1);D=f.color.ensureContrastRatio(k||L,T||x,P),A.setColor((k||L).rgba,(T||x).rgba,D??null)}return!!D&&(this._addStyle(C,`color:${D.css}`),!0)}_getContrastCache(C){return C.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(C,L){C.setAttribute("style",`${C.getAttribute("style")||""}${L};`)}_isCellInSelection(C,L){const x=this._selectionStart,E=this._selectionEnd;return!(!x||!E)&&(this._columnSelectMode?x[0]<=E[0]?C>=x[0]&&L>=x[1]&&C<E[0]&&L<=E[1]:C<x[0]&&L>=x[1]&&C>=E[0]&&L<=E[1]:L>x[1]&&L<E[1]||x[1]===E[1]&&L===x[1]&&C>=x[0]&&C<E[0]||x[1]<E[1]&&L===E[1]&&C<E[0]||x[1]<E[1]&&L===x[1]&&C>=x[0])}};function y(C,L,x){for(;C.length<x;)C=L+C;return C}i.DomRendererRowFactory=m=d([v(1,n.ICharacterJoinerService),v(2,w.IOptionsService),v(3,n.ICoreBrowserService),v(4,w.ICoreService),v(5,w.IDecorationService),v(6,n.IThemeService)],m)},2550:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WidthCache=void 0,i.WidthCache=class{constructor(a){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=a.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const d=a.createElement("span"),v=a.createElement("span");v.style.fontWeight="bold";const u=a.createElement("span");u.style.fontStyle="italic";const _=a.createElement("span");_.style.fontWeight="bold",_.style.fontStyle="italic",this._measureElements=[d,v,u,_],this._container.appendChild(d),this._container.appendChild(v),this._container.appendChild(u),this._container.appendChild(_),a.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(a,d,v,u){a===this._font&&d===this._fontSize&&v===this._weight&&u===this._weightBold||(this._font=a,this._fontSize=d,this._weight=v,this._weightBold=u,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${v}`,this._measureElements[1].style.fontWeight=`${u}`,this._measureElements[2].style.fontWeight=`${v}`,this._measureElements[3].style.fontWeight=`${u}`,this.clear())}get(a,d,v){let u=0;if(!d&&!v&&a.length===1&&(u=a.charCodeAt(0))<256)return this._flat[u]!==-9999?this._flat[u]:this._flat[u]=this._measure(a,0);let _=a;d&&(_+="B"),v&&(_+="I");let b=this._holey.get(_);if(b===void 0){let w=0;d&&(w|=1),v&&(w|=2),b=this._measure(a,w),this._holey.set(_,b)}return b}_measure(a,d){const v=this._measureElements[d];return v.textContent=a.repeat(32),v.offsetWidth/32}}},2223:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TEXT_BASELINE=i.DIM_OPACITY=i.INVERTED_DEFAULT_COLOR=void 0;const d=a(6114);i.INVERTED_DEFAULT_COLOR=257,i.DIM_OPACITY=.5,i.TEXT_BASELINE=d.isFirefox||d.isLegacyEdge?"bottom":"ideographic"},6171:(S,i)=>{function a(d){return 57508<=d&&d<=57558}Object.defineProperty(i,"__esModule",{value:!0}),i.createRenderDimensions=i.excludeFromContrastRatioDemands=i.isRestrictedPowerlineGlyph=i.isPowerlineGlyph=i.throwIfFalsy=void 0,i.throwIfFalsy=function(d){if(!d)throw new Error("value must not be falsy");return d},i.isPowerlineGlyph=a,i.isRestrictedPowerlineGlyph=function(d){return 57520<=d&&d<=57527},i.excludeFromContrastRatioDemands=function(d){return a(d)||function(v){return 9472<=v&&v<=9631}(d)},i.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SelectionModel=void 0,i.SelectionModel=class{constructor(a){this._bufferService=a,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?a%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)-1]:[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[a,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[Math.max(a,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const a=this.selectionStart,d=this.selectionEnd;return!(!a||!d)&&(a[1]>d[1]||a[1]===d[1]&&a[0]>d[0])}handleTrim(a){return this.selectionStart&&(this.selectionStart[1]-=a),this.selectionEnd&&(this.selectionEnd[1]-=a),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(S,i,a){var d=this&&this.__decorate||function(n,c,l,h){var m,y=arguments.length,C=y<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,l):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(n,c,l,h);else for(var L=n.length-1;L>=0;L--)(m=n[L])&&(C=(y<3?m(C):y>3?m(c,l,C):m(c,l))||C);return y>3&&C&&Object.defineProperty(c,l,C),C},v=this&&this.__param||function(n,c){return function(l,h){c(l,h,n)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CharSizeService=void 0;const u=a(2585),_=a(8460),b=a(844);let w=i.CharSizeService=class extends b.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(n,c,l){super(),this._optionsService=l,this.width=0,this.height=0,this._onCharSizeChange=this.register(new _.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new f(n,c,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const n=this._measureStrategy.measure();n.width===this.width&&n.height===this.height||(this.width=n.width,this.height=n.height,this._onCharSizeChange.fire())}};i.CharSizeService=w=d([v(2,u.IOptionsService)],w);class f{constructor(c,l,h){this._document=c,this._parentElement=l,this._optionsService=h,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const c={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return c.width!==0&&c.height!==0&&(this._result.width=c.width/32,this._result.height=Math.ceil(c.height)),this._result}}},4269:function(S,i,a){var d=this&&this.__decorate||function(c,l,h,m){var y,C=arguments.length,L=C<3?l:m===null?m=Object.getOwnPropertyDescriptor(l,h):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(c,l,h,m);else for(var x=c.length-1;x>=0;x--)(y=c[x])&&(L=(C<3?y(L):C>3?y(l,h,L):y(l,h))||L);return C>3&&L&&Object.defineProperty(l,h,L),L},v=this&&this.__param||function(c,l){return function(h,m){l(h,m,c)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CharacterJoinerService=i.JoinedCellData=void 0;const u=a(3734),_=a(643),b=a(511),w=a(2585);class f extends u.AttributeData{constructor(l,h,m){super(),this.content=0,this.combinedData="",this.fg=l.fg,this.bg=l.bg,this.combinedData=h,this._width=m}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(l){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}i.JoinedCellData=f;let n=i.CharacterJoinerService=class Ef{constructor(l){this._bufferService=l,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new b.CellData}register(l){const h={id:this._nextCharacterJoinerId++,handler:l};return this._characterJoiners.push(h),h.id}deregister(l){for(let h=0;h<this._characterJoiners.length;h++)if(this._characterJoiners[h].id===l)return this._characterJoiners.splice(h,1),!0;return!1}getJoinedCharacters(l){if(this._characterJoiners.length===0)return[];const h=this._bufferService.buffer.lines.get(l);if(!h||h.length===0)return[];const m=[],y=h.translateToString(!0);let C=0,L=0,x=0,E=h.getFg(0),k=h.getBg(0);for(let T=0;T<h.getTrimmedLength();T++)if(h.loadCell(T,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==E||this._workCell.bg!==k){if(T-C>1){const A=this._getJoinedRanges(y,x,L,h,C);for(let D=0;D<A.length;D++)m.push(A[D])}C=T,x=L,E=this._workCell.fg,k=this._workCell.bg}L+=this._workCell.getChars().length||_.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-C>1){const T=this._getJoinedRanges(y,x,L,h,C);for(let A=0;A<T.length;A++)m.push(T[A])}return m}_getJoinedRanges(l,h,m,y,C){const L=l.substring(h,m);let x=[];try{x=this._characterJoiners[0].handler(L)}catch(E){console.error(E)}for(let E=1;E<this._characterJoiners.length;E++)try{const k=this._characterJoiners[E].handler(L);for(let T=0;T<k.length;T++)Ef._mergeRanges(x,k[T])}catch(k){console.error(k)}return this._stringRangesToCellRanges(x,y,C),x}_stringRangesToCellRanges(l,h,m){let y=0,C=!1,L=0,x=l[y];if(x){for(let E=m;E<this._bufferService.cols;E++){const k=h.getWidth(E),T=h.getString(E).length||_.WHITESPACE_CELL_CHAR.length;if(k!==0){if(!C&&x[0]<=L&&(x[0]=E,C=!0),x[1]<=L){if(x[1]=E,x=l[++y],!x)break;x[0]<=L?(x[0]=E,C=!0):C=!1}L+=T}}x&&(x[1]=this._bufferService.cols)}}static _mergeRanges(l,h){let m=!1;for(let y=0;y<l.length;y++){const C=l[y];if(m){if(h[1]<=C[0])return l[y-1][1]=h[1],l;if(h[1]<=C[1])return l[y-1][1]=Math.max(h[1],C[1]),l.splice(y,1),l;l.splice(y,1),y--}else{if(h[1]<=C[0])return l.splice(y,0,h),l;if(h[1]<=C[1])return C[0]=Math.min(h[0],C[0]),l;h[0]<C[1]&&(C[0]=Math.min(h[0],C[0]),m=!0)}}return m?l[l.length-1][1]=h[1]:l.push(h),l}};i.CharacterJoinerService=n=d([v(0,w.IBufferService)],n)},5114:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CoreBrowserService=void 0,i.CoreBrowserService=class{constructor(a,d){this._textarea=a,this.window=d,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(S,i,a){var d=this&&this.__decorate||function(w,f,n,c){var l,h=arguments.length,m=h<3?f:c===null?c=Object.getOwnPropertyDescriptor(f,n):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(w,f,n,c);else for(var y=w.length-1;y>=0;y--)(l=w[y])&&(m=(h<3?l(m):h>3?l(f,n,m):l(f,n))||m);return h>3&&m&&Object.defineProperty(f,n,m),m},v=this&&this.__param||function(w,f){return function(n,c){f(n,c,w)}};Object.defineProperty(i,"__esModule",{value:!0}),i.MouseService=void 0;const u=a(4725),_=a(9806);let b=i.MouseService=class{constructor(w,f){this._renderService=w,this._charSizeService=f}getCoords(w,f,n,c,l){return(0,_.getCoords)(window,w,f,n,c,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,l)}getMouseReportCoords(w,f){const n=(0,_.getCoordsRelativeToElement)(window,w,f);if(this._charSizeService.hasValidSize)return n[0]=Math.min(Math.max(n[0],0),this._renderService.dimensions.css.canvas.width-1),n[1]=Math.min(Math.max(n[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(n[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(n[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(n[0]),y:Math.floor(n[1])}}};i.MouseService=b=d([v(0,u.IRenderService),v(1,u.ICharSizeService)],b)},3230:function(S,i,a){var d=this&&this.__decorate||function(m,y,C,L){var x,E=arguments.length,k=E<3?y:L===null?L=Object.getOwnPropertyDescriptor(y,C):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(m,y,C,L);else for(var T=m.length-1;T>=0;T--)(x=m[T])&&(k=(E<3?x(k):E>3?x(y,C,k):x(y,C))||k);return E>3&&k&&Object.defineProperty(y,C,k),k},v=this&&this.__param||function(m,y){return function(C,L){y(C,L,m)}};Object.defineProperty(i,"__esModule",{value:!0}),i.RenderService=void 0;const u=a(3656),_=a(6193),b=a(5596),w=a(4725),f=a(8460),n=a(844),c=a(7226),l=a(2585);let h=i.RenderService=class extends n.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(m,y,C,L,x,E,k,T){if(super(),this._rowCount=m,this._charSizeService=L,this._renderer=this.register(new n.MutableDisposable),this._pausedResizeTask=new c.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new f.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new f.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new f.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new f.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new _.RenderDebouncer(k.window,(A,D)=>this._renderRows(A,D)),this.register(this._renderDebouncer),this._screenDprMonitor=new b.ScreenDprMonitor(k.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(E.onResize(()=>this._fullRefresh())),this.register(E.buffers.onBufferActivate(()=>{var A;return(A=this._renderer.value)===null||A===void 0?void 0:A.clear()})),this.register(C.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(x.onDecorationRegistered(()=>this._fullRefresh())),this.register(x.onDecorationRemoved(()=>this._fullRefresh())),this.register(C.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(E.cols,E.rows),this._fullRefresh()})),this.register(C.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(E.buffer.y,E.buffer.y,!0))),this.register((0,u.addDisposableDomListener)(k.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(T.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in k.window){const A=new k.window.IntersectionObserver(D=>this._handleIntersectionChange(D[D.length-1]),{threshold:0});A.observe(y),this.register({dispose:()=>A.disconnect()})}}_handleIntersectionChange(m){this._isPaused=m.isIntersecting===void 0?m.intersectionRatio===0:!m.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(m,y,C=!1){this._isPaused?this._needsFullRefresh=!0:(C||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(m,y,this._rowCount))}_renderRows(m,y){this._renderer.value&&(m=Math.min(m,this._rowCount-1),y=Math.min(y,this._rowCount-1),this._renderer.value.renderRows(m,y),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:m,end:y}),this._onRender.fire({start:m,end:y}),this._isNextRenderRedrawOnly=!0)}resize(m,y){this._rowCount=y,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(m){this._renderer.value=m,this._renderer.value.onRequestRedraw(y=>this.refreshRows(y.start,y.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(m){return this._renderDebouncer.addRefreshCallback(m)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var m,y;this._renderer.value&&((y=(m=this._renderer.value).clearTextureAtlas)===null||y===void 0||y.call(m),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(m,y){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(m,y)):this._renderer.value.handleResize(m,y),this._fullRefresh())}handleCharSizeChanged(){var m;(m=this._renderer.value)===null||m===void 0||m.handleCharSizeChanged()}handleBlur(){var m;(m=this._renderer.value)===null||m===void 0||m.handleBlur()}handleFocus(){var m;(m=this._renderer.value)===null||m===void 0||m.handleFocus()}handleSelectionChanged(m,y,C){var L;this._selectionState.start=m,this._selectionState.end=y,this._selectionState.columnSelectMode=C,(L=this._renderer.value)===null||L===void 0||L.handleSelectionChanged(m,y,C)}handleCursorMove(){var m;(m=this._renderer.value)===null||m===void 0||m.handleCursorMove()}clear(){var m;(m=this._renderer.value)===null||m===void 0||m.clear()}};i.RenderService=h=d([v(2,l.IOptionsService),v(3,w.ICharSizeService),v(4,l.IDecorationService),v(5,l.IBufferService),v(6,w.ICoreBrowserService),v(7,w.IThemeService)],h)},9312:function(S,i,a){var d=this&&this.__decorate||function(x,E,k,T){var A,D=arguments.length,P=D<3?E:T===null?T=Object.getOwnPropertyDescriptor(E,k):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(x,E,k,T);else for(var O=x.length-1;O>=0;O--)(A=x[O])&&(P=(D<3?A(P):D>3?A(E,k,P):A(E,k))||P);return D>3&&P&&Object.defineProperty(E,k,P),P},v=this&&this.__param||function(x,E){return function(k,T){E(k,T,x)}};Object.defineProperty(i,"__esModule",{value:!0}),i.SelectionService=void 0;const u=a(9806),_=a(9504),b=a(456),w=a(4725),f=a(8460),n=a(844),c=a(6114),l=a(4841),h=a(511),m=a(2585),y="",C=new RegExp(y,"g");let L=i.SelectionService=class extends n.Disposable{constructor(x,E,k,T,A,D,P,O,F){super(),this._element=x,this._screenElement=E,this._linkifier=k,this._bufferService=T,this._coreService=A,this._mouseService=D,this._optionsService=P,this._renderService=O,this._coreBrowserService=F,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new h.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new f.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new f.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new f.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=H=>this._handleMouseMove(H),this._mouseUpListener=H=>this._handleMouseUp(H),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(H=>this._handleTrim(H)),this.register(this._bufferService.buffers.onBufferActivate(H=>this._handleBufferActivate(H))),this.enable(),this._model=new b.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,n.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const x=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;return!(!x||!E||x[0]===E[0]&&x[1]===E[1])}get selectionText(){const x=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;if(!x||!E)return"";const k=this._bufferService.buffer,T=[];if(this._activeSelectionMode===3){if(x[0]===E[0])return"";const A=x[0]<E[0]?x[0]:E[0],D=x[0]<E[0]?E[0]:x[0];for(let P=x[1];P<=E[1];P++){const O=k.translateBufferLineToString(P,!0,A,D);T.push(O)}}else{const A=x[1]===E[1]?E[0]:void 0;T.push(k.translateBufferLineToString(x[1],!0,x[0],A));for(let D=x[1]+1;D<=E[1]-1;D++){const P=k.lines.get(D),O=k.translateBufferLineToString(D,!0);P!=null&&P.isWrapped?T[T.length-1]+=O:T.push(O)}if(x[1]!==E[1]){const D=k.lines.get(E[1]),P=k.translateBufferLineToString(E[1],!0,0,E[0]);D&&D.isWrapped?T[T.length-1]+=P:T.push(P)}}return T.map(A=>A.replace(C," ")).join(c.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(x){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),c.isLinux&&x&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(x){const E=this._getMouseBufferCoords(x),k=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!!(k&&T&&E)&&this._areCoordsInSelection(E,k,T)}isCellInSelection(x,E){const k=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!(!k||!T)&&this._areCoordsInSelection([x,E],k,T)}_areCoordsInSelection(x,E,k){return x[1]>E[1]&&x[1]<k[1]||E[1]===k[1]&&x[1]===E[1]&&x[0]>=E[0]&&x[0]<k[0]||E[1]<k[1]&&x[1]===k[1]&&x[0]<k[0]||E[1]<k[1]&&x[1]===E[1]&&x[0]>=E[0]}_selectWordAtCursor(x,E){var k,T;const A=(T=(k=this._linkifier.currentLink)===null||k===void 0?void 0:k.link)===null||T===void 0?void 0:T.range;if(A)return this._model.selectionStart=[A.start.x-1,A.start.y-1],this._model.selectionStartLength=(0,l.getRangeLength)(A,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const D=this._getMouseBufferCoords(x);return!!D&&(this._selectWordAt(D,E),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(x,E){this._model.clearSelection(),x=Math.max(x,0),E=Math.min(E,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,x],this._model.selectionEnd=[this._bufferService.cols,E],this.refresh(),this._onSelectionChange.fire()}_handleTrim(x){this._model.handleTrim(x)&&this.refresh()}_getMouseBufferCoords(x){const E=this._mouseService.getCoords(x,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(E)return E[0]--,E[1]--,E[1]+=this._bufferService.buffer.ydisp,E}_getMouseEventScrollAmount(x){let E=(0,u.getCoordsRelativeToElement)(this._coreBrowserService.window,x,this._screenElement)[1];const k=this._renderService.dimensions.css.canvas.height;return E>=0&&E<=k?0:(E>k&&(E-=k),E=Math.min(Math.max(E,-50),50),E/=50,E/Math.abs(E)+Math.round(14*E))}shouldForceSelection(x){return c.isMac?x.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:x.shiftKey}handleMouseDown(x){if(this._mouseDownTimeStamp=x.timeStamp,(x.button!==2||!this.hasSelection)&&x.button===0){if(!this._enabled){if(!this.shouldForceSelection(x))return;x.stopPropagation()}x.preventDefault(),this._dragScrollAmount=0,this._enabled&&x.shiftKey?this._handleIncrementalClick(x):x.detail===1?this._handleSingleClick(x):x.detail===2?this._handleDoubleClick(x):x.detail===3&&this._handleTripleClick(x),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(x){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(x))}_handleSingleClick(x){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(x)?3:0,this._model.selectionStart=this._getMouseBufferCoords(x),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const E=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);E&&E.length!==this._model.selectionStart[0]&&E.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(x){this._selectWordAtCursor(x,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(x){const E=this._getMouseBufferCoords(x);E&&(this._activeSelectionMode=2,this._selectLineAt(E[1]))}shouldColumnSelect(x){return x.altKey&&!(c.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(x){if(x.stopImmediatePropagation(),!this._model.selectionStart)return;const E=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(x),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(x),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const k=this._bufferService.buffer;if(this._model.selectionEnd[1]<k.lines.length){const T=k.lines.get(this._model.selectionEnd[1]);T&&T.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}E&&E[0]===this._model.selectionEnd[0]&&E[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const x=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(x.ydisp+this._bufferService.rows,x.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=x.ydisp),this.refresh()}}_handleMouseUp(x){const E=x.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&E<500&&x.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const k=this._mouseService.getCoords(x,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(k&&k[0]!==void 0&&k[1]!==void 0){const T=(0,_.moveToCellSequence)(k[0]-1,k[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(T,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const x=this._model.finalSelectionStart,E=this._model.finalSelectionEnd,k=!(!x||!E||x[0]===E[0]&&x[1]===E[1]);k?x&&E&&(this._oldSelectionStart&&this._oldSelectionEnd&&x[0]===this._oldSelectionStart[0]&&x[1]===this._oldSelectionStart[1]&&E[0]===this._oldSelectionEnd[0]&&E[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(x,E,k)):this._oldHasSelection&&this._fireOnSelectionChange(x,E,k)}_fireOnSelectionChange(x,E,k){this._oldSelectionStart=x,this._oldSelectionEnd=E,this._oldHasSelection=k,this._onSelectionChange.fire()}_handleBufferActivate(x){this.clearSelection(),this._trimListener.dispose(),this._trimListener=x.activeBuffer.lines.onTrim(E=>this._handleTrim(E))}_convertViewportColToCharacterIndex(x,E){let k=E;for(let T=0;E>=T;T++){const A=x.loadCell(T,this._workCell).getChars().length;this._workCell.getWidth()===0?k--:A>1&&E!==T&&(k+=A-1)}return k}setSelection(x,E,k){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[x,E],this._model.selectionStartLength=k,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(x){this._isClickInSelection(x)||(this._selectWordAtCursor(x,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(x,E,k=!0,T=!0){if(x[0]>=this._bufferService.cols)return;const A=this._bufferService.buffer,D=A.lines.get(x[1]);if(!D)return;const P=A.translateBufferLineToString(x[1],!1);let O=this._convertViewportColToCharacterIndex(D,x[0]),F=O;const H=x[0]-O;let R=0,j=0,M=0,B=0;if(P.charAt(O)===" "){for(;O>0&&P.charAt(O-1)===" ";)O--;for(;F<P.length&&P.charAt(F+1)===" ";)F++}else{let K=x[0],Y=x[0];D.getWidth(K)===0&&(R++,K--),D.getWidth(Y)===2&&(j++,Y++);const se=D.getString(Y).length;for(se>1&&(B+=se-1,F+=se-1);K>0&&O>0&&!this._isCharWordSeparator(D.loadCell(K-1,this._workCell));){D.loadCell(K-1,this._workCell);const N=this._workCell.getChars().length;this._workCell.getWidth()===0?(R++,K--):N>1&&(M+=N-1,O-=N-1),O--,K--}for(;Y<D.length&&F+1<P.length&&!this._isCharWordSeparator(D.loadCell(Y+1,this._workCell));){D.loadCell(Y+1,this._workCell);const N=this._workCell.getChars().length;this._workCell.getWidth()===2?(j++,Y++):N>1&&(B+=N-1,F+=N-1),F++,Y++}}F++;let $=O+H-R+M,q=Math.min(this._bufferService.cols,F-O+R+j-M-B);if(E||P.slice(O,F).trim()!==""){if(k&&$===0&&D.getCodePoint(0)!==32){const K=A.lines.get(x[1]-1);if(K&&D.isWrapped&&K.getCodePoint(this._bufferService.cols-1)!==32){const Y=this._getWordAt([this._bufferService.cols-1,x[1]-1],!1,!0,!1);if(Y){const se=this._bufferService.cols-Y.start;$-=se,q+=se}}}if(T&&$+q===this._bufferService.cols&&D.getCodePoint(this._bufferService.cols-1)!==32){const K=A.lines.get(x[1]+1);if(K!=null&&K.isWrapped&&K.getCodePoint(0)!==32){const Y=this._getWordAt([0,x[1]+1],!1,!1,!0);Y&&(q+=Y.length)}}return{start:$,length:q}}}_selectWordAt(x,E){const k=this._getWordAt(x,E);if(k){for(;k.start<0;)k.start+=this._bufferService.cols,x[1]--;this._model.selectionStart=[k.start,x[1]],this._model.selectionStartLength=k.length}}_selectToWordAt(x){const E=this._getWordAt(x,!0);if(E){let k=x[1];for(;E.start<0;)E.start+=this._bufferService.cols,k--;if(!this._model.areSelectionValuesReversed())for(;E.start+E.length>this._bufferService.cols;)E.length-=this._bufferService.cols,k++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?E.start:E.start+E.length,k]}}_isCharWordSeparator(x){return x.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(x.getChars())>=0}_selectLineAt(x){const E=this._bufferService.buffer.getWrappedRangeForLine(x),k={start:{x:0,y:E.first},end:{x:this._bufferService.cols-1,y:E.last}};this._model.selectionStart=[0,E.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,l.getRangeLength)(k,this._bufferService.cols)}};i.SelectionService=L=d([v(3,m.IBufferService),v(4,m.ICoreService),v(5,w.IMouseService),v(6,m.IOptionsService),v(7,w.IRenderService),v(8,w.ICoreBrowserService)],L)},4725:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.IThemeService=i.ICharacterJoinerService=i.ISelectionService=i.IRenderService=i.IMouseService=i.ICoreBrowserService=i.ICharSizeService=void 0;const d=a(8343);i.ICharSizeService=(0,d.createDecorator)("CharSizeService"),i.ICoreBrowserService=(0,d.createDecorator)("CoreBrowserService"),i.IMouseService=(0,d.createDecorator)("MouseService"),i.IRenderService=(0,d.createDecorator)("RenderService"),i.ISelectionService=(0,d.createDecorator)("SelectionService"),i.ICharacterJoinerService=(0,d.createDecorator)("CharacterJoinerService"),i.IThemeService=(0,d.createDecorator)("ThemeService")},6731:function(S,i,a){var d=this&&this.__decorate||function(L,x,E,k){var T,A=arguments.length,D=A<3?x:k===null?k=Object.getOwnPropertyDescriptor(x,E):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(L,x,E,k);else for(var P=L.length-1;P>=0;P--)(T=L[P])&&(D=(A<3?T(D):A>3?T(x,E,D):T(x,E))||D);return A>3&&D&&Object.defineProperty(x,E,D),D},v=this&&this.__param||function(L,x){return function(E,k){x(E,k,L)}};Object.defineProperty(i,"__esModule",{value:!0}),i.ThemeService=i.DEFAULT_ANSI_COLORS=void 0;const u=a(7239),_=a(8055),b=a(8460),w=a(844),f=a(2585),n=_.css.toColor("#ffffff"),c=_.css.toColor("#000000"),l=_.css.toColor("#ffffff"),h=_.css.toColor("#000000"),m={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};i.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const L=[_.css.toColor("#2e3436"),_.css.toColor("#cc0000"),_.css.toColor("#4e9a06"),_.css.toColor("#c4a000"),_.css.toColor("#3465a4"),_.css.toColor("#75507b"),_.css.toColor("#06989a"),_.css.toColor("#d3d7cf"),_.css.toColor("#555753"),_.css.toColor("#ef2929"),_.css.toColor("#8ae234"),_.css.toColor("#fce94f"),_.css.toColor("#729fcf"),_.css.toColor("#ad7fa8"),_.css.toColor("#34e2e2"),_.css.toColor("#eeeeec")],x=[0,95,135,175,215,255];for(let E=0;E<216;E++){const k=x[E/36%6|0],T=x[E/6%6|0],A=x[E%6];L.push({css:_.channels.toCss(k,T,A),rgba:_.channels.toRgba(k,T,A)})}for(let E=0;E<24;E++){const k=8+10*E;L.push({css:_.channels.toCss(k,k,k),rgba:_.channels.toRgba(k,k,k)})}return L})());let y=i.ThemeService=class extends w.Disposable{get colors(){return this._colors}constructor(L){super(),this._optionsService=L,this._contrastCache=new u.ColorContrastCache,this._halfContrastCache=new u.ColorContrastCache,this._onChangeColors=this.register(new b.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:n,background:c,cursor:l,cursorAccent:h,selectionForeground:void 0,selectionBackgroundTransparent:m,selectionBackgroundOpaque:_.color.blend(c,m),selectionInactiveBackgroundTransparent:m,selectionInactiveBackgroundOpaque:_.color.blend(c,m),ansi:i.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(L={}){const x=this._colors;if(x.foreground=C(L.foreground,n),x.background=C(L.background,c),x.cursor=C(L.cursor,l),x.cursorAccent=C(L.cursorAccent,h),x.selectionBackgroundTransparent=C(L.selectionBackground,m),x.selectionBackgroundOpaque=_.color.blend(x.background,x.selectionBackgroundTransparent),x.selectionInactiveBackgroundTransparent=C(L.selectionInactiveBackground,x.selectionBackgroundTransparent),x.selectionInactiveBackgroundOpaque=_.color.blend(x.background,x.selectionInactiveBackgroundTransparent),x.selectionForeground=L.selectionForeground?C(L.selectionForeground,_.NULL_COLOR):void 0,x.selectionForeground===_.NULL_COLOR&&(x.selectionForeground=void 0),_.color.isOpaque(x.selectionBackgroundTransparent)&&(x.selectionBackgroundTransparent=_.color.opacity(x.selectionBackgroundTransparent,.3)),_.color.isOpaque(x.selectionInactiveBackgroundTransparent)&&(x.selectionInactiveBackgroundTransparent=_.color.opacity(x.selectionInactiveBackgroundTransparent,.3)),x.ansi=i.DEFAULT_ANSI_COLORS.slice(),x.ansi[0]=C(L.black,i.DEFAULT_ANSI_COLORS[0]),x.ansi[1]=C(L.red,i.DEFAULT_ANSI_COLORS[1]),x.ansi[2]=C(L.green,i.DEFAULT_ANSI_COLORS[2]),x.ansi[3]=C(L.yellow,i.DEFAULT_ANSI_COLORS[3]),x.ansi[4]=C(L.blue,i.DEFAULT_ANSI_COLORS[4]),x.ansi[5]=C(L.magenta,i.DEFAULT_ANSI_COLORS[5]),x.ansi[6]=C(L.cyan,i.DEFAULT_ANSI_COLORS[6]),x.ansi[7]=C(L.white,i.DEFAULT_ANSI_COLORS[7]),x.ansi[8]=C(L.brightBlack,i.DEFAULT_ANSI_COLORS[8]),x.ansi[9]=C(L.brightRed,i.DEFAULT_ANSI_COLORS[9]),x.ansi[10]=C(L.brightGreen,i.DEFAULT_ANSI_COLORS[10]),x.ansi[11]=C(L.brightYellow,i.DEFAULT_ANSI_COLORS[11]),x.ansi[12]=C(L.brightBlue,i.DEFAULT_ANSI_COLORS[12]),x.ansi[13]=C(L.brightMagenta,i.DEFAULT_ANSI_COLORS[13]),x.ansi[14]=C(L.brightCyan,i.DEFAULT_ANSI_COLORS[14]),x.ansi[15]=C(L.brightWhite,i.DEFAULT_ANSI_COLORS[15]),L.extendedAnsi){const E=Math.min(x.ansi.length-16,L.extendedAnsi.length);for(let k=0;k<E;k++)x.ansi[k+16]=C(L.extendedAnsi[k],i.DEFAULT_ANSI_COLORS[k+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(L){this._restoreColor(L),this._onChangeColors.fire(this.colors)}_restoreColor(L){if(L!==void 0)switch(L){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[L]=this._restoreColors.ansi[L]}else for(let x=0;x<this._restoreColors.ansi.length;++x)this._colors.ansi[x]=this._restoreColors.ansi[x]}modifyColors(L){L(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function C(L,x){if(L!==void 0)try{return _.css.toColor(L)}catch{}return x}i.ThemeService=y=d([v(0,f.IOptionsService)],y)},6349:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CircularList=void 0;const d=a(8460),v=a(844);class u extends v.Disposable{constructor(b){super(),this._maxLength=b,this.onDeleteEmitter=this.register(new d.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new d.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new d.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(b){if(this._maxLength===b)return;const w=new Array(b);for(let f=0;f<Math.min(b,this.length);f++)w[f]=this._array[this._getCyclicIndex(f)];this._array=w,this._maxLength=b,this._startIndex=0}get length(){return this._length}set length(b){if(b>this._length)for(let w=this._length;w<b;w++)this._array[w]=void 0;this._length=b}get(b){return this._array[this._getCyclicIndex(b)]}set(b,w){this._array[this._getCyclicIndex(b)]=w}push(b){this._array[this._getCyclicIndex(this._length)]=b,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(b,w,...f){if(w){for(let n=b;n<this._length-w;n++)this._array[this._getCyclicIndex(n)]=this._array[this._getCyclicIndex(n+w)];this._length-=w,this.onDeleteEmitter.fire({index:b,amount:w})}for(let n=this._length-1;n>=b;n--)this._array[this._getCyclicIndex(n+f.length)]=this._array[this._getCyclicIndex(n)];for(let n=0;n<f.length;n++)this._array[this._getCyclicIndex(b+n)]=f[n];if(f.length&&this.onInsertEmitter.fire({index:b,amount:f.length}),this._length+f.length>this._maxLength){const n=this._length+f.length-this._maxLength;this._startIndex+=n,this._length=this._maxLength,this.onTrimEmitter.fire(n)}else this._length+=f.length}trimStart(b){b>this._length&&(b=this._length),this._startIndex+=b,this._length-=b,this.onTrimEmitter.fire(b)}shiftElements(b,w,f){if(!(w<=0)){if(b<0||b>=this._length)throw new Error("start argument out of range");if(b+f<0)throw new Error("Cannot shift elements in list beyond index 0");if(f>0){for(let c=w-1;c>=0;c--)this.set(b+c+f,this.get(b+c));const n=b+w+f-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let n=0;n<w;n++)this.set(b+n+f,this.get(b+n))}}_getCyclicIndex(b){return(this._startIndex+b)%this._maxLength}}i.CircularList=u},1439:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.clone=void 0,i.clone=function a(d,v=5){if(typeof d!="object")return d;const u=Array.isArray(d)?[]:{};for(const _ in d)u[_]=v<=1?d[_]:d[_]&&a(d[_],v-1);return u}},8055:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.contrastRatio=i.toPaddedHex=i.rgba=i.rgb=i.css=i.color=i.channels=i.NULL_COLOR=void 0;const d=a(6114);let v=0,u=0,_=0,b=0;var w,f,n,c,l;function h(y){const C=y.toString(16);return C.length<2?"0"+C:C}function m(y,C){return y<C?(C+.05)/(y+.05):(y+.05)/(C+.05)}i.NULL_COLOR={css:"#00000000",rgba:0},function(y){y.toCss=function(C,L,x,E){return E!==void 0?`#${h(C)}${h(L)}${h(x)}${h(E)}`:`#${h(C)}${h(L)}${h(x)}`},y.toRgba=function(C,L,x,E=255){return(C<<24|L<<16|x<<8|E)>>>0}}(w||(i.channels=w={})),function(y){function C(L,x){return b=Math.round(255*x),[v,u,_]=l.toChannels(L.rgba),{css:w.toCss(v,u,_,b),rgba:w.toRgba(v,u,_,b)}}y.blend=function(L,x){if(b=(255&x.rgba)/255,b===1)return{css:x.css,rgba:x.rgba};const E=x.rgba>>24&255,k=x.rgba>>16&255,T=x.rgba>>8&255,A=L.rgba>>24&255,D=L.rgba>>16&255,P=L.rgba>>8&255;return v=A+Math.round((E-A)*b),u=D+Math.round((k-D)*b),_=P+Math.round((T-P)*b),{css:w.toCss(v,u,_),rgba:w.toRgba(v,u,_)}},y.isOpaque=function(L){return(255&L.rgba)==255},y.ensureContrastRatio=function(L,x,E){const k=l.ensureContrastRatio(L.rgba,x.rgba,E);if(k)return l.toColor(k>>24&255,k>>16&255,k>>8&255)},y.opaque=function(L){const x=(255|L.rgba)>>>0;return[v,u,_]=l.toChannels(x),{css:w.toCss(v,u,_),rgba:x}},y.opacity=C,y.multiplyOpacity=function(L,x){return b=255&L.rgba,C(L,b*x/255)},y.toColorRGB=function(L){return[L.rgba>>24&255,L.rgba>>16&255,L.rgba>>8&255]}}(f||(i.color=f={})),function(y){let C,L;if(!d.isNode){const x=document.createElement("canvas");x.width=1,x.height=1;const E=x.getContext("2d",{willReadFrequently:!0});E&&(C=E,C.globalCompositeOperation="copy",L=C.createLinearGradient(0,0,1,1))}y.toColor=function(x){if(x.match(/#[\da-f]{3,8}/i))switch(x.length){case 4:return v=parseInt(x.slice(1,2).repeat(2),16),u=parseInt(x.slice(2,3).repeat(2),16),_=parseInt(x.slice(3,4).repeat(2),16),l.toColor(v,u,_);case 5:return v=parseInt(x.slice(1,2).repeat(2),16),u=parseInt(x.slice(2,3).repeat(2),16),_=parseInt(x.slice(3,4).repeat(2),16),b=parseInt(x.slice(4,5).repeat(2),16),l.toColor(v,u,_,b);case 7:return{css:x,rgba:(parseInt(x.slice(1),16)<<8|255)>>>0};case 9:return{css:x,rgba:parseInt(x.slice(1),16)>>>0}}const E=x.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(E)return v=parseInt(E[1]),u=parseInt(E[2]),_=parseInt(E[3]),b=Math.round(255*(E[5]===void 0?1:parseFloat(E[5]))),l.toColor(v,u,_,b);if(!C||!L)throw new Error("css.toColor: Unsupported css format");if(C.fillStyle=L,C.fillStyle=x,typeof C.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(C.fillRect(0,0,1,1),[v,u,_,b]=C.getImageData(0,0,1,1).data,b!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:w.toRgba(v,u,_,b),css:x}}}(n||(i.css=n={})),function(y){function C(L,x,E){const k=L/255,T=x/255,A=E/255;return .2126*(k<=.03928?k/12.92:Math.pow((k+.055)/1.055,2.4))+.7152*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))+.0722*(A<=.03928?A/12.92:Math.pow((A+.055)/1.055,2.4))}y.relativeLuminance=function(L){return C(L>>16&255,L>>8&255,255&L)},y.relativeLuminance2=C}(c||(i.rgb=c={})),function(y){function C(x,E,k){const T=x>>24&255,A=x>>16&255,D=x>>8&255;let P=E>>24&255,O=E>>16&255,F=E>>8&255,H=m(c.relativeLuminance2(P,O,F),c.relativeLuminance2(T,A,D));for(;H<k&&(P>0||O>0||F>0);)P-=Math.max(0,Math.ceil(.1*P)),O-=Math.max(0,Math.ceil(.1*O)),F-=Math.max(0,Math.ceil(.1*F)),H=m(c.relativeLuminance2(P,O,F),c.relativeLuminance2(T,A,D));return(P<<24|O<<16|F<<8|255)>>>0}function L(x,E,k){const T=x>>24&255,A=x>>16&255,D=x>>8&255;let P=E>>24&255,O=E>>16&255,F=E>>8&255,H=m(c.relativeLuminance2(P,O,F),c.relativeLuminance2(T,A,D));for(;H<k&&(P<255||O<255||F<255);)P=Math.min(255,P+Math.ceil(.1*(255-P))),O=Math.min(255,O+Math.ceil(.1*(255-O))),F=Math.min(255,F+Math.ceil(.1*(255-F))),H=m(c.relativeLuminance2(P,O,F),c.relativeLuminance2(T,A,D));return(P<<24|O<<16|F<<8|255)>>>0}y.ensureContrastRatio=function(x,E,k){const T=c.relativeLuminance(x>>8),A=c.relativeLuminance(E>>8);if(m(T,A)<k){if(A<T){const O=C(x,E,k),F=m(T,c.relativeLuminance(O>>8));if(F<k){const H=L(x,E,k);return F>m(T,c.relativeLuminance(H>>8))?O:H}return O}const D=L(x,E,k),P=m(T,c.relativeLuminance(D>>8));if(P<k){const O=C(x,E,k);return P>m(T,c.relativeLuminance(O>>8))?D:O}return D}},y.reduceLuminance=C,y.increaseLuminance=L,y.toChannels=function(x){return[x>>24&255,x>>16&255,x>>8&255,255&x]},y.toColor=function(x,E,k,T){return{css:w.toCss(x,E,k,T),rgba:w.toRgba(x,E,k,T)}}}(l||(i.rgba=l={})),i.toPaddedHex=h,i.contrastRatio=m},8969:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CoreTerminal=void 0;const d=a(844),v=a(2585),u=a(4348),_=a(7866),b=a(744),w=a(7302),f=a(6975),n=a(8460),c=a(1753),l=a(1480),h=a(7994),m=a(9282),y=a(5435),C=a(5981),L=a(2660);let x=!1;class E extends d.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new n.EventEmitter),this._onScroll.event(T=>{var A;(A=this._onScrollApi)===null||A===void 0||A.fire(T.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(T){for(const A in T)this.optionsService.options[A]=T[A]}constructor(T){super(),this._windowsWrappingHeuristics=this.register(new d.MutableDisposable),this._onBinary=this.register(new n.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new n.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new n.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new n.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new n.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new n.EventEmitter),this._instantiationService=new u.InstantiationService,this.optionsService=this.register(new w.OptionsService(T)),this._instantiationService.setService(v.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(b.BufferService)),this._instantiationService.setService(v.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(_.LogService)),this._instantiationService.setService(v.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(f.CoreService)),this._instantiationService.setService(v.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(c.CoreMouseService)),this._instantiationService.setService(v.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(l.UnicodeService)),this._instantiationService.setService(v.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(h.CharsetService),this._instantiationService.setService(v.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(L.OscLinkService),this._instantiationService.setService(v.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new y.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,n.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,n.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,n.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,n.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(A=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(A=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new C.WriteBuffer((A,D)=>this._inputHandler.parse(A,D))),this.register((0,n.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(T,A){this._writeBuffer.write(T,A)}writeSync(T,A){this._logService.logLevel<=v.LogLevelEnum.WARN&&!x&&(this._logService.warn("writeSync is unreliable and will be removed soon."),x=!0),this._writeBuffer.writeSync(T,A)}resize(T,A){isNaN(T)||isNaN(A)||(T=Math.max(T,b.MINIMUM_COLS),A=Math.max(A,b.MINIMUM_ROWS),this._bufferService.resize(T,A))}scroll(T,A=!1){this._bufferService.scroll(T,A)}scrollLines(T,A,D){this._bufferService.scrollLines(T,A,D)}scrollPages(T){this.scrollLines(T*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(T){const A=T-this._bufferService.buffer.ydisp;A!==0&&this.scrollLines(A)}registerEscHandler(T,A){return this._inputHandler.registerEscHandler(T,A)}registerDcsHandler(T,A){return this._inputHandler.registerDcsHandler(T,A)}registerCsiHandler(T,A){return this._inputHandler.registerCsiHandler(T,A)}registerOscHandler(T,A){return this._inputHandler.registerOscHandler(T,A)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let T=!1;const A=this.optionsService.rawOptions.windowsPty;A&&A.buildNumber!==void 0&&A.buildNumber!==void 0?T=A.backend==="conpty"&&A.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(T=!0),T?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const T=[];T.push(this.onLineFeed(m.updateWindowsModeWrappedState.bind(null,this._bufferService))),T.push(this.registerCsiHandler({final:"H"},()=>((0,m.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,d.toDisposable)(()=>{for(const A of T)A.dispose()})}}}i.CoreTerminal=E},8460:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.forwardEvent=i.EventEmitter=void 0,i.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=a=>(this._listeners.push(a),{dispose:()=>{if(!this._disposed){for(let d=0;d<this._listeners.length;d++)if(this._listeners[d]===a)return void this._listeners.splice(d,1)}}})),this._event}fire(a,d){const v=[];for(let u=0;u<this._listeners.length;u++)v.push(this._listeners[u]);for(let u=0;u<v.length;u++)v[u].call(void 0,a,d)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},i.forwardEvent=function(a,d){return a(v=>d.fire(v))}},5435:function(S,i,a){var d=this&&this.__decorate||function(H,R,j,M){var B,$=arguments.length,q=$<3?R:M===null?M=Object.getOwnPropertyDescriptor(R,j):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")q=Reflect.decorate(H,R,j,M);else for(var K=H.length-1;K>=0;K--)(B=H[K])&&(q=($<3?B(q):$>3?B(R,j,q):B(R,j))||q);return $>3&&q&&Object.defineProperty(R,j,q),q},v=this&&this.__param||function(H,R){return function(j,M){R(j,M,H)}};Object.defineProperty(i,"__esModule",{value:!0}),i.InputHandler=i.WindowsOptionsReportType=void 0;const u=a(2584),_=a(7116),b=a(2015),w=a(844),f=a(482),n=a(8437),c=a(8460),l=a(643),h=a(511),m=a(3734),y=a(2585),C=a(6242),L=a(6351),x=a(5941),E={"(":0,")":1,"*":2,"+":3,"-":1,".":2},k=131072;function T(H,R){if(H>24)return R.setWinLines||!1;switch(H){case 1:return!!R.restoreWin;case 2:return!!R.minimizeWin;case 3:return!!R.setWinPosition;case 4:return!!R.setWinSizePixels;case 5:return!!R.raiseWin;case 6:return!!R.lowerWin;case 7:return!!R.refreshWin;case 8:return!!R.setWinSizeChars;case 9:return!!R.maximizeWin;case 10:return!!R.fullscreenWin;case 11:return!!R.getWinState;case 13:return!!R.getWinPosition;case 14:return!!R.getWinSizePixels;case 15:return!!R.getScreenSizePixels;case 16:return!!R.getCellSizePixels;case 18:return!!R.getWinSizeChars;case 19:return!!R.getScreenSizeChars;case 20:return!!R.getIconTitle;case 21:return!!R.getWinTitle;case 22:return!!R.pushTitle;case 23:return!!R.popTitle;case 24:return!!R.setWinLines}return!1}var A;(function(H){H[H.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",H[H.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(A||(i.WindowsOptionsReportType=A={}));let D=0;class P extends w.Disposable{getAttrData(){return this._curAttrData}constructor(R,j,M,B,$,q,K,Y,se=new b.EscapeSequenceParser){super(),this._bufferService=R,this._charsetService=j,this._coreService=M,this._logService=B,this._optionsService=$,this._oscLinkService=q,this._coreMouseService=K,this._unicodeService=Y,this._parser=se,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new f.StringToUtf32,this._utf8Decoder=new f.Utf8ToUtf32,this._workCell=new h.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new c.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new c.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new c.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new c.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new c.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new c.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new c.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new c.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new c.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new c.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new c.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new c.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new c.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new O(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(N=>this._activeBuffer=N.activeBuffer)),this._parser.setCsiHandlerFallback((N,z)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(N),params:z.toArray()})}),this._parser.setEscHandlerFallback(N=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(N)})}),this._parser.setExecuteHandlerFallback(N=>{this._logService.debug("Unknown EXECUTE code: ",{code:N})}),this._parser.setOscHandlerFallback((N,z,U)=>{this._logService.debug("Unknown OSC code: ",{identifier:N,action:z,data:U})}),this._parser.setDcsHandlerFallback((N,z,U)=>{z==="HOOK"&&(U=U.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(N),action:z,payload:U})}),this._parser.setPrintHandler((N,z,U)=>this.print(N,z,U)),this._parser.registerCsiHandler({final:"@"},N=>this.insertChars(N)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},N=>this.scrollLeft(N)),this._parser.registerCsiHandler({final:"A"},N=>this.cursorUp(N)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},N=>this.scrollRight(N)),this._parser.registerCsiHandler({final:"B"},N=>this.cursorDown(N)),this._parser.registerCsiHandler({final:"C"},N=>this.cursorForward(N)),this._parser.registerCsiHandler({final:"D"},N=>this.cursorBackward(N)),this._parser.registerCsiHandler({final:"E"},N=>this.cursorNextLine(N)),this._parser.registerCsiHandler({final:"F"},N=>this.cursorPrecedingLine(N)),this._parser.registerCsiHandler({final:"G"},N=>this.cursorCharAbsolute(N)),this._parser.registerCsiHandler({final:"H"},N=>this.cursorPosition(N)),this._parser.registerCsiHandler({final:"I"},N=>this.cursorForwardTab(N)),this._parser.registerCsiHandler({final:"J"},N=>this.eraseInDisplay(N,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},N=>this.eraseInDisplay(N,!0)),this._parser.registerCsiHandler({final:"K"},N=>this.eraseInLine(N,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},N=>this.eraseInLine(N,!0)),this._parser.registerCsiHandler({final:"L"},N=>this.insertLines(N)),this._parser.registerCsiHandler({final:"M"},N=>this.deleteLines(N)),this._parser.registerCsiHandler({final:"P"},N=>this.deleteChars(N)),this._parser.registerCsiHandler({final:"S"},N=>this.scrollUp(N)),this._parser.registerCsiHandler({final:"T"},N=>this.scrollDown(N)),this._parser.registerCsiHandler({final:"X"},N=>this.eraseChars(N)),this._parser.registerCsiHandler({final:"Z"},N=>this.cursorBackwardTab(N)),this._parser.registerCsiHandler({final:"`"},N=>this.charPosAbsolute(N)),this._parser.registerCsiHandler({final:"a"},N=>this.hPositionRelative(N)),this._parser.registerCsiHandler({final:"b"},N=>this.repeatPrecedingCharacter(N)),this._parser.registerCsiHandler({final:"c"},N=>this.sendDeviceAttributesPrimary(N)),this._parser.registerCsiHandler({prefix:">",final:"c"},N=>this.sendDeviceAttributesSecondary(N)),this._parser.registerCsiHandler({final:"d"},N=>this.linePosAbsolute(N)),this._parser.registerCsiHandler({final:"e"},N=>this.vPositionRelative(N)),this._parser.registerCsiHandler({final:"f"},N=>this.hVPosition(N)),this._parser.registerCsiHandler({final:"g"},N=>this.tabClear(N)),this._parser.registerCsiHandler({final:"h"},N=>this.setMode(N)),this._parser.registerCsiHandler({prefix:"?",final:"h"},N=>this.setModePrivate(N)),this._parser.registerCsiHandler({final:"l"},N=>this.resetMode(N)),this._parser.registerCsiHandler({prefix:"?",final:"l"},N=>this.resetModePrivate(N)),this._parser.registerCsiHandler({final:"m"},N=>this.charAttributes(N)),this._parser.registerCsiHandler({final:"n"},N=>this.deviceStatus(N)),this._parser.registerCsiHandler({prefix:"?",final:"n"},N=>this.deviceStatusPrivate(N)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},N=>this.softReset(N)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},N=>this.setCursorStyle(N)),this._parser.registerCsiHandler({final:"r"},N=>this.setScrollRegion(N)),this._parser.registerCsiHandler({final:"s"},N=>this.saveCursor(N)),this._parser.registerCsiHandler({final:"t"},N=>this.windowOptions(N)),this._parser.registerCsiHandler({final:"u"},N=>this.restoreCursor(N)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},N=>this.insertColumns(N)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},N=>this.deleteColumns(N)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},N=>this.selectProtected(N)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},N=>this.requestMode(N,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},N=>this.requestMode(N,!1)),this._parser.setExecuteHandler(u.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(u.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(u.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(u.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(u.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(u.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(u.C1.IND,()=>this.index()),this._parser.setExecuteHandler(u.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(u.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new C.OscHandler(N=>(this.setTitle(N),this.setIconName(N),!0))),this._parser.registerOscHandler(1,new C.OscHandler(N=>this.setIconName(N))),this._parser.registerOscHandler(2,new C.OscHandler(N=>this.setTitle(N))),this._parser.registerOscHandler(4,new C.OscHandler(N=>this.setOrReportIndexedColor(N))),this._parser.registerOscHandler(8,new C.OscHandler(N=>this.setHyperlink(N))),this._parser.registerOscHandler(10,new C.OscHandler(N=>this.setOrReportFgColor(N))),this._parser.registerOscHandler(11,new C.OscHandler(N=>this.setOrReportBgColor(N))),this._parser.registerOscHandler(12,new C.OscHandler(N=>this.setOrReportCursorColor(N))),this._parser.registerOscHandler(104,new C.OscHandler(N=>this.restoreIndexedColor(N))),this._parser.registerOscHandler(110,new C.OscHandler(N=>this.restoreFgColor(N))),this._parser.registerOscHandler(111,new C.OscHandler(N=>this.restoreBgColor(N))),this._parser.registerOscHandler(112,new C.OscHandler(N=>this.restoreCursorColor(N))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const N in _.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:N},()=>this.selectCharset("("+N)),this._parser.registerEscHandler({intermediates:")",final:N},()=>this.selectCharset(")"+N)),this._parser.registerEscHandler({intermediates:"*",final:N},()=>this.selectCharset("*"+N)),this._parser.registerEscHandler({intermediates:"+",final:N},()=>this.selectCharset("+"+N)),this._parser.registerEscHandler({intermediates:"-",final:N},()=>this.selectCharset("-"+N)),this._parser.registerEscHandler({intermediates:".",final:N},()=>this.selectCharset("."+N)),this._parser.registerEscHandler({intermediates:"/",final:N},()=>this.selectCharset("/"+N));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(N=>(this._logService.error("Parsing error: ",N),N)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new L.DcsHandler((N,z)=>this.requestStatusString(N,z)))}_preserveStack(R,j,M,B){this._parseStack.paused=!0,this._parseStack.cursorStartX=R,this._parseStack.cursorStartY=j,this._parseStack.decodedLength=M,this._parseStack.position=B}_logSlowResolvingAsync(R){this._logService.logLevel<=y.LogLevelEnum.WARN&&Promise.race([R,new Promise((j,M)=>setTimeout(()=>M("#SLOW_TIMEOUT"),5e3))]).catch(j=>{if(j!=="#SLOW_TIMEOUT")throw j;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(R,j){let M,B=this._activeBuffer.x,$=this._activeBuffer.y,q=0;const K=this._parseStack.paused;if(K){if(M=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,j))return this._logSlowResolvingAsync(M),M;B=this._parseStack.cursorStartX,$=this._parseStack.cursorStartY,this._parseStack.paused=!1,R.length>k&&(q=this._parseStack.position+k)}if(this._logService.logLevel<=y.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof R=="string"?` "${R}"`:` "${Array.prototype.map.call(R,Y=>String.fromCharCode(Y)).join("")}"`),typeof R=="string"?R.split("").map(Y=>Y.charCodeAt(0)):R),this._parseBuffer.length<R.length&&this._parseBuffer.length<k&&(this._parseBuffer=new Uint32Array(Math.min(R.length,k))),K||this._dirtyRowTracker.clearRange(),R.length>k)for(let Y=q;Y<R.length;Y+=k){const se=Y+k<R.length?Y+k:R.length,N=typeof R=="string"?this._stringDecoder.decode(R.substring(Y,se),this._parseBuffer):this._utf8Decoder.decode(R.subarray(Y,se),this._parseBuffer);if(M=this._parser.parse(this._parseBuffer,N))return this._preserveStack(B,$,N,Y),this._logSlowResolvingAsync(M),M}else if(!K){const Y=typeof R=="string"?this._stringDecoder.decode(R,this._parseBuffer):this._utf8Decoder.decode(R,this._parseBuffer);if(M=this._parser.parse(this._parseBuffer,Y))return this._preserveStack(B,$,Y,0),this._logSlowResolvingAsync(M),M}this._activeBuffer.x===B&&this._activeBuffer.y===$||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(R,j,M){let B,$;const q=this._charsetService.charset,K=this._optionsService.rawOptions.screenReaderMode,Y=this._bufferService.cols,se=this._coreService.decPrivateModes.wraparound,N=this._coreService.modes.insertMode,z=this._curAttrData;let U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&M-j>0&&U.getWidth(this._activeBuffer.x-1)===2&&U.setCellFromCodePoint(this._activeBuffer.x-1,0,1,z.fg,z.bg,z.extended);for(let W=j;W<M;++W){if(B=R[W],$=this._unicodeService.wcwidth(B),B<127&&q){const ne=q[String.fromCharCode(B)];ne&&(B=ne.charCodeAt(0))}if(K&&this._onA11yChar.fire((0,f.stringFromCodePoint)(B)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),$||!this._activeBuffer.x){if(this._activeBuffer.x+$-1>=Y){if(se){for(;this._activeBuffer.x<Y;)U.setCellFromCodePoint(this._activeBuffer.x++,0,1,z.fg,z.bg,z.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=Y-1,$===2)continue}if(N&&(U.insertCells(this._activeBuffer.x,$,this._activeBuffer.getNullCell(z),z),U.getWidth(Y-1)===2&&U.setCellFromCodePoint(Y-1,l.NULL_CELL_CODE,l.NULL_CELL_WIDTH,z.fg,z.bg,z.extended)),U.setCellFromCodePoint(this._activeBuffer.x++,B,$,z.fg,z.bg,z.extended),$>0)for(;--$;)U.setCellFromCodePoint(this._activeBuffer.x++,0,0,z.fg,z.bg,z.extended)}else U.getWidth(this._activeBuffer.x-1)?U.addCodepointToCell(this._activeBuffer.x-1,B):U.addCodepointToCell(this._activeBuffer.x-2,B)}M-j>0&&(U.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<Y&&M-j>0&&U.getWidth(this._activeBuffer.x)===0&&!U.hasContent(this._activeBuffer.x)&&U.setCellFromCodePoint(this._activeBuffer.x,0,1,z.fg,z.bg,z.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(R,j){return R.final!=="t"||R.prefix||R.intermediates?this._parser.registerCsiHandler(R,j):this._parser.registerCsiHandler(R,M=>!T(M.params[0],this._optionsService.rawOptions.windowOptions)||j(M))}registerDcsHandler(R,j){return this._parser.registerDcsHandler(R,new L.DcsHandler(j))}registerEscHandler(R,j){return this._parser.registerEscHandler(R,j)}registerOscHandler(R,j){return this._parser.registerOscHandler(R,new C.OscHandler(j))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var R;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((R=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||R===void 0)&&R.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);j.hasWidth(this._activeBuffer.x)&&!j.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const R=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-R),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(R=this._bufferService.cols-1){this._activeBuffer.x=Math.min(R,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(R,j){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=R,this._activeBuffer.y=this._activeBuffer.scrollTop+j):(this._activeBuffer.x=R,this._activeBuffer.y=j),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(R,j){this._restrictCursor(),this._setCursor(this._activeBuffer.x+R,this._activeBuffer.y+j)}cursorUp(R){const j=this._activeBuffer.y-this._activeBuffer.scrollTop;return j>=0?this._moveCursor(0,-Math.min(j,R.params[0]||1)):this._moveCursor(0,-(R.params[0]||1)),!0}cursorDown(R){const j=this._activeBuffer.scrollBottom-this._activeBuffer.y;return j>=0?this._moveCursor(0,Math.min(j,R.params[0]||1)):this._moveCursor(0,R.params[0]||1),!0}cursorForward(R){return this._moveCursor(R.params[0]||1,0),!0}cursorBackward(R){return this._moveCursor(-(R.params[0]||1),0),!0}cursorNextLine(R){return this.cursorDown(R),this._activeBuffer.x=0,!0}cursorPrecedingLine(R){return this.cursorUp(R),this._activeBuffer.x=0,!0}cursorCharAbsolute(R){return this._setCursor((R.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(R){return this._setCursor(R.length>=2?(R.params[1]||1)-1:0,(R.params[0]||1)-1),!0}charPosAbsolute(R){return this._setCursor((R.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(R){return this._moveCursor(R.params[0]||1,0),!0}linePosAbsolute(R){return this._setCursor(this._activeBuffer.x,(R.params[0]||1)-1),!0}vPositionRelative(R){return this._moveCursor(0,R.params[0]||1),!0}hVPosition(R){return this.cursorPosition(R),!0}tabClear(R){const j=R.params[0];return j===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:j===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(R){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let j=R.params[0]||1;for(;j--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(R){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let j=R.params[0]||1;for(;j--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(R){const j=R.params[0];return j===1&&(this._curAttrData.bg|=536870912),j!==2&&j!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(R,j,M,B=!1,$=!1){const q=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);q.replaceCells(j,M,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),$),B&&(q.isWrapped=!1)}_resetBufferLine(R,j=!1){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);M&&(M.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),j),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+R),M.isWrapped=!1)}eraseInDisplay(R,j=!1){let M;switch(this._restrictCursor(this._bufferService.cols),R.params[0]){case 0:for(M=this._activeBuffer.y,this._dirtyRowTracker.markDirty(M),this._eraseInBufferLine(M++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,j);M<this._bufferService.rows;M++)this._resetBufferLine(M,j);this._dirtyRowTracker.markDirty(M);break;case 1:for(M=this._activeBuffer.y,this._dirtyRowTracker.markDirty(M),this._eraseInBufferLine(M,0,this._activeBuffer.x+1,!0,j),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(M+1).isWrapped=!1);M--;)this._resetBufferLine(M,j);this._dirtyRowTracker.markDirty(0);break;case 2:for(M=this._bufferService.rows,this._dirtyRowTracker.markDirty(M-1);M--;)this._resetBufferLine(M,j);this._dirtyRowTracker.markDirty(0);break;case 3:const B=this._activeBuffer.lines.length-this._bufferService.rows;B>0&&(this._activeBuffer.lines.trimStart(B),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-B,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-B,0),this._onScroll.fire(0))}return!0}eraseInLine(R,j=!1){switch(this._restrictCursor(this._bufferService.cols),R.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,j);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,j);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,j)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(R){this._restrictCursor();let j=R.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=this._activeBuffer.ybase+this._activeBuffer.y,B=this._bufferService.rows-1-this._activeBuffer.scrollBottom,$=this._bufferService.rows-1+this._activeBuffer.ybase-B+1;for(;j--;)this._activeBuffer.lines.splice($-1,1),this._activeBuffer.lines.splice(M,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(R){this._restrictCursor();let j=R.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=this._activeBuffer.ybase+this._activeBuffer.y;let B;for(B=this._bufferService.rows-1-this._activeBuffer.scrollBottom,B=this._bufferService.rows-1+this._activeBuffer.ybase-B;j--;)this._activeBuffer.lines.splice(M,1),this._activeBuffer.lines.splice(B,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(R){this._restrictCursor();const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return j&&(j.insertCells(this._activeBuffer.x,R.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(R){this._restrictCursor();const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return j&&(j.deleteCells(this._activeBuffer.x,R.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(R){let j=R.params[0]||1;for(;j--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(R){let j=R.params[0]||1;for(;j--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(n.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=R.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);B.deleteCells(0,j,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),B.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=R.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);B.insertCells(0,j,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),B.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=R.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);B.insertCells(this._activeBuffer.x,j,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),B.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const j=R.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);B.deleteCells(this._activeBuffer.x,j,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),B.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(R){this._restrictCursor();const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return j&&(j.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(R.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(R){if(!this._parser.precedingCodepoint)return!0;const j=R.params[0]||1,M=new Uint32Array(j);for(let B=0;B<j;++B)M[B]=this._parser.precedingCodepoint;return this.print(M,0,M.length),!0}sendDeviceAttributesPrimary(R){return R.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(u.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(u.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(R){return R.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(u.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(u.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(R.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(u.C0.ESC+"[>83;40003;0c")),!0}_is(R){return(this._optionsService.rawOptions.termName+"").indexOf(R)===0}setMode(R){for(let j=0;j<R.length;j++)switch(R.params[j]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(R){for(let j=0;j<R.length;j++)switch(R.params[j]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,_.DEFAULT_CHARSET),this._charsetService.setgCharset(1,_.DEFAULT_CHARSET),this._charsetService.setgCharset(2,_.DEFAULT_CHARSET),this._charsetService.setgCharset(3,_.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(R){for(let j=0;j<R.length;j++)switch(R.params[j]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(R){for(let j=0;j<R.length;j++)switch(R.params[j]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),R.params[j]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(R,j){const M=this._coreService.decPrivateModes,{activeProtocol:B,activeEncoding:$}=this._coreMouseService,q=this._coreService,{buffers:K,cols:Y}=this._bufferService,{active:se,alt:N}=K,z=this._optionsService.rawOptions,U=ce=>ce?1:2,W=R.params[0];return ne=W,Q=j?W===2?4:W===4?U(q.modes.insertMode):W===12?3:W===20?U(z.convertEol):0:W===1?U(M.applicationCursorKeys):W===3?z.windowOptions.setWinLines?Y===80?2:Y===132?1:0:0:W===6?U(M.origin):W===7?U(M.wraparound):W===8?3:W===9?U(B==="X10"):W===12?U(z.cursorBlink):W===25?U(!q.isCursorHidden):W===45?U(M.reverseWraparound):W===66?U(M.applicationKeypad):W===67?4:W===1e3?U(B==="VT200"):W===1002?U(B==="DRAG"):W===1003?U(B==="ANY"):W===1004?U(M.sendFocus):W===1005?4:W===1006?U($==="SGR"):W===1015?4:W===1016?U($==="SGR_PIXELS"):W===1048?1:W===47||W===1047||W===1049?U(se===N):W===2004?U(M.bracketedPasteMode):0,q.triggerDataEvent(`${u.C0.ESC}[${j?"":"?"}${ne};${Q}$y`),!0;var ne,Q}_updateAttrColor(R,j,M,B,$){return j===2?(R|=50331648,R&=-16777216,R|=m.AttributeData.fromColorRGB([M,B,$])):j===5&&(R&=-50331904,R|=33554432|255&M),R}_extractColor(R,j,M){const B=[0,0,-1,0,0,0];let $=0,q=0;do{if(B[q+$]=R.params[j+q],R.hasSubParams(j+q)){const K=R.getSubParams(j+q);let Y=0;do B[1]===5&&($=1),B[q+Y+1+$]=K[Y];while(++Y<K.length&&Y+q+1+$<B.length);break}if(B[1]===5&&q+$>=2||B[1]===2&&q+$>=5)break;B[1]&&($=1)}while(++q+j<R.length&&q+$<B.length);for(let K=2;K<B.length;++K)B[K]===-1&&(B[K]=0);switch(B[0]){case 38:M.fg=this._updateAttrColor(M.fg,B[1],B[3],B[4],B[5]);break;case 48:M.bg=this._updateAttrColor(M.bg,B[1],B[3],B[4],B[5]);break;case 58:M.extended=M.extended.clone(),M.extended.underlineColor=this._updateAttrColor(M.extended.underlineColor,B[1],B[3],B[4],B[5])}return q}_processUnderline(R,j){j.extended=j.extended.clone(),(!~R||R>5)&&(R=1),j.extended.underlineStyle=R,j.fg|=268435456,R===0&&(j.fg&=-268435457),j.updateExtended()}_processSGR0(R){R.fg=n.DEFAULT_ATTR_DATA.fg,R.bg=n.DEFAULT_ATTR_DATA.bg,R.extended=R.extended.clone(),R.extended.underlineStyle=0,R.extended.underlineColor&=-67108864,R.updateExtended()}charAttributes(R){if(R.length===1&&R.params[0]===0)return this._processSGR0(this._curAttrData),!0;const j=R.length;let M;const B=this._curAttrData;for(let $=0;$<j;$++)M=R.params[$],M>=30&&M<=37?(B.fg&=-50331904,B.fg|=16777216|M-30):M>=40&&M<=47?(B.bg&=-50331904,B.bg|=16777216|M-40):M>=90&&M<=97?(B.fg&=-50331904,B.fg|=16777224|M-90):M>=100&&M<=107?(B.bg&=-50331904,B.bg|=16777224|M-100):M===0?this._processSGR0(B):M===1?B.fg|=134217728:M===3?B.bg|=67108864:M===4?(B.fg|=268435456,this._processUnderline(R.hasSubParams($)?R.getSubParams($)[0]:1,B)):M===5?B.fg|=536870912:M===7?B.fg|=67108864:M===8?B.fg|=1073741824:M===9?B.fg|=2147483648:M===2?B.bg|=134217728:M===21?this._processUnderline(2,B):M===22?(B.fg&=-134217729,B.bg&=-134217729):M===23?B.bg&=-67108865:M===24?(B.fg&=-268435457,this._processUnderline(0,B)):M===25?B.fg&=-536870913:M===27?B.fg&=-67108865:M===28?B.fg&=-1073741825:M===29?B.fg&=2147483647:M===39?(B.fg&=-67108864,B.fg|=16777215&n.DEFAULT_ATTR_DATA.fg):M===49?(B.bg&=-67108864,B.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):M===38||M===48||M===58?$+=this._extractColor(R,$,B):M===53?B.bg|=1073741824:M===55?B.bg&=-1073741825:M===59?(B.extended=B.extended.clone(),B.extended.underlineColor=-1,B.updateExtended()):M===100?(B.fg&=-67108864,B.fg|=16777215&n.DEFAULT_ATTR_DATA.fg,B.bg&=-67108864,B.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",M);return!0}deviceStatus(R){switch(R.params[0]){case 5:this._coreService.triggerDataEvent(`${u.C0.ESC}[0n`);break;case 6:const j=this._activeBuffer.y+1,M=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${u.C0.ESC}[${j};${M}R`)}return!0}deviceStatusPrivate(R){if(R.params[0]===6){const j=this._activeBuffer.y+1,M=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${u.C0.ESC}[?${j};${M}R`)}return!0}softReset(R){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(R){const j=R.params[0]||1;switch(j){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const M=j%2==1;return this._optionsService.options.cursorBlink=M,!0}setScrollRegion(R){const j=R.params[0]||1;let M;return(R.length<2||(M=R.params[1])>this._bufferService.rows||M===0)&&(M=this._bufferService.rows),M>j&&(this._activeBuffer.scrollTop=j-1,this._activeBuffer.scrollBottom=M-1,this._setCursor(0,0)),!0}windowOptions(R){if(!T(R.params[0],this._optionsService.rawOptions.windowOptions))return!0;const j=R.length>1?R.params[1]:0;switch(R.params[0]){case 14:j!==2&&this._onRequestWindowsOptionsReport.fire(A.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(A.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${u.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:j!==0&&j!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),j!==0&&j!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:j!==0&&j!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),j!==0&&j!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(R){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(R){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(R){return this._windowTitle=R,this._onTitleChange.fire(R),!0}setIconName(R){return this._iconName=R,!0}setOrReportIndexedColor(R){const j=[],M=R.split(";");for(;M.length>1;){const B=M.shift(),$=M.shift();if(/^\d+$/.exec(B)){const q=parseInt(B);if(F(q))if($==="?")j.push({type:0,index:q});else{const K=(0,x.parseColor)($);K&&j.push({type:1,index:q,color:K})}}}return j.length&&this._onColor.fire(j),!0}setHyperlink(R){const j=R.split(";");return!(j.length<2)&&(j[1]?this._createHyperlink(j[0],j[1]):!j[0]&&this._finishHyperlink())}_createHyperlink(R,j){this._getCurrentLinkId()&&this._finishHyperlink();const M=R.split(":");let B;const $=M.findIndex(q=>q.startsWith("id="));return $!==-1&&(B=M[$].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:B,uri:j}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(R,j){const M=R.split(";");for(let B=0;B<M.length&&!(j>=this._specialColors.length);++B,++j)if(M[B]==="?")this._onColor.fire([{type:0,index:this._specialColors[j]}]);else{const $=(0,x.parseColor)(M[B]);$&&this._onColor.fire([{type:1,index:this._specialColors[j],color:$}])}return!0}setOrReportFgColor(R){return this._setOrReportSpecialColor(R,0)}setOrReportBgColor(R){return this._setOrReportSpecialColor(R,1)}setOrReportCursorColor(R){return this._setOrReportSpecialColor(R,2)}restoreIndexedColor(R){if(!R)return this._onColor.fire([{type:2}]),!0;const j=[],M=R.split(";");for(let B=0;B<M.length;++B)if(/^\d+$/.exec(M[B])){const $=parseInt(M[B]);F($)&&j.push({type:2,index:$})}return j.length&&this._onColor.fire(j),!0}restoreFgColor(R){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(R){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(R){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,_.DEFAULT_CHARSET),!0}selectCharset(R){return R.length!==2?(this.selectDefaultCharset(),!0):(R[0]==="/"||this._charsetService.setgCharset(E[R[0]],_.CHARSETS[R[1]]||_.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const R=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,R,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(R){return this._charsetService.setgLevel(R),!0}screenAlignmentPattern(){const R=new h.CellData;R.content=4194373,R.fg=this._curAttrData.fg,R.bg=this._curAttrData.bg,this._setCursor(0,0);for(let j=0;j<this._bufferService.rows;++j){const M=this._activeBuffer.ybase+this._activeBuffer.y+j,B=this._activeBuffer.lines.get(M);B&&(B.fill(R),B.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(R,j){const M=this._bufferService.buffer,B=this._optionsService.rawOptions;return($=>(this._coreService.triggerDataEvent(`${u.C0.ESC}${$}${u.C0.ESC}\\`),!0))(R==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:R==='"p'?'P1$r61;1"p':R==="r"?`P1$r${M.scrollTop+1};${M.scrollBottom+1}r`:R==="m"?"P1$r0m":R===" q"?`P1$r${{block:2,underline:4,bar:6}[B.cursorStyle]-(B.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(R,j){this._dirtyRowTracker.markRangeDirty(R,j)}}i.InputHandler=P;let O=class{constructor(H){this._bufferService=H,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(H){H<this.start?this.start=H:H>this.end&&(this.end=H)}markRangeDirty(H,R){H>R&&(D=H,H=R,R=D),H<this.start&&(this.start=H),R>this.end&&(this.end=R)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function F(H){return 0<=H&&H<256}O=d([v(0,y.IBufferService)],O)},844:(S,i)=>{function a(d){for(const v of d)v.dispose();d.length=0}Object.defineProperty(i,"__esModule",{value:!0}),i.getDisposeArrayDisposable=i.disposeArray=i.toDisposable=i.MutableDisposable=i.Disposable=void 0,i.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const d of this._disposables)d.dispose();this._disposables.length=0}register(d){return this._disposables.push(d),d}unregister(d){const v=this._disposables.indexOf(d);v!==-1&&this._disposables.splice(v,1)}},i.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(d){var v;this._isDisposed||d===this._value||((v=this._value)===null||v===void 0||v.dispose(),this._value=d)}clear(){this.value=void 0}dispose(){var d;this._isDisposed=!0,(d=this._value)===null||d===void 0||d.dispose(),this._value=void 0}},i.toDisposable=function(d){return{dispose:d}},i.disposeArray=a,i.getDisposeArrayDisposable=function(d){return{dispose:()=>a(d)}}},1505:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.FourKeyMap=i.TwoKeyMap=void 0;class a{constructor(){this._data={}}set(v,u,_){this._data[v]||(this._data[v]={}),this._data[v][u]=_}get(v,u){return this._data[v]?this._data[v][u]:void 0}clear(){this._data={}}}i.TwoKeyMap=a,i.FourKeyMap=class{constructor(){this._data=new a}set(d,v,u,_,b){this._data.get(d,v)||this._data.set(d,v,new a),this._data.get(d,v).set(u,_,b)}get(d,v,u,_){var b;return(b=this._data.get(d,v))===null||b===void 0?void 0:b.get(u,_)}clear(){this._data.clear()}}},6114:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isChromeOS=i.isLinux=i.isWindows=i.isIphone=i.isIpad=i.isMac=i.getSafariVersion=i.isSafari=i.isLegacyEdge=i.isFirefox=i.isNode=void 0,i.isNode=typeof navigator>"u";const a=i.isNode?"node":navigator.userAgent,d=i.isNode?"node":navigator.platform;i.isFirefox=a.includes("Firefox"),i.isLegacyEdge=a.includes("Edge"),i.isSafari=/^((?!chrome|android).)*safari/i.test(a),i.getSafariVersion=function(){if(!i.isSafari)return 0;const v=a.match(/Version\/(\d+)/);return v===null||v.length<2?0:parseInt(v[1])},i.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(d),i.isIpad=d==="iPad",i.isIphone=d==="iPhone",i.isWindows=["Windows","Win16","Win32","WinCE"].includes(d),i.isLinux=d.indexOf("Linux")>=0,i.isChromeOS=/\bCrOS\b/.test(a)},6106:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SortedList=void 0;let a=0;i.SortedList=class{constructor(d){this._getKey=d,this._array=[]}clear(){this._array.length=0}insert(d){this._array.length!==0?(a=this._search(this._getKey(d)),this._array.splice(a,0,d)):this._array.push(d)}delete(d){if(this._array.length===0)return!1;const v=this._getKey(d);if(v===void 0||(a=this._search(v),a===-1)||this._getKey(this._array[a])!==v)return!1;do if(this._array[a]===d)return this._array.splice(a,1),!0;while(++a<this._array.length&&this._getKey(this._array[a])===v);return!1}*getKeyIterator(d){if(this._array.length!==0&&(a=this._search(d),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===d))do yield this._array[a];while(++a<this._array.length&&this._getKey(this._array[a])===d)}forEachByKey(d,v){if(this._array.length!==0&&(a=this._search(d),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===d))do v(this._array[a]);while(++a<this._array.length&&this._getKey(this._array[a])===d)}values(){return[...this._array].values()}_search(d){let v=0,u=this._array.length-1;for(;u>=v;){let _=v+u>>1;const b=this._getKey(this._array[_]);if(b>d)u=_-1;else{if(!(b<d)){for(;_>0&&this._getKey(this._array[_-1])===d;)_--;return _}v=_+1}}return v}}},7226:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DebouncedIdleTask=i.IdleTaskQueue=i.PriorityTaskQueue=void 0;const d=a(6114);class v{constructor(){this._tasks=[],this._i=0}enqueue(b){this._tasks.push(b),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(b){this._idleCallback=void 0;let w=0,f=0,n=b.timeRemaining(),c=0;for(;this._i<this._tasks.length;){if(w=Date.now(),this._tasks[this._i]()||this._i++,w=Math.max(1,Date.now()-w),f=Math.max(w,f),c=b.timeRemaining(),1.5*f>c)return n-w<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-w))}ms`),void this._start();n=c}this.clear()}}class u extends v{_requestCallback(b){return setTimeout(()=>b(this._createDeadline(16)))}_cancelCallback(b){clearTimeout(b)}_createDeadline(b){const w=Date.now()+b;return{timeRemaining:()=>Math.max(0,w-Date.now())}}}i.PriorityTaskQueue=u,i.IdleTaskQueue=!d.isNode&&"requestIdleCallback"in window?class extends v{_requestCallback(_){return requestIdleCallback(_)}_cancelCallback(_){cancelIdleCallback(_)}}:u,i.DebouncedIdleTask=class{constructor(){this._queue=new i.IdleTaskQueue}set(_){this._queue.clear(),this._queue.enqueue(_)}flush(){this._queue.flush()}}},9282:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.updateWindowsModeWrappedState=void 0;const d=a(643);i.updateWindowsModeWrappedState=function(v){const u=v.buffer.lines.get(v.buffer.ybase+v.buffer.y-1),_=u==null?void 0:u.get(v.cols-1),b=v.buffer.lines.get(v.buffer.ybase+v.buffer.y);b&&_&&(b.isWrapped=_[d.CHAR_DATA_CODE_INDEX]!==d.NULL_CELL_CODE&&_[d.CHAR_DATA_CODE_INDEX]!==d.WHITESPACE_CELL_CODE)}},3734:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ExtendedAttrs=i.AttributeData=void 0;class a{constructor(){this.fg=0,this.bg=0,this.extended=new d}static toColorRGB(u){return[u>>>16&255,u>>>8&255,255&u]}static fromColorRGB(u){return(255&u[0])<<16|(255&u[1])<<8|255&u[2]}clone(){const u=new a;return u.fg=this.fg,u.bg=this.bg,u.extended=this.extended.clone(),u}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}i.AttributeData=a;class d{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(u){this._ext=u}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(u){this._ext&=-469762049,this._ext|=u<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(u){this._ext&=-67108864,this._ext|=67108863&u}get urlId(){return this._urlId}set urlId(u){this._urlId=u}constructor(u=0,_=0){this._ext=0,this._urlId=0,this._ext=u,this._urlId=_}clone(){return new d(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}i.ExtendedAttrs=d},9092:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Buffer=i.MAX_BUFFER_SIZE=void 0;const d=a(6349),v=a(7226),u=a(3734),_=a(8437),b=a(4634),w=a(511),f=a(643),n=a(4863),c=a(7116);i.MAX_BUFFER_SIZE=4294967295,i.Buffer=class{constructor(l,h,m){this._hasScrollback=l,this._optionsService=h,this._bufferService=m,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=_.DEFAULT_ATTR_DATA.clone(),this.savedCharset=c.DEFAULT_CHARSET,this.markers=[],this._nullCell=w.CellData.fromCharData([0,f.NULL_CELL_CHAR,f.NULL_CELL_WIDTH,f.NULL_CELL_CODE]),this._whitespaceCell=w.CellData.fromCharData([0,f.WHITESPACE_CELL_CHAR,f.WHITESPACE_CELL_WIDTH,f.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new v.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new d.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(l){return l?(this._nullCell.fg=l.fg,this._nullCell.bg=l.bg,this._nullCell.extended=l.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new u.ExtendedAttrs),this._nullCell}getWhitespaceCell(l){return l?(this._whitespaceCell.fg=l.fg,this._whitespaceCell.bg=l.bg,this._whitespaceCell.extended=l.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new u.ExtendedAttrs),this._whitespaceCell}getBlankLine(l,h){return new _.BufferLine(this._bufferService.cols,this.getNullCell(l),h)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const l=this.ybase+this.y-this.ydisp;return l>=0&&l<this._rows}_getCorrectBufferLength(l){if(!this._hasScrollback)return l;const h=l+this._optionsService.rawOptions.scrollback;return h>i.MAX_BUFFER_SIZE?i.MAX_BUFFER_SIZE:h}fillViewportRows(l){if(this.lines.length===0){l===void 0&&(l=_.DEFAULT_ATTR_DATA);let h=this._rows;for(;h--;)this.lines.push(this.getBlankLine(l))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new d.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(l,h){const m=this.getNullCell(_.DEFAULT_ATTR_DATA);let y=0;const C=this._getCorrectBufferLength(h);if(C>this.lines.maxLength&&(this.lines.maxLength=C),this.lines.length>0){if(this._cols<l)for(let x=0;x<this.lines.length;x++)y+=+this.lines.get(x).resize(l,m);let L=0;if(this._rows<h)for(let x=this._rows;x<h;x++)this.lines.length<h+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new _.BufferLine(l,m)):this.ybase>0&&this.lines.length<=this.ybase+this.y+L+1?(this.ybase--,L++,this.ydisp>0&&this.ydisp--):this.lines.push(new _.BufferLine(l,m)));else for(let x=this._rows;x>h;x--)this.lines.length>h+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(C<this.lines.maxLength){const x=this.lines.length-C;x>0&&(this.lines.trimStart(x),this.ybase=Math.max(this.ybase-x,0),this.ydisp=Math.max(this.ydisp-x,0),this.savedY=Math.max(this.savedY-x,0)),this.lines.maxLength=C}this.x=Math.min(this.x,l-1),this.y=Math.min(this.y,h-1),L&&(this.y+=L),this.savedX=Math.min(this.savedX,l-1),this.scrollTop=0}if(this.scrollBottom=h-1,this._isReflowEnabled&&(this._reflow(l,h),this._cols>l))for(let L=0;L<this.lines.length;L++)y+=+this.lines.get(L).resize(l,m);this._cols=l,this._rows=h,this._memoryCleanupQueue.clear(),y>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let l=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,l=!1);let h=0;for(;this._memoryCleanupPosition<this.lines.length;)if(h+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),h>100)return!0;return l}get _isReflowEnabled(){const l=this._optionsService.rawOptions.windowsPty;return l&&l.buildNumber?this._hasScrollback&&l.backend==="conpty"&&l.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(l,h){this._cols!==l&&(l>this._cols?this._reflowLarger(l,h):this._reflowSmaller(l,h))}_reflowLarger(l,h){const m=(0,b.reflowLargerGetLinesToRemove)(this.lines,this._cols,l,this.ybase+this.y,this.getNullCell(_.DEFAULT_ATTR_DATA));if(m.length>0){const y=(0,b.reflowLargerCreateNewLayout)(this.lines,m);(0,b.reflowLargerApplyNewLayout)(this.lines,y.layout),this._reflowLargerAdjustViewport(l,h,y.countRemoved)}}_reflowLargerAdjustViewport(l,h,m){const y=this.getNullCell(_.DEFAULT_ATTR_DATA);let C=m;for(;C-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<h&&this.lines.push(new _.BufferLine(l,y))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-m,0)}_reflowSmaller(l,h){const m=this.getNullCell(_.DEFAULT_ATTR_DATA),y=[];let C=0;for(let L=this.lines.length-1;L>=0;L--){let x=this.lines.get(L);if(!x||!x.isWrapped&&x.getTrimmedLength()<=l)continue;const E=[x];for(;x.isWrapped&&L>0;)x=this.lines.get(--L),E.unshift(x);const k=this.ybase+this.y;if(k>=L&&k<L+E.length)continue;const T=E[E.length-1].getTrimmedLength(),A=(0,b.reflowSmallerGetNewLineLengths)(E,this._cols,l),D=A.length-E.length;let P;P=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+D):Math.max(0,this.lines.length-this.lines.maxLength+D);const O=[];for(let B=0;B<D;B++){const $=this.getBlankLine(_.DEFAULT_ATTR_DATA,!0);O.push($)}O.length>0&&(y.push({start:L+E.length+C,newLines:O}),C+=O.length),E.push(...O);let F=A.length-1,H=A[F];H===0&&(F--,H=A[F]);let R=E.length-D-1,j=T;for(;R>=0;){const B=Math.min(j,H);if(E[F]===void 0)break;if(E[F].copyCellsFrom(E[R],j-B,H-B,B,!0),H-=B,H===0&&(F--,H=A[F]),j-=B,j===0){R--;const $=Math.max(R,0);j=(0,b.getWrappedLineTrimmedLength)(E,$,this._cols)}}for(let B=0;B<E.length;B++)A[B]<l&&E[B].setCell(A[B],m);let M=D-P;for(;M-- >0;)this.ybase===0?this.y<h-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+C)-h&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+D,this.ybase+h-1)}if(y.length>0){const L=[],x=[];for(let F=0;F<this.lines.length;F++)x.push(this.lines.get(F));const E=this.lines.length;let k=E-1,T=0,A=y[T];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+C);let D=0;for(let F=Math.min(this.lines.maxLength-1,E+C-1);F>=0;F--)if(A&&A.start>k+D){for(let H=A.newLines.length-1;H>=0;H--)this.lines.set(F--,A.newLines[H]);F++,L.push({index:k+1,amount:A.newLines.length}),D+=A.newLines.length,A=y[++T]}else this.lines.set(F,x[k--]);let P=0;for(let F=L.length-1;F>=0;F--)L[F].index+=P,this.lines.onInsertEmitter.fire(L[F]),P+=L[F].amount;const O=Math.max(0,E+C-this.lines.maxLength);O>0&&this.lines.onTrimEmitter.fire(O)}}translateBufferLineToString(l,h,m=0,y){const C=this.lines.get(l);return C?C.translateToString(h,m,y):""}getWrappedRangeForLine(l){let h=l,m=l;for(;h>0&&this.lines.get(h).isWrapped;)h--;for(;m+1<this.lines.length&&this.lines.get(m+1).isWrapped;)m++;return{first:h,last:m}}setupTabStops(l){for(l!=null?this.tabs[l]||(l=this.prevStop(l)):(this.tabs={},l=0);l<this._cols;l+=this._optionsService.rawOptions.tabStopWidth)this.tabs[l]=!0}prevStop(l){for(l==null&&(l=this.x);!this.tabs[--l]&&l>0;);return l>=this._cols?this._cols-1:l<0?0:l}nextStop(l){for(l==null&&(l=this.x);!this.tabs[++l]&&l<this._cols;);return l>=this._cols?this._cols-1:l<0?0:l}clearMarkers(l){this._isClearing=!0;for(let h=0;h<this.markers.length;h++)this.markers[h].line===l&&(this.markers[h].dispose(),this.markers.splice(h--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let l=0;l<this.markers.length;l++)this.markers[l].dispose(),this.markers.splice(l--,1);this._isClearing=!1}addMarker(l){const h=new n.Marker(l);return this.markers.push(h),h.register(this.lines.onTrim(m=>{h.line-=m,h.line<0&&h.dispose()})),h.register(this.lines.onInsert(m=>{h.line>=m.index&&(h.line+=m.amount)})),h.register(this.lines.onDelete(m=>{h.line>=m.index&&h.line<m.index+m.amount&&h.dispose(),h.line>m.index&&(h.line-=m.amount)})),h.register(h.onDispose(()=>this._removeMarker(h))),h}_removeMarker(l){this._isClearing||this.markers.splice(this.markers.indexOf(l),1)}}},8437:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferLine=i.DEFAULT_ATTR_DATA=void 0;const d=a(3734),v=a(511),u=a(643),_=a(482);i.DEFAULT_ATTR_DATA=Object.freeze(new d.AttributeData);let b=0;class w{constructor(n,c,l=!1){this.isWrapped=l,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*n);const h=c||v.CellData.fromCharData([0,u.NULL_CELL_CHAR,u.NULL_CELL_WIDTH,u.NULL_CELL_CODE]);for(let m=0;m<n;++m)this.setCell(m,h);this.length=n}get(n){const c=this._data[3*n+0],l=2097151&c;return[this._data[3*n+1],2097152&c?this._combined[n]:l?(0,_.stringFromCodePoint)(l):"",c>>22,2097152&c?this._combined[n].charCodeAt(this._combined[n].length-1):l]}set(n,c){this._data[3*n+1]=c[u.CHAR_DATA_ATTR_INDEX],c[u.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[n]=c[1],this._data[3*n+0]=2097152|n|c[u.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*n+0]=c[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|c[u.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(n){return this._data[3*n+0]>>22}hasWidth(n){return 12582912&this._data[3*n+0]}getFg(n){return this._data[3*n+1]}getBg(n){return this._data[3*n+2]}hasContent(n){return 4194303&this._data[3*n+0]}getCodePoint(n){const c=this._data[3*n+0];return 2097152&c?this._combined[n].charCodeAt(this._combined[n].length-1):2097151&c}isCombined(n){return 2097152&this._data[3*n+0]}getString(n){const c=this._data[3*n+0];return 2097152&c?this._combined[n]:2097151&c?(0,_.stringFromCodePoint)(2097151&c):""}isProtected(n){return 536870912&this._data[3*n+2]}loadCell(n,c){return b=3*n,c.content=this._data[b+0],c.fg=this._data[b+1],c.bg=this._data[b+2],2097152&c.content&&(c.combinedData=this._combined[n]),268435456&c.bg&&(c.extended=this._extendedAttrs[n]),c}setCell(n,c){2097152&c.content&&(this._combined[n]=c.combinedData),268435456&c.bg&&(this._extendedAttrs[n]=c.extended),this._data[3*n+0]=c.content,this._data[3*n+1]=c.fg,this._data[3*n+2]=c.bg}setCellFromCodePoint(n,c,l,h,m,y){268435456&m&&(this._extendedAttrs[n]=y),this._data[3*n+0]=c|l<<22,this._data[3*n+1]=h,this._data[3*n+2]=m}addCodepointToCell(n,c){let l=this._data[3*n+0];2097152&l?this._combined[n]+=(0,_.stringFromCodePoint)(c):(2097151&l?(this._combined[n]=(0,_.stringFromCodePoint)(2097151&l)+(0,_.stringFromCodePoint)(c),l&=-2097152,l|=2097152):l=c|4194304,this._data[3*n+0]=l)}insertCells(n,c,l,h){if((n%=this.length)&&this.getWidth(n-1)===2&&this.setCellFromCodePoint(n-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new d.ExtendedAttrs),c<this.length-n){const m=new v.CellData;for(let y=this.length-n-c-1;y>=0;--y)this.setCell(n+c+y,this.loadCell(n+y,m));for(let y=0;y<c;++y)this.setCell(n+y,l)}else for(let m=n;m<this.length;++m)this.setCell(m,l);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new d.ExtendedAttrs)}deleteCells(n,c,l,h){if(n%=this.length,c<this.length-n){const m=new v.CellData;for(let y=0;y<this.length-n-c;++y)this.setCell(n+y,this.loadCell(n+c+y,m));for(let y=this.length-c;y<this.length;++y)this.setCell(y,l)}else for(let m=n;m<this.length;++m)this.setCell(m,l);n&&this.getWidth(n-1)===2&&this.setCellFromCodePoint(n-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new d.ExtendedAttrs),this.getWidth(n)!==0||this.hasContent(n)||this.setCellFromCodePoint(n,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new d.ExtendedAttrs)}replaceCells(n,c,l,h,m=!1){if(m)for(n&&this.getWidth(n-1)===2&&!this.isProtected(n-1)&&this.setCellFromCodePoint(n-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new d.ExtendedAttrs),c<this.length&&this.getWidth(c-1)===2&&!this.isProtected(c)&&this.setCellFromCodePoint(c,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new d.ExtendedAttrs);n<c&&n<this.length;)this.isProtected(n)||this.setCell(n,l),n++;else for(n&&this.getWidth(n-1)===2&&this.setCellFromCodePoint(n-1,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new d.ExtendedAttrs),c<this.length&&this.getWidth(c-1)===2&&this.setCellFromCodePoint(c,0,1,(h==null?void 0:h.fg)||0,(h==null?void 0:h.bg)||0,(h==null?void 0:h.extended)||new d.ExtendedAttrs);n<c&&n<this.length;)this.setCell(n++,l)}resize(n,c){if(n===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const l=3*n;if(n>this.length){if(this._data.buffer.byteLength>=4*l)this._data=new Uint32Array(this._data.buffer,0,l);else{const h=new Uint32Array(l);h.set(this._data),this._data=h}for(let h=this.length;h<n;++h)this.setCell(h,c)}else{this._data=this._data.subarray(0,l);const h=Object.keys(this._combined);for(let y=0;y<h.length;y++){const C=parseInt(h[y],10);C>=n&&delete this._combined[C]}const m=Object.keys(this._extendedAttrs);for(let y=0;y<m.length;y++){const C=parseInt(m[y],10);C>=n&&delete this._extendedAttrs[C]}}return this.length=n,4*l*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const n=new Uint32Array(this._data.length);return n.set(this._data),this._data=n,1}return 0}fill(n,c=!1){if(c)for(let l=0;l<this.length;++l)this.isProtected(l)||this.setCell(l,n);else{this._combined={},this._extendedAttrs={};for(let l=0;l<this.length;++l)this.setCell(l,n)}}copyFrom(n){this.length!==n.length?this._data=new Uint32Array(n._data):this._data.set(n._data),this.length=n.length,this._combined={};for(const c in n._combined)this._combined[c]=n._combined[c];this._extendedAttrs={};for(const c in n._extendedAttrs)this._extendedAttrs[c]=n._extendedAttrs[c];this.isWrapped=n.isWrapped}clone(){const n=new w(0);n._data=new Uint32Array(this._data),n.length=this.length;for(const c in this._combined)n._combined[c]=this._combined[c];for(const c in this._extendedAttrs)n._extendedAttrs[c]=this._extendedAttrs[c];return n.isWrapped=this.isWrapped,n}getTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0])return n+(this._data[3*n+0]>>22);return 0}getNoBgTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0]||50331648&this._data[3*n+2])return n+(this._data[3*n+0]>>22);return 0}copyCellsFrom(n,c,l,h,m){const y=n._data;if(m)for(let L=h-1;L>=0;L--){for(let x=0;x<3;x++)this._data[3*(l+L)+x]=y[3*(c+L)+x];268435456&y[3*(c+L)+2]&&(this._extendedAttrs[l+L]=n._extendedAttrs[c+L])}else for(let L=0;L<h;L++){for(let x=0;x<3;x++)this._data[3*(l+L)+x]=y[3*(c+L)+x];268435456&y[3*(c+L)+2]&&(this._extendedAttrs[l+L]=n._extendedAttrs[c+L])}const C=Object.keys(n._combined);for(let L=0;L<C.length;L++){const x=parseInt(C[L],10);x>=c&&(this._combined[x-c+l]=n._combined[x])}}translateToString(n=!1,c=0,l=this.length){n&&(l=Math.min(l,this.getTrimmedLength()));let h="";for(;c<l;){const m=this._data[3*c+0],y=2097151&m;h+=2097152&m?this._combined[c]:y?(0,_.stringFromCodePoint)(y):u.WHITESPACE_CELL_CHAR,c+=m>>22||1}return h}}i.BufferLine=w},4841:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getRangeLength=void 0,i.getRangeLength=function(a,d){if(a.start.y>a.end.y)throw new Error(`Buffer range end (${a.end.x}, ${a.end.y}) cannot be before start (${a.start.x}, ${a.start.y})`);return d*(a.end.y-a.start.y)+(a.end.x-a.start.x+1)}},4634:(S,i)=>{function a(d,v,u){if(v===d.length-1)return d[v].getTrimmedLength();const _=!d[v].hasContent(u-1)&&d[v].getWidth(u-1)===1,b=d[v+1].getWidth(0)===2;return _&&b?u-1:u}Object.defineProperty(i,"__esModule",{value:!0}),i.getWrappedLineTrimmedLength=i.reflowSmallerGetNewLineLengths=i.reflowLargerApplyNewLayout=i.reflowLargerCreateNewLayout=i.reflowLargerGetLinesToRemove=void 0,i.reflowLargerGetLinesToRemove=function(d,v,u,_,b){const w=[];for(let f=0;f<d.length-1;f++){let n=f,c=d.get(++n);if(!c.isWrapped)continue;const l=[d.get(f)];for(;n<d.length&&c.isWrapped;)l.push(c),c=d.get(++n);if(_>=f&&_<n){f+=l.length-1;continue}let h=0,m=a(l,h,v),y=1,C=0;for(;y<l.length;){const x=a(l,y,v),E=x-C,k=u-m,T=Math.min(E,k);l[h].copyCellsFrom(l[y],C,m,T,!1),m+=T,m===u&&(h++,m=0),C+=T,C===x&&(y++,C=0),m===0&&h!==0&&l[h-1].getWidth(u-1)===2&&(l[h].copyCellsFrom(l[h-1],u-1,m++,1,!1),l[h-1].setCell(u-1,b))}l[h].replaceCells(m,u,b);let L=0;for(let x=l.length-1;x>0&&(x>h||l[x].getTrimmedLength()===0);x--)L++;L>0&&(w.push(f+l.length-L),w.push(L)),f+=l.length-1}return w},i.reflowLargerCreateNewLayout=function(d,v){const u=[];let _=0,b=v[_],w=0;for(let f=0;f<d.length;f++)if(b===f){const n=v[++_];d.onDeleteEmitter.fire({index:f-w,amount:n}),f+=n-1,w+=n,b=v[++_]}else u.push(f);return{layout:u,countRemoved:w}},i.reflowLargerApplyNewLayout=function(d,v){const u=[];for(let _=0;_<v.length;_++)u.push(d.get(v[_]));for(let _=0;_<u.length;_++)d.set(_,u[_]);d.length=v.length},i.reflowSmallerGetNewLineLengths=function(d,v,u){const _=[],b=d.map((c,l)=>a(d,l,v)).reduce((c,l)=>c+l);let w=0,f=0,n=0;for(;n<b;){if(b-n<u){_.push(b-n);break}w+=u;const c=a(d,f,v);w>c&&(w-=c,f++);const l=d[f].getWidth(w-1)===2;l&&w--;const h=l?u-1:u;_.push(h),n+=h}return _},i.getWrappedLineTrimmedLength=a},5295:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferSet=void 0;const d=a(8460),v=a(844),u=a(9092);class _ extends v.Disposable{constructor(w,f){super(),this._optionsService=w,this._bufferService=f,this._onBufferActivate=this.register(new d.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new u.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new u.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(w){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(w),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(w,f){this._normal.resize(w,f),this._alt.resize(w,f),this.setupTabStops(w)}setupTabStops(w){this._normal.setupTabStops(w),this._alt.setupTabStops(w)}}i.BufferSet=_},511:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CellData=void 0;const d=a(482),v=a(643),u=a(3734);class _ extends u.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new u.ExtendedAttrs,this.combinedData=""}static fromCharData(w){const f=new _;return f.setFromCharData(w),f}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,d.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(w){this.fg=w[v.CHAR_DATA_ATTR_INDEX],this.bg=0;let f=!1;if(w[v.CHAR_DATA_CHAR_INDEX].length>2)f=!0;else if(w[v.CHAR_DATA_CHAR_INDEX].length===2){const n=w[v.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=n&&n<=56319){const c=w[v.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=c&&c<=57343?this.content=1024*(n-55296)+c-56320+65536|w[v.CHAR_DATA_WIDTH_INDEX]<<22:f=!0}else f=!0}else this.content=w[v.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|w[v.CHAR_DATA_WIDTH_INDEX]<<22;f&&(this.combinedData=w[v.CHAR_DATA_CHAR_INDEX],this.content=2097152|w[v.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}i.CellData=_},643:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WHITESPACE_CELL_CODE=i.WHITESPACE_CELL_WIDTH=i.WHITESPACE_CELL_CHAR=i.NULL_CELL_CODE=i.NULL_CELL_WIDTH=i.NULL_CELL_CHAR=i.CHAR_DATA_CODE_INDEX=i.CHAR_DATA_WIDTH_INDEX=i.CHAR_DATA_CHAR_INDEX=i.CHAR_DATA_ATTR_INDEX=i.DEFAULT_EXT=i.DEFAULT_ATTR=i.DEFAULT_COLOR=void 0,i.DEFAULT_COLOR=0,i.DEFAULT_ATTR=256|i.DEFAULT_COLOR<<9,i.DEFAULT_EXT=0,i.CHAR_DATA_ATTR_INDEX=0,i.CHAR_DATA_CHAR_INDEX=1,i.CHAR_DATA_WIDTH_INDEX=2,i.CHAR_DATA_CODE_INDEX=3,i.NULL_CELL_CHAR="",i.NULL_CELL_WIDTH=1,i.NULL_CELL_CODE=0,i.WHITESPACE_CELL_CHAR=" ",i.WHITESPACE_CELL_WIDTH=1,i.WHITESPACE_CELL_CODE=32},4863:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Marker=void 0;const d=a(8460),v=a(844);class u{get id(){return this._id}constructor(b){this.line=b,this.isDisposed=!1,this._disposables=[],this._id=u._nextId++,this._onDispose=this.register(new d.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,v.disposeArray)(this._disposables),this._disposables.length=0)}register(b){return this._disposables.push(b),b}}i.Marker=u,u._nextId=1},7116:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DEFAULT_CHARSET=i.CHARSETS=void 0,i.CHARSETS={},i.DEFAULT_CHARSET=i.CHARSETS.B,i.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},i.CHARSETS.A={"#":""},i.CHARSETS.B=void 0,i.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},i.CHARSETS.C=i.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},i.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},i.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},i.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},i.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},i.CHARSETS.E=i.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},i.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},i.CHARSETS.H=i.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},i.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(S,i)=>{var a,d,v;Object.defineProperty(i,"__esModule",{value:!0}),i.C1_ESCAPED=i.C1=i.C0=void 0,function(u){u.NUL="\0",u.SOH="",u.STX="",u.ETX="",u.EOT="",u.ENQ="",u.ACK="",u.BEL="\x07",u.BS="\b",u.HT="	",u.LF=`
`,u.VT="\v",u.FF="\f",u.CR="\r",u.SO="",u.SI="",u.DLE="",u.DC1="",u.DC2="",u.DC3="",u.DC4="",u.NAK="",u.SYN="",u.ETB="",u.CAN="",u.EM="",u.SUB="",u.ESC="\x1B",u.FS="",u.GS="",u.RS="",u.US="",u.SP=" ",u.DEL=""}(a||(i.C0=a={})),function(u){u.PAD="",u.HOP="",u.BPH="",u.NBH="",u.IND="",u.NEL="",u.SSA="",u.ESA="",u.HTS="",u.HTJ="",u.VTS="",u.PLD="",u.PLU="",u.RI="",u.SS2="",u.SS3="",u.DCS="",u.PU1="",u.PU2="",u.STS="",u.CCH="",u.MW="",u.SPA="",u.EPA="",u.SOS="",u.SGCI="",u.SCI="",u.CSI="",u.ST="",u.OSC="",u.PM="",u.APC=""}(d||(i.C1=d={})),function(u){u.ST=`${a.ESC}\\`}(v||(i.C1_ESCAPED=v={}))},7399:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.evaluateKeyboardEvent=void 0;const d=a(2584),v={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};i.evaluateKeyboardEvent=function(u,_,b,w){const f={type:0,cancel:!1,key:void 0},n=(u.shiftKey?1:0)|(u.altKey?2:0)|(u.ctrlKey?4:0)|(u.metaKey?8:0);switch(u.keyCode){case 0:u.key==="UIKeyInputUpArrow"?f.key=_?d.C0.ESC+"OA":d.C0.ESC+"[A":u.key==="UIKeyInputLeftArrow"?f.key=_?d.C0.ESC+"OD":d.C0.ESC+"[D":u.key==="UIKeyInputRightArrow"?f.key=_?d.C0.ESC+"OC":d.C0.ESC+"[C":u.key==="UIKeyInputDownArrow"&&(f.key=_?d.C0.ESC+"OB":d.C0.ESC+"[B");break;case 8:if(u.altKey){f.key=d.C0.ESC+d.C0.DEL;break}f.key=d.C0.DEL;break;case 9:if(u.shiftKey){f.key=d.C0.ESC+"[Z";break}f.key=d.C0.HT,f.cancel=!0;break;case 13:f.key=u.altKey?d.C0.ESC+d.C0.CR:d.C0.CR,f.cancel=!0;break;case 27:f.key=d.C0.ESC,u.altKey&&(f.key=d.C0.ESC+d.C0.ESC),f.cancel=!0;break;case 37:if(u.metaKey)break;n?(f.key=d.C0.ESC+"[1;"+(n+1)+"D",f.key===d.C0.ESC+"[1;3D"&&(f.key=d.C0.ESC+(b?"b":"[1;5D"))):f.key=_?d.C0.ESC+"OD":d.C0.ESC+"[D";break;case 39:if(u.metaKey)break;n?(f.key=d.C0.ESC+"[1;"+(n+1)+"C",f.key===d.C0.ESC+"[1;3C"&&(f.key=d.C0.ESC+(b?"f":"[1;5C"))):f.key=_?d.C0.ESC+"OC":d.C0.ESC+"[C";break;case 38:if(u.metaKey)break;n?(f.key=d.C0.ESC+"[1;"+(n+1)+"A",b||f.key!==d.C0.ESC+"[1;3A"||(f.key=d.C0.ESC+"[1;5A")):f.key=_?d.C0.ESC+"OA":d.C0.ESC+"[A";break;case 40:if(u.metaKey)break;n?(f.key=d.C0.ESC+"[1;"+(n+1)+"B",b||f.key!==d.C0.ESC+"[1;3B"||(f.key=d.C0.ESC+"[1;5B")):f.key=_?d.C0.ESC+"OB":d.C0.ESC+"[B";break;case 45:u.shiftKey||u.ctrlKey||(f.key=d.C0.ESC+"[2~");break;case 46:f.key=n?d.C0.ESC+"[3;"+(n+1)+"~":d.C0.ESC+"[3~";break;case 36:f.key=n?d.C0.ESC+"[1;"+(n+1)+"H":_?d.C0.ESC+"OH":d.C0.ESC+"[H";break;case 35:f.key=n?d.C0.ESC+"[1;"+(n+1)+"F":_?d.C0.ESC+"OF":d.C0.ESC+"[F";break;case 33:u.shiftKey?f.type=2:u.ctrlKey?f.key=d.C0.ESC+"[5;"+(n+1)+"~":f.key=d.C0.ESC+"[5~";break;case 34:u.shiftKey?f.type=3:u.ctrlKey?f.key=d.C0.ESC+"[6;"+(n+1)+"~":f.key=d.C0.ESC+"[6~";break;case 112:f.key=n?d.C0.ESC+"[1;"+(n+1)+"P":d.C0.ESC+"OP";break;case 113:f.key=n?d.C0.ESC+"[1;"+(n+1)+"Q":d.C0.ESC+"OQ";break;case 114:f.key=n?d.C0.ESC+"[1;"+(n+1)+"R":d.C0.ESC+"OR";break;case 115:f.key=n?d.C0.ESC+"[1;"+(n+1)+"S":d.C0.ESC+"OS";break;case 116:f.key=n?d.C0.ESC+"[15;"+(n+1)+"~":d.C0.ESC+"[15~";break;case 117:f.key=n?d.C0.ESC+"[17;"+(n+1)+"~":d.C0.ESC+"[17~";break;case 118:f.key=n?d.C0.ESC+"[18;"+(n+1)+"~":d.C0.ESC+"[18~";break;case 119:f.key=n?d.C0.ESC+"[19;"+(n+1)+"~":d.C0.ESC+"[19~";break;case 120:f.key=n?d.C0.ESC+"[20;"+(n+1)+"~":d.C0.ESC+"[20~";break;case 121:f.key=n?d.C0.ESC+"[21;"+(n+1)+"~":d.C0.ESC+"[21~";break;case 122:f.key=n?d.C0.ESC+"[23;"+(n+1)+"~":d.C0.ESC+"[23~";break;case 123:f.key=n?d.C0.ESC+"[24;"+(n+1)+"~":d.C0.ESC+"[24~";break;default:if(!u.ctrlKey||u.shiftKey||u.altKey||u.metaKey)if(b&&!w||!u.altKey||u.metaKey)!b||u.altKey||u.ctrlKey||u.shiftKey||!u.metaKey?u.key&&!u.ctrlKey&&!u.altKey&&!u.metaKey&&u.keyCode>=48&&u.key.length===1?f.key=u.key:u.key&&u.ctrlKey&&(u.key==="_"&&(f.key=d.C0.US),u.key==="@"&&(f.key=d.C0.NUL)):u.keyCode===65&&(f.type=1);else{const c=v[u.keyCode],l=c==null?void 0:c[u.shiftKey?1:0];if(l)f.key=d.C0.ESC+l;else if(u.keyCode>=65&&u.keyCode<=90){const h=u.ctrlKey?u.keyCode-64:u.keyCode+32;let m=String.fromCharCode(h);u.shiftKey&&(m=m.toUpperCase()),f.key=d.C0.ESC+m}else if(u.keyCode===32)f.key=d.C0.ESC+(u.ctrlKey?d.C0.NUL:" ");else if(u.key==="Dead"&&u.code.startsWith("Key")){let h=u.code.slice(3,4);u.shiftKey||(h=h.toLowerCase()),f.key=d.C0.ESC+h,f.cancel=!0}}else u.keyCode>=65&&u.keyCode<=90?f.key=String.fromCharCode(u.keyCode-64):u.keyCode===32?f.key=d.C0.NUL:u.keyCode>=51&&u.keyCode<=55?f.key=String.fromCharCode(u.keyCode-51+27):u.keyCode===56?f.key=d.C0.DEL:u.keyCode===219?f.key=d.C0.ESC:u.keyCode===220?f.key=d.C0.FS:u.keyCode===221&&(f.key=d.C0.GS)}return f}},482:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Utf8ToUtf32=i.StringToUtf32=i.utf32ToString=i.stringFromCodePoint=void 0,i.stringFromCodePoint=function(a){return a>65535?(a-=65536,String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):String.fromCharCode(a)},i.utf32ToString=function(a,d=0,v=a.length){let u="";for(let _=d;_<v;++_){let b=a[_];b>65535?(b-=65536,u+=String.fromCharCode(55296+(b>>10))+String.fromCharCode(b%1024+56320)):u+=String.fromCharCode(b)}return u},i.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(a,d){const v=a.length;if(!v)return 0;let u=0,_=0;if(this._interim){const b=a.charCodeAt(_++);56320<=b&&b<=57343?d[u++]=1024*(this._interim-55296)+b-56320+65536:(d[u++]=this._interim,d[u++]=b),this._interim=0}for(let b=_;b<v;++b){const w=a.charCodeAt(b);if(55296<=w&&w<=56319){if(++b>=v)return this._interim=w,u;const f=a.charCodeAt(b);56320<=f&&f<=57343?d[u++]=1024*(w-55296)+f-56320+65536:(d[u++]=w,d[u++]=f)}else w!==65279&&(d[u++]=w)}return u}},i.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(a,d){const v=a.length;if(!v)return 0;let u,_,b,w,f=0,n=0,c=0;if(this.interim[0]){let m=!1,y=this.interim[0];y&=(224&y)==192?31:(240&y)==224?15:7;let C,L=0;for(;(C=63&this.interim[++L])&&L<4;)y<<=6,y|=C;const x=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,E=x-L;for(;c<E;){if(c>=v)return 0;if(C=a[c++],(192&C)!=128){c--,m=!0;break}this.interim[L++]=C,y<<=6,y|=63&C}m||(x===2?y<128?c--:d[f++]=y:x===3?y<2048||y>=55296&&y<=57343||y===65279||(d[f++]=y):y<65536||y>1114111||(d[f++]=y)),this.interim.fill(0)}const l=v-4;let h=c;for(;h<v;){for(;!(!(h<l)||128&(u=a[h])||128&(_=a[h+1])||128&(b=a[h+2])||128&(w=a[h+3]));)d[f++]=u,d[f++]=_,d[f++]=b,d[f++]=w,h+=4;if(u=a[h++],u<128)d[f++]=u;else if((224&u)==192){if(h>=v)return this.interim[0]=u,f;if(_=a[h++],(192&_)!=128){h--;continue}if(n=(31&u)<<6|63&_,n<128){h--;continue}d[f++]=n}else if((240&u)==224){if(h>=v)return this.interim[0]=u,f;if(_=a[h++],(192&_)!=128){h--;continue}if(h>=v)return this.interim[0]=u,this.interim[1]=_,f;if(b=a[h++],(192&b)!=128){h--;continue}if(n=(15&u)<<12|(63&_)<<6|63&b,n<2048||n>=55296&&n<=57343||n===65279)continue;d[f++]=n}else if((248&u)==240){if(h>=v)return this.interim[0]=u,f;if(_=a[h++],(192&_)!=128){h--;continue}if(h>=v)return this.interim[0]=u,this.interim[1]=_,f;if(b=a[h++],(192&b)!=128){h--;continue}if(h>=v)return this.interim[0]=u,this.interim[1]=_,this.interim[2]=b,f;if(w=a[h++],(192&w)!=128){h--;continue}if(n=(7&u)<<18|(63&_)<<12|(63&b)<<6|63&w,n<65536||n>1114111)continue;d[f++]=n}}return f}}},225:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.UnicodeV6=void 0;const a=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],d=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let v;i.UnicodeV6=class{constructor(){if(this.version="6",!v){v=new Uint8Array(65536),v.fill(1),v[0]=0,v.fill(0,1,32),v.fill(0,127,160),v.fill(2,4352,4448),v[9001]=2,v[9002]=2,v.fill(2,11904,42192),v[12351]=1,v.fill(2,44032,55204),v.fill(2,63744,64256),v.fill(2,65040,65050),v.fill(2,65072,65136),v.fill(2,65280,65377),v.fill(2,65504,65511);for(let u=0;u<a.length;++u)v.fill(0,a[u][0],a[u][1]+1)}}wcwidth(u){return u<32?0:u<127?1:u<65536?v[u]:function(_,b){let w,f=0,n=b.length-1;if(_<b[0][0]||_>b[n][1])return!1;for(;n>=f;)if(w=f+n>>1,_>b[w][1])f=w+1;else{if(!(_<b[w][0]))return!0;n=w-1}return!1}(u,d)?0:u>=131072&&u<=196605||u>=196608&&u<=262141?2:1}}},5981:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WriteBuffer=void 0;const d=a(8460),v=a(844);class u extends v.Disposable{constructor(b){super(),this._action=b,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new d.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(b,w){if(w!==void 0&&this._syncCalls>w)return void(this._syncCalls=0);if(this._pendingData+=b.length,this._writeBuffer.push(b),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let f;for(this._isSyncWriting=!0;f=this._writeBuffer.shift();){this._action(f);const n=this._callbacks.shift();n&&n()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(b,w){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=b.length,this._writeBuffer.push(b),this._callbacks.push(w),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=b.length,this._writeBuffer.push(b),this._callbacks.push(w)}_innerWrite(b=0,w=!0){const f=b||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const n=this._writeBuffer[this._bufferOffset],c=this._action(n,w);if(c){const h=m=>Date.now()-f>=12?setTimeout(()=>this._innerWrite(0,m)):this._innerWrite(f,m);return void c.catch(m=>(queueMicrotask(()=>{throw m}),Promise.resolve(!1))).then(h)}const l=this._callbacks[this._bufferOffset];if(l&&l(),this._bufferOffset++,this._pendingData-=n.length,Date.now()-f>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}i.WriteBuffer=u},5941:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.toRgbString=i.parseColor=void 0;const a=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,d=/^[\da-f]+$/;function v(u,_){const b=u.toString(16),w=b.length<2?"0"+b:b;switch(_){case 4:return b[0];case 8:return w;case 12:return(w+w).slice(0,3);default:return w+w}}i.parseColor=function(u){if(!u)return;let _=u.toLowerCase();if(_.indexOf("rgb:")===0){_=_.slice(4);const b=a.exec(_);if(b){const w=b[1]?15:b[4]?255:b[7]?4095:65535;return[Math.round(parseInt(b[1]||b[4]||b[7]||b[10],16)/w*255),Math.round(parseInt(b[2]||b[5]||b[8]||b[11],16)/w*255),Math.round(parseInt(b[3]||b[6]||b[9]||b[12],16)/w*255)]}}else if(_.indexOf("#")===0&&(_=_.slice(1),d.exec(_)&&[3,6,9,12].includes(_.length))){const b=_.length/3,w=[0,0,0];for(let f=0;f<3;++f){const n=parseInt(_.slice(b*f,b*f+b),16);w[f]=b===1?n<<4:b===2?n:b===3?n>>4:n>>8}return w}},i.toRgbString=function(u,_=16){const[b,w,f]=u;return`rgb:${v(b,_)}/${v(w,_)}/${v(f,_)}`}},5770:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PAYLOAD_LIMIT=void 0,i.PAYLOAD_LIMIT=1e7},6351:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DcsHandler=i.DcsParser=void 0;const d=a(482),v=a(8742),u=a(5770),_=[];i.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=_,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=_}registerHandler(w,f){this._handlers[w]===void 0&&(this._handlers[w]=[]);const n=this._handlers[w];return n.push(f),{dispose:()=>{const c=n.indexOf(f);c!==-1&&n.splice(c,1)}}}clearHandler(w){this._handlers[w]&&delete this._handlers[w]}setHandlerFallback(w){this._handlerFb=w}reset(){if(this._active.length)for(let w=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;w>=0;--w)this._active[w].unhook(!1);this._stack.paused=!1,this._active=_,this._ident=0}hook(w,f){if(this.reset(),this._ident=w,this._active=this._handlers[w]||_,this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].hook(f);else this._handlerFb(this._ident,"HOOK",f)}put(w,f,n){if(this._active.length)for(let c=this._active.length-1;c>=0;c--)this._active[c].put(w,f,n);else this._handlerFb(this._ident,"PUT",(0,d.utf32ToString)(w,f,n))}unhook(w,f=!0){if(this._active.length){let n=!1,c=this._active.length-1,l=!1;if(this._stack.paused&&(c=this._stack.loopPosition-1,n=f,l=this._stack.fallThrough,this._stack.paused=!1),!l&&n===!1){for(;c>=0&&(n=this._active[c].unhook(w),n!==!0);c--)if(n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=c,this._stack.fallThrough=!1,n;c--}for(;c>=0;c--)if(n=this._active[c].unhook(!1),n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=c,this._stack.fallThrough=!0,n}else this._handlerFb(this._ident,"UNHOOK",w);this._active=_,this._ident=0}};const b=new v.Params;b.addParam(0),i.DcsHandler=class{constructor(w){this._handler=w,this._data="",this._params=b,this._hitLimit=!1}hook(w){this._params=w.length>1||w.params[0]?w.clone():b,this._data="",this._hitLimit=!1}put(w,f,n){this._hitLimit||(this._data+=(0,d.utf32ToString)(w,f,n),this._data.length>u.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(w){let f=!1;if(this._hitLimit)f=!1;else if(w&&(f=this._handler(this._data,this._params),f instanceof Promise))return f.then(n=>(this._params=b,this._data="",this._hitLimit=!1,n));return this._params=b,this._data="",this._hitLimit=!1,f}}},2015:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.EscapeSequenceParser=i.VT500_TRANSITION_TABLE=i.TransitionTable=void 0;const d=a(844),v=a(8742),u=a(6242),_=a(6351);class b{constructor(c){this.table=new Uint8Array(c)}setDefault(c,l){this.table.fill(c<<4|l)}add(c,l,h,m){this.table[l<<8|c]=h<<4|m}addMany(c,l,h,m){for(let y=0;y<c.length;y++)this.table[l<<8|c[y]]=h<<4|m}}i.TransitionTable=b;const w=160;i.VT500_TRANSITION_TABLE=function(){const n=new b(4095),c=Array.apply(null,Array(256)).map((L,x)=>x),l=(L,x)=>c.slice(L,x),h=l(32,127),m=l(0,24);m.push(25),m.push.apply(m,l(28,32));const y=l(0,14);let C;for(C in n.setDefault(1,0),n.addMany(h,0,2,0),y)n.addMany([24,26,153,154],C,3,0),n.addMany(l(128,144),C,3,0),n.addMany(l(144,152),C,3,0),n.add(156,C,0,0),n.add(27,C,11,1),n.add(157,C,4,8),n.addMany([152,158,159],C,0,7),n.add(155,C,11,3),n.add(144,C,11,9);return n.addMany(m,0,3,0),n.addMany(m,1,3,1),n.add(127,1,0,1),n.addMany(m,8,0,8),n.addMany(m,3,3,3),n.add(127,3,0,3),n.addMany(m,4,3,4),n.add(127,4,0,4),n.addMany(m,6,3,6),n.addMany(m,5,3,5),n.add(127,5,0,5),n.addMany(m,2,3,2),n.add(127,2,0,2),n.add(93,1,4,8),n.addMany(h,8,5,8),n.add(127,8,5,8),n.addMany([156,27,24,26,7],8,6,0),n.addMany(l(28,32),8,0,8),n.addMany([88,94,95],1,0,7),n.addMany(h,7,0,7),n.addMany(m,7,0,7),n.add(156,7,0,0),n.add(127,7,0,7),n.add(91,1,11,3),n.addMany(l(64,127),3,7,0),n.addMany(l(48,60),3,8,4),n.addMany([60,61,62,63],3,9,4),n.addMany(l(48,60),4,8,4),n.addMany(l(64,127),4,7,0),n.addMany([60,61,62,63],4,0,6),n.addMany(l(32,64),6,0,6),n.add(127,6,0,6),n.addMany(l(64,127),6,0,0),n.addMany(l(32,48),3,9,5),n.addMany(l(32,48),5,9,5),n.addMany(l(48,64),5,0,6),n.addMany(l(64,127),5,7,0),n.addMany(l(32,48),4,9,5),n.addMany(l(32,48),1,9,2),n.addMany(l(32,48),2,9,2),n.addMany(l(48,127),2,10,0),n.addMany(l(48,80),1,10,0),n.addMany(l(81,88),1,10,0),n.addMany([89,90,92],1,10,0),n.addMany(l(96,127),1,10,0),n.add(80,1,11,9),n.addMany(m,9,0,9),n.add(127,9,0,9),n.addMany(l(28,32),9,0,9),n.addMany(l(32,48),9,9,12),n.addMany(l(48,60),9,8,10),n.addMany([60,61,62,63],9,9,10),n.addMany(m,11,0,11),n.addMany(l(32,128),11,0,11),n.addMany(l(28,32),11,0,11),n.addMany(m,10,0,10),n.add(127,10,0,10),n.addMany(l(28,32),10,0,10),n.addMany(l(48,60),10,8,10),n.addMany([60,61,62,63],10,0,11),n.addMany(l(32,48),10,9,12),n.addMany(m,12,0,12),n.add(127,12,0,12),n.addMany(l(28,32),12,0,12),n.addMany(l(32,48),12,9,12),n.addMany(l(48,64),12,0,11),n.addMany(l(64,127),12,12,13),n.addMany(l(64,127),10,12,13),n.addMany(l(64,127),9,12,13),n.addMany(m,13,13,13),n.addMany(h,13,13,13),n.add(127,13,0,13),n.addMany([27,156,24,26],13,14,0),n.add(w,0,2,0),n.add(w,8,5,8),n.add(w,6,0,6),n.add(w,11,0,11),n.add(w,13,13,13),n}();class f extends d.Disposable{constructor(c=i.VT500_TRANSITION_TABLE){super(),this._transitions=c,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new v.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(l,h,m)=>{},this._executeHandlerFb=l=>{},this._csiHandlerFb=(l,h)=>{},this._escHandlerFb=l=>{},this._errorHandlerFb=l=>l,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,d.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new u.OscParser),this._dcsParser=this.register(new _.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(c,l=[64,126]){let h=0;if(c.prefix){if(c.prefix.length>1)throw new Error("only one byte as prefix supported");if(h=c.prefix.charCodeAt(0),h&&60>h||h>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(c.intermediates){if(c.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let y=0;y<c.intermediates.length;++y){const C=c.intermediates.charCodeAt(y);if(32>C||C>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");h<<=8,h|=C}}if(c.final.length!==1)throw new Error("final must be a single byte");const m=c.final.charCodeAt(0);if(l[0]>m||m>l[1])throw new Error(`final must be in range ${l[0]} .. ${l[1]}`);return h<<=8,h|=m,h}identToString(c){const l=[];for(;c;)l.push(String.fromCharCode(255&c)),c>>=8;return l.reverse().join("")}setPrintHandler(c){this._printHandler=c}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(c,l){const h=this._identifier(c,[48,126]);this._escHandlers[h]===void 0&&(this._escHandlers[h]=[]);const m=this._escHandlers[h];return m.push(l),{dispose:()=>{const y=m.indexOf(l);y!==-1&&m.splice(y,1)}}}clearEscHandler(c){this._escHandlers[this._identifier(c,[48,126])]&&delete this._escHandlers[this._identifier(c,[48,126])]}setEscHandlerFallback(c){this._escHandlerFb=c}setExecuteHandler(c,l){this._executeHandlers[c.charCodeAt(0)]=l}clearExecuteHandler(c){this._executeHandlers[c.charCodeAt(0)]&&delete this._executeHandlers[c.charCodeAt(0)]}setExecuteHandlerFallback(c){this._executeHandlerFb=c}registerCsiHandler(c,l){const h=this._identifier(c);this._csiHandlers[h]===void 0&&(this._csiHandlers[h]=[]);const m=this._csiHandlers[h];return m.push(l),{dispose:()=>{const y=m.indexOf(l);y!==-1&&m.splice(y,1)}}}clearCsiHandler(c){this._csiHandlers[this._identifier(c)]&&delete this._csiHandlers[this._identifier(c)]}setCsiHandlerFallback(c){this._csiHandlerFb=c}registerDcsHandler(c,l){return this._dcsParser.registerHandler(this._identifier(c),l)}clearDcsHandler(c){this._dcsParser.clearHandler(this._identifier(c))}setDcsHandlerFallback(c){this._dcsParser.setHandlerFallback(c)}registerOscHandler(c,l){return this._oscParser.registerHandler(c,l)}clearOscHandler(c){this._oscParser.clearHandler(c)}setOscHandlerFallback(c){this._oscParser.setHandlerFallback(c)}setErrorHandler(c){this._errorHandler=c}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(c,l,h,m,y){this._parseStack.state=c,this._parseStack.handlers=l,this._parseStack.handlerPos=h,this._parseStack.transition=m,this._parseStack.chunkPos=y}parse(c,l,h){let m,y=0,C=0,L=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,L=this._parseStack.chunkPos+1;else{if(h===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const x=this._parseStack.handlers;let E=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(h===!1&&E>-1){for(;E>=0&&(m=x[E](this._params),m!==!0);E--)if(m instanceof Promise)return this._parseStack.handlerPos=E,m}this._parseStack.handlers=[];break;case 4:if(h===!1&&E>-1){for(;E>=0&&(m=x[E](),m!==!0);E--)if(m instanceof Promise)return this._parseStack.handlerPos=E,m}this._parseStack.handlers=[];break;case 6:if(y=c[this._parseStack.chunkPos],m=this._dcsParser.unhook(y!==24&&y!==26,h),m)return m;y===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(y=c[this._parseStack.chunkPos],m=this._oscParser.end(y!==24&&y!==26,h),m)return m;y===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,L=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let x=L;x<l;++x){switch(y=c[x],C=this._transitions.table[this.currentState<<8|(y<160?y:w)],C>>4){case 2:for(let D=x+1;;++D){if(D>=l||(y=c[D])<32||y>126&&y<w){this._printHandler(c,x,D),x=D-1;break}if(++D>=l||(y=c[D])<32||y>126&&y<w){this._printHandler(c,x,D),x=D-1;break}if(++D>=l||(y=c[D])<32||y>126&&y<w){this._printHandler(c,x,D),x=D-1;break}if(++D>=l||(y=c[D])<32||y>126&&y<w){this._printHandler(c,x,D),x=D-1;break}}break;case 3:this._executeHandlers[y]?this._executeHandlers[y]():this._executeHandlerFb(y),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:x,code:y,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const E=this._csiHandlers[this._collect<<8|y];let k=E?E.length-1:-1;for(;k>=0&&(m=E[k](this._params),m!==!0);k--)if(m instanceof Promise)return this._preserveStack(3,E,k,C,x),m;k<0&&this._csiHandlerFb(this._collect<<8|y,this._params),this.precedingCodepoint=0;break;case 8:do switch(y){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(y-48)}while(++x<l&&(y=c[x])>47&&y<60);x--;break;case 9:this._collect<<=8,this._collect|=y;break;case 10:const T=this._escHandlers[this._collect<<8|y];let A=T?T.length-1:-1;for(;A>=0&&(m=T[A](),m!==!0);A--)if(m instanceof Promise)return this._preserveStack(4,T,A,C,x),m;A<0&&this._escHandlerFb(this._collect<<8|y),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|y,this._params);break;case 13:for(let D=x+1;;++D)if(D>=l||(y=c[D])===24||y===26||y===27||y>127&&y<w){this._dcsParser.put(c,x,D),x=D-1;break}break;case 14:if(m=this._dcsParser.unhook(y!==24&&y!==26),m)return this._preserveStack(6,[],0,C,x),m;y===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let D=x+1;;D++)if(D>=l||(y=c[D])<32||y>127&&y<w){this._oscParser.put(c,x,D),x=D-1;break}break;case 6:if(m=this._oscParser.end(y!==24&&y!==26),m)return this._preserveStack(5,[],0,C,x),m;y===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&C}}}i.EscapeSequenceParser=f},6242:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.OscHandler=i.OscParser=void 0;const d=a(5770),v=a(482),u=[];i.OscParser=class{constructor(){this._state=0,this._active=u,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(_,b){this._handlers[_]===void 0&&(this._handlers[_]=[]);const w=this._handlers[_];return w.push(b),{dispose:()=>{const f=w.indexOf(b);f!==-1&&w.splice(f,1)}}}clearHandler(_){this._handlers[_]&&delete this._handlers[_]}setHandlerFallback(_){this._handlerFb=_}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=u}reset(){if(this._state===2)for(let _=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;_>=0;--_)this._active[_].end(!1);this._stack.paused=!1,this._active=u,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||u,this._active.length)for(let _=this._active.length-1;_>=0;_--)this._active[_].start();else this._handlerFb(this._id,"START")}_put(_,b,w){if(this._active.length)for(let f=this._active.length-1;f>=0;f--)this._active[f].put(_,b,w);else this._handlerFb(this._id,"PUT",(0,v.utf32ToString)(_,b,w))}start(){this.reset(),this._state=1}put(_,b,w){if(this._state!==3){if(this._state===1)for(;b<w;){const f=_[b++];if(f===59){this._state=2,this._start();break}if(f<48||57<f)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+f-48}this._state===2&&w-b>0&&this._put(_,b,w)}}end(_,b=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let w=!1,f=this._active.length-1,n=!1;if(this._stack.paused&&(f=this._stack.loopPosition-1,w=b,n=this._stack.fallThrough,this._stack.paused=!1),!n&&w===!1){for(;f>=0&&(w=this._active[f].end(_),w!==!0);f--)if(w instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!1,w;f--}for(;f>=0;f--)if(w=this._active[f].end(!1),w instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!0,w}else this._handlerFb(this._id,"END",_);this._active=u,this._id=-1,this._state=0}}},i.OscHandler=class{constructor(_){this._handler=_,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(_,b,w){this._hitLimit||(this._data+=(0,v.utf32ToString)(_,b,w),this._data.length>d.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(_){let b=!1;if(this._hitLimit)b=!1;else if(_&&(b=this._handler(this._data),b instanceof Promise))return b.then(w=>(this._data="",this._hitLimit=!1,w));return this._data="",this._hitLimit=!1,b}}},8742:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Params=void 0;const a=2147483647;class d{static fromArray(u){const _=new d;if(!u.length)return _;for(let b=Array.isArray(u[0])?1:0;b<u.length;++b){const w=u[b];if(Array.isArray(w))for(let f=0;f<w.length;++f)_.addSubParam(w[f]);else _.addParam(w)}return _}constructor(u=32,_=32){if(this.maxLength=u,this.maxSubParamsLength=_,_>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(u),this.length=0,this._subParams=new Int32Array(_),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(u),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const u=new d(this.maxLength,this.maxSubParamsLength);return u.params.set(this.params),u.length=this.length,u._subParams.set(this._subParams),u._subParamsLength=this._subParamsLength,u._subParamsIdx.set(this._subParamsIdx),u._rejectDigits=this._rejectDigits,u._rejectSubDigits=this._rejectSubDigits,u._digitIsSub=this._digitIsSub,u}toArray(){const u=[];for(let _=0;_<this.length;++_){u.push(this.params[_]);const b=this._subParamsIdx[_]>>8,w=255&this._subParamsIdx[_];w-b>0&&u.push(Array.prototype.slice.call(this._subParams,b,w))}return u}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(u){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(u<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=u>a?a:u}}addSubParam(u){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(u<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=u>a?a:u,this._subParamsIdx[this.length-1]++}}hasSubParams(u){return(255&this._subParamsIdx[u])-(this._subParamsIdx[u]>>8)>0}getSubParams(u){const _=this._subParamsIdx[u]>>8,b=255&this._subParamsIdx[u];return b-_>0?this._subParams.subarray(_,b):null}getSubParamsAll(){const u={};for(let _=0;_<this.length;++_){const b=this._subParamsIdx[_]>>8,w=255&this._subParamsIdx[_];w-b>0&&(u[_]=this._subParams.slice(b,w))}return u}addDigit(u){let _;if(this._rejectDigits||!(_=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const b=this._digitIsSub?this._subParams:this.params,w=b[_-1];b[_-1]=~w?Math.min(10*w+u,a):u}}i.Params=d},5741:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.AddonManager=void 0,i.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let a=this._addons.length-1;a>=0;a--)this._addons[a].instance.dispose()}loadAddon(a,d){const v={instance:d,dispose:d.dispose,isDisposed:!1};this._addons.push(v),d.dispose=()=>this._wrappedAddonDispose(v),d.activate(a)}_wrappedAddonDispose(a){if(a.isDisposed)return;let d=-1;for(let v=0;v<this._addons.length;v++)if(this._addons[v]===a){d=v;break}if(d===-1)throw new Error("Could not dispose an addon that has not been loaded");a.isDisposed=!0,a.dispose.apply(a.instance),this._addons.splice(d,1)}}},8771:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferApiView=void 0;const d=a(3785),v=a(511);i.BufferApiView=class{constructor(u,_){this._buffer=u,this.type=_}init(u){return this._buffer=u,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(u){const _=this._buffer.lines.get(u);if(_)return new d.BufferLineApiView(_)}getNullCell(){return new v.CellData}}},3785:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferLineApiView=void 0;const d=a(511);i.BufferLineApiView=class{constructor(v){this._line=v}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(v,u){if(!(v<0||v>=this._line.length))return u?(this._line.loadCell(v,u),u):this._line.loadCell(v,new d.CellData)}translateToString(v,u,_){return this._line.translateToString(v,u,_)}}},8285:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferNamespaceApi=void 0;const d=a(8771),v=a(8460),u=a(844);class _ extends u.Disposable{constructor(w){super(),this._core=w,this._onBufferChange=this.register(new v.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new d.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new d.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}i.BufferNamespaceApi=_},7975:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ParserApi=void 0,i.ParserApi=class{constructor(a){this._core=a}registerCsiHandler(a,d){return this._core.registerCsiHandler(a,v=>d(v.toArray()))}addCsiHandler(a,d){return this.registerCsiHandler(a,d)}registerDcsHandler(a,d){return this._core.registerDcsHandler(a,(v,u)=>d(v,u.toArray()))}addDcsHandler(a,d){return this.registerDcsHandler(a,d)}registerEscHandler(a,d){return this._core.registerEscHandler(a,d)}addEscHandler(a,d){return this.registerEscHandler(a,d)}registerOscHandler(a,d){return this._core.registerOscHandler(a,d)}addOscHandler(a,d){return this.registerOscHandler(a,d)}}},7090:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.UnicodeApi=void 0,i.UnicodeApi=class{constructor(a){this._core=a}register(a){this._core.unicodeService.register(a)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(a){this._core.unicodeService.activeVersion=a}}},744:function(S,i,a){var d=this&&this.__decorate||function(n,c,l,h){var m,y=arguments.length,C=y<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,l):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(n,c,l,h);else for(var L=n.length-1;L>=0;L--)(m=n[L])&&(C=(y<3?m(C):y>3?m(c,l,C):m(c,l))||C);return y>3&&C&&Object.defineProperty(c,l,C),C},v=this&&this.__param||function(n,c){return function(l,h){c(l,h,n)}};Object.defineProperty(i,"__esModule",{value:!0}),i.BufferService=i.MINIMUM_ROWS=i.MINIMUM_COLS=void 0;const u=a(8460),_=a(844),b=a(5295),w=a(2585);i.MINIMUM_COLS=2,i.MINIMUM_ROWS=1;let f=i.BufferService=class extends _.Disposable{get buffer(){return this.buffers.active}constructor(n){super(),this.isUserScrolling=!1,this._onResize=this.register(new u.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new u.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(n.rawOptions.cols||0,i.MINIMUM_COLS),this.rows=Math.max(n.rawOptions.rows||0,i.MINIMUM_ROWS),this.buffers=this.register(new b.BufferSet(n,this))}resize(n,c){this.cols=n,this.rows=c,this.buffers.resize(n,c),this._onResize.fire({cols:n,rows:c})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(n,c=!1){const l=this.buffer;let h;h=this._cachedBlankLine,h&&h.length===this.cols&&h.getFg(0)===n.fg&&h.getBg(0)===n.bg||(h=l.getBlankLine(n,c),this._cachedBlankLine=h),h.isWrapped=c;const m=l.ybase+l.scrollTop,y=l.ybase+l.scrollBottom;if(l.scrollTop===0){const C=l.lines.isFull;y===l.lines.length-1?C?l.lines.recycle().copyFrom(h):l.lines.push(h.clone()):l.lines.splice(y+1,0,h.clone()),C?this.isUserScrolling&&(l.ydisp=Math.max(l.ydisp-1,0)):(l.ybase++,this.isUserScrolling||l.ydisp++)}else{const C=y-m+1;l.lines.shiftElements(m+1,C-1,-1),l.lines.set(y,h.clone())}this.isUserScrolling||(l.ydisp=l.ybase),this._onScroll.fire(l.ydisp)}scrollLines(n,c,l){const h=this.buffer;if(n<0){if(h.ydisp===0)return;this.isUserScrolling=!0}else n+h.ydisp>=h.ybase&&(this.isUserScrolling=!1);const m=h.ydisp;h.ydisp=Math.max(Math.min(h.ydisp+n,h.ybase),0),m!==h.ydisp&&(c||this._onScroll.fire(h.ydisp))}};i.BufferService=f=d([v(0,w.IOptionsService)],f)},7994:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CharsetService=void 0,i.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(a){this.glevel=a,this.charset=this._charsets[a]}setgCharset(a,d){this._charsets[a]=d,this.glevel===a&&(this.charset=d)}}},1753:function(S,i,a){var d=this&&this.__decorate||function(h,m,y,C){var L,x=arguments.length,E=x<3?m:C===null?C=Object.getOwnPropertyDescriptor(m,y):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(h,m,y,C);else for(var k=h.length-1;k>=0;k--)(L=h[k])&&(E=(x<3?L(E):x>3?L(m,y,E):L(m,y))||E);return x>3&&E&&Object.defineProperty(m,y,E),E},v=this&&this.__param||function(h,m){return function(y,C){m(y,C,h)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CoreMouseService=void 0;const u=a(2585),_=a(8460),b=a(844),w={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:h=>h.button!==4&&h.action===1&&(h.ctrl=!1,h.alt=!1,h.shift=!1,!0)},VT200:{events:19,restrict:h=>h.action!==32},DRAG:{events:23,restrict:h=>h.action!==32||h.button!==3},ANY:{events:31,restrict:h=>!0}};function f(h,m){let y=(h.ctrl?16:0)|(h.shift?4:0)|(h.alt?8:0);return h.button===4?(y|=64,y|=h.action):(y|=3&h.button,4&h.button&&(y|=64),8&h.button&&(y|=128),h.action===32?y|=32:h.action!==0||m||(y|=3)),y}const n=String.fromCharCode,c={DEFAULT:h=>{const m=[f(h,!1)+32,h.col+32,h.row+32];return m[0]>255||m[1]>255||m[2]>255?"":`\x1B[M${n(m[0])}${n(m[1])}${n(m[2])}`},SGR:h=>{const m=h.action===0&&h.button!==4?"m":"M";return`\x1B[<${f(h,!0)};${h.col};${h.row}${m}`},SGR_PIXELS:h=>{const m=h.action===0&&h.button!==4?"m":"M";return`\x1B[<${f(h,!0)};${h.x};${h.y}${m}`}};let l=i.CoreMouseService=class extends b.Disposable{constructor(h,m){super(),this._bufferService=h,this._coreService=m,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new _.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const y of Object.keys(w))this.addProtocol(y,w[y]);for(const y of Object.keys(c))this.addEncoding(y,c[y]);this.reset()}addProtocol(h,m){this._protocols[h]=m}addEncoding(h,m){this._encodings[h]=m}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(h){if(!this._protocols[h])throw new Error(`unknown protocol "${h}"`);this._activeProtocol=h,this._onProtocolChange.fire(this._protocols[h].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(h){if(!this._encodings[h])throw new Error(`unknown encoding "${h}"`);this._activeEncoding=h}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(h){if(h.col<0||h.col>=this._bufferService.cols||h.row<0||h.row>=this._bufferService.rows||h.button===4&&h.action===32||h.button===3&&h.action!==32||h.button!==4&&(h.action===2||h.action===3)||(h.col++,h.row++,h.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,h,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(h))return!1;const m=this._encodings[this._activeEncoding](h);return m&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(m):this._coreService.triggerDataEvent(m,!0)),this._lastEvent=h,!0}explainEvents(h){return{down:!!(1&h),up:!!(2&h),drag:!!(4&h),move:!!(8&h),wheel:!!(16&h)}}_equalEvents(h,m,y){if(y){if(h.x!==m.x||h.y!==m.y)return!1}else if(h.col!==m.col||h.row!==m.row)return!1;return h.button===m.button&&h.action===m.action&&h.ctrl===m.ctrl&&h.alt===m.alt&&h.shift===m.shift}};i.CoreMouseService=l=d([v(0,u.IBufferService),v(1,u.ICoreService)],l)},6975:function(S,i,a){var d=this&&this.__decorate||function(l,h,m,y){var C,L=arguments.length,x=L<3?h:y===null?y=Object.getOwnPropertyDescriptor(h,m):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(l,h,m,y);else for(var E=l.length-1;E>=0;E--)(C=l[E])&&(x=(L<3?C(x):L>3?C(h,m,x):C(h,m))||x);return L>3&&x&&Object.defineProperty(h,m,x),x},v=this&&this.__param||function(l,h){return function(m,y){h(m,y,l)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CoreService=void 0;const u=a(1439),_=a(8460),b=a(844),w=a(2585),f=Object.freeze({insertMode:!1}),n=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let c=i.CoreService=class extends b.Disposable{constructor(l,h,m){super(),this._bufferService=l,this._logService=h,this._optionsService=m,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new _.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new _.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new _.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new _.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,u.clone)(f),this.decPrivateModes=(0,u.clone)(n)}reset(){this.modes=(0,u.clone)(f),this.decPrivateModes=(0,u.clone)(n)}triggerDataEvent(l,h=!1){if(this._optionsService.rawOptions.disableStdin)return;const m=this._bufferService.buffer;h&&this._optionsService.rawOptions.scrollOnUserInput&&m.ybase!==m.ydisp&&this._onRequestScrollToBottom.fire(),h&&this._onUserInput.fire(),this._logService.debug(`sending data "${l}"`,()=>l.split("").map(y=>y.charCodeAt(0))),this._onData.fire(l)}triggerBinaryEvent(l){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${l}"`,()=>l.split("").map(h=>h.charCodeAt(0))),this._onBinary.fire(l))}};i.CoreService=c=d([v(0,w.IBufferService),v(1,w.ILogService),v(2,w.IOptionsService)],c)},9074:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DecorationService=void 0;const d=a(8055),v=a(8460),u=a(844),_=a(6106);let b=0,w=0;class f extends u.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new _.SortedList(l=>l==null?void 0:l.marker.line),this._onDecorationRegistered=this.register(new v.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new v.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,u.toDisposable)(()=>this.reset()))}registerDecoration(l){if(l.marker.isDisposed)return;const h=new n(l);if(h){const m=h.marker.onDispose(()=>h.dispose());h.onDispose(()=>{h&&(this._decorations.delete(h)&&this._onDecorationRemoved.fire(h),m.dispose())}),this._decorations.insert(h),this._onDecorationRegistered.fire(h)}return h}reset(){for(const l of this._decorations.values())l.dispose();this._decorations.clear()}*getDecorationsAtCell(l,h,m){var y,C,L;let x=0,E=0;for(const k of this._decorations.getKeyIterator(h))x=(y=k.options.x)!==null&&y!==void 0?y:0,E=x+((C=k.options.width)!==null&&C!==void 0?C:1),l>=x&&l<E&&(!m||((L=k.options.layer)!==null&&L!==void 0?L:"bottom")===m)&&(yield k)}forEachDecorationAtCell(l,h,m,y){this._decorations.forEachByKey(h,C=>{var L,x,E;b=(L=C.options.x)!==null&&L!==void 0?L:0,w=b+((x=C.options.width)!==null&&x!==void 0?x:1),l>=b&&l<w&&(!m||((E=C.options.layer)!==null&&E!==void 0?E:"bottom")===m)&&y(C)})}}i.DecorationService=f;class n extends u.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=d.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=d.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(l){super(),this.options=l,this.onRenderEmitter=this.register(new v.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new v.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=l.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.InstantiationService=i.ServiceCollection=void 0;const d=a(2585),v=a(8343);class u{constructor(...b){this._entries=new Map;for(const[w,f]of b)this.set(w,f)}set(b,w){const f=this._entries.get(b);return this._entries.set(b,w),f}forEach(b){for(const[w,f]of this._entries.entries())b(w,f)}has(b){return this._entries.has(b)}get(b){return this._entries.get(b)}}i.ServiceCollection=u,i.InstantiationService=class{constructor(){this._services=new u,this._services.set(d.IInstantiationService,this)}setService(_,b){this._services.set(_,b)}getService(_){return this._services.get(_)}createInstance(_,...b){const w=(0,v.getServiceDependencies)(_).sort((c,l)=>c.index-l.index),f=[];for(const c of w){const l=this._services.get(c.id);if(!l)throw new Error(`[createInstance] ${_.name} depends on UNKNOWN service ${c.id}.`);f.push(l)}const n=w.length>0?w[0].index:b.length;if(b.length!==n)throw new Error(`[createInstance] First service dependency of ${_.name} at position ${n+1} conflicts with ${b.length} static arguments`);return new _(...b,...f)}}},7866:function(S,i,a){var d=this&&this.__decorate||function(n,c,l,h){var m,y=arguments.length,C=y<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,l):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(n,c,l,h);else for(var L=n.length-1;L>=0;L--)(m=n[L])&&(C=(y<3?m(C):y>3?m(c,l,C):m(c,l))||C);return y>3&&C&&Object.defineProperty(c,l,C),C},v=this&&this.__param||function(n,c){return function(l,h){c(l,h,n)}};Object.defineProperty(i,"__esModule",{value:!0}),i.traceCall=i.setTraceLogger=i.LogService=void 0;const u=a(844),_=a(2585),b={trace:_.LogLevelEnum.TRACE,debug:_.LogLevelEnum.DEBUG,info:_.LogLevelEnum.INFO,warn:_.LogLevelEnum.WARN,error:_.LogLevelEnum.ERROR,off:_.LogLevelEnum.OFF};let w,f=i.LogService=class extends u.Disposable{get logLevel(){return this._logLevel}constructor(n){super(),this._optionsService=n,this._logLevel=_.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),w=this}_updateLogLevel(){this._logLevel=b[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(n){for(let c=0;c<n.length;c++)typeof n[c]=="function"&&(n[c]=n[c]())}_log(n,c,l){this._evalLazyOptionalParams(l),n.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+c,...l)}trace(n,...c){var l,h;this._logLevel<=_.LogLevelEnum.TRACE&&this._log((h=(l=this._optionsService.options.logger)===null||l===void 0?void 0:l.trace.bind(this._optionsService.options.logger))!==null&&h!==void 0?h:console.log,n,c)}debug(n,...c){var l,h;this._logLevel<=_.LogLevelEnum.DEBUG&&this._log((h=(l=this._optionsService.options.logger)===null||l===void 0?void 0:l.debug.bind(this._optionsService.options.logger))!==null&&h!==void 0?h:console.log,n,c)}info(n,...c){var l,h;this._logLevel<=_.LogLevelEnum.INFO&&this._log((h=(l=this._optionsService.options.logger)===null||l===void 0?void 0:l.info.bind(this._optionsService.options.logger))!==null&&h!==void 0?h:console.info,n,c)}warn(n,...c){var l,h;this._logLevel<=_.LogLevelEnum.WARN&&this._log((h=(l=this._optionsService.options.logger)===null||l===void 0?void 0:l.warn.bind(this._optionsService.options.logger))!==null&&h!==void 0?h:console.warn,n,c)}error(n,...c){var l,h;this._logLevel<=_.LogLevelEnum.ERROR&&this._log((h=(l=this._optionsService.options.logger)===null||l===void 0?void 0:l.error.bind(this._optionsService.options.logger))!==null&&h!==void 0?h:console.error,n,c)}};i.LogService=f=d([v(0,_.IOptionsService)],f),i.setTraceLogger=function(n){w=n},i.traceCall=function(n,c,l){if(typeof l.value!="function")throw new Error("not supported");const h=l.value;l.value=function(...m){if(w.logLevel!==_.LogLevelEnum.TRACE)return h.apply(this,m);w.trace(`GlyphRenderer#${h.name}(${m.map(C=>JSON.stringify(C)).join(", ")})`);const y=h.apply(this,m);return w.trace(`GlyphRenderer#${h.name} return`,y),y}}},7302:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.OptionsService=i.DEFAULT_OPTIONS=void 0;const d=a(8460),v=a(844),u=a(6114);i.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:u.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const _=["normal","bold","100","200","300","400","500","600","700","800","900"];class b extends v.Disposable{constructor(f){super(),this._onOptionChange=this.register(new d.EventEmitter),this.onOptionChange=this._onOptionChange.event;const n=Object.assign({},i.DEFAULT_OPTIONS);for(const c in f)if(c in n)try{const l=f[c];n[c]=this._sanitizeAndValidateOption(c,l)}catch(l){console.error(l)}this.rawOptions=n,this.options=Object.assign({},n),this._setupOptions()}onSpecificOptionChange(f,n){return this.onOptionChange(c=>{c===f&&n(this.rawOptions[f])})}onMultipleOptionChange(f,n){return this.onOptionChange(c=>{f.indexOf(c)!==-1&&n()})}_setupOptions(){const f=c=>{if(!(c in i.DEFAULT_OPTIONS))throw new Error(`No option with key "${c}"`);return this.rawOptions[c]},n=(c,l)=>{if(!(c in i.DEFAULT_OPTIONS))throw new Error(`No option with key "${c}"`);l=this._sanitizeAndValidateOption(c,l),this.rawOptions[c]!==l&&(this.rawOptions[c]=l,this._onOptionChange.fire(c))};for(const c in this.rawOptions){const l={get:f.bind(this,c),set:n.bind(this,c)};Object.defineProperty(this.options,c,l)}}_sanitizeAndValidateOption(f,n){switch(f){case"cursorStyle":if(n||(n=i.DEFAULT_OPTIONS[f]),!function(c){return c==="block"||c==="underline"||c==="bar"}(n))throw new Error(`"${n}" is not a valid value for ${f}`);break;case"wordSeparator":n||(n=i.DEFAULT_OPTIONS[f]);break;case"fontWeight":case"fontWeightBold":if(typeof n=="number"&&1<=n&&n<=1e3)break;n=_.includes(n)?n:i.DEFAULT_OPTIONS[f];break;case"cursorWidth":n=Math.floor(n);case"lineHeight":case"tabStopWidth":if(n<1)throw new Error(`${f} cannot be less than 1, value: ${n}`);break;case"minimumContrastRatio":n=Math.max(1,Math.min(21,Math.round(10*n)/10));break;case"scrollback":if((n=Math.min(n,4294967295))<0)throw new Error(`${f} cannot be less than 0, value: ${n}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(n<=0)throw new Error(`${f} cannot be less than or equal to 0, value: ${n}`);break;case"rows":case"cols":if(!n&&n!==0)throw new Error(`${f} must be numeric, value: ${n}`);break;case"windowsPty":n=n??{}}return n}}i.OptionsService=b},2660:function(S,i,a){var d=this&&this.__decorate||function(b,w,f,n){var c,l=arguments.length,h=l<3?w:n===null?n=Object.getOwnPropertyDescriptor(w,f):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(b,w,f,n);else for(var m=b.length-1;m>=0;m--)(c=b[m])&&(h=(l<3?c(h):l>3?c(w,f,h):c(w,f))||h);return l>3&&h&&Object.defineProperty(w,f,h),h},v=this&&this.__param||function(b,w){return function(f,n){w(f,n,b)}};Object.defineProperty(i,"__esModule",{value:!0}),i.OscLinkService=void 0;const u=a(2585);let _=i.OscLinkService=class{constructor(b){this._bufferService=b,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(b){const w=this._bufferService.buffer;if(b.id===void 0){const m=w.addMarker(w.ybase+w.y),y={data:b,id:this._nextId++,lines:[m]};return m.onDispose(()=>this._removeMarkerFromLink(y,m)),this._dataByLinkId.set(y.id,y),y.id}const f=b,n=this._getEntryIdKey(f),c=this._entriesWithId.get(n);if(c)return this.addLineToLink(c.id,w.ybase+w.y),c.id;const l=w.addMarker(w.ybase+w.y),h={id:this._nextId++,key:this._getEntryIdKey(f),data:f,lines:[l]};return l.onDispose(()=>this._removeMarkerFromLink(h,l)),this._entriesWithId.set(h.key,h),this._dataByLinkId.set(h.id,h),h.id}addLineToLink(b,w){const f=this._dataByLinkId.get(b);if(f&&f.lines.every(n=>n.line!==w)){const n=this._bufferService.buffer.addMarker(w);f.lines.push(n),n.onDispose(()=>this._removeMarkerFromLink(f,n))}}getLinkData(b){var w;return(w=this._dataByLinkId.get(b))===null||w===void 0?void 0:w.data}_getEntryIdKey(b){return`${b.id};;${b.uri}`}_removeMarkerFromLink(b,w){const f=b.lines.indexOf(w);f!==-1&&(b.lines.splice(f,1),b.lines.length===0&&(b.data.id!==void 0&&this._entriesWithId.delete(b.key),this._dataByLinkId.delete(b.id)))}};i.OscLinkService=_=d([v(0,u.IBufferService)],_)},8343:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createDecorator=i.getServiceDependencies=i.serviceRegistry=void 0;const a="di$target",d="di$dependencies";i.serviceRegistry=new Map,i.getServiceDependencies=function(v){return v[d]||[]},i.createDecorator=function(v){if(i.serviceRegistry.has(v))return i.serviceRegistry.get(v);const u=function(_,b,w){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(f,n,c){n[a]===n?n[d].push({id:f,index:c}):(n[d]=[{id:f,index:c}],n[a]=n)})(u,_,w)};return u.toString=()=>v,i.serviceRegistry.set(v,u),u}},2585:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.IDecorationService=i.IUnicodeService=i.IOscLinkService=i.IOptionsService=i.ILogService=i.LogLevelEnum=i.IInstantiationService=i.ICharsetService=i.ICoreService=i.ICoreMouseService=i.IBufferService=void 0;const d=a(8343);var v;i.IBufferService=(0,d.createDecorator)("BufferService"),i.ICoreMouseService=(0,d.createDecorator)("CoreMouseService"),i.ICoreService=(0,d.createDecorator)("CoreService"),i.ICharsetService=(0,d.createDecorator)("CharsetService"),i.IInstantiationService=(0,d.createDecorator)("InstantiationService"),function(u){u[u.TRACE=0]="TRACE",u[u.DEBUG=1]="DEBUG",u[u.INFO=2]="INFO",u[u.WARN=3]="WARN",u[u.ERROR=4]="ERROR",u[u.OFF=5]="OFF"}(v||(i.LogLevelEnum=v={})),i.ILogService=(0,d.createDecorator)("LogService"),i.IOptionsService=(0,d.createDecorator)("OptionsService"),i.IOscLinkService=(0,d.createDecorator)("OscLinkService"),i.IUnicodeService=(0,d.createDecorator)("UnicodeService"),i.IDecorationService=(0,d.createDecorator)("DecorationService")},1480:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.UnicodeService=void 0;const d=a(8460),v=a(225);i.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new d.EventEmitter,this.onChange=this._onChange.event;const u=new v.UnicodeV6;this.register(u),this._active=u.version,this._activeProvider=u}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(u){if(!this._providers[u])throw new Error(`unknown Unicode version "${u}"`);this._active=u,this._activeProvider=this._providers[u],this._onChange.fire(u)}register(u){this._providers[u.version]=u}wcwidth(u){return this._activeProvider.wcwidth(u)}getStringCellWidth(u){let _=0;const b=u.length;for(let w=0;w<b;++w){let f=u.charCodeAt(w);if(55296<=f&&f<=56319){if(++w>=b)return _+this.wcwidth(f);const n=u.charCodeAt(w);56320<=n&&n<=57343?f=1024*(f-55296)+n-56320+65536:_+=this.wcwidth(n)}_+=this.wcwidth(f)}return _}}}},s={};function o(S){var i=s[S];if(i!==void 0)return i.exports;var a=s[S]={exports:{}};return r[S].call(a.exports,a,a.exports,o),a.exports}var g={};return(()=>{var S=g;Object.defineProperty(S,"__esModule",{value:!0}),S.Terminal=void 0;const i=o(9042),a=o(3236),d=o(844),v=o(5741),u=o(8285),_=o(7975),b=o(7090),w=["cols","rows"];class f extends d.Disposable{constructor(c){super(),this._core=this.register(new a.Terminal(c)),this._addonManager=this.register(new v.AddonManager),this._publicOptions=Object.assign({},this._core.options);const l=m=>this._core.options[m],h=(m,y)=>{this._checkReadonlyOptions(m),this._core.options[m]=y};for(const m in this._core.options){const y={get:l.bind(this,m),set:h.bind(this,m)};Object.defineProperty(this._publicOptions,m,y)}}_checkReadonlyOptions(c){if(w.includes(c))throw new Error(`Option "${c}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new _.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new b.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new u.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const c=this._core.coreService.decPrivateModes;let l="none";switch(this._core.coreMouseService.activeProtocol){case"X10":l="x10";break;case"VT200":l="vt200";break;case"DRAG":l="drag";break;case"ANY":l="any"}return{applicationCursorKeysMode:c.applicationCursorKeys,applicationKeypadMode:c.applicationKeypad,bracketedPasteMode:c.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:l,originMode:c.origin,reverseWraparoundMode:c.reverseWraparound,sendFocusMode:c.sendFocus,wraparoundMode:c.wraparound}}get options(){return this._publicOptions}set options(c){for(const l in c)this._publicOptions[l]=c[l]}blur(){this._core.blur()}focus(){this._core.focus()}resize(c,l){this._verifyIntegers(c,l),this._core.resize(c,l)}open(c){this._core.open(c)}attachCustomKeyEventHandler(c){this._core.attachCustomKeyEventHandler(c)}registerLinkProvider(c){return this._core.registerLinkProvider(c)}registerCharacterJoiner(c){return this._checkProposedApi(),this._core.registerCharacterJoiner(c)}deregisterCharacterJoiner(c){this._checkProposedApi(),this._core.deregisterCharacterJoiner(c)}registerMarker(c=0){return this._verifyIntegers(c),this._core.registerMarker(c)}registerDecoration(c){var l,h,m;return this._checkProposedApi(),this._verifyPositiveIntegers((l=c.x)!==null&&l!==void 0?l:0,(h=c.width)!==null&&h!==void 0?h:0,(m=c.height)!==null&&m!==void 0?m:0),this._core.registerDecoration(c)}hasSelection(){return this._core.hasSelection()}select(c,l,h){this._verifyIntegers(c,l,h),this._core.select(c,l,h)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(c,l){this._verifyIntegers(c,l),this._core.selectLines(c,l)}dispose(){super.dispose()}scrollLines(c){this._verifyIntegers(c),this._core.scrollLines(c)}scrollPages(c){this._verifyIntegers(c),this._core.scrollPages(c)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(c){this._verifyIntegers(c),this._core.scrollToLine(c)}clear(){this._core.clear()}write(c,l){this._core.write(c,l)}writeln(c,l){this._core.write(c),this._core.write(`\r
`,l)}paste(c){this._core.paste(c)}refresh(c,l){this._verifyIntegers(c,l),this._core.refresh(c,l)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(c){this._addonManager.loadAddon(this,c)}static get strings(){return i}_verifyIntegers(...c){for(const l of c)if(l===1/0||isNaN(l)||l%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...c){for(const l of c)if(l&&(l===1/0||isNaN(l)||l%1!=0||l<0))throw new Error("This API only accepts positive integers")}}S.Terminal=f})(),g})())})(kf);var ov=kf.exports,Lf={exports:{}};(function(e,t){(function(r,s){e.exports=s()})(self,()=>(()=>{var r={};return(()=>{var s=r;Object.defineProperty(s,"__esModule",{value:!0}),s.FitAddon=void 0,s.FitAddon=class{activate(o){this._terminal=o}dispose(){}fit(){const o=this.proposeDimensions();if(!o||!this._terminal||isNaN(o.cols)||isNaN(o.rows))return;const g=this._terminal._core;this._terminal.rows===o.rows&&this._terminal.cols===o.cols||(g._renderService.clear(),this._terminal.resize(o.cols,o.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const o=this._terminal._core,g=o._renderService.dimensions;if(g.css.cell.width===0||g.css.cell.height===0)return;const S=this._terminal.options.scrollback===0?0:o.viewport.scrollBarWidth,i=window.getComputedStyle(this._terminal.element.parentElement),a=parseInt(i.getPropertyValue("height")),d=Math.max(0,parseInt(i.getPropertyValue("width"))),v=window.getComputedStyle(this._terminal.element),u=a-(parseInt(v.getPropertyValue("padding-top"))+parseInt(v.getPropertyValue("padding-bottom"))),_=d-(parseInt(v.getPropertyValue("padding-right"))+parseInt(v.getPropertyValue("padding-left")))-S;return{cols:Math.max(2,Math.floor(_/g.css.cell.width)),rows:Math.max(1,Math.floor(u/g.css.cell.height))}}}})(),r})())})(Lf);var av=Lf.exports,Rf={exports:{}};(function(e,t){(function(r,s){e.exports=s()})(self,()=>(()=>{var r={965:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GlyphRenderer=void 0;const d=a(374),v=a(509),u=a(855),_=a(859),b=a(381),w=11,f=w*Float32Array.BYTES_PER_ELEMENT;let n,c=0,l=0,h=0;class m extends _.Disposable{constructor(C,L,x,E){super(),this._terminal=C,this._gl=L,this._dimensions=x,this._optionsService=E,this._activeBuffer=0,this._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};const k=this._gl;v.TextureAtlas.maxAtlasPages===void 0&&(v.TextureAtlas.maxAtlasPages=Math.min(32,(0,d.throwIfFalsy)(k.getParameter(k.MAX_TEXTURE_IMAGE_UNITS))),v.TextureAtlas.maxTextureSize=(0,d.throwIfFalsy)(k.getParameter(k.MAX_TEXTURE_SIZE))),this._program=(0,d.throwIfFalsy)((0,b.createProgram)(k,`#version 300 es
layout (location = 0) in vec2 a_unitquad;
layout (location = 1) in vec2 a_cellpos;
layout (location = 2) in vec2 a_offset;
layout (location = 3) in vec2 a_size;
layout (location = 4) in float a_texpage;
layout (location = 5) in vec2 a_texcoord;
layout (location = 6) in vec2 a_texsize;

uniform mat4 u_projection;
uniform vec2 u_resolution;

out vec2 v_texcoord;
flat out int v_texpage;

void main() {
  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_texpage = int(a_texpage);
  v_texcoord = a_texcoord + a_unitquad * a_texsize;
}`,function(F){let H="";for(let R=1;R<F;R++)H+=` else if (v_texpage == ${R}) { outColor = texture(u_texture[${R}], v_texcoord); }`;return`#version 300 es
precision lowp float;

in vec2 v_texcoord;
flat in int v_texpage;

uniform sampler2D u_texture[${F}];

out vec4 outColor;

void main() {
  if (v_texpage == 0) {
    outColor = texture(u_texture[0], v_texcoord);
  } ${H}
}`}(v.TextureAtlas.maxAtlasPages))),this.register((0,_.toDisposable)(()=>k.deleteProgram(this._program))),this._projectionLocation=(0,d.throwIfFalsy)(k.getUniformLocation(this._program,"u_projection")),this._resolutionLocation=(0,d.throwIfFalsy)(k.getUniformLocation(this._program,"u_resolution")),this._textureLocation=(0,d.throwIfFalsy)(k.getUniformLocation(this._program,"u_texture")),this._vertexArrayObject=k.createVertexArray(),k.bindVertexArray(this._vertexArrayObject);const T=new Float32Array([0,0,1,0,0,1,1,1]),A=k.createBuffer();this.register((0,_.toDisposable)(()=>k.deleteBuffer(A))),k.bindBuffer(k.ARRAY_BUFFER,A),k.bufferData(k.ARRAY_BUFFER,T,k.STATIC_DRAW),k.enableVertexAttribArray(0),k.vertexAttribPointer(0,2,this._gl.FLOAT,!1,0,0);const D=new Uint8Array([0,1,2,3]),P=k.createBuffer();this.register((0,_.toDisposable)(()=>k.deleteBuffer(P))),k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,P),k.bufferData(k.ELEMENT_ARRAY_BUFFER,D,k.STATIC_DRAW),this._attributesBuffer=(0,d.throwIfFalsy)(k.createBuffer()),this.register((0,_.toDisposable)(()=>k.deleteBuffer(this._attributesBuffer))),k.bindBuffer(k.ARRAY_BUFFER,this._attributesBuffer),k.enableVertexAttribArray(2),k.vertexAttribPointer(2,2,k.FLOAT,!1,f,0),k.vertexAttribDivisor(2,1),k.enableVertexAttribArray(3),k.vertexAttribPointer(3,2,k.FLOAT,!1,f,2*Float32Array.BYTES_PER_ELEMENT),k.vertexAttribDivisor(3,1),k.enableVertexAttribArray(4),k.vertexAttribPointer(4,1,k.FLOAT,!1,f,4*Float32Array.BYTES_PER_ELEMENT),k.vertexAttribDivisor(4,1),k.enableVertexAttribArray(5),k.vertexAttribPointer(5,2,k.FLOAT,!1,f,5*Float32Array.BYTES_PER_ELEMENT),k.vertexAttribDivisor(5,1),k.enableVertexAttribArray(6),k.vertexAttribPointer(6,2,k.FLOAT,!1,f,7*Float32Array.BYTES_PER_ELEMENT),k.vertexAttribDivisor(6,1),k.enableVertexAttribArray(1),k.vertexAttribPointer(1,2,k.FLOAT,!1,f,9*Float32Array.BYTES_PER_ELEMENT),k.vertexAttribDivisor(1,1),k.useProgram(this._program);const O=new Int32Array(v.TextureAtlas.maxAtlasPages);for(let F=0;F<v.TextureAtlas.maxAtlasPages;F++)O[F]=F;k.uniform1iv(this._textureLocation,O),k.uniformMatrix4fv(this._projectionLocation,!1,b.PROJECTION_MATRIX),this._atlasTextures=[];for(let F=0;F<v.TextureAtlas.maxAtlasPages;F++){const H=new b.GLTexture((0,d.throwIfFalsy)(k.createTexture()));this.register((0,_.toDisposable)(()=>k.deleteTexture(H.texture))),k.activeTexture(k.TEXTURE0+F),k.bindTexture(k.TEXTURE_2D,H.texture),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE),k.texImage2D(k.TEXTURE_2D,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),this._atlasTextures[F]=H}k.enable(k.BLEND),k.blendFunc(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA),this.handleResize()}beginFrame(){return!this._atlas||this._atlas.beginFrame()}updateCell(C,L,x,E,k,T,A,D,P){this._updateCell(this._vertices.attributes,C,L,x,E,k,T,A,D,P)}_updateCell(C,L,x,E,k,T,A,D,P,O){c=(x*this._terminal.cols+L)*w,E!==u.NULL_CELL_CODE&&E!==void 0?this._atlas&&(n=D&&D.length>1?this._atlas.getRasterizedGlyphCombinedChar(D,k,T,A,!1):this._atlas.getRasterizedGlyph(E,k,T,A,!1),l=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),k!==O&&n.offset.x>l?(h=n.offset.x-l,C[c]=-(n.offset.x-h)+this._dimensions.device.char.left,C[c+1]=-n.offset.y+this._dimensions.device.char.top,C[c+2]=(n.size.x-h)/this._dimensions.device.canvas.width,C[c+3]=n.size.y/this._dimensions.device.canvas.height,C[c+4]=n.texturePage,C[c+5]=n.texturePositionClipSpace.x+h/this._atlas.pages[n.texturePage].canvas.width,C[c+6]=n.texturePositionClipSpace.y,C[c+7]=n.sizeClipSpace.x-h/this._atlas.pages[n.texturePage].canvas.width,C[c+8]=n.sizeClipSpace.y):(C[c]=-n.offset.x+this._dimensions.device.char.left,C[c+1]=-n.offset.y+this._dimensions.device.char.top,C[c+2]=n.size.x/this._dimensions.device.canvas.width,C[c+3]=n.size.y/this._dimensions.device.canvas.height,C[c+4]=n.texturePage,C[c+5]=n.texturePositionClipSpace.x,C[c+6]=n.texturePositionClipSpace.y,C[c+7]=n.sizeClipSpace.x,C[c+8]=n.sizeClipSpace.y),this._optionsService.rawOptions.rescaleOverlappingGlyphs&&(0,d.allowRescaling)(E,P,n.size.x,this._dimensions.device.cell.width)&&(C[c+2]=(this._dimensions.device.cell.width-1)/this._dimensions.device.canvas.width)):C.fill(0,c,c+w-1-2)}clear(){const C=this._terminal,L=C.cols*C.rows*w;this._vertices.count!==L?this._vertices.attributes=new Float32Array(L):this._vertices.attributes.fill(0);let x=0;for(;x<this._vertices.attributesBuffers.length;x++)this._vertices.count!==L?this._vertices.attributesBuffers[x]=new Float32Array(L):this._vertices.attributesBuffers[x].fill(0);this._vertices.count=L,x=0;for(let E=0;E<C.rows;E++)for(let k=0;k<C.cols;k++)this._vertices.attributes[x+9]=k/C.cols,this._vertices.attributes[x+10]=E/C.rows,x+=w}handleResize(){const C=this._gl;C.useProgram(this._program),C.viewport(0,0,C.canvas.width,C.canvas.height),C.uniform2f(this._resolutionLocation,C.canvas.width,C.canvas.height),this.clear()}render(C){if(!this._atlas)return;const L=this._gl;L.useProgram(this._program),L.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;const x=this._vertices.attributesBuffers[this._activeBuffer];let E=0;for(let k=0;k<C.lineLengths.length;k++){const T=k*this._terminal.cols*w,A=this._vertices.attributes.subarray(T,T+C.lineLengths[k]*w);x.set(A,E),E+=A.length}L.bindBuffer(L.ARRAY_BUFFER,this._attributesBuffer),L.bufferData(L.ARRAY_BUFFER,x.subarray(0,E),L.STREAM_DRAW);for(let k=0;k<this._atlas.pages.length;k++)this._atlas.pages[k].version!==this._atlasTextures[k].version&&this._bindAtlasPageTexture(L,this._atlas,k);L.drawElementsInstanced(L.TRIANGLE_STRIP,4,L.UNSIGNED_BYTE,0,E/w)}setAtlas(C){this._atlas=C;for(const L of this._atlasTextures)L.version=-1}_bindAtlasPageTexture(C,L,x){C.activeTexture(C.TEXTURE0+x),C.bindTexture(C.TEXTURE_2D,this._atlasTextures[x].texture),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,C.CLAMP_TO_EDGE),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,C.CLAMP_TO_EDGE),C.texImage2D(C.TEXTURE_2D,0,C.RGBA,C.RGBA,C.UNSIGNED_BYTE,L.pages[x].canvas),C.generateMipmap(C.TEXTURE_2D),this._atlasTextures[x].version=L.pages[x].version}setDimensions(C){this._dimensions=C}}i.GlyphRenderer=m},742:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.RectangleRenderer=void 0;const d=a(374),v=a(859),u=a(310),_=a(381),b=8*Float32Array.BYTES_PER_ELEMENT;class w{constructor(){this.attributes=new Float32Array(160),this.count=0}}let f=0,n=0,c=0,l=0,h=0,m=0,y=0;class C extends v.Disposable{constructor(x,E,k,T){super(),this._terminal=x,this._gl=E,this._dimensions=k,this._themeService=T,this._vertices=new w,this._verticesCursor=new w;const A=this._gl;this._program=(0,d.throwIfFalsy)((0,_.createProgram)(A,`#version 300 es
layout (location = 0) in vec2 a_position;
layout (location = 1) in vec2 a_size;
layout (location = 2) in vec4 a_color;
layout (location = 3) in vec2 a_unitquad;

uniform mat4 u_projection;

out vec4 v_color;

void main() {
  vec2 zeroToOne = a_position + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_color = a_color;
}`,`#version 300 es
precision lowp float;

in vec4 v_color;

out vec4 outColor;

void main() {
  outColor = v_color;
}`)),this.register((0,v.toDisposable)(()=>A.deleteProgram(this._program))),this._projectionLocation=(0,d.throwIfFalsy)(A.getUniformLocation(this._program,"u_projection")),this._vertexArrayObject=A.createVertexArray(),A.bindVertexArray(this._vertexArrayObject);const D=new Float32Array([0,0,1,0,0,1,1,1]),P=A.createBuffer();this.register((0,v.toDisposable)(()=>A.deleteBuffer(P))),A.bindBuffer(A.ARRAY_BUFFER,P),A.bufferData(A.ARRAY_BUFFER,D,A.STATIC_DRAW),A.enableVertexAttribArray(3),A.vertexAttribPointer(3,2,this._gl.FLOAT,!1,0,0);const O=new Uint8Array([0,1,2,3]),F=A.createBuffer();this.register((0,v.toDisposable)(()=>A.deleteBuffer(F))),A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,F),A.bufferData(A.ELEMENT_ARRAY_BUFFER,O,A.STATIC_DRAW),this._attributesBuffer=(0,d.throwIfFalsy)(A.createBuffer()),this.register((0,v.toDisposable)(()=>A.deleteBuffer(this._attributesBuffer))),A.bindBuffer(A.ARRAY_BUFFER,this._attributesBuffer),A.enableVertexAttribArray(0),A.vertexAttribPointer(0,2,A.FLOAT,!1,b,0),A.vertexAttribDivisor(0,1),A.enableVertexAttribArray(1),A.vertexAttribPointer(1,2,A.FLOAT,!1,b,2*Float32Array.BYTES_PER_ELEMENT),A.vertexAttribDivisor(1,1),A.enableVertexAttribArray(2),A.vertexAttribPointer(2,4,A.FLOAT,!1,b,4*Float32Array.BYTES_PER_ELEMENT),A.vertexAttribDivisor(2,1),this._updateCachedColors(T.colors),this.register(this._themeService.onChangeColors(H=>{this._updateCachedColors(H),this._updateViewportRectangle()}))}renderBackgrounds(){this._renderVertices(this._vertices)}renderCursor(){this._renderVertices(this._verticesCursor)}_renderVertices(x){const E=this._gl;E.useProgram(this._program),E.bindVertexArray(this._vertexArrayObject),E.uniformMatrix4fv(this._projectionLocation,!1,_.PROJECTION_MATRIX),E.bindBuffer(E.ARRAY_BUFFER,this._attributesBuffer),E.bufferData(E.ARRAY_BUFFER,x.attributes,E.DYNAMIC_DRAW),E.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,E.UNSIGNED_BYTE,0,x.count)}handleResize(){this._updateViewportRectangle()}setDimensions(x){this._dimensions=x}_updateCachedColors(x){this._bgFloat=this._colorToFloat32Array(x.background),this._cursorFloat=this._colorToFloat32Array(x.cursor)}_updateViewportRectangle(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}updateBackgrounds(x){const E=this._terminal,k=this._vertices;let T,A,D,P,O,F,H,R,j,M,B,$=1;for(T=0;T<E.rows;T++){for(D=-1,P=0,O=0,F=!1,A=0;A<E.cols;A++)H=(T*E.cols+A)*u.RENDER_MODEL_INDICIES_PER_CELL,R=x.cells[H+u.RENDER_MODEL_BG_OFFSET],j=x.cells[H+u.RENDER_MODEL_FG_OFFSET],M=!!(67108864&j),(R!==P||j!==O&&(F||M))&&((P!==0||F&&O!==0)&&(B=8*$++,this._updateRectangle(k,B,O,P,D,A,T)),D=A,P=R,O=j,F=M);(P!==0||F&&O!==0)&&(B=8*$++,this._updateRectangle(k,B,O,P,D,E.cols,T))}k.count=$}updateCursor(x){const E=this._verticesCursor,k=x.cursor;if(!k||k.style==="block")return void(E.count=0);let T,A=0;k.style!=="bar"&&k.style!=="outline"||(T=8*A++,this._addRectangleFloat(E.attributes,T,k.x*this._dimensions.device.cell.width,k.y*this._dimensions.device.cell.height,k.style==="bar"?k.dpr*k.cursorWidth:k.dpr,this._dimensions.device.cell.height,this._cursorFloat)),k.style!=="underline"&&k.style!=="outline"||(T=8*A++,this._addRectangleFloat(E.attributes,T,k.x*this._dimensions.device.cell.width,(k.y+1)*this._dimensions.device.cell.height-k.dpr,k.width*this._dimensions.device.cell.width,k.dpr,this._cursorFloat)),k.style==="outline"&&(T=8*A++,this._addRectangleFloat(E.attributes,T,k.x*this._dimensions.device.cell.width,k.y*this._dimensions.device.cell.height,k.width*this._dimensions.device.cell.width,k.dpr,this._cursorFloat),T=8*A++,this._addRectangleFloat(E.attributes,T,(k.x+k.width)*this._dimensions.device.cell.width-k.dpr,k.y*this._dimensions.device.cell.height,k.dpr,this._dimensions.device.cell.height,this._cursorFloat)),E.count=A}_updateRectangle(x,E,k,T,A,D,P){if(67108864&k)switch(50331648&k){case 16777216:case 33554432:f=this._themeService.colors.ansi[255&k].rgba;break;case 50331648:f=(16777215&k)<<8;break;default:f=this._themeService.colors.foreground.rgba}else switch(50331648&T){case 16777216:case 33554432:f=this._themeService.colors.ansi[255&T].rgba;break;case 50331648:f=(16777215&T)<<8;break;default:f=this._themeService.colors.background.rgba}x.attributes.length<E+4&&(x.attributes=(0,_.expandFloat32Array)(x.attributes,this._terminal.rows*this._terminal.cols*8)),n=A*this._dimensions.device.cell.width,c=P*this._dimensions.device.cell.height,l=(f>>24&255)/255,h=(f>>16&255)/255,m=(f>>8&255)/255,y=1,this._addRectangle(x.attributes,E,n,c,(D-A)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,l,h,m,y)}_addRectangle(x,E,k,T,A,D,P,O,F,H){x[E]=k/this._dimensions.device.canvas.width,x[E+1]=T/this._dimensions.device.canvas.height,x[E+2]=A/this._dimensions.device.canvas.width,x[E+3]=D/this._dimensions.device.canvas.height,x[E+4]=P,x[E+5]=O,x[E+6]=F,x[E+7]=H}_addRectangleFloat(x,E,k,T,A,D,P){x[E]=k/this._dimensions.device.canvas.width,x[E+1]=T/this._dimensions.device.canvas.height,x[E+2]=A/this._dimensions.device.canvas.width,x[E+3]=D/this._dimensions.device.canvas.height,x[E+4]=P[0],x[E+5]=P[1],x[E+6]=P[2],x[E+7]=P[3]}_colorToFloat32Array(x){return new Float32Array([(x.rgba>>24&255)/255,(x.rgba>>16&255)/255,(x.rgba>>8&255)/255,(255&x.rgba)/255])}}i.RectangleRenderer=C},310:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.RenderModel=i.COMBINED_CHAR_BIT_MASK=i.RENDER_MODEL_EXT_OFFSET=i.RENDER_MODEL_FG_OFFSET=i.RENDER_MODEL_BG_OFFSET=i.RENDER_MODEL_INDICIES_PER_CELL=void 0;const d=a(296);i.RENDER_MODEL_INDICIES_PER_CELL=4,i.RENDER_MODEL_BG_OFFSET=1,i.RENDER_MODEL_FG_OFFSET=2,i.RENDER_MODEL_EXT_OFFSET=3,i.COMBINED_CHAR_BIT_MASK=2147483648,i.RenderModel=class{constructor(){this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=(0,d.createSelectionRenderModel)()}resize(v,u){const _=v*u*i.RENDER_MODEL_INDICIES_PER_CELL;_!==this.cells.length&&(this.cells=new Uint32Array(_),this.lineLengths=new Uint32Array(u))}clear(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}},666:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.JoinedCellData=i.WebglRenderer=void 0;const d=a(820),v=a(274),u=a(627),_=a(457),b=a(56),w=a(374),f=a(345),n=a(859),c=a(147),l=a(782),h=a(855),m=a(965),y=a(742),C=a(310),L=a(733);class x extends n.Disposable{constructor(A,D,P,O,F,H,R,j,M){super(),this._terminal=A,this._characterJoinerService=D,this._charSizeService=P,this._coreBrowserService=O,this._coreService=F,this._decorationService=H,this._optionsService=R,this._themeService=j,this._cursorBlinkStateManager=new n.MutableDisposable,this._charAtlasDisposable=this.register(new n.MutableDisposable),this._observerDisposable=this.register(new n.MutableDisposable),this._model=new C.RenderModel,this._workCell=new l.CellData,this._workCell2=new l.CellData,this._rectangleRenderer=this.register(new n.MutableDisposable),this._glyphRenderer=this.register(new n.MutableDisposable),this._onChangeTextureAtlas=this.register(new f.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new f.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new f.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onRequestRedraw=this.register(new f.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onContextLoss=this.register(new f.EventEmitter),this.onContextLoss=this._onContextLoss.event,this.register(this._themeService.onChangeColors(()=>this._handleColorChange())),this._cellColorResolver=new v.CellColorResolver(this._terminal,this._optionsService,this._model.selection,this._decorationService,this._coreBrowserService,this._themeService),this._core=this._terminal._core,this._renderLayers=[new L.LinkRenderLayer(this._core.screenElement,2,this._terminal,this._core.linkifier,this._coreBrowserService,R,this._themeService)],this.dimensions=(0,w.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this._updateCursorBlink(),this.register(R.onOptionChange(()=>this._handleOptionsChanged())),this._canvas=this._coreBrowserService.mainDocument.createElement("canvas");const B={antialias:!1,depth:!1,preserveDrawingBuffer:M};if(this._gl=this._canvas.getContext("webgl2",B),!this._gl)throw new Error("WebGL2 not supported "+this._gl);this.register((0,d.addDisposableDomListener)(this._canvas,"webglcontextlost",$=>{console.log("webglcontextlost event received"),$.preventDefault(),this._contextRestorationTimeout=setTimeout(()=>{this._contextRestorationTimeout=void 0,console.warn("webgl context not restored; firing onContextLoss"),this._onContextLoss.fire($)},3e3)})),this.register((0,d.addDisposableDomListener)(this._canvas,"webglcontextrestored",$=>{console.warn("webglcontextrestored event received"),clearTimeout(this._contextRestorationTimeout),this._contextRestorationTimeout=void 0,(0,u.removeTerminalFromCache)(this._terminal),this._initializeWebGLState(),this._requestRedrawViewport()})),this._observerDisposable.value=(0,b.observeDevicePixelDimensions)(this._canvas,this._coreBrowserService.window,($,q)=>this._setCanvasDevicePixelDimensions($,q)),this.register(this._coreBrowserService.onWindowChange($=>{this._observerDisposable.value=(0,b.observeDevicePixelDimensions)(this._canvas,$,(q,K)=>this._setCanvasDevicePixelDimensions(q,K))})),this._core.screenElement.appendChild(this._canvas),[this._rectangleRenderer.value,this._glyphRenderer.value]=this._initializeWebGLState(),this._isAttached=this._coreBrowserService.window.document.body.contains(this._core.screenElement),this.register((0,n.toDisposable)(()=>{var $;for(const q of this._renderLayers)q.dispose();($=this._canvas.parentElement)==null||$.removeChild(this._canvas),(0,u.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){var A;return(A=this._charAtlas)==null?void 0:A.pages[0].canvas}_handleColorChange(){this._refreshCharAtlas(),this._clearModel(!0)}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}handleResize(A,D){var P,O,F,H;this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);for(const R of this._renderLayers)R.resize(this._terminal,this.dimensions);this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width=`${this.dimensions.css.canvas.width}px`,this._canvas.style.height=`${this.dimensions.css.canvas.height}px`,this._core.screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._core.screenElement.style.height=`${this.dimensions.css.canvas.height}px`,(P=this._rectangleRenderer.value)==null||P.setDimensions(this.dimensions),(O=this._rectangleRenderer.value)==null||O.handleResize(),(F=this._glyphRenderer.value)==null||F.setDimensions(this.dimensions),(H=this._glyphRenderer.value)==null||H.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}handleCharSizeChanged(){this.handleResize(this._terminal.cols,this._terminal.rows)}handleBlur(){var A;for(const D of this._renderLayers)D.handleBlur(this._terminal);(A=this._cursorBlinkStateManager.value)==null||A.pause(),this._requestRedrawViewport()}handleFocus(){var A;for(const D of this._renderLayers)D.handleFocus(this._terminal);(A=this._cursorBlinkStateManager.value)==null||A.resume(),this._requestRedrawViewport()}handleSelectionChanged(A,D,P){for(const O of this._renderLayers)O.handleSelectionChanged(this._terminal,A,D,P);this._model.selection.update(this._core,A,D,P),this._requestRedrawViewport()}handleCursorMove(){var A;for(const D of this._renderLayers)D.handleCursorMove(this._terminal);(A=this._cursorBlinkStateManager.value)==null||A.restartBlinkAnimation()}_handleOptionsChanged(){this._updateDimensions(),this._refreshCharAtlas(),this._updateCursorBlink()}_initializeWebGLState(){return this._rectangleRenderer.value=new y.RectangleRenderer(this._terminal,this._gl,this.dimensions,this._themeService),this._glyphRenderer.value=new m.GlyphRenderer(this._terminal,this._gl,this.dimensions,this._optionsService),this.handleCharSizeChanged(),[this._rectangleRenderer.value,this._glyphRenderer.value]}_refreshCharAtlas(){var D;if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0)return void(this._isAttached=!1);const A=(0,u.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr);this._charAtlas!==A&&(this._onChangeTextureAtlas.fire(A.pages[0].canvas),this._charAtlasDisposable.value=(0,n.getDisposeArrayDisposable)([(0,f.forwardEvent)(A.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),(0,f.forwardEvent)(A.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)])),this._charAtlas=A,this._charAtlas.warmUp(),(D=this._glyphRenderer.value)==null||D.setAtlas(this._charAtlas)}_clearModel(A){var D;this._model.clear(),A&&((D=this._glyphRenderer.value)==null||D.clear())}clearTextureAtlas(){var A;(A=this._charAtlas)==null||A.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}clear(){var A;this._clearModel(!0);for(const D of this._renderLayers)D.reset(this._terminal);(A=this._cursorBlinkStateManager.value)==null||A.restartBlinkAnimation(),this._updateCursorBlink()}registerCharacterJoiner(A){return-1}deregisterCharacterJoiner(A){return!1}renderRows(A,D){if(!this._isAttached){if(!(this._coreBrowserService.window.document.body.contains(this._core.screenElement)&&this._charSizeService.width&&this._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}for(const P of this._renderLayers)P.handleGridChanged(this._terminal,A,D);this._glyphRenderer.value&&this._rectangleRenderer.value&&(this._glyphRenderer.value.beginFrame()?(this._clearModel(!0),this._updateModel(0,this._terminal.rows-1)):this._updateModel(A,D),this._rectangleRenderer.value.renderBackgrounds(),this._glyphRenderer.value.render(this._model),this._cursorBlinkStateManager.value&&!this._cursorBlinkStateManager.value.isCursorVisible||this._rectangleRenderer.value.renderCursor())}_updateCursorBlink(){this._terminal.options.cursorBlink?this._cursorBlinkStateManager.value=new _.CursorBlinkStateManager(()=>{this._requestRedrawCursor()},this._coreBrowserService):this._cursorBlinkStateManager.clear(),this._requestRedrawCursor()}_updateModel(A,D){const P=this._core;let O,F,H,R,j,M,B,$,q,K,Y,se,N,z,U=this._workCell;A=k(A,P.rows-1,0),D=k(D,P.rows-1,0);const W=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY,ne=W-P.buffer.ydisp,Q=Math.min(this._terminal.buffer.active.cursorX,P.cols-1);let ce=-1;const oe=this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden&&(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible);this._model.cursor=void 0;let ke=!1;for(F=A;F<=D;F++)for(H=F+P.buffer.ydisp,R=P.buffer.lines.get(H),this._model.lineLengths[F]=0,j=this._characterJoinerService.getJoinedCharacters(H),N=0;N<P.cols;N++)if(O=this._cellColorResolver.result.bg,R.loadCell(N,U),N===0&&(O=this._cellColorResolver.result.bg),M=!1,B=N,j.length>0&&N===j[0][0]&&(M=!0,$=j.shift(),U=new E(U,R.translateToString(!0,$[0],$[1]),$[1]-$[0]),B=$[1]-1),q=U.getChars(),K=U.getCode(),se=(F*P.cols+N)*C.RENDER_MODEL_INDICIES_PER_CELL,this._cellColorResolver.resolve(U,N,H,this.dimensions.device.cell.width),oe&&H===W&&(N===Q&&(this._model.cursor={x:Q,y:ne,width:U.getWidth(),style:this._coreBrowserService.isFocused?P.options.cursorStyle||"block":P.options.cursorInactiveStyle,cursorWidth:P.options.cursorWidth,dpr:this._devicePixelRatio},ce=Q+U.getWidth()-1),N>=Q&&N<=ce&&(this._coreBrowserService.isFocused&&(P.options.cursorStyle||"block")==="block"||this._coreBrowserService.isFocused===!1&&P.options.cursorInactiveStyle==="block")&&(this._cellColorResolver.result.fg=50331648|this._themeService.colors.cursorAccent.rgba>>8&16777215,this._cellColorResolver.result.bg=50331648|this._themeService.colors.cursor.rgba>>8&16777215)),K!==h.NULL_CELL_CODE&&(this._model.lineLengths[F]=N+1),(this._model.cells[se]!==K||this._model.cells[se+C.RENDER_MODEL_BG_OFFSET]!==this._cellColorResolver.result.bg||this._model.cells[se+C.RENDER_MODEL_FG_OFFSET]!==this._cellColorResolver.result.fg||this._model.cells[se+C.RENDER_MODEL_EXT_OFFSET]!==this._cellColorResolver.result.ext)&&(ke=!0,q.length>1&&(K|=C.COMBINED_CHAR_BIT_MASK),this._model.cells[se]=K,this._model.cells[se+C.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[se+C.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[se+C.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext,Y=U.getWidth(),this._glyphRenderer.value.updateCell(N,F,K,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,q,Y,O),M))for(U=this._workCell,N++;N<B;N++)z=(F*P.cols+N)*C.RENDER_MODEL_INDICIES_PER_CELL,this._glyphRenderer.value.updateCell(N,F,h.NULL_CELL_CODE,0,0,0,h.NULL_CELL_CHAR,0,0),this._model.cells[z]=h.NULL_CELL_CODE,this._model.cells[z+C.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[z+C.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[z+C.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext;ke&&this._rectangleRenderer.value.updateBackgrounds(this._model),this._rectangleRenderer.value.updateCursor(this._model)}_updateDimensions(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}_setCanvasDevicePixelDimensions(A,D){this._canvas.width===A&&this._canvas.height===D||(this._canvas.width=A,this._canvas.height=D,this._requestRedrawViewport())}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}_requestRedrawCursor(){const A=this._terminal.buffer.active.cursorY;this._onRequestRedraw.fire({start:A,end:A})}}i.WebglRenderer=x;class E extends c.AttributeData{constructor(A,D,P){super(),this.content=0,this.combinedData="",this.fg=A.fg,this.bg=A.bg,this.combinedData=D,this._width=P}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(A){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}function k(T,A,D=0){return Math.max(Math.min(T,A),D)}i.JoinedCellData=E},381:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GLTexture=i.expandFloat32Array=i.createShader=i.createProgram=i.PROJECTION_MATRIX=void 0;const d=a(374);function v(u,_,b){const w=(0,d.throwIfFalsy)(u.createShader(_));if(u.shaderSource(w,b),u.compileShader(w),u.getShaderParameter(w,u.COMPILE_STATUS))return w;console.error(u.getShaderInfoLog(w)),u.deleteShader(w)}i.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),i.createProgram=function(u,_,b){const w=(0,d.throwIfFalsy)(u.createProgram());if(u.attachShader(w,(0,d.throwIfFalsy)(v(u,u.VERTEX_SHADER,_))),u.attachShader(w,(0,d.throwIfFalsy)(v(u,u.FRAGMENT_SHADER,b))),u.linkProgram(w),u.getProgramParameter(w,u.LINK_STATUS))return w;console.error(u.getProgramInfoLog(w)),u.deleteProgram(w)},i.createShader=v,i.expandFloat32Array=function(u,_){const b=Math.min(2*u.length,_),w=new Float32Array(b);for(let f=0;f<u.length;f++)w[f]=u[f];return w},i.GLTexture=class{constructor(u){this.texture=u,this.version=-1}}},592:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BaseRenderLayer=void 0;const d=a(627),v=a(237),u=a(374),_=a(859);class b extends _.Disposable{constructor(f,n,c,l,h,m,y,C){super(),this._container=n,this._alpha=h,this._coreBrowserService=m,this._optionsService=y,this._themeService=C,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add(`xterm-${c}-layer`),this._canvas.style.zIndex=l.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this.register(this._themeService.onChangeColors(L=>{this._refreshCharAtlas(f,L),this.reset(f)})),this.register((0,_.toDisposable)(()=>{this._canvas.remove()}))}_initCanvas(){this._ctx=(0,u.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(f){}handleFocus(f){}handleCursorMove(f){}handleGridChanged(f,n,c){}handleSelectionChanged(f,n,c,l=!1){}_setTransparency(f,n){if(n===this._alpha)return;const c=this._canvas;this._alpha=n,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,c),this._refreshCharAtlas(f,this._themeService.colors),this.handleGridChanged(f,0,f.rows-1)}_refreshCharAtlas(f,n){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=(0,d.acquireTextureAtlas)(f,this._optionsService.rawOptions,n,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlas.warmUp())}resize(f,n){this._deviceCellWidth=n.device.cell.width,this._deviceCellHeight=n.device.cell.height,this._deviceCharWidth=n.device.char.width,this._deviceCharHeight=n.device.char.height,this._deviceCharLeft=n.device.char.left,this._deviceCharTop=n.device.char.top,this._canvas.width=n.device.canvas.width,this._canvas.height=n.device.canvas.height,this._canvas.style.width=`${n.css.canvas.width}px`,this._canvas.style.height=`${n.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(f,this._themeService.colors)}_fillBottomLineAtCells(f,n,c=1){this._ctx.fillRect(f*this._deviceCellWidth,(n+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,c*this._deviceCellWidth,this._coreBrowserService.dpr)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(f,n,c,l){this._alpha?this._ctx.clearRect(f*this._deviceCellWidth,n*this._deviceCellHeight,c*this._deviceCellWidth,l*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(f*this._deviceCellWidth,n*this._deviceCellHeight,c*this._deviceCellWidth,l*this._deviceCellHeight))}_fillCharTrueColor(f,n,c,l){this._ctx.font=this._getFont(f,!1,!1),this._ctx.textBaseline=v.TEXT_BASELINE,this._clipCell(c,l,n.getWidth()),this._ctx.fillText(n.getChars(),c*this._deviceCellWidth+this._deviceCharLeft,l*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_clipCell(f,n,c){this._ctx.beginPath(),this._ctx.rect(f*this._deviceCellWidth,n*this._deviceCellHeight,c*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(f,n,c){return`${c?"italic":""} ${n?f.options.fontWeightBold:f.options.fontWeight} ${f.options.fontSize*this._coreBrowserService.dpr}px ${f.options.fontFamily}`}}i.BaseRenderLayer=b},733:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.LinkRenderLayer=void 0;const d=a(197),v=a(237),u=a(592);class _ extends u.BaseRenderLayer{constructor(w,f,n,c,l,h,m){super(n,w,"link",f,!0,l,h,m),this.register(c.onShowLinkUnderline(y=>this._handleShowLinkUnderline(y))),this.register(c.onHideLinkUnderline(y=>this._handleHideLinkUnderline(y)))}resize(w,f){super.resize(w,f),this._state=void 0}reset(w){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);const w=this._state.y2-this._state.y1-1;w>0&&this._clearCells(0,this._state.y1+1,this._state.cols,w),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(w){if(w.fg===v.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:w.fg!==void 0&&(0,d.is256Color)(w.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[w.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,w.y1===w.y2)this._fillBottomLineAtCells(w.x1,w.y1,w.x2-w.x1);else{this._fillBottomLineAtCells(w.x1,w.y1,w.cols-w.x1);for(let f=w.y1+1;f<w.y2;f++)this._fillBottomLineAtCells(0,f,w.cols);this._fillBottomLineAtCells(0,w.y2,w.x2)}this._state=w}_handleHideLinkUnderline(w){this._clearCurrentLink()}}i.LinkRenderLayer=_},820:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.addDisposableDomListener=void 0,i.addDisposableDomListener=function(a,d,v,u){a.addEventListener(d,v,u);let _=!1;return{dispose:()=>{_||(_=!0,a.removeEventListener(d,v,u))}}}},274:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CellColorResolver=void 0;const d=a(855),v=a(160),u=a(374);let _,b=0,w=0,f=!1,n=!1,c=!1,l=0;i.CellColorResolver=class{constructor(h,m,y,C,L,x){this._terminal=h,this._optionService=m,this._selectionRenderModel=y,this._decorationService=C,this._coreBrowserService=L,this._themeService=x,this.result={fg:0,bg:0,ext:0}}resolve(h,m,y,C){if(this.result.bg=h.bg,this.result.fg=h.fg,this.result.ext=268435456&h.bg?h.extended.ext:0,w=0,b=0,n=!1,f=!1,c=!1,_=this._themeService.colors,l=0,h.getCode()!==d.NULL_CELL_CODE&&h.extended.underlineStyle===4){const L=Math.max(1,Math.floor(this._optionService.rawOptions.fontSize*this._coreBrowserService.dpr/15));l=m*C%(2*Math.round(L))}if(this._decorationService.forEachDecorationAtCell(m,y,"bottom",L=>{L.backgroundColorRGB&&(w=L.backgroundColorRGB.rgba>>8&16777215,n=!0),L.foregroundColorRGB&&(b=L.foregroundColorRGB.rgba>>8&16777215,f=!0)}),c=this._selectionRenderModel.isCellSelected(this._terminal,m,y),c){if(67108864&this.result.fg||50331648&this.result.bg){if(67108864&this.result.fg)switch(50331648&this.result.fg){case 16777216:case 33554432:w=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 50331648:w=(16777215&this.result.fg)<<8|255;break;default:w=this._themeService.colors.foreground.rgba}else switch(50331648&this.result.bg){case 16777216:case 33554432:w=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 50331648:w=(16777215&this.result.bg)<<8|255}w=v.rgba.blend(w,4294967040&(this._coreBrowserService.isFocused?_.selectionBackgroundOpaque:_.selectionInactiveBackgroundOpaque).rgba|128)>>8&16777215}else w=(this._coreBrowserService.isFocused?_.selectionBackgroundOpaque:_.selectionInactiveBackgroundOpaque).rgba>>8&16777215;if(n=!0,_.selectionForeground&&(b=_.selectionForeground.rgba>>8&16777215,f=!0),(0,u.treatGlyphAsBackgroundColor)(h.getCode())){if(67108864&this.result.fg&&!(50331648&this.result.bg))b=(this._coreBrowserService.isFocused?_.selectionBackgroundOpaque:_.selectionInactiveBackgroundOpaque).rgba>>8&16777215;else{if(67108864&this.result.fg)switch(50331648&this.result.bg){case 16777216:case 33554432:b=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 50331648:b=(16777215&this.result.bg)<<8|255}else switch(50331648&this.result.fg){case 16777216:case 33554432:b=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 50331648:b=(16777215&this.result.fg)<<8|255;break;default:b=this._themeService.colors.foreground.rgba}b=v.rgba.blend(b,4294967040&(this._coreBrowserService.isFocused?_.selectionBackgroundOpaque:_.selectionInactiveBackgroundOpaque).rgba|128)>>8&16777215}f=!0}}this._decorationService.forEachDecorationAtCell(m,y,"top",L=>{L.backgroundColorRGB&&(w=L.backgroundColorRGB.rgba>>8&16777215,n=!0),L.foregroundColorRGB&&(b=L.foregroundColorRGB.rgba>>8&16777215,f=!0)}),n&&(w=c?-16777216&h.bg&-134217729|w|50331648:-16777216&h.bg|w|50331648),f&&(b=-16777216&h.fg&-67108865|b|50331648),67108864&this.result.fg&&(n&&!f&&(b=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&_.background.rgba>>8|50331648,f=!0),!n&&f&&(w=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&_.foreground.rgba>>8|50331648,n=!0)),_=void 0,this.result.bg=n?w:this.result.bg,this.result.fg=f?b:this.result.fg,this.result.ext&=536870911,this.result.ext|=l<<29&3758096384}}},627:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.removeTerminalFromCache=i.acquireTextureAtlas=void 0;const d=a(509),v=a(197),u=[];i.acquireTextureAtlas=function(_,b,w,f,n,c,l,h){const m=(0,v.generateConfig)(f,n,c,l,b,w,h);for(let L=0;L<u.length;L++){const x=u[L],E=x.ownedBy.indexOf(_);if(E>=0){if((0,v.configEquals)(x.config,m))return x.atlas;x.ownedBy.length===1?(x.atlas.dispose(),u.splice(L,1)):x.ownedBy.splice(E,1);break}}for(let L=0;L<u.length;L++){const x=u[L];if((0,v.configEquals)(x.config,m))return x.ownedBy.push(_),x.atlas}const y=_._core,C={atlas:new d.TextureAtlas(document,m,y.unicodeService),config:m,ownedBy:[_]};return u.push(C),C.atlas},i.removeTerminalFromCache=function(_){for(let b=0;b<u.length;b++){const w=u[b].ownedBy.indexOf(_);if(w!==-1){u[b].ownedBy.length===1?(u[b].atlas.dispose(),u.splice(b,1)):u[b].ownedBy.splice(w,1);break}}}},197:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.is256Color=i.configEquals=i.generateConfig=void 0;const d=a(160);i.generateConfig=function(v,u,_,b,w,f,n){const c={foreground:f.foreground,background:f.background,cursor:d.NULL_COLOR,cursorAccent:d.NULL_COLOR,selectionForeground:d.NULL_COLOR,selectionBackgroundTransparent:d.NULL_COLOR,selectionBackgroundOpaque:d.NULL_COLOR,selectionInactiveBackgroundTransparent:d.NULL_COLOR,selectionInactiveBackgroundOpaque:d.NULL_COLOR,ansi:f.ansi.slice(),contrastCache:f.contrastCache,halfContrastCache:f.halfContrastCache};return{customGlyphs:w.customGlyphs,devicePixelRatio:n,letterSpacing:w.letterSpacing,lineHeight:w.lineHeight,deviceCellWidth:v,deviceCellHeight:u,deviceCharWidth:_,deviceCharHeight:b,fontFamily:w.fontFamily,fontSize:w.fontSize,fontWeight:w.fontWeight,fontWeightBold:w.fontWeightBold,allowTransparency:w.allowTransparency,drawBoldTextInBrightColors:w.drawBoldTextInBrightColors,minimumContrastRatio:w.minimumContrastRatio,colors:c}},i.configEquals=function(v,u){for(let _=0;_<v.colors.ansi.length;_++)if(v.colors.ansi[_].rgba!==u.colors.ansi[_].rgba)return!1;return v.devicePixelRatio===u.devicePixelRatio&&v.customGlyphs===u.customGlyphs&&v.lineHeight===u.lineHeight&&v.letterSpacing===u.letterSpacing&&v.fontFamily===u.fontFamily&&v.fontSize===u.fontSize&&v.fontWeight===u.fontWeight&&v.fontWeightBold===u.fontWeightBold&&v.allowTransparency===u.allowTransparency&&v.deviceCharWidth===u.deviceCharWidth&&v.deviceCharHeight===u.deviceCharHeight&&v.drawBoldTextInBrightColors===u.drawBoldTextInBrightColors&&v.minimumContrastRatio===u.minimumContrastRatio&&v.colors.foreground.rgba===u.colors.foreground.rgba&&v.colors.background.rgba===u.colors.background.rgba},i.is256Color=function(v){return(50331648&v)==16777216||(50331648&v)==33554432}},237:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TEXT_BASELINE=i.DIM_OPACITY=i.INVERTED_DEFAULT_COLOR=void 0;const d=a(399);i.INVERTED_DEFAULT_COLOR=257,i.DIM_OPACITY=.5,i.TEXT_BASELINE=d.isFirefox||d.isLegacyEdge?"bottom":"ideographic"},457:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CursorBlinkStateManager=void 0,i.CursorBlinkStateManager=class{constructor(a,d){this._renderCallback=a,this._coreBrowserService=d,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(a=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){const d=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,d>0)return void this._restartInterval(d)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){const d=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(d)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},a)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}},860:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.tryDrawCustomChar=i.powerlineDefinitions=i.boxDrawingDefinitions=i.blockElementDefinitions=void 0;const d=a(374);i.blockElementDefinitions={"":[{x:0,y:0,w:8,h:4}],"":[{x:0,y:7,w:8,h:1}],"":[{x:0,y:6,w:8,h:2}],"":[{x:0,y:5,w:8,h:3}],"":[{x:0,y:4,w:8,h:4}],"":[{x:0,y:3,w:8,h:5}],"":[{x:0,y:2,w:8,h:6}],"":[{x:0,y:1,w:8,h:7}],"":[{x:0,y:0,w:8,h:8}],"":[{x:0,y:0,w:7,h:8}],"":[{x:0,y:0,w:6,h:8}],"":[{x:0,y:0,w:5,h:8}],"":[{x:0,y:0,w:4,h:8}],"":[{x:0,y:0,w:3,h:8}],"":[{x:0,y:0,w:2,h:8}],"":[{x:0,y:0,w:1,h:8}],"":[{x:4,y:0,w:4,h:8}],"":[{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8}],"":[{x:0,y:4,w:4,h:4}],"":[{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"":[{x:4,y:0,w:4,h:4}],"":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:1,y:0,w:1,h:8}],"":[{x:2,y:0,w:1,h:8}],"":[{x:3,y:0,w:1,h:8}],"":[{x:4,y:0,w:1,h:8}],"":[{x:5,y:0,w:1,h:8}],"":[{x:6,y:0,w:1,h:8}],"":[{x:0,y:1,w:8,h:1}],"":[{x:0,y:2,w:8,h:1}],"":[{x:0,y:3,w:8,h:1}],"":[{x:0,y:4,w:8,h:1}],"":[{x:0,y:5,w:8,h:1}],"":[{x:0,y:6,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:2}],"":[{x:0,y:0,w:8,h:3}],"":[{x:0,y:0,w:8,h:5}],"":[{x:0,y:0,w:8,h:6}],"":[{x:0,y:0,w:8,h:7}],"":[{x:6,y:0,w:2,h:8}],"":[{x:5,y:0,w:3,h:8}],"":[{x:3,y:0,w:5,h:8}],"":[{x:2,y:0,w:6,h:8}],"":[{x:1,y:0,w:7,h:8}],"":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};const v={"":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"":[[1,0],[0,0],[0,1],[0,0]],"":[[0,1],[1,1],[1,0],[1,1]]};i.boxDrawingDefinitions={"":{1:"M0,.5 L1,.5"},"":{3:"M0,.5 L1,.5"},"":{1:"M.5,0 L.5,1"},"":{3:"M.5,0 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5"},"":{3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M0,.5 L.5,.5 L.5,1"},"":{3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,0 L.5,.5 L1,.5"},"":{3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L0,.5"},"":{3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"":{1:"M.5,.5 L0,.5"},"":{3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,0"},"":{3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L1,.5"},"":{3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1"},"":{3:"M.5,.5 L.5,1"},"":{1:(f,n)=>`M0,${.5-n} L1,${.5-n} M0,${.5+n} L1,${.5+n}`},"":{1:(f,n)=>`M${.5-f},0 L${.5-f},1 M${.5+f},0 L${.5+f},1`},"":{1:(f,n)=>`M.5,1 L.5,${.5-n} L1,${.5-n} M.5,${.5+n} L1,${.5+n}`},"":{1:(f,n)=>`M${.5-f},1 L${.5-f},.5 L1,.5 M${.5+f},.5 L${.5+f},1`},"":{1:(f,n)=>`M1,${.5-n} L${.5-f},${.5-n} L${.5-f},1 M1,${.5+n} L${.5+f},${.5+n} L${.5+f},1`},"":{1:(f,n)=>`M0,${.5-n} L.5,${.5-n} L.5,1 M0,${.5+n} L.5,${.5+n}`},"":{1:(f,n)=>`M${.5+f},1 L${.5+f},.5 L0,.5 M${.5-f},.5 L${.5-f},1`},"":{1:(f,n)=>`M0,${.5+n} L${.5-f},${.5+n} L${.5-f},1 M0,${.5-n} L${.5+f},${.5-n} L${.5+f},1`},"":{1:(f,n)=>`M.5,0 L.5,${.5+n} L1,${.5+n} M.5,${.5-n} L1,${.5-n}`},"":{1:(f,n)=>`M1,.5 L${.5-f},.5 L${.5-f},0 M${.5+f},.5 L${.5+f},0`},"":{1:(f,n)=>`M1,${.5-n} L${.5+f},${.5-n} L${.5+f},0 M1,${.5+n} L${.5-f},${.5+n} L${.5-f},0`},"":{1:(f,n)=>`M0,${.5+n} L.5,${.5+n} L.5,0 M0,${.5-n} L.5,${.5-n}`},"":{1:(f,n)=>`M0,.5 L${.5+f},.5 L${.5+f},0 M${.5-f},.5 L${.5-f},0`},"":{1:(f,n)=>`M0,${.5-n} L${.5-f},${.5-n} L${.5-f},0 M0,${.5+n} L${.5+f},${.5+n} L${.5+f},0`},"":{1:(f,n)=>`M.5,0 L.5,1 M.5,${.5-n} L1,${.5-n} M.5,${.5+n} L1,${.5+n}`},"":{1:(f,n)=>`M${.5-f},0 L${.5-f},1 M${.5+f},0 L${.5+f},1 M${.5+f},.5 L1,.5`},"":{1:(f,n)=>`M${.5-f},0 L${.5-f},1 M1,${.5+n} L${.5+f},${.5+n} L${.5+f},1 M1,${.5-n} L${.5+f},${.5-n} L${.5+f},0`},"":{1:(f,n)=>`M.5,0 L.5,1 M0,${.5-n} L.5,${.5-n} M0,${.5+n} L.5,${.5+n}`},"":{1:(f,n)=>`M0,.5 L${.5-f},.5 M${.5-f},0 L${.5-f},1 M${.5+f},0 L${.5+f},1`},"":{1:(f,n)=>`M${.5+f},0 L${.5+f},1 M0,${.5+n} L${.5-f},${.5+n} L${.5-f},1 M0,${.5-n} L${.5-f},${.5-n} L${.5-f},0`},"":{1:(f,n)=>`M0,${.5-n} L1,${.5-n} M0,${.5+n} L1,${.5+n} M.5,${.5+n} L.5,1`},"":{1:(f,n)=>`M0,.5 L1,.5 M${.5-f},.5 L${.5-f},1 M${.5+f},.5 L${.5+f},1`},"":{1:(f,n)=>`M0,${.5-n} L1,${.5-n} M0,${.5+n} L${.5-f},${.5+n} L${.5-f},1 M1,${.5+n} L${.5+f},${.5+n} L${.5+f},1`},"":{1:(f,n)=>`M.5,0 L.5,${.5-n} M0,${.5-n} L1,${.5-n} M0,${.5+n} L1,${.5+n}`},"":{1:(f,n)=>`M0,.5 L1,.5 M${.5-f},.5 L${.5-f},0 M${.5+f},.5 L${.5+f},0`},"":{1:(f,n)=>`M0,${.5+n} L1,${.5+n} M0,${.5-n} L${.5-f},${.5-n} L${.5-f},0 M1,${.5-n} L${.5+f},${.5-n} L${.5+f},0`},"":{1:(f,n)=>`M.5,0 L.5,1 M0,${.5-n} L1,${.5-n} M0,${.5+n} L1,${.5+n}`},"":{1:(f,n)=>`M0,.5 L1,.5 M${.5-f},0 L${.5-f},1 M${.5+f},0 L${.5+f},1`},"":{1:(f,n)=>`M0,${.5+n} L${.5-f},${.5+n} L${.5-f},1 M1,${.5+n} L${.5+f},${.5+n} L${.5+f},1 M0,${.5-n} L${.5-f},${.5-n} L${.5-f},0 M1,${.5-n} L${.5+f},${.5-n} L${.5+f},0`},"":{1:"M1,0 L0,1"},"":{1:"M0,0 L1,1"},"":{1:"M1,0 L0,1 M0,0 L1,1"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"":{1:(f,n)=>`M.5,1 L.5,${.5+n/.15*.5} C.5,${.5+n/.15*.5},.5,.5,1,.5`},"":{1:(f,n)=>`M.5,1 L.5,${.5+n/.15*.5} C.5,${.5+n/.15*.5},.5,.5,0,.5`},"":{1:(f,n)=>`M.5,0 L.5,${.5-n/.15*.5} C.5,${.5-n/.15*.5},.5,.5,0,.5`},"":{1:(f,n)=>`M.5,0 L.5,${.5-n/.15*.5} C.5,${.5-n/.15*.5},.5,.5,1,.5`}},i.powerlineDefinitions={"":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"":{d:"M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0",type:1,rightPadding:1},"":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"":{d:"M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0",type:1,leftPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},i.powerlineDefinitions[""]=i.powerlineDefinitions[""],i.powerlineDefinitions[""]=i.powerlineDefinitions[""],i.tryDrawCustomChar=function(f,n,c,l,h,m,y,C){const L=i.blockElementDefinitions[n];if(L)return function(T,A,D,P,O,F){for(let H=0;H<A.length;H++){const R=A[H],j=O/8,M=F/8;T.fillRect(D+R.x*j,P+R.y*M,R.w*j,R.h*M)}}(f,L,c,l,h,m),!0;const x=v[n];if(x)return function(T,A,D,P,O,F){let H=u.get(A);H||(H=new Map,u.set(A,H));const R=T.fillStyle;if(typeof R!="string")throw new Error(`Unexpected fillStyle type "${R}"`);let j=H.get(R);if(!j){const M=A[0].length,B=A.length,$=T.canvas.ownerDocument.createElement("canvas");$.width=M,$.height=B;const q=(0,d.throwIfFalsy)($.getContext("2d")),K=new ImageData(M,B);let Y,se,N,z;if(R.startsWith("#"))Y=parseInt(R.slice(1,3),16),se=parseInt(R.slice(3,5),16),N=parseInt(R.slice(5,7),16),z=R.length>7&&parseInt(R.slice(7,9),16)||1;else{if(!R.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${R}" when drawing pattern glyph`);[Y,se,N,z]=R.substring(5,R.length-1).split(",").map(U=>parseFloat(U))}for(let U=0;U<B;U++)for(let W=0;W<M;W++)K.data[4*(U*M+W)]=Y,K.data[4*(U*M+W)+1]=se,K.data[4*(U*M+W)+2]=N,K.data[4*(U*M+W)+3]=A[U][W]*(255*z);q.putImageData(K,0,0),j=(0,d.throwIfFalsy)(T.createPattern($,null)),H.set(R,j)}T.fillStyle=j,T.fillRect(D,P,O,F)}(f,x,c,l,h,m),!0;const E=i.boxDrawingDefinitions[n];if(E)return function(T,A,D,P,O,F,H){T.strokeStyle=T.fillStyle;for(const[R,j]of Object.entries(A)){let M;T.beginPath(),T.lineWidth=H*Number.parseInt(R),M=typeof j=="function"?j(.15,.15/F*O):j;for(const B of M.split(" ")){const $=B[0],q=b[$];if(!q){console.error(`Could not find drawing instructions for "${$}"`);continue}const K=B.substring(1).split(",");K[0]&&K[1]&&q(T,w(K,O,F,D,P,!0,H))}T.stroke(),T.closePath()}}(f,E,c,l,h,m,C),!0;const k=i.powerlineDefinitions[n];return!!k&&(function(T,A,D,P,O,F,H,R){const j=new Path2D;j.rect(D,P,O,F),T.clip(j),T.beginPath();const M=H/12;T.lineWidth=R*M;for(const B of A.d.split(" ")){const $=B[0],q=b[$];if(!q){console.error(`Could not find drawing instructions for "${$}"`);continue}const K=B.substring(1).split(",");K[0]&&K[1]&&q(T,w(K,O,F,D,P,!1,R,(A.leftPadding??0)*(M/2),(A.rightPadding??0)*(M/2)))}A.type===1?(T.strokeStyle=T.fillStyle,T.stroke()):T.fill(),T.closePath()}(f,k,c,l,h,m,y,C),!0)};const u=new Map;function _(f,n,c=0){return Math.max(Math.min(f,n),c)}const b={C:(f,n)=>f.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5]),L:(f,n)=>f.lineTo(n[0],n[1]),M:(f,n)=>f.moveTo(n[0],n[1])};function w(f,n,c,l,h,m,y,C=0,L=0){const x=f.map(E=>parseFloat(E)||parseInt(E));if(x.length<2)throw new Error("Too few arguments for instruction");for(let E=0;E<x.length;E+=2)x[E]*=n-C*y-L*y,m&&x[E]!==0&&(x[E]=_(Math.round(x[E]+.5)-.5,n,0)),x[E]+=l+C*y;for(let E=1;E<x.length;E+=2)x[E]*=c,m&&x[E]!==0&&(x[E]=_(Math.round(x[E]+.5)-.5,c,0)),x[E]+=h;return x}},56:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.observeDevicePixelDimensions=void 0;const d=a(859);i.observeDevicePixelDimensions=function(v,u,_){let b=new u.ResizeObserver(w=>{const f=w.find(l=>l.target===v);if(!f)return;if(!("devicePixelContentBoxSize"in f))return b==null||b.disconnect(),void(b=void 0);const n=f.devicePixelContentBoxSize[0].inlineSize,c=f.devicePixelContentBoxSize[0].blockSize;n>0&&c>0&&_(n,c)});try{b.observe(v,{box:["device-pixel-content-box"]})}catch{b.disconnect(),b=void 0}return(0,d.toDisposable)(()=>b==null?void 0:b.disconnect())}},374:(S,i)=>{function a(v){return 57508<=v&&v<=57558}function d(v){return v>=128512&&v<=128591||v>=127744&&v<=128511||v>=128640&&v<=128767||v>=9728&&v<=9983||v>=9984&&v<=10175||v>=65024&&v<=65039||v>=129280&&v<=129535||v>=127462&&v<=127487}Object.defineProperty(i,"__esModule",{value:!0}),i.computeNextVariantOffset=i.createRenderDimensions=i.treatGlyphAsBackgroundColor=i.allowRescaling=i.isEmoji=i.isRestrictedPowerlineGlyph=i.isPowerlineGlyph=i.throwIfFalsy=void 0,i.throwIfFalsy=function(v){if(!v)throw new Error("value must not be falsy");return v},i.isPowerlineGlyph=a,i.isRestrictedPowerlineGlyph=function(v){return 57520<=v&&v<=57527},i.isEmoji=d,i.allowRescaling=function(v,u,_,b){return u===1&&_>Math.ceil(1.5*b)&&v!==void 0&&v>255&&!d(v)&&!a(v)&&!function(w){return 57344<=w&&w<=63743}(v)},i.treatGlyphAsBackgroundColor=function(v){return a(v)||function(u){return 9472<=u&&u<=9631}(v)},i.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},i.computeNextVariantOffset=function(v,u,_=0){return(v-(2*Math.round(u)-_))%(2*Math.round(u))}},296:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createSelectionRenderModel=void 0;class a{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(v,u,_,b=!1){if(this.selectionStart=u,this.selectionEnd=_,!u||!_||u[0]===_[0]&&u[1]===_[1])return void this.clear();const w=v.buffers.active.ydisp,f=u[1]-w,n=_[1]-w,c=Math.max(f,0),l=Math.min(n,v.rows-1);c>=v.rows||l<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=b,this.viewportStartRow=f,this.viewportEndRow=n,this.viewportCappedStartRow=c,this.viewportCappedEndRow=l,this.startCol=u[0],this.endCol=_[0])}isCellSelected(v,u,_){return!!this.hasSelection&&(_-=v.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?u>=this.startCol&&_>=this.viewportCappedStartRow&&u<this.endCol&&_<=this.viewportCappedEndRow:u<this.startCol&&_>=this.viewportCappedStartRow&&u>=this.endCol&&_<=this.viewportCappedEndRow:_>this.viewportStartRow&&_<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&_===this.viewportStartRow&&u>=this.startCol&&u<this.endCol||this.viewportStartRow<this.viewportEndRow&&_===this.viewportEndRow&&u<this.endCol||this.viewportStartRow<this.viewportEndRow&&_===this.viewportStartRow&&u>=this.startCol)}}i.createSelectionRenderModel=function(){return new a}},509:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TextureAtlas=void 0;const d=a(237),v=a(860),u=a(374),_=a(160),b=a(345),w=a(485),f=a(385),n=a(147),c=a(855),l={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}};let h;class m{get pages(){return this._pages}constructor(E,k,T){this._document=E,this._config=k,this._unicodeService=T,this._didWarmUp=!1,this._cacheMap=new w.FourKeyMap,this._cacheMapCombined=new w.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new n.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new b.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new b.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=L(E,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,u.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}dispose(){for(const E of this.pages)E.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){const E=new f.IdleTaskQueue;for(let k=33;k<126;k++)E.enqueue(()=>{if(!this._cacheMap.get(k,c.DEFAULT_COLOR,c.DEFAULT_COLOR,c.DEFAULT_EXT)){const T=this._drawToCache(k,c.DEFAULT_COLOR,c.DEFAULT_COLOR,c.DEFAULT_EXT);this._cacheMap.set(k,c.DEFAULT_COLOR,c.DEFAULT_COLOR,c.DEFAULT_EXT,T)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(const E of this._pages)E.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){if(m.maxAtlasPages&&this._pages.length>=Math.max(4,m.maxAtlasPages)){const k=this._pages.filter(H=>2*H.canvas.width<=(m.maxTextureSize||4096)).sort((H,R)=>R.canvas.width!==H.canvas.width?R.canvas.width-H.canvas.width:R.percentageUsed-H.percentageUsed);let T=-1,A=0;for(let H=0;H<k.length;H++)if(k[H].canvas.width!==A)T=H,A=k[H].canvas.width;else if(H-T==3)break;const D=k.slice(T,T+4),P=D.map(H=>H.glyphs[0].texturePage).sort((H,R)=>H>R?1:-1),O=this.pages.length-D.length,F=this._mergePages(D,O);F.version++;for(let H=P.length-1;H>=0;H--)this._deletePage(P[H]);this.pages.push(F),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(F.canvas)}const E=new y(this._document,this._textureSize);return this._pages.push(E),this._activePages.push(E),this._onAddTextureAtlasCanvas.fire(E.canvas),E}_mergePages(E,k){const T=2*E[0].canvas.width,A=new y(this._document,T,E);for(const[D,P]of E.entries()){const O=D*P.canvas.width%T,F=Math.floor(D/2)*P.canvas.height;A.ctx.drawImage(P.canvas,O,F);for(const R of P.glyphs)R.texturePage=k,R.sizeClipSpace.x=R.size.x/T,R.sizeClipSpace.y=R.size.y/T,R.texturePosition.x+=O,R.texturePosition.y+=F,R.texturePositionClipSpace.x=R.texturePosition.x/T,R.texturePositionClipSpace.y=R.texturePosition.y/T;this._onRemoveTextureAtlasCanvas.fire(P.canvas);const H=this._activePages.indexOf(P);H!==-1&&this._activePages.splice(H,1)}return A}_deletePage(E){this._pages.splice(E,1);for(let k=E;k<this._pages.length;k++){const T=this._pages[k];for(const A of T.glyphs)A.texturePage--;T.version++}}getRasterizedGlyphCombinedChar(E,k,T,A,D){return this._getFromCacheMap(this._cacheMapCombined,E,k,T,A,D)}getRasterizedGlyph(E,k,T,A,D){return this._getFromCacheMap(this._cacheMap,E,k,T,A,D)}_getFromCacheMap(E,k,T,A,D,P=!1){return h=E.get(k,T,A,D),h||(h=this._drawToCache(k,T,A,D,P),E.set(k,T,A,D,h)),h}_getColorFromAnsiIndex(E){if(E>=this._config.colors.ansi.length)throw new Error("No color found for idx "+E);return this._config.colors.ansi[E]}_getBackgroundColor(E,k,T,A){if(this._config.allowTransparency)return _.NULL_COLOR;let D;switch(E){case 16777216:case 33554432:D=this._getColorFromAnsiIndex(k);break;case 50331648:const P=n.AttributeData.toColorRGB(k);D=_.channels.toColor(P[0],P[1],P[2]);break;default:D=T?_.color.opaque(this._config.colors.foreground):this._config.colors.background}return D}_getForegroundColor(E,k,T,A,D,P,O,F,H,R){const j=this._getMinimumContrastColor(E,k,T,A,D,P,O,H,F,R);if(j)return j;let M;switch(D){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&H&&P<8&&(P+=8),M=this._getColorFromAnsiIndex(P);break;case 50331648:const B=n.AttributeData.toColorRGB(P);M=_.channels.toColor(B[0],B[1],B[2]);break;default:M=O?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(M=_.color.opaque(M)),F&&(M=_.color.multiplyOpacity(M,d.DIM_OPACITY)),M}_resolveBackgroundRgba(E,k,T){switch(E){case 16777216:case 33554432:return this._getColorFromAnsiIndex(k).rgba;case 50331648:return k<<8;default:return T?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(E,k,T,A){switch(E){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&A&&k<8&&(k+=8),this._getColorFromAnsiIndex(k).rgba;case 50331648:return k<<8;default:return T?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(E,k,T,A,D,P,O,F,H,R){if(this._config.minimumContrastRatio===1||R)return;const j=this._getContrastCache(H),M=j.getColor(E,A);if(M!==void 0)return M||void 0;const B=this._resolveBackgroundRgba(k,T,O),$=this._resolveForegroundRgba(D,P,O,F),q=_.rgba.ensureContrastRatio(B,$,this._config.minimumContrastRatio/(H?2:1));if(!q)return void j.setColor(E,A,null);const K=_.channels.toColor(q>>24&255,q>>16&255,q>>8&255);return j.setColor(E,A,K),K}_getContrastCache(E){return E?this._config.colors.halfContrastCache:this._config.colors.contrastCache}_drawToCache(E,k,T,A,D=!1){const P=typeof E=="number"?String.fromCharCode(E):E,O=Math.min(this._config.deviceCellWidth*Math.max(P.length,2)+4,this._textureSize);this._tmpCanvas.width<O&&(this._tmpCanvas.width=O);const F=Math.min(this._config.deviceCellHeight+8,this._textureSize);if(this._tmpCanvas.height<F&&(this._tmpCanvas.height=F),this._tmpCtx.save(),this._workAttributeData.fg=T,this._workAttributeData.bg=k,this._workAttributeData.extended.ext=A,this._workAttributeData.isInvisible())return l;const H=!!this._workAttributeData.isBold(),R=!!this._workAttributeData.isInverse(),j=!!this._workAttributeData.isDim(),M=!!this._workAttributeData.isItalic(),B=!!this._workAttributeData.isUnderline(),$=!!this._workAttributeData.isStrikethrough(),q=!!this._workAttributeData.isOverline();let K=this._workAttributeData.getFgColor(),Y=this._workAttributeData.getFgColorMode(),se=this._workAttributeData.getBgColor(),N=this._workAttributeData.getBgColorMode();if(R){const ee=K;K=se,se=ee;const pe=Y;Y=N,N=pe}const z=this._getBackgroundColor(N,se,R,j);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=z.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";const U=H?this._config.fontWeightBold:this._config.fontWeight,W=M?"italic":"";this._tmpCtx.font=`${W} ${U} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=d.TEXT_BASELINE;const ne=P.length===1&&(0,u.isPowerlineGlyph)(P.charCodeAt(0)),Q=P.length===1&&(0,u.isRestrictedPowerlineGlyph)(P.charCodeAt(0)),ce=this._getForegroundColor(k,N,se,T,Y,K,R,j,H,(0,u.treatGlyphAsBackgroundColor)(P.charCodeAt(0)));this._tmpCtx.fillStyle=ce.css;const oe=Q?0:4;let ke=!1;this._config.customGlyphs!==!1&&(ke=(0,v.tryDrawCustomChar)(this._tmpCtx,P,oe,oe,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let tt,ae=!ne;if(tt=typeof E=="number"?this._unicodeService.wcwidth(E):this._unicodeService.getStringCellWidth(E),B){this._tmpCtx.save();const ee=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),pe=ee%2==1?.5:0;if(this._tmpCtx.lineWidth=ee,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())ae=!1,this._tmpCtx.strokeStyle=`rgb(${n.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{ae=!1;let Me=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&Me<8&&(Me+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(Me).css}this._tmpCtx.beginPath();const Ee=oe,xe=Math.ceil(oe+this._config.deviceCharHeight)-pe-(D?2*ee:0),lt=xe+ee,Ve=xe+2*ee;let ct=this._workAttributeData.getUnderlineVariantOffset();for(let Me=0;Me<tt;Me++){this._tmpCtx.save();const ve=Ee+Me*this._config.deviceCellWidth,he=Ee+(Me+1)*this._config.deviceCellWidth,Cr=ve+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(ve,xe),this._tmpCtx.lineTo(he,xe),this._tmpCtx.moveTo(ve,Ve),this._tmpCtx.lineTo(he,Ve);break;case 3:const Hr=ee<=1?Ve:Math.ceil(oe+this._config.deviceCharHeight-ee/2)-pe,Z=ee<=1?xe:Math.ceil(oe+this._config.deviceCharHeight+ee/2)-pe,ie=new Path2D;ie.rect(ve,xe,this._config.deviceCellWidth,Ve-xe),this._tmpCtx.clip(ie),this._tmpCtx.moveTo(ve-this._config.deviceCellWidth/2,lt),this._tmpCtx.bezierCurveTo(ve-this._config.deviceCellWidth/2,Z,ve,Z,ve,lt),this._tmpCtx.bezierCurveTo(ve,Hr,Cr,Hr,Cr,lt),this._tmpCtx.bezierCurveTo(Cr,Z,he,Z,he,lt),this._tmpCtx.bezierCurveTo(he,Hr,he+this._config.deviceCellWidth/2,Hr,he+this._config.deviceCellWidth/2,lt);break;case 4:const G=ct===0?0:ct>=ee?2*ee-ct:ee-ct;ct>=ee||G===0?(this._tmpCtx.setLineDash([Math.round(ee),Math.round(ee)]),this._tmpCtx.moveTo(ve+G,xe),this._tmpCtx.lineTo(he,xe)):(this._tmpCtx.setLineDash([Math.round(ee),Math.round(ee)]),this._tmpCtx.moveTo(ve,xe),this._tmpCtx.lineTo(ve+G,xe),this._tmpCtx.moveTo(ve+G+ee,xe),this._tmpCtx.lineTo(he,xe)),ct=(0,u.computeNextVariantOffset)(he-ve,ee,ct);break;case 5:const te=.6,le=.3,we=he-ve,Oe=Math.floor(te*we),Ye=Math.floor(le*we),tr=we-Oe-Ye;this._tmpCtx.setLineDash([Oe,Ye,tr]),this._tmpCtx.moveTo(ve,xe),this._tmpCtx.lineTo(he,xe);break;default:this._tmpCtx.moveTo(ve,xe),this._tmpCtx.lineTo(he,xe)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!ke&&this._config.fontSize>=12&&!this._config.allowTransparency&&P!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";const Me=this._tmpCtx.measureText(P);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in Me&&Me.actualBoundingBoxDescent>0){this._tmpCtx.save();const ve=new Path2D;ve.rect(Ee,xe-Math.ceil(ee/2),this._config.deviceCellWidth*tt,Ve-xe+Math.ceil(ee/2)),this._tmpCtx.clip(ve),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=z.css,this._tmpCtx.strokeText(P,oe,oe+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(q){const ee=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),pe=ee%2==1?.5:0;this._tmpCtx.lineWidth=ee,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(oe,oe+pe),this._tmpCtx.lineTo(oe+this._config.deviceCharWidth*tt,oe+pe),this._tmpCtx.stroke()}if(ke||this._tmpCtx.fillText(P,oe,oe+this._config.deviceCharHeight),P==="_"&&!this._config.allowTransparency){let ee=C(this._tmpCtx.getImageData(oe,oe,this._config.deviceCellWidth,this._config.deviceCellHeight),z,ce,ae);if(ee)for(let pe=1;pe<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=z.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(P,oe,oe+this._config.deviceCharHeight-pe),ee=C(this._tmpCtx.getImageData(oe,oe,this._config.deviceCellWidth,this._config.deviceCellHeight),z,ce,ae),ee);pe++);}if($){const ee=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),pe=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=ee,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(oe,oe+Math.floor(this._config.deviceCharHeight/2)-pe),this._tmpCtx.lineTo(oe+this._config.deviceCharWidth*tt,oe+Math.floor(this._config.deviceCharHeight/2)-pe),this._tmpCtx.stroke()}this._tmpCtx.restore();const mt=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);let er;if(er=this._config.allowTransparency?function(ee){for(let pe=0;pe<ee.data.length;pe+=4)if(ee.data[pe+3]>0)return!1;return!0}(mt):C(mt,z,ce,ae),er)return l;const _e=this._findGlyphBoundingBox(mt,this._workBoundingBox,O,Q,ke,oe);let ue,de;for(;;){if(this._activePages.length===0){const ee=this._createNewPage();ue=ee,de=ee.currentRow,de.height=_e.size.y;break}ue=this._activePages[this._activePages.length-1],de=ue.currentRow;for(const ee of this._activePages)_e.size.y<=ee.currentRow.height&&(ue=ee,de=ee.currentRow);for(let ee=this._activePages.length-1;ee>=0;ee--)for(const pe of this._activePages[ee].fixedRows)pe.height<=de.height&&_e.size.y<=pe.height&&(ue=this._activePages[ee],de=pe);if(de.y+_e.size.y>=ue.canvas.height||de.height>_e.size.y+2){let ee=!1;if(ue.currentRow.y+ue.currentRow.height+_e.size.y>=ue.canvas.height){let pe;for(const Ee of this._activePages)if(Ee.currentRow.y+Ee.currentRow.height+_e.size.y<Ee.canvas.height){pe=Ee;break}if(pe)ue=pe;else if(m.maxAtlasPages&&this._pages.length>=m.maxAtlasPages&&de.y+_e.size.y<=ue.canvas.height&&de.height>=_e.size.y&&de.x+_e.size.x<=ue.canvas.width)ee=!0;else{const Ee=this._createNewPage();ue=Ee,de=Ee.currentRow,de.height=_e.size.y,ee=!0}}ee||(ue.currentRow.height>0&&ue.fixedRows.push(ue.currentRow),de={x:0,y:ue.currentRow.y+ue.currentRow.height,height:_e.size.y},ue.fixedRows.push(de),ue.currentRow={x:0,y:de.y+de.height,height:0})}if(de.x+_e.size.x<=ue.canvas.width)break;de===ue.currentRow?(de.x=0,de.y+=de.height,de.height=0):ue.fixedRows.splice(ue.fixedRows.indexOf(de),1)}return _e.texturePage=this._pages.indexOf(ue),_e.texturePosition.x=de.x,_e.texturePosition.y=de.y,_e.texturePositionClipSpace.x=de.x/ue.canvas.width,_e.texturePositionClipSpace.y=de.y/ue.canvas.height,_e.sizeClipSpace.x/=ue.canvas.width,_e.sizeClipSpace.y/=ue.canvas.height,de.height=Math.max(de.height,_e.size.y),de.x+=_e.size.x,ue.ctx.putImageData(mt,_e.texturePosition.x-this._workBoundingBox.left,_e.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,_e.size.x,_e.size.y),ue.addGlyph(_e),ue.version++,_e}_findGlyphBoundingBox(E,k,T,A,D,P){k.top=0;const O=A?this._config.deviceCellHeight:this._tmpCanvas.height,F=A?this._config.deviceCellWidth:T;let H=!1;for(let R=0;R<O;R++){for(let j=0;j<F;j++){const M=R*this._tmpCanvas.width*4+4*j+3;if(E.data[M]!==0){k.top=R,H=!0;break}}if(H)break}k.left=0,H=!1;for(let R=0;R<P+F;R++){for(let j=0;j<O;j++){const M=j*this._tmpCanvas.width*4+4*R+3;if(E.data[M]!==0){k.left=R,H=!0;break}}if(H)break}k.right=F,H=!1;for(let R=P+F-1;R>=P;R--){for(let j=0;j<O;j++){const M=j*this._tmpCanvas.width*4+4*R+3;if(E.data[M]!==0){k.right=R,H=!0;break}}if(H)break}k.bottom=O,H=!1;for(let R=O-1;R>=0;R--){for(let j=0;j<F;j++){const M=R*this._tmpCanvas.width*4+4*j+3;if(E.data[M]!==0){k.bottom=R,H=!0;break}}if(H)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:k.right-k.left+1,y:k.bottom-k.top+1},sizeClipSpace:{x:k.right-k.left+1,y:k.bottom-k.top+1},offset:{x:-k.left+P+(A||D?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-k.top+P+(A||D?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}i.TextureAtlas=m;class y{get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(E){this._glyphs.push(E),this._usedPixels+=E.size.x*E.size.y}constructor(E,k,T){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],T)for(const A of T)this._glyphs.push(...A.glyphs),this._usedPixels+=A._usedPixels;this.canvas=L(E,k,k),this.ctx=(0,u.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function C(x,E,k,T){const A=E.rgba>>>24,D=E.rgba>>>16&255,P=E.rgba>>>8&255,O=k.rgba>>>24,F=k.rgba>>>16&255,H=k.rgba>>>8&255,R=Math.floor((Math.abs(A-O)+Math.abs(D-F)+Math.abs(P-H))/12);let j=!0;for(let M=0;M<x.data.length;M+=4)x.data[M]===A&&x.data[M+1]===D&&x.data[M+2]===P||T&&Math.abs(x.data[M]-A)+Math.abs(x.data[M+1]-D)+Math.abs(x.data[M+2]-P)<R?x.data[M+3]=0:j=!1;return j}function L(x,E,k){const T=x.createElement("canvas");return T.width=E,T.height=k,T}},160:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.contrastRatio=i.toPaddedHex=i.rgba=i.rgb=i.css=i.color=i.channels=i.NULL_COLOR=void 0;let a=0,d=0,v=0,u=0;var _,b,w,f,n;function c(h){const m=h.toString(16);return m.length<2?"0"+m:m}function l(h,m){return h<m?(m+.05)/(h+.05):(h+.05)/(m+.05)}i.NULL_COLOR={css:"#00000000",rgba:0},function(h){h.toCss=function(m,y,C,L){return L!==void 0?`#${c(m)}${c(y)}${c(C)}${c(L)}`:`#${c(m)}${c(y)}${c(C)}`},h.toRgba=function(m,y,C,L=255){return(m<<24|y<<16|C<<8|L)>>>0},h.toColor=function(m,y,C,L){return{css:h.toCss(m,y,C,L),rgba:h.toRgba(m,y,C,L)}}}(_||(i.channels=_={})),function(h){function m(y,C){return u=Math.round(255*C),[a,d,v]=n.toChannels(y.rgba),{css:_.toCss(a,d,v,u),rgba:_.toRgba(a,d,v,u)}}h.blend=function(y,C){if(u=(255&C.rgba)/255,u===1)return{css:C.css,rgba:C.rgba};const L=C.rgba>>24&255,x=C.rgba>>16&255,E=C.rgba>>8&255,k=y.rgba>>24&255,T=y.rgba>>16&255,A=y.rgba>>8&255;return a=k+Math.round((L-k)*u),d=T+Math.round((x-T)*u),v=A+Math.round((E-A)*u),{css:_.toCss(a,d,v),rgba:_.toRgba(a,d,v)}},h.isOpaque=function(y){return(255&y.rgba)==255},h.ensureContrastRatio=function(y,C,L){const x=n.ensureContrastRatio(y.rgba,C.rgba,L);if(x)return _.toColor(x>>24&255,x>>16&255,x>>8&255)},h.opaque=function(y){const C=(255|y.rgba)>>>0;return[a,d,v]=n.toChannels(C),{css:_.toCss(a,d,v),rgba:C}},h.opacity=m,h.multiplyOpacity=function(y,C){return u=255&y.rgba,m(y,u*C/255)},h.toColorRGB=function(y){return[y.rgba>>24&255,y.rgba>>16&255,y.rgba>>8&255]}}(b||(i.color=b={})),function(h){let m,y;try{const C=document.createElement("canvas");C.width=1,C.height=1;const L=C.getContext("2d",{willReadFrequently:!0});L&&(m=L,m.globalCompositeOperation="copy",y=m.createLinearGradient(0,0,1,1))}catch{}h.toColor=function(C){if(C.match(/#[\da-f]{3,8}/i))switch(C.length){case 4:return a=parseInt(C.slice(1,2).repeat(2),16),d=parseInt(C.slice(2,3).repeat(2),16),v=parseInt(C.slice(3,4).repeat(2),16),_.toColor(a,d,v);case 5:return a=parseInt(C.slice(1,2).repeat(2),16),d=parseInt(C.slice(2,3).repeat(2),16),v=parseInt(C.slice(3,4).repeat(2),16),u=parseInt(C.slice(4,5).repeat(2),16),_.toColor(a,d,v,u);case 7:return{css:C,rgba:(parseInt(C.slice(1),16)<<8|255)>>>0};case 9:return{css:C,rgba:parseInt(C.slice(1),16)>>>0}}const L=C.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(L)return a=parseInt(L[1]),d=parseInt(L[2]),v=parseInt(L[3]),u=Math.round(255*(L[5]===void 0?1:parseFloat(L[5]))),_.toColor(a,d,v,u);if(!m||!y)throw new Error("css.toColor: Unsupported css format");if(m.fillStyle=y,m.fillStyle=C,typeof m.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(m.fillRect(0,0,1,1),[a,d,v,u]=m.getImageData(0,0,1,1).data,u!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:_.toRgba(a,d,v,u),css:C}}}(w||(i.css=w={})),function(h){function m(y,C,L){const x=y/255,E=C/255,k=L/255;return .2126*(x<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4))+.7152*(E<=.03928?E/12.92:Math.pow((E+.055)/1.055,2.4))+.0722*(k<=.03928?k/12.92:Math.pow((k+.055)/1.055,2.4))}h.relativeLuminance=function(y){return m(y>>16&255,y>>8&255,255&y)},h.relativeLuminance2=m}(f||(i.rgb=f={})),function(h){function m(C,L,x){const E=C>>24&255,k=C>>16&255,T=C>>8&255;let A=L>>24&255,D=L>>16&255,P=L>>8&255,O=l(f.relativeLuminance2(A,D,P),f.relativeLuminance2(E,k,T));for(;O<x&&(A>0||D>0||P>0);)A-=Math.max(0,Math.ceil(.1*A)),D-=Math.max(0,Math.ceil(.1*D)),P-=Math.max(0,Math.ceil(.1*P)),O=l(f.relativeLuminance2(A,D,P),f.relativeLuminance2(E,k,T));return(A<<24|D<<16|P<<8|255)>>>0}function y(C,L,x){const E=C>>24&255,k=C>>16&255,T=C>>8&255;let A=L>>24&255,D=L>>16&255,P=L>>8&255,O=l(f.relativeLuminance2(A,D,P),f.relativeLuminance2(E,k,T));for(;O<x&&(A<255||D<255||P<255);)A=Math.min(255,A+Math.ceil(.1*(255-A))),D=Math.min(255,D+Math.ceil(.1*(255-D))),P=Math.min(255,P+Math.ceil(.1*(255-P))),O=l(f.relativeLuminance2(A,D,P),f.relativeLuminance2(E,k,T));return(A<<24|D<<16|P<<8|255)>>>0}h.blend=function(C,L){if(u=(255&L)/255,u===1)return L;const x=L>>24&255,E=L>>16&255,k=L>>8&255,T=C>>24&255,A=C>>16&255,D=C>>8&255;return a=T+Math.round((x-T)*u),d=A+Math.round((E-A)*u),v=D+Math.round((k-D)*u),_.toRgba(a,d,v)},h.ensureContrastRatio=function(C,L,x){const E=f.relativeLuminance(C>>8),k=f.relativeLuminance(L>>8);if(l(E,k)<x){if(k<E){const D=m(C,L,x),P=l(E,f.relativeLuminance(D>>8));if(P<x){const O=y(C,L,x);return P>l(E,f.relativeLuminance(O>>8))?D:O}return D}const T=y(C,L,x),A=l(E,f.relativeLuminance(T>>8));if(A<x){const D=m(C,L,x);return A>l(E,f.relativeLuminance(D>>8))?T:D}return T}},h.reduceLuminance=m,h.increaseLuminance=y,h.toChannels=function(C){return[C>>24&255,C>>16&255,C>>8&255,255&C]}}(n||(i.rgba=n={})),i.toPaddedHex=c,i.contrastRatio=l},345:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.runAndSubscribe=i.forwardEvent=i.EventEmitter=void 0,i.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=a=>(this._listeners.push(a),{dispose:()=>{if(!this._disposed){for(let d=0;d<this._listeners.length;d++)if(this._listeners[d]===a)return void this._listeners.splice(d,1)}}})),this._event}fire(a,d){const v=[];for(let u=0;u<this._listeners.length;u++)v.push(this._listeners[u]);for(let u=0;u<v.length;u++)v[u].call(void 0,a,d)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},i.forwardEvent=function(a,d){return a(v=>d.fire(v))},i.runAndSubscribe=function(a,d){return d(void 0),a(v=>d(v))}},859:(S,i)=>{function a(d){for(const v of d)v.dispose();d.length=0}Object.defineProperty(i,"__esModule",{value:!0}),i.getDisposeArrayDisposable=i.disposeArray=i.toDisposable=i.MutableDisposable=i.Disposable=void 0,i.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const d of this._disposables)d.dispose();this._disposables.length=0}register(d){return this._disposables.push(d),d}unregister(d){const v=this._disposables.indexOf(d);v!==-1&&this._disposables.splice(v,1)}},i.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(d){var v;this._isDisposed||d===this._value||((v=this._value)==null||v.dispose(),this._value=d)}clear(){this.value=void 0}dispose(){var d;this._isDisposed=!0,(d=this._value)==null||d.dispose(),this._value=void 0}},i.toDisposable=function(d){return{dispose:d}},i.disposeArray=a,i.getDisposeArrayDisposable=function(d){return{dispose:()=>a(d)}}},485:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.FourKeyMap=i.TwoKeyMap=void 0;class a{constructor(){this._data={}}set(v,u,_){this._data[v]||(this._data[v]={}),this._data[v][u]=_}get(v,u){return this._data[v]?this._data[v][u]:void 0}clear(){this._data={}}}i.TwoKeyMap=a,i.FourKeyMap=class{constructor(){this._data=new a}set(d,v,u,_,b){this._data.get(d,v)||this._data.set(d,v,new a),this._data.get(d,v).set(u,_,b)}get(d,v,u,_){var b;return(b=this._data.get(d,v))==null?void 0:b.get(u,_)}clear(){this._data.clear()}}},399:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isChromeOS=i.isLinux=i.isWindows=i.isIphone=i.isIpad=i.isMac=i.getSafariVersion=i.isSafari=i.isLegacyEdge=i.isFirefox=i.isNode=void 0,i.isNode=typeof process<"u"&&"title"in process;const a=i.isNode?"node":navigator.userAgent,d=i.isNode?"node":navigator.platform;i.isFirefox=a.includes("Firefox"),i.isLegacyEdge=a.includes("Edge"),i.isSafari=/^((?!chrome|android).)*safari/i.test(a),i.getSafariVersion=function(){if(!i.isSafari)return 0;const v=a.match(/Version\/(\d+)/);return v===null||v.length<2?0:parseInt(v[1])},i.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(d),i.isIpad=d==="iPad",i.isIphone=d==="iPhone",i.isWindows=["Windows","Win16","Win32","WinCE"].includes(d),i.isLinux=d.indexOf("Linux")>=0,i.isChromeOS=/\bCrOS\b/.test(a)},385:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DebouncedIdleTask=i.IdleTaskQueue=i.PriorityTaskQueue=void 0;const d=a(399);class v{constructor(){this._tasks=[],this._i=0}enqueue(b){this._tasks.push(b),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(b){this._idleCallback=void 0;let w=0,f=0,n=b.timeRemaining(),c=0;for(;this._i<this._tasks.length;){if(w=Date.now(),this._tasks[this._i]()||this._i++,w=Math.max(1,Date.now()-w),f=Math.max(w,f),c=b.timeRemaining(),1.5*f>c)return n-w<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-w))}ms`),void this._start();n=c}this.clear()}}class u extends v{_requestCallback(b){return setTimeout(()=>b(this._createDeadline(16)))}_cancelCallback(b){clearTimeout(b)}_createDeadline(b){const w=Date.now()+b;return{timeRemaining:()=>Math.max(0,w-Date.now())}}}i.PriorityTaskQueue=u,i.IdleTaskQueue=!d.isNode&&"requestIdleCallback"in window?class extends v{_requestCallback(_){return requestIdleCallback(_)}_cancelCallback(_){cancelIdleCallback(_)}}:u,i.DebouncedIdleTask=class{constructor(){this._queue=new i.IdleTaskQueue}set(_){this._queue.clear(),this._queue.enqueue(_)}flush(){this._queue.flush()}}},147:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ExtendedAttrs=i.AttributeData=void 0;class a{constructor(){this.fg=0,this.bg=0,this.extended=new d}static toColorRGB(u){return[u>>>16&255,u>>>8&255,255&u]}static fromColorRGB(u){return(255&u[0])<<16|(255&u[1])<<8|255&u[2]}clone(){const u=new a;return u.fg=this.fg,u.bg=this.bg,u.extended=this.extended.clone(),u}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}i.AttributeData=a;class d{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(u){this._ext=u}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(u){this._ext&=-469762049,this._ext|=u<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(u){this._ext&=-67108864,this._ext|=67108863&u}get urlId(){return this._urlId}set urlId(u){this._urlId=u}get underlineVariantOffset(){const u=(3758096384&this._ext)>>29;return u<0?4294967288^u:u}set underlineVariantOffset(u){this._ext&=536870911,this._ext|=u<<29&3758096384}constructor(u=0,_=0){this._ext=0,this._urlId=0,this._ext=u,this._urlId=_}clone(){return new d(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}i.ExtendedAttrs=d},782:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CellData=void 0;const d=a(133),v=a(855),u=a(147);class _ extends u.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new u.ExtendedAttrs,this.combinedData=""}static fromCharData(w){const f=new _;return f.setFromCharData(w),f}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,d.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(w){this.fg=w[v.CHAR_DATA_ATTR_INDEX],this.bg=0;let f=!1;if(w[v.CHAR_DATA_CHAR_INDEX].length>2)f=!0;else if(w[v.CHAR_DATA_CHAR_INDEX].length===2){const n=w[v.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=n&&n<=56319){const c=w[v.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=c&&c<=57343?this.content=1024*(n-55296)+c-56320+65536|w[v.CHAR_DATA_WIDTH_INDEX]<<22:f=!0}else f=!0}else this.content=w[v.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|w[v.CHAR_DATA_WIDTH_INDEX]<<22;f&&(this.combinedData=w[v.CHAR_DATA_CHAR_INDEX],this.content=2097152|w[v.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}i.CellData=_},855:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WHITESPACE_CELL_CODE=i.WHITESPACE_CELL_WIDTH=i.WHITESPACE_CELL_CHAR=i.NULL_CELL_CODE=i.NULL_CELL_WIDTH=i.NULL_CELL_CHAR=i.CHAR_DATA_CODE_INDEX=i.CHAR_DATA_WIDTH_INDEX=i.CHAR_DATA_CHAR_INDEX=i.CHAR_DATA_ATTR_INDEX=i.DEFAULT_EXT=i.DEFAULT_ATTR=i.DEFAULT_COLOR=void 0,i.DEFAULT_COLOR=0,i.DEFAULT_ATTR=256|i.DEFAULT_COLOR<<9,i.DEFAULT_EXT=0,i.CHAR_DATA_ATTR_INDEX=0,i.CHAR_DATA_CHAR_INDEX=1,i.CHAR_DATA_WIDTH_INDEX=2,i.CHAR_DATA_CODE_INDEX=3,i.NULL_CELL_CHAR="",i.NULL_CELL_WIDTH=1,i.NULL_CELL_CODE=0,i.WHITESPACE_CELL_CHAR=" ",i.WHITESPACE_CELL_WIDTH=1,i.WHITESPACE_CELL_CODE=32},133:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Utf8ToUtf32=i.StringToUtf32=i.utf32ToString=i.stringFromCodePoint=void 0,i.stringFromCodePoint=function(a){return a>65535?(a-=65536,String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):String.fromCharCode(a)},i.utf32ToString=function(a,d=0,v=a.length){let u="";for(let _=d;_<v;++_){let b=a[_];b>65535?(b-=65536,u+=String.fromCharCode(55296+(b>>10))+String.fromCharCode(b%1024+56320)):u+=String.fromCharCode(b)}return u},i.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(a,d){const v=a.length;if(!v)return 0;let u=0,_=0;if(this._interim){const b=a.charCodeAt(_++);56320<=b&&b<=57343?d[u++]=1024*(this._interim-55296)+b-56320+65536:(d[u++]=this._interim,d[u++]=b),this._interim=0}for(let b=_;b<v;++b){const w=a.charCodeAt(b);if(55296<=w&&w<=56319){if(++b>=v)return this._interim=w,u;const f=a.charCodeAt(b);56320<=f&&f<=57343?d[u++]=1024*(w-55296)+f-56320+65536:(d[u++]=w,d[u++]=f)}else w!==65279&&(d[u++]=w)}return u}},i.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(a,d){const v=a.length;if(!v)return 0;let u,_,b,w,f=0,n=0,c=0;if(this.interim[0]){let m=!1,y=this.interim[0];y&=(224&y)==192?31:(240&y)==224?15:7;let C,L=0;for(;(C=63&this.interim[++L])&&L<4;)y<<=6,y|=C;const x=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,E=x-L;for(;c<E;){if(c>=v)return 0;if(C=a[c++],(192&C)!=128){c--,m=!0;break}this.interim[L++]=C,y<<=6,y|=63&C}m||(x===2?y<128?c--:d[f++]=y:x===3?y<2048||y>=55296&&y<=57343||y===65279||(d[f++]=y):y<65536||y>1114111||(d[f++]=y)),this.interim.fill(0)}const l=v-4;let h=c;for(;h<v;){for(;!(!(h<l)||128&(u=a[h])||128&(_=a[h+1])||128&(b=a[h+2])||128&(w=a[h+3]));)d[f++]=u,d[f++]=_,d[f++]=b,d[f++]=w,h+=4;if(u=a[h++],u<128)d[f++]=u;else if((224&u)==192){if(h>=v)return this.interim[0]=u,f;if(_=a[h++],(192&_)!=128){h--;continue}if(n=(31&u)<<6|63&_,n<128){h--;continue}d[f++]=n}else if((240&u)==224){if(h>=v)return this.interim[0]=u,f;if(_=a[h++],(192&_)!=128){h--;continue}if(h>=v)return this.interim[0]=u,this.interim[1]=_,f;if(b=a[h++],(192&b)!=128){h--;continue}if(n=(15&u)<<12|(63&_)<<6|63&b,n<2048||n>=55296&&n<=57343||n===65279)continue;d[f++]=n}else if((248&u)==240){if(h>=v)return this.interim[0]=u,f;if(_=a[h++],(192&_)!=128){h--;continue}if(h>=v)return this.interim[0]=u,this.interim[1]=_,f;if(b=a[h++],(192&b)!=128){h--;continue}if(h>=v)return this.interim[0]=u,this.interim[1]=_,this.interim[2]=b,f;if(w=a[h++],(192&w)!=128){h--;continue}if(n=(7&u)<<18|(63&_)<<12|(63&b)<<6|63&w,n<65536||n>1114111)continue;d[f++]=n}}return f}}},776:function(S,i,a){var d=this&&this.__decorate||function(n,c,l,h){var m,y=arguments.length,C=y<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,l):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(n,c,l,h);else for(var L=n.length-1;L>=0;L--)(m=n[L])&&(C=(y<3?m(C):y>3?m(c,l,C):m(c,l))||C);return y>3&&C&&Object.defineProperty(c,l,C),C},v=this&&this.__param||function(n,c){return function(l,h){c(l,h,n)}};Object.defineProperty(i,"__esModule",{value:!0}),i.traceCall=i.setTraceLogger=i.LogService=void 0;const u=a(859),_=a(97),b={trace:_.LogLevelEnum.TRACE,debug:_.LogLevelEnum.DEBUG,info:_.LogLevelEnum.INFO,warn:_.LogLevelEnum.WARN,error:_.LogLevelEnum.ERROR,off:_.LogLevelEnum.OFF};let w,f=i.LogService=class extends u.Disposable{get logLevel(){return this._logLevel}constructor(n){super(),this._optionsService=n,this._logLevel=_.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),w=this}_updateLogLevel(){this._logLevel=b[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(n){for(let c=0;c<n.length;c++)typeof n[c]=="function"&&(n[c]=n[c]())}_log(n,c,l){this._evalLazyOptionalParams(l),n.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+c,...l)}trace(n,...c){var l;this._logLevel<=_.LogLevelEnum.TRACE&&this._log(((l=this._optionsService.options.logger)==null?void 0:l.trace.bind(this._optionsService.options.logger))??console.log,n,c)}debug(n,...c){var l;this._logLevel<=_.LogLevelEnum.DEBUG&&this._log(((l=this._optionsService.options.logger)==null?void 0:l.debug.bind(this._optionsService.options.logger))??console.log,n,c)}info(n,...c){var l;this._logLevel<=_.LogLevelEnum.INFO&&this._log(((l=this._optionsService.options.logger)==null?void 0:l.info.bind(this._optionsService.options.logger))??console.info,n,c)}warn(n,...c){var l;this._logLevel<=_.LogLevelEnum.WARN&&this._log(((l=this._optionsService.options.logger)==null?void 0:l.warn.bind(this._optionsService.options.logger))??console.warn,n,c)}error(n,...c){var l;this._logLevel<=_.LogLevelEnum.ERROR&&this._log(((l=this._optionsService.options.logger)==null?void 0:l.error.bind(this._optionsService.options.logger))??console.error,n,c)}};i.LogService=f=d([v(0,_.IOptionsService)],f),i.setTraceLogger=function(n){w=n},i.traceCall=function(n,c,l){if(typeof l.value!="function")throw new Error("not supported");const h=l.value;l.value=function(...m){if(w.logLevel!==_.LogLevelEnum.TRACE)return h.apply(this,m);w.trace(`GlyphRenderer#${h.name}(${m.map(C=>JSON.stringify(C)).join(", ")})`);const y=h.apply(this,m);return w.trace(`GlyphRenderer#${h.name} return`,y),y}}},726:(S,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createDecorator=i.getServiceDependencies=i.serviceRegistry=void 0;const a="di$target",d="di$dependencies";i.serviceRegistry=new Map,i.getServiceDependencies=function(v){return v[d]||[]},i.createDecorator=function(v){if(i.serviceRegistry.has(v))return i.serviceRegistry.get(v);const u=function(_,b,w){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(f,n,c){n[a]===n?n[d].push({id:f,index:c}):(n[d]=[{id:f,index:c}],n[a]=n)})(u,_,w)};return u.toString=()=>v,i.serviceRegistry.set(v,u),u}},97:(S,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.IDecorationService=i.IUnicodeService=i.IOscLinkService=i.IOptionsService=i.ILogService=i.LogLevelEnum=i.IInstantiationService=i.ICharsetService=i.ICoreService=i.ICoreMouseService=i.IBufferService=void 0;const d=a(726);var v;i.IBufferService=(0,d.createDecorator)("BufferService"),i.ICoreMouseService=(0,d.createDecorator)("CoreMouseService"),i.ICoreService=(0,d.createDecorator)("CoreService"),i.ICharsetService=(0,d.createDecorator)("CharsetService"),i.IInstantiationService=(0,d.createDecorator)("InstantiationService"),function(u){u[u.TRACE=0]="TRACE",u[u.DEBUG=1]="DEBUG",u[u.INFO=2]="INFO",u[u.WARN=3]="WARN",u[u.ERROR=4]="ERROR",u[u.OFF=5]="OFF"}(v||(i.LogLevelEnum=v={})),i.ILogService=(0,d.createDecorator)("LogService"),i.IOptionsService=(0,d.createDecorator)("OptionsService"),i.IOscLinkService=(0,d.createDecorator)("OscLinkService"),i.IUnicodeService=(0,d.createDecorator)("UnicodeService"),i.IDecorationService=(0,d.createDecorator)("DecorationService")}},s={};function o(S){var i=s[S];if(i!==void 0)return i.exports;var a=s[S]={exports:{}};return r[S].call(a.exports,a,a.exports,o),a.exports}var g={};return(()=>{var S=g;Object.defineProperty(S,"__esModule",{value:!0}),S.WebglAddon=void 0;const i=o(345),a=o(859),d=o(399),v=o(666),u=o(776);class _ extends a.Disposable{constructor(w){if(d.isSafari&&(0,d.getSafariVersion)()<16){const f={antialias:!1,depth:!1,preserveDrawingBuffer:!0};if(!document.createElement("canvas").getContext("webgl2",f))throw new Error("Webgl2 is only supported on Safari 16 and above")}super(),this._preserveDrawingBuffer=w,this._onChangeTextureAtlas=this.register(new i.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new i.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new i.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onContextLoss=this.register(new i.EventEmitter),this.onContextLoss=this._onContextLoss.event}activate(w){const f=w._core;if(!w.element)return void this.register(f.onWillOpen(()=>this.activate(w)));this._terminal=w;const n=f.coreService,c=f.optionsService,l=f,h=l._renderService,m=l._characterJoinerService,y=l._charSizeService,C=l._coreBrowserService,L=l._decorationService,x=l._logService,E=l._themeService;(0,u.setTraceLogger)(x),this._renderer=this.register(new v.WebglRenderer(w,m,y,C,n,L,c,E,this._preserveDrawingBuffer)),this.register((0,i.forwardEvent)(this._renderer.onContextLoss,this._onContextLoss)),this.register((0,i.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,i.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this.register((0,i.forwardEvent)(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),h.setRenderer(this._renderer),this.register((0,a.toDisposable)(()=>{const k=this._terminal._core._renderService;k.setRenderer(this._terminal._core._createRenderer()),k.handleResize(w.cols,w.rows)}))}get textureAtlas(){var w;return(w=this._renderer)==null?void 0:w.textureAtlas}clearTextureAtlas(){var w;(w=this._renderer)==null||w.clearTextureAtlas()}}S.WebglAddon=_})(),g})())})(Rf);var lv=Rf.exports;function cv(e){return e&&e.replace(/\\u001b/g,"\x1B")}const Af=I.memo(function({workerId:t,output:r,onInput:s,onRawInput:o,onResize:g,className:S=""}){const i=I.useRef(null),a=I.useRef(null),d=I.useRef(null),v=I.useRef(0),u=I.useRef({cols:0,rows:0}),_=I.useRef(null),[b,w]=I.useState(!1),f=I.useRef(o),n=I.useRef(s),c=I.useRef(g);return I.useEffect(()=>{f.current=o,n.current=s,c.current=g}),I.useEffect(()=>{if(!i.current)return;v.current=0,w(!1);const l=i.current,h=13,m=new ov.Terminal({theme:{background:"#0a0a0a",foreground:"#DAA520",cursor:"#FFD700",cursorAccent:"#000000",selection:"rgba(218, 165, 32, 0.3)",black:"#0a0a0a",red:"#8B0000",green:"#DAA520",yellow:"#FFD700",blue:"#4169E1",magenta:"#660000",cyan:"#20B2AA",white:"#FFFFFF",brightBlack:"#333333",brightRed:"#DC143C",brightGreen:"#FFD700",brightYellow:"#FFEC8B",brightBlue:"#6495ED",brightMagenta:"#8B0000",brightCyan:"#40E0D0",brightWhite:"#FFFFFF"},fontFamily:'"Share Tech Mono", "Courier New", monospace',fontSize:h,lineHeight:1.2,cursorBlink:!0,cursorStyle:"block",scrollback:1e3,convertEol:!0}),y=new av.FitAddon;m.loadAddon(y),a.current=m,d.current=y,m.open(l);try{const k=new lv.WebglAddon;k.onContextLoss(()=>{k.dispose()}),m.loadAddon(k)}catch(k){console.warn("WebGL addon failed, using DOM renderer:",k.message)}const C=()=>{const k=a.current;if(!k)return;const{cols:T,rows:A}=k,D=u.current;(T!==D.cols||A!==D.rows)&&(u.current={cols:T,rows:A},c.current&&c.current(T,A))};setTimeout(()=>{try{y.fit(),C()}catch(k){console.warn("Fit error:",k)}w(!0)},100);let L;const x=()=>{clearTimeout(L),L=setTimeout(()=>{try{d.current&&i.current&&(d.current.fit(),C())}catch{}},150)},E=new ResizeObserver(x);if(E.observe(l),f.current)m.onKey(({key:k,domEvent:T})=>{var P;const A=T;let D=null;switch(A.keyCode){case 38:D="\x1B[A";break;case 40:D="\x1B[B";break;case 39:D="\x1B[C";break;case 37:D="\x1B[D";break;case 13:D="\r";break;case 27:D="\x1B";break;case 9:D="	";break;case 8:D="";break;default:k&&(D=k)}D&&(A.preventDefault(),(P=f.current)==null||P.call(f,D))}),m.onData(k=>{var T;k.length>1&&((T=f.current)==null||T.call(f,k))});else if(n.current){let k="";m.onKey(({key:T,domEvent:A})=>{var P;const D=A;D.keyCode===13?(m.write(`\r
`),k.trim()&&((P=n.current)==null||P.call(n,k)),k=""):D.keyCode===8?k.length>0&&(k=k.slice(0,-1),m.write("\b \b")):!D.ctrlKey&&!D.altKey&&!D.metaKey&&T.length===1&&(k+=T,m.write(T))})}return()=>{clearTimeout(L),_.current&&clearTimeout(_.current),E.disconnect(),m.dispose(),a.current=null,d.current=null}},[t]),I.useEffect(()=>{const l=a.current,h=i.current;if(!l||!b||!h||!r)return;const m=cv(r),y=m.length+":"+m.slice(-200);if(y===v.current)return;v.current=y;let C=m.replace(/\x1b\[\d*[ABCD]/g,"").replace(/\x1b\[\d+;\d+[Hf]/g,"").replace(/\x1b\[\d+G/g,"").replace(/\x1b\[[su]/g,"").replace(/\x1b\[[12]J/g,"").replace(/\x1b\[[012]?K/g,"");const L=500,x=C.split(`
`);x.length>L&&(C=x.slice(-L).join(`
`)),_.current&&clearTimeout(_.current);const E=C;_.current=setTimeout(()=>{_.current=null;const k=a.current;k&&(k.reset(),k.write(E,()=>{k.scrollToBottom()}))},100)},[r,b,t]),p.jsx("div",{ref:i,className:`bg-thea-nearBlack rounded border border-thea-gold-dark/30 overflow-hidden ${S}`,style:{opacity:b?1:.5,transition:"opacity 0.2s",maxWidth:"100%",contain:"strict"}})});function Tf({score:e=null,status:t=null,size:r="md",showScore:s=!0,className:o}){const g=t||Df(e),S={healthy:{icon:jm,color:"text-green-400",bgColor:"bg-green-500/20",borderColor:"border-green-500/30",glow:"shadow-[0_0_8px_rgba(74,222,128,0.4)]",label:"Healthy"},warning:{icon:_i,color:"text-yellow-400",bgColor:"bg-yellow-500/20",borderColor:"border-yellow-500/30",glow:"shadow-[0_0_8px_rgba(250,204,21,0.4)]",label:"Warning"},critical:{icon:Qm,color:"text-red-400",bgColor:"bg-red-500/20",borderColor:"border-red-500/30",glow:"shadow-[0_0_8px_rgba(248,113,113,0.4)]",label:"Critical"},unknown:{icon:Ft,color:"text-thea-gold-dark",bgColor:"bg-thea-gold/10",borderColor:"border-thea-gold-dark/30",glow:"",label:"Unknown"}},i={sm:{container:"gap-1 px-1.5 py-0.5",icon:"w-3 h-3",text:"text-[10px]"},md:{container:"gap-1.5 px-2 py-1",icon:"w-3.5 h-3.5",text:"text-xs"},lg:{container:"gap-2 px-3 py-1.5",icon:"w-4 h-4",text:"text-sm"}},{icon:a,color:d,bgColor:v,borderColor:u,glow:_}=S[g]||S.unknown,b=i[r]||i.md;return p.jsxs("div",{className:V("inline-flex items-center rounded border font-mono",v,u,d,_,b.container,o),title:`Health: ${e!==null?`${e}%`:"Unknown"}`,children:[p.jsx(a,{className:V(b.icon,g==="healthy"&&"animate-pulse")}),s&&e!==null&&p.jsx("span",{className:b.text,children:e})]})}function Df(e){return e==null?"unknown":e>=80?"healthy":e>=50?"warning":"critical"}function Mf({score:e,status:t,size:r="md",className:s}){const o=t||Df(e),g={healthy:"bg-green-400 shadow-[0_0_6px_rgba(74,222,128,0.6)]",warning:"bg-yellow-400 shadow-[0_0_6px_rgba(250,204,21,0.6)]",critical:"bg-red-400 shadow-[0_0_6px_rgba(248,113,113,0.6)]",unknown:"bg-thea-gold-dark/50"},S={sm:"w-1.5 h-1.5",md:"w-2 h-2",lg:"w-2.5 h-2.5"};return p.jsx("span",{className:V("inline-block rounded-full",g[o]||g.unknown,S[r]||S.md,o!=="unknown"&&"animate-pulse",s),title:`Health: ${e!==null?`${e}%`:"Unknown"}`})}function hv(e){return{healthy:100,active:90,stalled:50,warning:40,critical:20,error:10,stopped:0}[e]??null}function uv(e){return e.replace(/\x1b\[[0-9;]*[a-zA-Z]/g,"").replace(/\x1b\([AB]/g,"").replace(/\x1b\][^\x07]*\x07/g,"").replace(/[\x00-\x09\x0b-\x1f]/g,"").replace(/\xa0/g," ")}const dv=I.memo(function({worker:t,onOpenInMultiTerminal:r}){const{outputs:s,killWorker:o,updateWorkerLabel:g,attachToWorker:S}=_t(),[i,a]=I.useState(!1),[d,v]=I.useState(t.label),u=s[t.id]||"",_=I.useMemo(()=>uv(u).split(`
`).filter(n=>n.trim()).slice(-8).join(`
`),[u]),b=()=>{d.trim()&&d!==t.label&&g(t.id,d.trim()),a(!1)},w={running:"thea-badge-running",stopped:"thea-badge-stopped",error:"thea-badge-error"}[t.status]||"bg-gray-800 text-gray-400 border-gray-600";return p.jsxs("div",{"data-testid":`worker-card-${t.id}`,className:"thea-card group relative p-4",style:{clipPath:"polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 12px 100%, 0 calc(100% - 12px))"},children:[p.jsx("div",{className:"absolute top-0 right-0 w-3 h-3 border-t-2 border-r-2 border-thea-gold-bright opacity-50 group-hover:opacity-100 transition-opacity animate-corner-pulse"}),p.jsxs("div",{className:"flex items-start justify-between mb-3",children:[p.jsxs("div",{className:"flex-1 min-w-0",children:[i?p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("input",{type:"text",value:d,onChange:f=>v(f.target.value),onKeyDown:f=>f.key==="Enter"&&b(),className:"bg-black/50 border border-thea-gold/50 px-2 py-1 text-sm text-thea-gold font-rajdhani rounded-none flex-1",autoFocus:!0}),p.jsx("button",{onClick:b,className:"text-thea-gold hover:text-thea-gold-bright",children:p.jsx(os,{className:"w-4 h-4"})})]}):p.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[p.jsx(Zm,{label:t.label,size:"sm"}),p.jsx("h3",{className:"font-rajdhani font-bold text-thea-gold-bright truncate",children:Cf(t.label).displayName||t.label}),p.jsx("button",{onClick:()=>a(!0),className:"opacity-0 group-hover:opacity-100 text-thea-gold/50 hover:text-thea-gold transition-opacity flex-shrink-0",children:p.jsx(Fm,{className:"w-3 h-3"})})]}),p.jsx("p",{className:"text-xs text-thea-gold-dark font-mono",children:t.project})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Mf,{score:hv(t.health),size:"md"}),p.jsx("span",{className:V("thea-badge",w),children:t.status})]})]}),p.jsx("div",{className:"bg-black/50 border border-thea-gold-dark/20 p-2 h-32 overflow-hidden mb-3 font-mono text-[10px] text-thea-gold-dark/80 leading-tight whitespace-pre-wrap",children:_||"No output yet..."}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("button",{"data-testid":`open-worker-${t.id}`,onClick:()=>S(t.id),className:"thea-btn flex-1 flex items-center justify-center gap-2 py-2",children:[p.jsx(Fl,{className:"w-4 h-4"}),"Open"]}),r&&p.jsx("button",{onClick:r,className:"thea-btn p-2",title:"Open in Multi-Terminal View",children:p.jsx(gs,{className:"w-4 h-4"})}),p.jsx("button",{"data-testid":`kill-worker-${t.id}`,onClick:()=>o(t.id),className:"thea-btn thea-btn-danger p-2",children:p.jsx(Jt,{className:"w-4 h-4"})})]}),p.jsxs("div",{className:"mt-2 text-[10px] font-mono text-thea-gold-dark/50",children:["ID: ",t.id]})]})});function Vl(){const[e,t]=I.useState(!1),[r,s]=I.useState(!1),[o,g]=I.useState(""),[S,i]=I.useState(!1),[a,d]=I.useState(!1),v=I.useRef(null),u=I.useRef(null);I.useEffect(()=>{const c=window.SpeechRecognition||window.webkitSpeechRecognition;if(c){i(!0);const l=new c;l.continuous=!0,l.interimResults=!0,l.lang="en-US",l.onresult=h=>{const y=Array.from(h.results).map(C=>C[0].transcript).join("");g(y)},l.onerror=h=>{console.error("Speech recognition error:",h.error),t(!1)},l.onend=()=>{t(!1)},v.current=l}return"speechSynthesis"in window&&d(!0),()=>{v.current&&v.current.stop(),window.speechSynthesis&&window.speechSynthesis.cancel()}},[]);const _=I.useCallback(()=>{if(!(!v.current||e)){g("");try{v.current.start(),t(!0)}catch(c){console.error("Failed to start speech recognition:",c)}}},[e]),b=I.useCallback(()=>{v.current&&(v.current.stop(),t(!1))},[]),w=I.useCallback((c,l={})=>!a||!c?Promise.resolve():new Promise(h=>{window.speechSynthesis.cancel();const m=new SpeechSynthesisUtterance(c);m.rate=l.rate||1,m.pitch=l.pitch||1,m.volume=l.volume||1;const y=window.speechSynthesis.getVoices(),C=y.find(L=>L.name.includes("Google")||L.name.includes("Microsoft")||L.name.includes("Natural")||L.lang.startsWith("en"))||y.find(L=>L.lang.startsWith("en"))||y[0];C&&(m.voice=C),m.onstart=()=>s(!0),m.onend=()=>{s(!1),h()},m.onerror=()=>{s(!1),h()},u.current=m,window.speechSynthesis.speak(m)}),[a]),f=I.useCallback(()=>{window.speechSynthesis&&(window.speechSynthesis.cancel(),s(!1))},[]),n=I.useCallback(()=>{g("")},[]);return{isListening:e,transcript:o,sttSupported:S,startListening:_,stopListening:b,clearTranscript:n,isSpeaking:r,ttsSupported:a,speak:w,stopSpeaking:f}}const gh="",fv=({status:e})=>{const t={idle:p.jsx(Vs,{className:"w-4 h-4 text-gray-400"}),thinking:p.jsx(Qt,{className:"w-4 h-4 text-thea-gold animate-spin"}),coding:p.jsx(uf,{className:"w-4 h-4 text-green-400"}),running_command:p.jsx(Jn,{className:"w-4 h-4 text-blue-400"}),waiting_input:p.jsx(Vs,{className:"w-4 h-4 text-yellow-400 animate-pulse"}),error:p.jsx(at,{className:"w-4 h-4 text-red-400"}),completed:p.jsx(xs,{className:"w-4 h-4 text-green-400"}),active:p.jsx(Qt,{className:"w-4 h-4 text-thea-gold animate-spin"}),unknown:p.jsx(Vs,{className:"w-4 h-4 text-gray-400"})};return t[e]||t.unknown},_h={idle:"bg-gray-800 text-gray-400 border-gray-600",thinking:"bg-thea-gold/20 text-thea-gold border-thea-gold/50",coding:"bg-green-900/50 text-green-400 border-green-600/50",running_command:"bg-blue-900/50 text-blue-400 border-blue-600/50",waiting_input:"bg-yellow-900/50 text-yellow-400 border-yellow-600/50",error:"bg-red-900/50 text-red-400 border-red-600/50",completed:"bg-green-900/50 text-green-400 border-green-600/50",active:"bg-thea-gold/20 text-thea-gold border-thea-gold/50",unknown:"bg-gray-800 text-gray-400 border-gray-600"};function Nf({workerId:e,className:t="",autoSpeak:r=!1,onSummaryChange:s}){const[o,g]=I.useState(null),[S,i]=I.useState(!1),[a,d]=I.useState(null),[v,u]=I.useState(null),[_,b]=I.useState(r),w=I.useRef(""),{speak:f,stopSpeaking:n,isSpeaking:c,ttsSupported:l}=Vl(),h=I.useCallback(async(E=!1)=>{i(!0),d(null);try{const k=`${gh}/api/workers/${e}/summary${E?"?refresh=true":""}`,T=await fetch(k);if(!T.ok)throw new Error(`Failed to fetch summary: ${T.status}`);const A=await T.json();g(A),u(new Date)}catch(k){d(k.message);try{const T=await fetch(`${gh}/api/workers/${e}/quick-status`);if(T.ok){const A=await T.json();g({status:A.status,summary:`Quick status: ${A.lastLine||"No output"}`,task:null,lastAction:null,pendingItems:[],hasError:A.status==="error"})}}catch{}}finally{i(!1)}},[e]),m=I.useCallback(E=>{var T;if(!E)return"";const k=[];return E.status==="waiting_input"?k.push("Waiting for input."):E.status==="error"&&k.push("Error detected."),E.task&&k.push(`Current task: ${E.task}`),E.summary&&k.push(E.summary),E.lastAction&&k.push(`Last action: ${E.lastAction}`),((T=E.pendingItems)==null?void 0:T.length)>0&&k.push(`${E.pendingItems.length} pending items.`),k.join(" ")},[]),y=I.useCallback(()=>{const E=m(o);E&&f(E,{rate:1.1})},[o,f,m]);I.useEffect(()=>{if(!_||!o||!l)return;const E=m(o);E&&E!==w.current&&(w.current=E,f(E,{rate:1.1}),s&&s(o))},[o,_,l,f,m,s]),I.useEffect(()=>{h();const E=setInterval(()=>{h()},1e4);return()=>clearInterval(E)},[h]);const C=()=>{h(!0)},L=()=>{c&&n(),b(!_)};if(!o&&S)return p.jsxs("div",{className:V("flex items-center justify-center py-8",t),children:[p.jsx(Qt,{className:"w-6 h-6 text-thea-gold animate-spin"}),p.jsx("span",{className:"ml-2 text-thea-gold-dark",children:"Generating summary..."})]});if(a&&!o)return p.jsxs("div",{className:V("p-4 bg-red-900/20 border border-red-600/30 rounded",t),children:[p.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[p.jsx(at,{className:"w-5 h-5"}),p.jsx("span",{children:"Failed to load summary"})]}),p.jsx("p",{className:"text-sm text-red-400/70 mt-1",children:a}),p.jsx("button",{onClick:C,className:"mt-2 text-sm text-thea-gold hover:text-thea-gold-bright",children:"Try again"})]});const x=(o==null?void 0:o.status)||"unknown";return p.jsxs("div",{className:V("flex flex-col",t),children:[p.jsxs("div",{className:"flex items-center justify-between mb-3",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(fv,{status:x}),p.jsx("span",{className:V("px-2 py-0.5 text-xs font-mono rounded border",_h[x]||_h.unknown),children:x.replace("_"," ").toUpperCase()})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[l&&p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:y,disabled:c,className:V("p-1.5 rounded hover:bg-thea-gold/10 transition-colors",c&&"text-thea-gold animate-pulse"),title:c?"Speaking...":"Speak summary",children:p.jsx(Nn,{className:"w-4 h-4 text-thea-gold-dark"})}),p.jsx("button",{onClick:L,className:V("p-1.5 rounded transition-colors",_?"bg-thea-gold/20 text-thea-gold":"hover:bg-thea-gold/10 text-thea-gold-dark"),title:_?"Auto-speak ON":"Auto-speak OFF",children:_?p.jsx(Nn,{className:"w-4 h-4"}):p.jsx(Wl,{className:"w-4 h-4"})})]}),p.jsx("button",{onClick:C,disabled:S,className:V("p-1.5 rounded hover:bg-thea-gold/10 transition-colors",S&&"animate-spin"),title:"Refresh summary",children:p.jsx(Ht,{className:"w-4 h-4 text-thea-gold-dark"})})]})]}),(o==null?void 0:o.task)&&p.jsxs("div",{className:"mb-3",children:[p.jsx("h4",{className:"text-xs font-semibold text-thea-gold-dark uppercase tracking-wider mb-1",children:"Current Task"}),p.jsx("p",{className:"text-sm text-thea-gold-bright",children:o.task})]}),(o==null?void 0:o.summary)&&p.jsxs("div",{className:"mb-3",children:[p.jsx("h4",{className:"text-xs font-semibold text-thea-gold-dark uppercase tracking-wider mb-1",children:"Summary"}),p.jsx("p",{className:"text-sm text-thea-gold/90 leading-relaxed",children:o.summary})]}),(o==null?void 0:o.lastAction)&&p.jsxs("div",{className:"mb-3",children:[p.jsx("h4",{className:"text-xs font-semibold text-thea-gold-dark uppercase tracking-wider mb-1",children:"Last Action"}),p.jsx("p",{className:"text-sm text-thea-gold/80",children:o.lastAction})]}),(o==null?void 0:o.pendingItems)&&o.pendingItems.length>0&&p.jsxs("div",{className:"mb-3",children:[p.jsxs("h4",{className:"text-xs font-semibold text-thea-gold-dark uppercase tracking-wider mb-1",children:["Pending (",o.pendingItems.length,")"]}),p.jsxs("ul",{className:"text-sm text-thea-gold/70 space-y-1",children:[o.pendingItems.slice(0,5).map((E,k)=>p.jsxs("li",{className:"flex items-start gap-2",children:[p.jsx("span",{className:"text-thea-gold-dark",children:"-"}),p.jsx("span",{children:E})]},k)),o.pendingItems.length>5&&p.jsxs("li",{className:"text-thea-gold-dark text-xs",children:["...and ",o.pendingItems.length-5," more"]})]})]}),(o==null?void 0:o.hasError)&&p.jsxs("div",{className:"flex items-center gap-2 p-2 bg-red-900/20 border border-red-600/30 rounded",children:[p.jsx(at,{className:"w-4 h-4 text-red-400"}),p.jsx("span",{className:"text-sm text-red-400",children:"Error detected"})]}),v&&p.jsxs("div",{className:"mt-auto pt-2 text-xs text-thea-gold-dark/50 text-right",children:["Updated ",v.toLocaleTimeString()]})]})}const pv="";function mh({workerId:e,className:t}){var w,f,n,c;const[r,s]=I.useState(null),[o,g]=I.useState(!0),[S,i]=I.useState(null),a=async()=>{if(e){g(!0),i(null);try{const l=await fetch(`${pv}/api/metrics/worker/${e}`);if(!l.ok){if(l.status===404){s(null);return}throw new Error("Failed to fetch worker metrics")}const h=await l.json();s(h)}catch(l){i(l.message)}finally{g(!1)}}};if(I.useEffect(()=>{a();const l=setInterval(a,1e4);return()=>clearInterval(l)},[e]),o&&!r)return p.jsxs("div",{className:V("thea-card p-4",t),children:[p.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[p.jsx(Ft,{className:"w-4 h-4 text-thea-gold"}),p.jsx("h3",{className:"font-rajdhani font-bold text-thea-gold-bright uppercase tracking-wider text-sm",children:"Worker Health"})]}),p.jsx("div",{className:"flex items-center justify-center py-8 text-thea-gold-dark",children:p.jsx(Ht,{className:"w-5 h-5 animate-spin"})})]});if(S)return p.jsxs("div",{className:V("thea-card p-4",t),children:[p.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[p.jsx(Ft,{className:"w-4 h-4 text-thea-gold"}),p.jsx("h3",{className:"font-rajdhani font-bold text-thea-gold-bright uppercase tracking-wider text-sm",children:"Worker Health"})]}),p.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[p.jsx(at,{className:"w-4 h-4"}),p.jsx("span",{children:S})]}),p.jsx("button",{onClick:a,className:"mt-2 text-xs text-thea-gold-dark hover:text-thea-gold",children:"Retry"})]});const d=(r==null?void 0:r.healthScore)??null,v=((w=r==null?void 0:r.performance)==null?void 0:w.avgLatency)??null,u=((f=r==null?void 0:r.lifecycle)==null?void 0:f.uptime)??null,_=((n=r==null?void 0:r.lifecycle)==null?void 0:n.spawnTime)??null,b=((c=r==null?void 0:r.performance)==null?void 0:c.avgLatency)??null;return p.jsxs("div",{className:V("thea-card",t),children:[p.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-thea-gold-dark/30",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Ft,{className:"w-4 h-4 text-thea-gold"}),p.jsx("h3",{className:"font-rajdhani font-bold text-thea-gold-bright uppercase tracking-wider text-sm",children:"Worker Health"})]}),p.jsx("button",{onClick:a,className:"p-1 text-thea-gold-dark hover:text-thea-gold transition-colors",title:"Refresh",children:p.jsx(Ht,{className:V("w-3.5 h-3.5",o&&"animate-spin")})})]}),p.jsxs("div",{className:"p-4 space-y-4",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"text-sm text-thea-gold-dark",children:"Health Score"}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(gv,{score:d}),p.jsx(Tf,{score:d,size:"md",showScore:!0})]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[p.jsx(Fi,{icon:Or,label:"Response Time",value:v!==null?`${v}ms`:"--",status:_v(v)}),p.jsx(Fi,{icon:yf,label:"Spawn Time",value:_!==null?`${_}ms`:"--",status:mv(_)}),p.jsx(Fi,{icon:Vs,label:"Uptime",value:yv(u),status:"neutral"}),p.jsx(Fi,{icon:Dn,label:"Latency",value:b!==null?`${b}ms`:"--",status:vv(b)})]}),!r&&p.jsx("div",{className:"text-center text-thea-gold-dark text-sm py-2",children:"No metrics available for this worker yet."})]})]})}function gv({score:e}){const t=e!==null?Math.min(100,Math.max(0,e)):0,r=t/100*180-90,s=()=>e===null?"#6b7280":e>=80?"#4ade80":e>=50?"#facc15":"#f87171";return p.jsxs("div",{className:"relative w-16 h-8 overflow-hidden",children:[p.jsxs("svg",{className:"absolute inset-0 w-full h-full",viewBox:"0 0 64 32",children:[p.jsx("path",{d:"M 4 32 A 28 28 0 0 1 60 32",fill:"none",stroke:"rgba(255,255,255,0.1)",strokeWidth:"4",strokeLinecap:"round"}),p.jsx("path",{d:"M 4 32 A 28 28 0 0 1 60 32",fill:"none",stroke:s(),strokeWidth:"4",strokeLinecap:"round",strokeDasharray:`${t*.88} 88`,style:{filter:`drop-shadow(0 0 4px ${s()})`}})]}),p.jsx("div",{className:"absolute bottom-0 left-1/2 w-0.5 h-6 bg-thea-gold origin-bottom transition-transform duration-500",style:{transform:`translateX(-50%) rotate(${r}deg)`}}),p.jsx("div",{className:"absolute bottom-0 left-1/2 w-2 h-2 -translate-x-1/2 translate-y-1/2 rounded-full bg-thea-gold shadow-[0_0_6px_rgba(218,165,32,0.6)]"})]})}function Fi({icon:e,label:t,value:r,status:s}){const o={good:"border-green-500/30 bg-green-500/5",warning:"border-yellow-500/30 bg-yellow-500/5",critical:"border-red-500/30 bg-red-500/5",neutral:"border-thea-gold-dark/30 bg-thea-gold/5"},g={good:"text-green-400",warning:"text-yellow-400",critical:"text-red-400",neutral:"text-thea-gold-bright"};return p.jsxs("div",{className:V("p-2.5 rounded border",o[s]||o.neutral),children:[p.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[p.jsx(e,{className:"w-3 h-3 text-thea-gold-dark"}),p.jsx("span",{className:"text-[10px] text-thea-gold-dark uppercase tracking-wider",children:t})]}),p.jsx("span",{className:V("font-mono text-sm font-bold",g[s]||g.neutral),children:r})]})}function _v(e){return e===null?"neutral":e<100?"good":e<500?"warning":"critical"}function mv(e){return e===null?"neutral":e<2e3?"good":e<5e3?"warning":"critical"}function vv(e){return e===null?"neutral":e<50?"good":e<200?"warning":"critical"}function yv(e){return e==null?"--":e<60?`${e}s`:e<3600?`${Math.floor(e/60)}m`:e<86400?`${Math.floor(e/3600)}h`:`${Math.floor(e/86400)}d`}function jf({onSend:e,onCancel:t,placeholder:r="Speak or type..."}){const[s,o]=I.useState(""),[g,S]=I.useState(!1),[i,a]=I.useState(!1),d=I.useRef(null);I.useEffect(()=>{const b=window.SpeechRecognition||window.webkitSpeechRecognition;if(b){a(!0);const w=new b;w.continuous=!0,w.interimResults=!0,w.lang="en-US",w.onresult=f=>{const n=Array.from(f.results).map(c=>c[0].transcript).join("");o(n)},w.onerror=f=>{console.error("Speech recognition error:",f.error),S(!1)},w.onend=()=>{S(!1)},d.current=w}return()=>{d.current&&d.current.stop()}},[]);const v=()=>{d.current&&(g?(d.current.stop(),S(!1)):(o(""),d.current.start(),S(!0)))},u=()=>{var b;s.trim()&&(e(s.trim()),o(""),g&&((b=d.current)==null||b.stop(),S(!1)))},_=b=>{b.key==="Enter"&&!b.shiftKey&&(b.preventDefault(),u())};return p.jsxs("div",{className:"bg-black/50 border border-thea-gold-dark/30 p-3",children:[p.jsxs("div",{className:"flex items-end gap-2",children:[p.jsx("div",{className:"flex-1",children:p.jsx("textarea",{value:s,onChange:b=>o(b.target.value),onKeyDown:_,placeholder:r,rows:2,className:"w-full bg-thea-nearBlack border border-thea-gold-dark/30 px-3 py-2 text-sm text-white font-mono placeholder:text-thea-gold-dark/50 focus:outline-none focus:border-thea-gold resize-none"})}),p.jsxs("div",{className:"flex flex-col gap-2",children:[i&&p.jsx("button",{onClick:v,className:V("p-3 border transition-colors",g?"bg-thea-maroon/20 border-thea-maroon text-thea-maroon animate-pulse":"bg-thea-gold/10 border-thea-gold/30 text-thea-gold hover:bg-thea-gold/20"),children:g?p.jsx(zl,{className:"w-5 h-5"}):p.jsx(ci,{className:"w-5 h-5"})}),p.jsx("button",{onClick:u,disabled:!s.trim(),className:"p-3 bg-thea-gold/20 border border-thea-gold text-thea-gold hover:bg-thea-gold/30 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:p.jsx($m,{className:"w-5 h-5"})})]})]}),g&&p.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-thea-maroon",children:[p.jsx("span",{className:"w-2 h-2 bg-thea-maroon rounded-full animate-pulse"}),"Listening..."]}),t&&p.jsxs("button",{onClick:t,className:"mt-2 flex items-center gap-1 text-xs text-thea-gold-dark hover:text-thea-gold transition-colors",children:[p.jsx(Jt,{className:"w-3 h-3"}),"Cancel"]})]})}function vh({children:e,direction:t="horizontal",sizes:r,minSize:s=100,onSizesChange:o,className:g=""}){const S=Array.isArray(e)?e:[e],i=S.length,a=Array(i).fill(100/i),[d,v]=I.useState(r||a),u=I.useRef(null),_=I.useRef(!1),b=I.useRef(null),w=I.useRef(null),f=I.useRef(null);I.useEffect(()=>{if(i!==d.length){const m=Array(i).fill(100/i);v(m)}},[i]);const n=I.useCallback((m,y)=>{y.preventDefault(),_.current=!0,b.current=m,w.current=t==="horizontal"?y.clientX:y.clientY,f.current=[...d],document.body.style.cursor=t==="horizontal"?"col-resize":"row-resize",document.body.style.userSelect="none"},[t,d]),c=I.useCallback(m=>{if(!_.current||!u.current)return;const C=u.current.getBoundingClientRect(),L=t==="horizontal"?C.width:C.height,x=t==="horizontal"?m.clientX:m.clientY,E=w.current,k=(x-E)/L*100,T=b.current,A=[...f.current];let D=A[T]+k,P=A[T+1]-k;const O=s/L*100;D<O&&(P+=D-O,D=O),P<O&&(D+=P-O,P=O),A[T]=D,A[T+1]=P,v(A),o==null||o(A)},[t,s,o]),l=I.useCallback(()=>{_.current=!1,b.current=null,document.body.style.cursor="",document.body.style.userSelect=""},[]);if(I.useEffect(()=>(document.addEventListener("mousemove",c),document.addEventListener("mouseup",l),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",l)}),[c,l]),i<=1)return p.jsx("div",{className:V("w-full h-full",g),children:S[0]});const h=t==="horizontal";return p.jsx("div",{ref:u,className:V("flex w-full h-full",h?"flex-row":"flex-col",g),children:S.map((m,y)=>p.jsxs("div",{className:"contents",children:[p.jsx("div",{className:"overflow-hidden",style:{[h?"width":"height"]:`${d[y]}%`,flexShrink:0},children:m}),y<i-1&&p.jsxs("div",{className:V("flex-shrink-0 relative group",h?"w-1 cursor-col-resize":"h-1 cursor-row-resize","bg-thea-gold-dark/30 hover:bg-thea-gold/50 transition-colors"),onMouseDown:C=>n(y,C),children:[p.jsx("div",{className:V("absolute",h?"inset-y-0 -left-1 -right-1":"inset-x-0 -top-1 -bottom-1")}),p.jsx("div",{className:V("absolute bg-thea-gold/60 opacity-0 group-hover:opacity-100 transition-opacity",h?"inset-y-0 left-0 right-0":"inset-x-0 top-0 bottom-0")})]})]},y))})}function To({children:e,columns:t=2,rows:r=2,gap:s=4,className:o=""}){const g=Array.isArray(e)?e:[e];return p.jsx("div",{className:V("w-full h-full grid",o),style:{gridTemplateColumns:`repeat(${t}, 1fr)`,gridTemplateRows:`repeat(${r}, 1fr)`,gap:`${s}px`},children:g.map((S,i)=>p.jsx("div",{className:"overflow-hidden min-h-0 min-w-0",children:S},i))})}const xv="";function wv({paneId:e,workerId:t,onWorkerChange:r,onClose:s,onMaximize:o,isMaximized:g=!1,isActive:S,showCloseButton:i=!0,className:a=""}){const{workers:d,outputs:v,sendRawInput:u,resizeTerminal:_,activePaneId:b,setActivePaneId:w,updateWorkerSettings:f}=_t(),[n,c]=I.useState("terminal"),[l,h]=I.useState(!1),[m,y]=I.useState(!1),[C,L]=I.useState(null),[x,E]=I.useState(null),k=d.find(R=>R.id===t),T=v[t]||"",A=S!==void 0?S:b===e,D=()=>{w&&w(e)},P=I.useCallback(async R=>{if(!R||!R.type.startsWith("image/")){L("error"),setTimeout(()=>L(null),2e3);return}L("uploading");const j=new FormData;j.append("screenshot",R),j.append("workerId",t||"unknown");try{const M=await fetch(`${xv}/api/uploads/screenshot`,{method:"POST",body:j});if(!M.ok)throw new Error("Upload failed");const B=await M.json();E(B.path),L("success"),setTimeout(()=>L(null),3e3)}catch(M){console.error("Upload error:",M),L("error"),setTimeout(()=>L(null),2e3)}},[t]),O=I.useCallback(R=>{R.preventDefault(),R.stopPropagation(),y(!0)},[]),F=I.useCallback(R=>{R.preventDefault(),R.stopPropagation(),y(!1)},[]),H=I.useCallback(R=>{var M;R.preventDefault(),R.stopPropagation(),y(!1);const j=(M=R.dataTransfer)==null?void 0:M.files;j&&j.length>0&&P(j[0])},[P]);return I.useEffect(()=>{const R=j=>{var B;const M=(B=j.clipboardData)==null?void 0:B.items;if(M){for(const $ of M)if($.type.startsWith("image/")){const q=$.getAsFile();if(q){P(q);break}}}};return document.addEventListener("paste",R),()=>document.removeEventListener("paste",R)},[P]),p.jsxs("div",{className:V("h-full flex flex-col bg-black/20 border rounded overflow-hidden transition-colors relative",A?"border-thea-gold/60 shadow-gold-sm":"border-thea-gold-dark/30",m&&"border-thea-gold border-2",a),onClick:D,onDragOver:O,onDragLeave:F,onDrop:H,children:[m&&p.jsx("div",{className:"absolute inset-0 z-50 bg-thea-gold/20 backdrop-blur-sm flex items-center justify-center",children:p.jsxs("div",{className:"text-center",children:[p.jsx(pf,{className:"w-12 h-12 text-thea-gold-bright mx-auto mb-2"}),p.jsx("p",{className:"text-thea-gold-bright font-rajdhani text-lg",children:"Drop image to upload"})]})}),C&&p.jsxs("div",{className:V("absolute top-12 left-1/2 -translate-x-1/2 z-50 px-4 py-2 rounded shadow-lg flex items-center gap-2 text-sm font-mono",C==="uploading"&&"bg-thea-gold/90 text-black",C==="success"&&"bg-green-600 text-white",C==="error"&&"bg-red-600 text-white"),children:[C==="uploading"&&p.jsxs(p.Fragment,{children:[p.jsx(Mn,{className:"w-4 h-4 animate-pulse"}),"Uploading..."]}),C==="success"&&p.jsxs(p.Fragment,{children:[p.jsx(xs,{className:"w-4 h-4"}),p.jsx("span",{className:"truncate max-w-[200px]",children:x})]}),C==="error"&&p.jsxs(p.Fragment,{children:[p.jsx(at,{className:"w-4 h-4"}),"Upload failed"]})]}),p.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5 bg-black/40 border-b border-thea-gold-dark/20 flex-shrink-0",children:[p.jsxs("div",{className:"relative",children:[p.jsxs("button",{onClick:()=>h(!l),className:"flex items-center gap-1.5 px-2 py-1 text-xs font-rajdhani text-thea-gold hover:text-thea-gold-bright transition-colors rounded hover:bg-white/5",children:[p.jsx("span",{className:V("w-1.5 h-1.5 rounded-full",(k==null?void 0:k.status)==="running"?"bg-green-500":"bg-thea-gold-dark")}),p.jsx("span",{className:"truncate max-w-[120px]",children:(k==null?void 0:k.label)||"Select Worker"}),p.jsx(mi,{className:"w-3 h-3"})]}),l&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>h(!1)}),p.jsx("div",{className:"absolute top-full left-0 mt-1 z-20 min-w-[200px] max-h-[300px] overflow-auto bg-thea-nearBlack border border-thea-gold-dark/50 rounded shadow-lg",children:d.length===0?p.jsx("div",{className:"px-3 py-2 text-xs text-thea-gold-dark",children:"No workers available"}):d.map(R=>p.jsxs("button",{onClick:()=>{r==null||r(R.id),h(!1)},className:V("w-full text-left px-3 py-2 text-xs hover:bg-thea-gold/10 transition-colors",R.id===t?"bg-thea-gold/20 text-thea-gold-bright":"text-thea-gold"),children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:V("w-1.5 h-1.5 rounded-full flex-shrink-0",R.status==="running"?"bg-green-500":"bg-thea-gold-dark")}),p.jsx("span",{className:"truncate",children:R.label})]}),p.jsx("div",{className:"text-[10px] text-thea-gold-dark ml-3.5 truncate",children:R.project})]},R.id))})]})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsxs("div",{className:"flex items-center bg-black/30 rounded border border-thea-gold-dark/20",children:[p.jsx("button",{onClick:()=>c("terminal"),className:V("p-1 rounded-l transition-colors",n==="terminal"?"bg-thea-gold/20 text-thea-gold-bright":"text-thea-gold-dark hover:text-thea-gold"),title:"Terminal View",children:p.jsx(Jn,{className:"w-3 h-3"})}),p.jsx("button",{onClick:()=>c("summary"),className:V("p-1 rounded-r transition-colors",n==="summary"?"bg-thea-gold/20 text-thea-gold-bright":"text-thea-gold-dark hover:text-thea-gold"),title:"Summary View",children:p.jsx(Hl,{className:"w-3 h-3"})})]}),k&&p.jsx("div",{className:"flex items-center",children:p.jsx("button",{onClick:()=>{k.autoAcceptPaused?f(k.id,{autoAcceptPaused:!1}):f(k.id,{autoAccept:!k.autoAccept})},className:V("p-1 rounded transition-colors relative",k.autoAccept?k.autoAcceptPaused?"bg-yellow-600/30 text-yellow-500 hover:bg-yellow-600/40":"bg-green-600/30 text-green-500 hover:bg-green-600/40":"text-thea-gold-dark hover:text-thea-gold hover:bg-white/5"),title:k.autoAccept?k.autoAcceptPaused?"Auto-accept PAUSED (click to resume)":"Auto-accept ON (click to disable)":"Auto-accept OFF (click to enable)",children:k.autoAccept?k.autoAcceptPaused?p.jsx(_i,{className:"w-3 h-3"}):p.jsx(Or,{className:"w-3 h-3"}):p.jsx(Ia,{className:"w-3 h-3"})})}),k&&p.jsx("button",{onClick:()=>{f(k.id,{ralphMode:!k.ralphMode})},className:V("p-1 rounded transition-colors",k.ralphMode?"bg-purple-600/30 text-purple-400 hover:bg-purple-600/40":"text-thea-gold-dark hover:text-thea-gold hover:bg-white/5"),title:k.ralphMode?"Ralph mode ON - Worker will signal completion via API":"Ralph mode OFF - Enable autonomous completion signaling",children:p.jsx(ps,{className:"w-3 h-3"})}),p.jsxs("label",{className:"p-1 text-thea-gold-dark hover:text-thea-gold transition-colors cursor-pointer",title:"Upload screenshot (or drag & drop, or paste)",children:[p.jsx(Mn,{className:"w-3 h-3"}),p.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:R=>{var M;const j=(M=R.target.files)==null?void 0:M[0];j&&P(j),R.target.value=""}})]}),o&&p.jsx("button",{onClick:o,className:"p-1 text-thea-gold-dark hover:text-thea-gold transition-colors",title:g?"Restore":"Maximize",children:g?p.jsx(Im,{className:"w-3 h-3"}):p.jsx(Fl,{className:"w-3 h-3"})}),i&&s&&p.jsx("button",{onClick:s,className:"p-1 text-thea-gold-dark hover:text-red-400 transition-colors",title:"Close Pane",children:p.jsx(Jt,{className:"w-3 h-3"})})]})]}),p.jsx("div",{className:"flex-1 min-h-0 p-1",children:!t||!k?p.jsx("div",{className:"h-full flex items-center justify-center text-thea-gold-dark text-sm",children:"Select a worker to display"}):n==="terminal"?p.jsx(Af,{workerId:t,output:T,onRawInput:R=>u(t,R),onResize:(R,j)=>_(t,R,j),className:"h-full w-full"}):p.jsx("div",{className:"h-full bg-black/30 rounded overflow-auto p-2",children:p.jsx(Nf,{workerId:t,className:"h-full"})})})]})}function Sv({className:e=""}){const{layoutMode:t,changeLayoutMode:r,addPane:s,panes:o}=_t(),g=[{mode:Re.SINGLE,icon:Fl,label:"Single"},{mode:Re.SPLIT_H,icon:Em,label:"Split H"},{mode:Re.SPLIT_V,icon:zm,label:"Split V"},{mode:Re.GRID_2X2,icon:Dm,label:"22"},{mode:Re.GRID_3X2,icon:Mm,label:"32"}];return p.jsxs("div",{className:V("flex items-center gap-1",e),children:[g.map(({mode:S,icon:i,label:a})=>p.jsxs("button",{onClick:()=>r(S),className:V("flex items-center gap-1.5 px-2 py-1 text-xs font-rajdhani rounded transition-all",t===S?"bg-thea-gold/20 text-thea-gold-bright border border-thea-gold/40":"text-thea-gold-dark hover:text-thea-gold hover:bg-white/5 border border-transparent"),title:a,children:[p.jsx(i,{className:"w-3.5 h-3.5"}),p.jsx("span",{className:"hidden sm:inline",children:a})]},S)),p.jsxs("button",{onClick:()=>s(),className:"flex items-center gap-1 px-2 py-1 text-xs font-rajdhani text-thea-gold-dark hover:text-thea-gold hover:bg-white/5 rounded transition-colors border border-transparent",title:"Add Pane",children:[p.jsx($l,{className:"w-3.5 h-3.5"}),p.jsx("span",{className:"hidden sm:inline",children:"Add"})]}),p.jsxs("span",{className:"text-[10px] text-thea-gold-dark/50 ml-2",children:[o.length," pane",o.length!==1?"s":""]})]})}function Cv({onBack:e}){const{layoutMode:t,panes:r,activePaneId:s,paneSizes:o,setPaneSizes:g,setPaneWorker:S,removePane:i,changeLayoutMode:a,sendInput:d,workers:v}=_t(),u=r.find(f=>f.id===s)||r[0],_=u!=null&&u.workerId?v.find(f=>f.id===u.workerId):null,b=(f,n)=>p.jsx(wv,{paneId:f.id,workerId:f.workerId,onWorkerChange:c=>S(f.id,c),onClose:()=>i(f.id),isActive:s===f.id,showCloseButton:r.length>1,className:"h-full"},f.id),w=()=>{switch(t){case Re.SINGLE:return p.jsx("div",{className:"h-full p-2",children:r[0]&&b(r[0])});case Re.SPLIT_H:return p.jsx("div",{className:"h-full p-2",children:p.jsx(vh,{direction:"horizontal",sizes:o,onSizesChange:g,minSize:200,children:r.slice(0,2).map((c,l)=>b(c))})});case Re.SPLIT_V:return p.jsx("div",{className:"h-full p-2",children:p.jsx(vh,{direction:"vertical",sizes:o,onSizesChange:g,minSize:100,children:r.slice(0,2).map((c,l)=>b(c))})});case Re.GRID_2X2:return p.jsx("div",{className:"h-full p-2",children:p.jsx(To,{columns:2,rows:2,gap:8,children:r.slice(0,4).map((c,l)=>b(c))})});case Re.GRID_3X2:return p.jsx("div",{className:"h-full p-2",children:p.jsx(To,{columns:3,rows:2,gap:8,children:r.slice(0,6).map((c,l)=>b(c))})});case Re.CUSTOM:default:const f=Math.ceil(Math.sqrt(r.length)),n=Math.ceil(r.length/f);return p.jsx("div",{className:"h-full p-2",children:p.jsx(To,{columns:f,rows:n,gap:8,children:r.map((c,l)=>b(c))})})}};return p.jsxs("div",{className:"h-full flex flex-col",children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-black/30 border-b border-thea-gold-dark/20 flex-shrink-0",children:[p.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-thea-gold hover:text-thea-gold-bright transition-colors min-h-[44px] min-w-[44px] px-2 -ml-2",children:[p.jsx(Tn,{className:"w-6 h-6 flex-shrink-0"}),p.jsx("span",{className:"font-rajdhani font-semibold hidden sm:inline",children:"Back to Grid"})]}),p.jsx(Sv,{}),p.jsx("div",{className:"text-xs text-thea-gold-dark font-mono",children:(_==null?void 0:_.label)||"No active worker"})]}),p.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:w()}),_&&p.jsx("div",{className:"p-4 border-t border-thea-gold-dark/20 flex-shrink-0",children:p.jsx(jf,{onSend:f=>d(_.id,f),placeholder:`Send to ${_.label}...`})})]})}const bv="";function kv(){const{workers:e,outputs:t,selectedProject:r,focusedWorker:s,sendInput:o,sendRawInput:g,resizeTerminal:S,detachFromWorker:i,layoutMode:a,changeLayoutMode:d,setPaneWorker:v,panes:u,updateWorkerSettings:_}=_t(),[b,w]=I.useState("summary"),[f,n]=I.useState(!1),[c,l]=I.useState(!1),[h,m]=I.useState(!1),[y,C]=I.useState(null),[L,x]=I.useState(null),E=I.useCallback(async M=>{if(!M||!M.type.startsWith("image/")){C("error"),setTimeout(()=>C(null),2e3);return}C("uploading");const B=new FormData;B.append("screenshot",M),B.append("workerId",s||"unknown");try{const $=await fetch(`${bv}/api/uploads/screenshot`,{method:"POST",body:B});if(!$.ok)throw new Error("Upload failed");const q=await $.json();x(q.path),C("success"),setTimeout(()=>C(null),5e3)}catch($){console.error("Upload error:",$),C("error"),setTimeout(()=>C(null),2e3)}},[s]),k=I.useCallback(M=>{M.preventDefault(),m(!0)},[]),T=I.useCallback(M=>{M.preventDefault(),m(!1)},[]),A=I.useCallback(M=>{var $;M.preventDefault(),m(!1);const B=($=M.dataTransfer)==null?void 0:$.files;B!=null&&B[0]&&E(B[0])},[E]);I.useEffect(()=>{if(!s)return;const M=B=>{var q;const $=(q=B.clipboardData)==null?void 0:q.items;if($){for(const K of $)if(K.type.startsWith("image/")){const Y=K.getAsFile();if(Y){E(Y);break}}}};return document.addEventListener("paste",M),()=>document.removeEventListener("paste",M)},[s,E]);const D=r?e.filter(M=>M.project===r):e,P=s?e.find(M=>M.id===s):null,O=(M=null)=>{M&&u.length>0&&v(u[0].id,M),n(!0)},F=D.length>0&&D.every(M=>M.ralphMode),H=D.length>0&&D.every(M=>M.autoAccept&&!M.autoAcceptPaused),R=I.useCallback(()=>{const M=!F;D.forEach(B=>{_(B.id,{ralphMode:M})})},[D,_,F]),j=I.useCallback(()=>{const M=!H;D.forEach(B=>{_(B.id,{autoAccept:M,autoAcceptPaused:!1})})},[D,_,H]);return f?p.jsx(Cv,{onBack:()=>n(!1)}):P?p.jsxs("div",{className:V("h-full flex flex-col relative",h&&"ring-2 ring-thea-gold"),onDragOver:k,onDragLeave:T,onDrop:A,children:[h&&p.jsx("div",{className:"absolute inset-0 z-50 bg-thea-gold/20 backdrop-blur-sm flex items-center justify-center",children:p.jsxs("div",{className:"text-center",children:[p.jsx(pf,{className:"w-16 h-16 text-thea-gold-bright mx-auto mb-3"}),p.jsx("p",{className:"text-thea-gold-bright font-rajdhani text-xl",children:"Drop image to upload"})]})}),y&&p.jsxs("div",{className:V("absolute top-16 left-1/2 -translate-x-1/2 z-50 px-4 py-2 rounded shadow-lg flex items-center gap-2 text-sm font-mono",y==="uploading"&&"bg-thea-gold/90 text-black",y==="success"&&"bg-green-600 text-white",y==="error"&&"bg-red-600 text-white"),children:[y==="uploading"&&p.jsxs(p.Fragment,{children:[p.jsx(Mn,{className:"w-4 h-4 animate-pulse"}),"Uploading..."]}),y==="success"&&p.jsxs(p.Fragment,{children:[p.jsx(xs,{className:"w-4 h-4"}),p.jsx("span",{className:"max-w-[300px] truncate",children:L})]}),y==="error"&&p.jsxs(p.Fragment,{children:[p.jsx(at,{className:"w-4 h-4"}),"Upload failed"]})]}),p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-black/30 border-b border-thea-gold-dark/20",children:[p.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-thea-gold hover:text-thea-gold-bright transition-colors min-h-[44px] min-w-[44px] px-2 -ml-2",children:[p.jsx(Tn,{className:"w-6 h-6 flex-shrink-0"}),p.jsx("span",{className:"font-rajdhani font-semibold hidden sm:inline",children:"Back to Grid"})]}),p.jsxs("div",{className:"text-center min-w-0 flex-1 mx-2",children:[p.jsx("h2",{className:"font-orbitron font-bold text-thea-gold-bright uppercase tracking-wider text-sm md:text-base truncate",children:P.label}),p.jsxs("p",{className:"text-[10px] md:text-xs text-thea-gold-dark font-mono truncate",children:[P.project,"  ",P.id]})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("button",{onClick:()=>l(!c),className:V("p-2 transition-colors",c?"text-thea-gold-bright bg-thea-gold/10 rounded":"text-thea-gold-dark hover:text-thea-gold"),title:c?"Hide Health Panel":"Show Health Panel",children:p.jsx(Ft,{className:"w-5 h-5"})}),p.jsxs("label",{className:"p-2 text-thea-gold-dark hover:text-thea-gold transition-colors cursor-pointer",title:"Upload screenshot",children:[p.jsx(Mn,{className:"w-5 h-5"}),p.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:M=>{var B;(B=M.target.files)!=null&&B[0]&&E(M.target.files[0]),M.target.value=""}})]}),p.jsxs("div",{className:"flex items-center gap-1 bg-black/50 rounded border border-thea-gold-dark/30 p-0.5",children:[p.jsxs("button",{onClick:()=>w("summary"),className:V("flex items-center gap-1.5 px-2 md:px-3 py-1.5 rounded text-sm font-rajdhani transition-all",b==="summary"?"bg-thea-gold/20 text-thea-gold-bright":"text-thea-gold-dark hover:text-thea-gold"),title:"AI Summary View",children:[p.jsx(Hl,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden md:inline",children:"Summary"})]}),p.jsxs("button",{onClick:()=>w("terminal"),className:V("flex items-center gap-1.5 px-2 md:px-3 py-1.5 rounded text-sm font-rajdhani transition-all",b==="terminal"?"bg-thea-gold/20 text-thea-gold-bright":"text-thea-gold-dark hover:text-thea-gold"),title:"Raw Terminal View",children:[p.jsx(Jn,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden md:inline",children:"Terminal"})]})]}),P&&p.jsxs("button",{onClick:()=>{P.autoAcceptPaused?_(P.id,{autoAcceptPaused:!1}):_(P.id,{autoAccept:!P.autoAccept})},className:V("flex items-center gap-1.5 px-2 md:px-3 py-1.5 rounded text-sm font-rajdhani transition-all",P.autoAccept?P.autoAcceptPaused?"bg-yellow-600/30 text-yellow-500 hover:bg-yellow-600/40":"bg-green-600/30 text-green-500 hover:bg-green-600/40":"text-thea-gold-dark hover:text-thea-gold hover:bg-white/5"),title:P.autoAccept?P.autoAcceptPaused?"Auto-accept PAUSED (click to resume)":"Auto-accept ON (click to disable)":"Auto-accept OFF (click to enable)",children:[P.autoAccept?P.autoAcceptPaused?p.jsx(_i,{className:"w-4 h-4"}):p.jsx(Or,{className:"w-4 h-4"}):p.jsx(Ia,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden md:inline",children:P.autoAccept&&P.autoAcceptPaused?"Paused":"Auto"})]}),P&&p.jsxs("button",{onClick:()=>{_(P.id,{ralphMode:!P.ralphMode})},className:V("flex items-center gap-1.5 px-2 md:px-3 py-1.5 rounded text-sm font-rajdhani transition-all",P.ralphMode?"bg-purple-600/30 text-purple-400 hover:bg-purple-600/40":"text-thea-gold-dark hover:text-thea-gold hover:bg-white/5"),title:P.ralphMode?"Ralph mode ON - Worker will signal completion via API":"Ralph mode OFF - Enable autonomous completion signaling",children:[p.jsx(ps,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden md:inline",children:"Ralph"})]})]})]}),p.jsxs("div",{className:"flex-1 p-4 min-h-0 flex gap-4 relative",children:[p.jsx("div",{className:V("flex-1 min-w-0",c&&"lg:max-w-[calc(100%-288px)]"),children:b==="summary"?p.jsx("div",{className:"h-full bg-black/30 border border-thea-gold-dark/20 rounded p-4 overflow-auto",children:p.jsx(Nf,{workerId:s,className:"h-full"})}):p.jsx(Af,{workerId:s,output:t[s]||"",onRawInput:M=>g(s,M),onResize:(M,B)=>S(s,M,B),className:"h-full w-full"})}),c&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"lg:hidden fixed inset-0 top-16 z-50 bg-black/95 overflow-auto p-4",children:[p.jsxs("div",{className:"flex items-center justify-between mb-4",children:[p.jsx("h3",{className:"font-orbitron text-thea-gold-bright uppercase tracking-wider",children:"Health Panel"}),p.jsx("button",{onClick:()=>l(!1),className:"p-2 text-thea-gold hover:text-thea-gold-bright",children:p.jsx(Tn,{className:"w-5 h-5"})})]}),p.jsx(mh,{workerId:s})]}),p.jsx("div",{className:"hidden lg:block w-72 shrink-0",children:p.jsx(mh,{workerId:s})})]})]}),p.jsx("div",{className:"p-4 border-t border-thea-gold-dark/20",children:p.jsx(jf,{onSend:M=>o(s,M),placeholder:`Send to ${P.label}...`})})]}):p.jsxs("div",{className:"p-4",children:[D.length>0&&p.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("button",{onClick:j,className:V("flex items-center gap-2 px-3 py-1.5 text-sm font-rajdhani rounded transition-all border",H?"bg-green-600/30 text-green-500 border-green-600/40 hover:bg-green-600/40":"text-thea-gold hover:text-thea-gold-bright bg-black/30 hover:bg-black/50 border-thea-gold-dark/30 hover:border-thea-gold/50"),title:H?"Click to disable auto-accept on all workers":"Click to enable auto-accept on all workers",children:[H?p.jsx(Or,{className:"w-4 h-4"}):p.jsx(Ia,{className:"w-4 h-4"}),"Auto-Accept All"]}),p.jsxs("button",{onClick:R,className:V("flex items-center gap-2 px-3 py-1.5 text-sm font-rajdhani rounded transition-all border",F?"bg-purple-600/30 text-purple-400 border-purple-600/40 hover:bg-purple-600/40":"text-thea-gold hover:text-thea-gold-bright bg-black/30 hover:bg-black/50 border-thea-gold-dark/30 hover:border-thea-gold/50"),title:F?"Click to disable Ralph mode on all workers":"Click to enable Ralph mode on all workers",children:[p.jsx(ps,{className:"w-4 h-4"}),"Ralph All"]})]}),p.jsxs("button",{onClick:()=>O(),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-rajdhani text-thea-gold hover:text-thea-gold-bright bg-black/30 hover:bg-black/50 border border-thea-gold-dark/30 hover:border-thea-gold/50 rounded transition-all",children:[p.jsx(gs,{className:"w-4 h-4"}),"Multi-Terminal View"]})]}),D.length===0?p.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[p.jsx("div",{className:"w-16 h-16 mb-4 opacity-30",children:p.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",className:"text-thea-gold",children:[p.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),p.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),p.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]})}),p.jsx("h3",{className:"font-orbitron text-lg text-thea-gold-dark mb-2",children:"No Workers Active"}),p.jsx("p",{className:"text-sm text-thea-gold-dark/50 text-center max-w-xs",children:r?`No workers running for ${r}. Start one from the project panel.`:"Select a project and start a worker to begin."})]}):p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:D.map(M=>p.jsx(dv,{worker:M,onOpenInMultiTerminal:()=>O(M.id)},M.id))})]})}const Ev="";function Lv({onExit:e}){const{workers:t}=_t(),{isListening:r,isSpeaking:s,transcript:o,sttSupported:g,ttsSupported:S,startListening:i,stopListening:a,clearTranscript:d,speak:v,stopSpeaking:u}=Vl(),[_,b]=I.useState(!1),[w,f]=I.useState(null),[n,c]=I.useState([]),[l,h]=I.useState(!0),[m,y]=I.useState(!0),C=I.useCallback(async T=>{if(T.trim()){b(!0),c(A=>[...A,{role:"user",content:T}]);try{const D=await(await fetch(`${Ev}/api/voice/command`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:T})})).json();f(D),c(P=>[...P,{role:"assistant",content:D.spoken||"Action completed."}]),l&&D.spoken&&await v(D.spoken),m&&!r&&setTimeout(()=>{i()},500)}catch(A){console.error("Voice command error:",A);const D="Sorry, I had trouble processing that request.";c(P=>[...P,{role:"assistant",content:D}]),l&&await v(D)}finally{b(!1)}}},[l,v,m,r,i]),L=I.useCallback(()=>{r&&a(),o.trim()&&(C(o),d())},[r,a,o,C,d]),x=I.useCallback(()=>{s&&u(),r?L():(d(),i())},[r,s,u,L,d,i]),E=()=>_?"bg-amber-500":s?"bg-blue-500":r?"bg-red-500":"bg-thea-gold",k=()=>_?"Thinking...":s?"Speaking...":r?"Listening...":"Ready";return p.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-b from-black to-thea-nearBlack",children:[p.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-thea-gold-dark/20",children:[p.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-thea-gold hover:text-thea-gold-bright transition-colors",children:[p.jsx(Tn,{className:"w-5 h-5"}),p.jsx("span",{className:"font-rajdhani font-semibold",children:"Exit Voice Mode"})]}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("button",{onClick:()=>h(!l),className:V("p-2 rounded transition-colors",l?"text-thea-gold-bright bg-thea-gold/20":"text-thea-gold-dark"),title:l?"Disable voice responses":"Enable voice responses",children:l?p.jsx(Nn,{className:"w-5 h-5"}):p.jsx(Wl,{className:"w-5 h-5"})}),p.jsx("div",{className:"px-3 py-1 bg-black/50 rounded border border-thea-gold-dark/30",children:p.jsxs("span",{className:"text-xs text-thea-gold-dark",children:[t.length," worker",t.length!==1?"s":""]})})]})]}),p.jsx("div",{className:"flex-1 overflow-auto p-6",children:p.jsxs("div",{className:"max-w-2xl mx-auto space-y-4",children:[n.length===0?p.jsxs("div",{className:"text-center py-12",children:[p.jsx(Hl,{className:"w-16 h-16 mx-auto mb-4 text-thea-gold-dark/30"}),p.jsx("h2",{className:"text-xl font-orbitron text-thea-gold-dark mb-2",children:"Voice Mode Active"}),p.jsx("p",{className:"text-sm text-thea-gold-dark/50 max-w-sm mx-auto",children:"Tap the microphone to speak. You can ask about worker status, start new workers, approve or reject pending actions, and more."}),p.jsxs("div",{className:"mt-6 space-y-2 text-left max-w-sm mx-auto",children:[p.jsx("p",{className:"text-xs text-thea-gold-dark/70",children:"Try saying:"}),p.jsxs("ul",{className:"text-xs text-thea-gold-dark/50 space-y-1",children:[p.jsx("li",{children:`"What's the status of my workers?"`}),p.jsx("li",{children:'"Start a new worker on strategos"'}),p.jsx("li",{children:'"Yes, approve that"'}),p.jsx("li",{children:'"Send help me with testing to the worker"'})]})]})]}):n.map((T,A)=>p.jsxs("div",{className:V("p-4 rounded-lg",T.role==="user"?"bg-thea-gold/10 border border-thea-gold/20 ml-8":"bg-black/50 border border-thea-gold-dark/20 mr-8"),children:[p.jsx("div",{className:"text-xs text-thea-gold-dark/50 mb-1",children:T.role==="user"?"You":"Strategos"}),p.jsx("p",{className:"text-sm text-white",children:T.content})]},A)),o&&p.jsxs("div",{className:"p-4 rounded-lg bg-thea-gold/5 border border-thea-gold/30 ml-8 animate-pulse",children:[p.jsx("div",{className:"text-xs text-thea-gold/70 mb-1",children:"You (listening...)"}),p.jsx("p",{className:"text-sm text-thea-gold",children:o})]}),_&&p.jsx("div",{className:"p-4 rounded-lg bg-black/50 border border-amber-500/20 mr-8",children:p.jsxs("div",{className:"flex items-center gap-2 text-amber-500",children:[p.jsx(Qt,{className:"w-4 h-4 animate-spin"}),p.jsx("span",{className:"text-sm",children:"Processing..."})]})})]})}),p.jsx("div",{className:"p-6 border-t border-thea-gold-dark/20",children:p.jsxs("div",{className:"max-w-2xl mx-auto flex flex-col items-center gap-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:V("w-2 h-2 rounded-full",E())}),p.jsx("span",{className:"text-sm text-thea-gold-dark",children:k()})]}),p.jsx("button",{onClick:x,disabled:_||!g,className:V("w-24 h-24 rounded-full flex items-center justify-center transition-all","border-4",r?"bg-red-500/20 border-red-500 text-red-400 animate-pulse scale-110":s?"bg-blue-500/20 border-blue-500 text-blue-400":"bg-thea-gold/10 border-thea-gold text-thea-gold hover:bg-thea-gold/20 hover:scale-105","disabled:opacity-50 disabled:cursor-not-allowed"),children:r?p.jsx(zl,{className:"w-10 h-10"}):p.jsx(ci,{className:"w-10 h-10"})}),p.jsx("p",{className:"text-xs text-thea-gold-dark/50 text-center",children:r?"Tap to stop and send":s?"Speaking response...":"Tap to start listening"}),!g&&p.jsx("p",{className:"text-xs text-red-400 text-center",children:"Speech recognition not supported in this browser"}),!S&&l&&p.jsx("p",{className:"text-xs text-amber-400 text-center",children:"Speech synthesis not available"})]})})]})}const yh={worker_started:{icon:Hm,color:"text-status-success",glow:"shadow-[0_0_10px_rgba(78,201,176,0.5)]"},worker_stopped:{icon:Vm,color:"text-thea-maroon-light",glow:"shadow-red-sm"},error:{icon:_i,color:"text-status-error",glow:"shadow-[0_0_10px_rgba(244,135,113,0.5)]"}};function Rv({className:e=""}){const{activity:t}=_t(),r=s=>new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});return p.jsxs("div",{className:V("bg-gradient-to-b from-thea-nearBlack/80 to-black/60",e),children:[p.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-thea-gold-dark/30 bg-black/40",children:[p.jsx(Ft,{className:"w-4 h-4 text-thea-gold animate-pulse-gold"}),p.jsx("h3",{className:"font-orbitron text-xs uppercase tracking-[0.15em] text-thea-gold-bright text-glow-gold-sm",children:"Activity"})]}),p.jsx("div",{className:"max-h-64 overflow-y-auto",children:t.length===0?p.jsx("div",{className:"px-4 py-6 text-center",children:p.jsx("span",{className:"text-thea-gold-dark/50 text-sm font-mono",children:"// No activity yet"})}):p.jsx("ul",{className:"divide-y divide-thea-gold-dark/10",children:t.slice(0,20).map(s=>{const o=yh[s.type]||yh.error,g=o.icon;return p.jsx("li",{className:"px-4 py-3 hover:bg-thea-gold/5 transition-colors group",children:p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsx("div",{className:V("p-1 rounded-sm",o.glow),children:p.jsx(g,{className:V("w-4 h-4 flex-shrink-0",o.color)})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"text-sm text-white/90 truncate font-rajdhani",children:s.message}),p.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[p.jsx("span",{className:"text-[10px] text-thea-gold-deep font-mono tracking-wider",children:r(s.timestamp)}),p.jsx("span",{className:"thea-tag text-[9px] py-0.5 px-1.5",children:s.project})]})]})]})},s.id)})})})]})}const Hi="";function Av({className:e=""}){const[t,r]=I.useState(null),[s,o]=I.useState([]),[g,S]=I.useState(!1),[i,a]=I.useState(null),[d,v]=I.useState(null),[u,_]=I.useState(null);I.useEffect(()=>{b()},[]);const b=async()=>{try{const h=await fetch(`${Hi}/api/activity/patterns`);if(!h.ok)throw new Error("Failed to fetch patterns");const m=await h.json();r(m),a(null)}catch(h){a(h.message)}},w=async()=>{try{const h=await fetch(`${Hi}/api/activity/workflows`);if(!h.ok)throw new Error("Failed to fetch workflows");const m=await h.json();o(m)}catch(h){console.error("Failed to fetch workflows:",h)}},f=async()=>{S(!0),a(null);try{const h=await fetch(`${Hi}/api/activity/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({windowSize:3,minOccurrences:2,minConfidence:.3})});if(!h.ok)throw new Error("Analysis failed");const m=await h.json();await b(),await w(),m.suggestions&&m.suggestions.length>0&&v(0)}catch(h){a(h.message)}finally{S(!1)}},n=async h=>{try{await fetch(`${Hi}/api/activity/workflows/${h}/accept`,{method:"POST"}),await w()}catch(m){console.error("Failed to accept workflow:",m)}},c=async(h,m)=>{try{await navigator.clipboard.writeText(h),_(m),setTimeout(()=>_(null),2e3)}catch(y){console.error("Failed to copy:",y)}},l=h=>h?(typeof h=="string"?JSON.parse(h):h).map(y=>{switch(y){case"worker_started":return"Start";case"worker_stopped":return"Stop";case"command_sent":return"Cmd";case"error":return"Err";default:return y}}).join("  "):"";return p.jsxs("div",{className:V("bg-gradient-to-b from-thea-nearBlack/80 to-black/60",e),children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-thea-gold-dark/30 bg-black/40",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Ba,{className:"w-4 h-4 text-thea-gold animate-pulse-gold"}),p.jsx("h3",{className:"font-orbitron text-xs uppercase tracking-[0.15em] text-thea-gold-bright text-glow-gold-sm",children:"Activity Patterns"})]}),p.jsxs("button",{onClick:f,disabled:g,className:V("thea-btn px-3 py-1.5 text-xs flex items-center gap-2",g&&"opacity-50 cursor-not-allowed"),children:[p.jsx(Ht,{className:V("w-3 h-3",g&&"animate-spin")}),g?"Analyzing...":"Analyze"]})]}),i&&p.jsx("div",{className:"px-4 py-3 bg-red-900/20 border-b border-red-500/30",children:p.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[p.jsx(at,{className:"w-4 h-4"}),p.jsx("span",{children:i})]})}),t&&p.jsxs("div",{className:"grid grid-cols-3 gap-2 p-4 border-b border-thea-gold-dark/20",children:[p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-2xl font-bold text-thea-gold-bright font-mono",children:t.totalEvents}),p.jsx("div",{className:"text-[10px] text-thea-gold-dark uppercase tracking-wider",children:"Events"})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-2xl font-bold text-thea-gold-bright font-mono",children:t.totalSequences}),p.jsx("div",{className:"text-[10px] text-thea-gold-dark uppercase tracking-wider",children:"Sequences"})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-2xl font-bold text-thea-gold-bright font-mono",children:t.totalWorkflows}),p.jsx("div",{className:"text-[10px] text-thea-gold-dark uppercase tracking-wider",children:"Workflows"})]})]}),(t==null?void 0:t.topSequences)&&t.topSequences.length>0&&p.jsxs("div",{className:"p-4 border-b border-thea-gold-dark/20",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[p.jsx(Dn,{className:"w-4 h-4 text-thea-gold-deep"}),p.jsx("span",{className:"text-xs text-thea-gold uppercase tracking-wider font-rajdhani",children:"Top Patterns"})]}),p.jsx("div",{className:"space-y-2",children:t.topSequences.map((h,m)=>p.jsxs("div",{className:"flex items-center justify-between p-2 bg-black/30 rounded border border-thea-gold-dark/10",children:[p.jsx("div",{className:"flex items-center gap-2",children:p.jsx("span",{className:"text-xs font-mono text-white/80",children:l(h.types)})}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("span",{className:"text-[10px] text-thea-gold-dark",children:[h.occurrences,"x"]}),h.confidence>0&&p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx(Or,{className:"w-3 h-3 text-status-success"}),p.jsxs("span",{className:"text-[10px] text-status-success",children:[Math.round(h.confidence*100),"%"]})]})]})]},m))})]}),s.length>0&&p.jsxs("div",{className:"p-4",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[p.jsx(Tm,{className:"w-4 h-4 text-thea-gold-deep"}),p.jsx("span",{className:"text-xs text-thea-gold uppercase tracking-wider font-rajdhani",children:"Suggested Workflows"})]}),p.jsx("div",{className:"space-y-2",children:s.map((h,m)=>p.jsxs("div",{className:"bg-black/30 rounded border border-thea-gold-dark/20 overflow-hidden",children:[p.jsxs("button",{onClick:()=>v(d===m?null:m),className:"w-full flex items-center justify-between p-3 hover:bg-thea-gold/5 transition-colors",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(Il,{className:V("w-4 h-4 text-thea-gold-dark transition-transform",d===m&&"rotate-90")}),p.jsx("span",{className:"text-sm text-white/90 font-rajdhani",children:h.name})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("span",{className:"thea-tag text-[9px] py-0.5 px-1.5",children:[Math.round(h.confidence_score*100),"% conf"]}),h.times_accepted>0&&p.jsx(os,{className:"w-3 h-3 text-status-success"})]})]}),d===m&&p.jsxs("div",{className:"border-t border-thea-gold-dark/20 p-3 space-y-3",children:[p.jsx("p",{className:"text-xs text-thea-gold-dark",children:h.description}),h.sequence_types&&p.jsxs("div",{className:"text-[10px] text-thea-gold-deep",children:["Pattern: ",l(h.sequence_types)," (",h.occurrence_count,"x)"]}),p.jsxs("div",{className:"relative",children:[p.jsx("pre",{className:"text-[10px] text-white/70 bg-black/50 p-2 rounded overflow-x-auto max-h-40 font-mono",children:h.workflow_yaml}),p.jsx("button",{onClick:()=>c(h.workflow_yaml,h.id),className:"absolute top-2 right-2 p-1 bg-black/70 rounded hover:bg-thea-gold/20 transition-colors",title:"Copy YAML",children:u===h.id?p.jsx(os,{className:"w-3 h-3 text-status-success"}):p.jsx(Lm,{className:"w-3 h-3 text-thea-gold-dark"})})]}),p.jsx("div",{className:"flex gap-2",children:p.jsxs("button",{onClick:()=>n(h.id),className:"thea-btn px-3 py-1.5 text-xs flex items-center gap-1",children:[p.jsx(os,{className:"w-3 h-3"}),"Accept"]})})]})]},h.id))})]}),(!t||t.totalSequences===0&&s.length===0)&&!i&&p.jsxs("div",{className:"px-4 py-8 text-center",children:[p.jsx(Ba,{className:"w-8 h-8 text-thea-gold-dark/30 mx-auto mb-3"}),p.jsx("p",{className:"text-sm text-thea-gold-dark/50",children:"No patterns detected yet"}),p.jsx("p",{className:"text-xs text-thea-gold-dark/30 mt-1",children:"Use workers to generate activity, then analyze"})]})]})}const xh="",wh={proposed:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",accepted:"bg-green-500/20 text-green-400 border-green-500/30",deprecated:"bg-red-500/20 text-red-400 border-red-500/30",superseded:"bg-gray-500/20 text-gray-400 border-gray-500/30"};function Tv({className:e,limit:t=5}){const[r,s]=I.useState([]),[o,g]=I.useState(!0),[S,i]=I.useState(null),[a,d]=I.useState(null),[v,u]=I.useState(null),_=async()=>{g(!0),i(null);try{const f=await fetch(`${xh}/api/adrs?limit=${t}`);if(!f.ok)throw new Error("Failed to fetch ADRs");const n=await f.json();s(n)}catch(f){i(f.message)}finally{g(!1)}},b=async f=>{try{const n=await fetch(`${xh}/api/adrs/${f}`);if(!n.ok)throw new Error("Failed to fetch ADR");const c=await n.json();u(c)}catch(n){console.error("Error fetching ADR detail:",n)}};I.useEffect(()=>{_()},[t]);const w=f=>{a===f?(d(null),u(null)):(d(f),b(f))};return o&&r.length===0?p.jsxs("div",{className:V("thea-panel p-4",e),children:[p.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[p.jsx(sn,{className:"w-4 h-4 text-thea-gold"}),p.jsx("h3",{className:"font-rajdhani font-bold text-thea-gold-bright uppercase tracking-wider text-sm",children:"Architecture Decisions"})]}),p.jsx("div",{className:"flex items-center justify-center py-8 text-thea-gold-dark",children:p.jsx(Ht,{className:"w-5 h-5 animate-spin"})})]}):S?p.jsxs("div",{className:V("thea-panel p-4",e),children:[p.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[p.jsx(sn,{className:"w-4 h-4 text-thea-gold"}),p.jsx("h3",{className:"font-rajdhani font-bold text-thea-gold-bright uppercase tracking-wider text-sm",children:"Architecture Decisions"})]}),p.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[p.jsx(at,{className:"w-4 h-4"}),p.jsx("span",{children:S})]}),p.jsx("button",{onClick:_,className:"mt-2 text-xs text-thea-gold-dark hover:text-thea-gold",children:"Retry"})]}):p.jsxs("div",{className:V("thea-panel",e),children:[p.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-thea-gold-dark/30",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(sn,{className:"w-4 h-4 text-thea-gold"}),p.jsx("h3",{className:"font-rajdhani font-bold text-thea-gold-bright uppercase tracking-wider text-sm",children:"Architecture Decisions"}),p.jsxs("span",{className:"text-xs text-thea-gold-dark",children:["(",r.length,")"]})]}),p.jsx("button",{onClick:_,className:"p-1 text-thea-gold-dark hover:text-thea-gold transition-colors",title:"Refresh",children:p.jsx(Ht,{className:V("w-3.5 h-3.5",o&&"animate-spin")})})]}),p.jsx("div",{className:"divide-y divide-thea-gold-dark/20",children:r.length===0?p.jsx("div",{className:"p-4 text-center text-thea-gold-dark text-sm",children:"No architecture decisions recorded yet."}):r.map(f=>{var n,c,l,h;return p.jsxs("div",{className:"group",children:[p.jsxs("button",{onClick:()=>w(f.id),className:"w-full px-4 py-3 flex items-start gap-3 hover:bg-thea-gold/5 transition-colors text-left",children:[p.jsx(Il,{className:V("w-4 h-4 text-thea-gold-dark mt-0.5 transition-transform",a===f.id&&"rotate-90")}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[p.jsxs("span",{className:"font-mono text-xs text-thea-gold-dark",children:["ADR-",f.id]}),p.jsx("span",{className:V("px-1.5 py-0.5 text-[10px] font-mono uppercase rounded border",wh[f.status]||wh.proposed),children:f.status})]}),p.jsx("h4",{className:"text-sm text-thea-gold-bright font-medium truncate group-hover:text-thea-gold",children:f.title}),f.date&&p.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-thea-gold-dark",children:[p.jsx(bm,{className:"w-3 h-3"}),p.jsx("span",{children:f.date})]})]})]}),a===f.id&&p.jsx("div",{className:"px-4 pb-4 pl-11 border-t border-thea-gold-dark/10 bg-black/20",children:v?p.jsxs("div",{className:"pt-3 space-y-3",children:[((c=(n=v.frontmatter)==null?void 0:n.tags)==null?void 0:c.length)>0&&p.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[p.jsx(vf,{className:"w-3 h-3 text-thea-gold-dark"}),v.frontmatter.tags.map(m=>p.jsx("span",{className:"px-2 py-0.5 text-[10px] bg-thea-gold/10 text-thea-gold-dark rounded border border-thea-gold-dark/20",children:m},m))]}),((h=(l=v.frontmatter)==null?void 0:l.deciders)==null?void 0:h.length)>0&&p.jsxs("div",{className:"flex items-center gap-2 text-xs text-thea-gold-dark",children:[p.jsx(xf,{className:"w-3 h-3"}),p.jsx("span",{children:v.frontmatter.deciders.join(", ")})]}),v.context&&p.jsxs("div",{className:"text-xs text-thea-gold-dark/80 leading-relaxed",children:[p.jsx("span",{className:"font-semibold text-thea-gold-dark",children:"Context: "}),v.context.slice(0,300),v.context.length>300&&"..."]}),v.decision&&p.jsxs("div",{className:"text-xs text-thea-gold-dark/80 leading-relaxed",children:[p.jsx("span",{className:"font-semibold text-thea-gold-dark",children:"Decision: "}),v.decision.slice(0,200),v.decision.length>200&&"..."]})]}):p.jsx("div",{className:"pt-3 flex items-center justify-center",children:p.jsx(Ht,{className:"w-4 h-4 text-thea-gold-dark animate-spin"})})})]},f.id)})})]})}const Dv="";function Mv({className:e}){const{socket:t,connected:r}=af(),[s,o]=I.useState(null),[g,S]=I.useState(!0),[i,a]=I.useState(null),d=I.useCallback(async()=>{S(!0),a(null);try{const l=await fetch(`${Dv}/api/metrics/system`);if(!l.ok){if(l.status===404){o(null);return}throw new Error("Failed to fetch system metrics")}const h=await l.json();o(h)}catch(l){a(l.message)}finally{S(!1)}},[]);if(I.useEffect(()=>{d();const l=setInterval(d,15e3);return()=>clearInterval(l)},[d]),I.useEffect(()=>{if(!t||!r)return;t.emit("metrics:subscribe");const l=h=>{o(h)};return t.on("metrics:update",l),()=>{t.emit("metrics:unsubscribe"),t.off("metrics:update",l)}},[t,r]),g&&!s)return p.jsxs("div",{className:V("thea-card",e),children:[p.jsx(Do,{onRefresh:d,loading:g}),p.jsx("div",{className:"flex items-center justify-center py-12 text-thea-gold-dark",children:p.jsx(Ht,{className:"w-5 h-5 animate-spin"})})]});if(i)return p.jsxs("div",{className:V("thea-card",e),children:[p.jsx(Do,{onRefresh:d,loading:g}),p.jsxs("div",{className:"p-4",children:[p.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[p.jsx(at,{className:"w-4 h-4"}),p.jsx("span",{children:i})]}),p.jsx("button",{onClick:d,className:"mt-2 text-xs text-thea-gold-dark hover:text-thea-gold",children:"Retry"})]})]});const u=(l=>{if(!l)return null;switch(l.toLowerCase()){case"healthy":return 100;case"degraded":return 60;case"critical":return 30;case"unknown":return null;default:return null}})(s==null?void 0:s.healthStatus),_=(s==null?void 0:s.activeWorkers)??0,b=(s==null?void 0:s.totalSpawns)??0,w=(s==null?void 0:s.avgSpawnTime)??null,f=(s==null?void 0:s.errorRate)??0,n=(s==null?void 0:s.uptime)??null,c=(s==null?void 0:s.memoryUsage)??null;return p.jsxs("div",{className:V("thea-card",e),children:[p.jsx(Do,{onRefresh:d,loading:g}),p.jsxs("div",{className:"p-4 space-y-4",children:[p.jsxs("div",{className:"flex items-center justify-between pb-3 border-b border-thea-gold-dark/20",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Ft,{className:"w-4 h-4 text-thea-gold"}),p.jsx("span",{className:"text-sm text-thea-gold-dark",children:"System Health"})]}),p.jsx(Tf,{score:u,size:"md",showScore:!0})]}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[p.jsx(Mo,{icon:xf,label:"Active",value:_,status:_>0?"active":"idle"}),p.jsx(Mo,{icon:Pa,label:"Total Spawns",value:b,status:"neutral"}),p.jsx(Mo,{icon:_i,label:"Errors",value:`${(f*100).toFixed(1)}%`,status:Nv(f)})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("h4",{className:"text-[10px] text-thea-gold-dark uppercase tracking-wider font-mono",children:"Performance"}),p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsx(Sh,{icon:yf,label:"Avg Spawn",value:w!==null?`${w}ms`:"--",trend:jv(w)}),p.jsx(Sh,{icon:Or,label:"Memory",value:c!==null?`${c}%`:"--",trend:Pv(c)})]})]}),n!==null&&p.jsx("div",{className:"pt-2 border-t border-thea-gold-dark/20",children:p.jsxs("div",{className:"flex items-center justify-between text-xs",children:[p.jsx("span",{className:"text-thea-gold-dark",children:"Server Uptime"}),p.jsx("span",{className:"font-mono text-thea-gold-bright",children:Bv(n)})]})}),!s&&p.jsxs("div",{className:"text-center py-4 text-thea-gold-dark text-sm",children:[p.jsx(Pa,{className:"w-8 h-8 mx-auto mb-2 opacity-30"}),p.jsx("p",{children:"Metrics service initializing..."}),p.jsx("p",{className:"text-[10px] mt-1 opacity-60",children:"Data will appear when available"})]}),p.jsx("div",{className:"pt-2 border-t border-thea-gold-dark/20",children:p.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-thea-gold-dark",children:[p.jsx(Mf,{score:r?100:0,size:"sm"}),p.jsx("span",{children:r?"Real-time updates active":"Connecting..."})]})})]})]})}function Do({onRefresh:e,loading:t}){return p.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-thea-gold-dark/30",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(cf,{className:"w-4 h-4 text-thea-gold"}),p.jsx("h3",{className:"font-rajdhani font-bold text-thea-gold-bright uppercase tracking-wider text-sm",children:"System Metrics"})]}),p.jsx("button",{onClick:e,className:"p-1 text-thea-gold-dark hover:text-thea-gold transition-colors",title:"Refresh metrics",children:p.jsx(Ht,{className:V("w-3.5 h-3.5",t&&"animate-spin")})})]})}function Mo({icon:e,label:t,value:r,status:s}){const o={active:"bg-green-500/20 text-green-400 border-green-500/30",warning:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",critical:"bg-red-500/20 text-red-400 border-red-500/30",idle:"bg-thea-gold/10 text-thea-gold-dark border-thea-gold-dark/30",neutral:"bg-thea-gold/5 text-thea-gold-dark border-thea-gold-dark/20"};return p.jsxs("div",{className:V("flex items-center gap-1.5 px-2 py-1 rounded border text-xs font-mono",o[s]||o.neutral),children:[p.jsx(e,{className:"w-3 h-3"}),p.jsxs("span",{className:"text-[10px] opacity-70",children:[t,":"]}),p.jsx("span",{className:"font-bold",children:r})]})}function Sh({icon:e,label:t,value:r,trend:s}){const o={up:p.jsx(Dn,{className:"w-3 h-3 text-green-400"}),down:p.jsx(Dn,{className:"w-3 h-3 text-red-400 rotate-180"}),stable:null};return p.jsxs("div",{className:"flex items-center justify-between p-2 bg-black/30 rounded border border-thea-gold-dark/20",children:[p.jsxs("div",{className:"flex items-center gap-1.5",children:[p.jsx(e,{className:"w-3 h-3 text-thea-gold-dark"}),p.jsx("span",{className:"text-[10px] text-thea-gold-dark",children:t})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("span",{className:"font-mono text-xs text-thea-gold-bright",children:r}),o[s]]})]})}function Nv(e){return e==null?"neutral":e<.01?"active":e<.05?"warning":"critical"}function jv(e){return e===null?"stable":e<2e3?"up":e>5e3?"down":"stable"}function Pv(e){return e===null?"stable":e<50?"up":e>80?"down":"stable"}function Bv(e){if(e==null)return"--";const t=Math.floor(e/86400),r=Math.floor(e%86400/3600),s=Math.floor(e%3600/60);return t>0?`${t}d ${r}h`:r>0?`${r}h ${s}m`:`${s}m`}const Ch={success:{icon:xs,bgClass:"bg-status-success/20 border-status-success",textClass:"text-status-success",glowClass:"shadow-[0_0_20px_rgba(78,201,176,0.4)]"},error:{icon:at,bgClass:"bg-status-error/20 border-status-error",textClass:"text-status-error",glowClass:"shadow-[0_0_20px_rgba(244,135,113,0.4)]"},info:{icon:Pm,bgClass:"bg-thea-gold/20 border-thea-gold",textClass:"text-thea-gold",glowClass:"shadow-gold-sm"},loading:{icon:Qt,bgClass:"bg-thea-gold/10 border-thea-gold-dark",textClass:"text-thea-gold-bright",glowClass:""}};function Ov({toast:e,onDismiss:t}){const r=Ch[e.type]||Ch.info,s=r.icon;return I.useEffect(()=>{if(e.duration&&e.duration>0){const o=setTimeout(()=>t(e.id),e.duration);return()=>clearTimeout(o)}},[e.id,e.duration,t]),p.jsxs("div",{className:V("flex items-start gap-3 px-4 py-3 border backdrop-blur-md","animate-[slideIn_0.3s_ease-out]",r.bgClass,r.glowClass),style:{clipPath:"polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px))"},children:[p.jsx(s,{className:V("w-5 h-5 flex-shrink-0 mt-0.5",r.textClass,e.type==="loading"&&"animate-spin")}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:V("font-rajdhani font-semibold",r.textClass),children:e.title}),e.message&&p.jsx("p",{className:"text-sm text-white/70 font-mono mt-0.5 truncate",children:e.message})]}),p.jsx("button",{onClick:()=>t(e.id),className:V("p-1 hover:bg-white/10 transition-colors",r.textClass),children:p.jsx(Jt,{className:"w-4 h-4"})})]})}function bh({toasts:e,onDismiss:t}){return p.jsx("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2 max-w-sm",children:e.map(r=>p.jsx(Ov,{toast:r,onDismiss:t},r.id))})}const Iv=[{name:"spawn_worker",patterns:[/spawn\s+(?:a\s+)?worker(?:\s+(?:on|for|in)\s+(.+))?/i,/start\s+(?:a\s+)?(?:new\s+)?worker(?:\s+(?:on|for|in)\s+(.+))?/i,/create\s+(?:a\s+)?(?:new\s+)?worker(?:\s+(?:on|for|in)\s+(.+))?/i,/launch\s+(?:a\s+)?worker(?:\s+(?:on|for|in)\s+(.+))?/i]},{name:"stop_worker",patterns:[/stop\s+(?:the\s+)?worker(?:\s+(.+))?/i,/kill\s+(?:the\s+)?worker(?:\s+(.+))?/i,/terminate\s+(?:the\s+)?worker(?:\s+(.+))?/i,/end\s+(?:the\s+)?worker(?:\s+(.+))?/i,/stop\s+all\s+workers/i,/kill\s+all\s+workers/i]},{name:"send_message",patterns:[/send\s+(?:message\s+)?["']?(.+?)["']?\s+(?:to\s+)?(?:the\s+)?(?:worker)?(?:\s+(.+))?$/i,/tell\s+(?:the\s+)?worker(?:\s+(.+))?\s+(?:to\s+)?["']?(.+?)["']?$/i,/message\s+(?:the\s+)?worker(?:\s+(.+))?\s+(?:with\s+)?["']?(.+?)["']?$/i]},{name:"show_status",patterns:[/(?:show|display|what(?:'s|\s+is)?)\s+(?:the\s+)?status/i,/status(?:\s+(?:of|for)\s+(?:the\s+)?workers?)?/i,/how\s+(?:are|is)\s+(?:the\s+)?workers?\s+doing/i,/worker\s+status/i,/list\s+workers/i,/what\s+workers\s+(?:are\s+)?running/i]}];function kh(e){const t=e.trim().toLowerCase();for(const r of Iv)for(const s of r.patterns){const o=t.match(s);if(o)return{command:r.name,matches:o.slice(1).filter(Boolean),raw:e}}return null}function Eh(e,t){if(!t)return null;const r=t.toLowerCase().trim();let s=e.find(o=>{var g;return o.id===r||((g=o.label)==null?void 0:g.toLowerCase())===r});return s||(s=e.find(o=>{var g,S;return((g=o.label)==null?void 0:g.toLowerCase().includes(r))||((S=o.projectPath)==null?void 0:S.toLowerCase().includes(r))})),s}function Fv(e,t){if(!t)return null;const r=t.toLowerCase().trim();let s=e.find(o=>{var g;return((g=o.name)==null?void 0:g.toLowerCase())===r});return s||(s=e.find(o=>{var g;return(g=o.name)==null?void 0:g.toLowerCase().includes(r)})),s}function Hv(){const{workers:e,projects:t,spawnWorker:r,killWorker:s,sendInput:o,focusedWorker:g,addToast:S}=_t(),i=I.useCallback(async d=>{if(!d)return{success:!1,message:"Command not recognized",spoken:"I didn't understand that command. Try spawn worker, stop worker, send message, or show status."};const{command:v,matches:u}=d;switch(v){case"spawn_worker":{const _=u[0];if(_){const b=Fv(t,_);return b?(await r(b.path,`${b.name} Worker`),{success:!0,message:`Spawning worker for ${b.name}`,spoken:`Spawning a new worker for ${b.name}.`}):{success:!1,message:`Project "${_}" not found`,spoken:`I couldn't find a project matching "${_}". Try saying the exact project name.`}}else if(t.length>0){const b=t[0];return await r(b.path,`${b.name} Worker`),{success:!0,message:`Spawning worker for ${b.name}`,spoken:`Spawning a new worker for ${b.name}.`}}else return{success:!1,message:"No projects available",spoken:"No projects are available to spawn a worker."}}case"stop_worker":{const _=u[0];if(d.raw.toLowerCase().includes("all")){const w=e.filter(f=>f.status==="running");return w.length===0?{success:!1,message:"No workers running",spoken:"There are no workers running to stop."}:(w.forEach(f=>s(f.id)),{success:!0,message:`Stopping ${w.length} workers`,spoken:`Stopping all ${w.length} workers.`})}if(_){const w=Eh(e,_);return w?(s(w.id),{success:!0,message:`Stopping worker ${w.label||w.id}`,spoken:`Stopping worker ${w.label||"unnamed"}.`}):{success:!1,message:`Worker "${_}" not found`,spoken:`I couldn't find a worker matching "${_}".`}}else if(g){const w=e.find(f=>f.id===g);return s(g),{success:!0,message:"Stopping focused worker",spoken:`Stopping the focused worker ${(w==null?void 0:w.label)||""}.`}}else return e.length===1?(s(e[0].id),{success:!0,message:`Stopping worker ${e[0].label||e[0].id}`,spoken:"Stopping the only running worker."}):{success:!1,message:"Please specify which worker to stop",spoken:"Please specify which worker to stop. You can say stop worker followed by the worker name, or say stop all workers."}}case"send_message":{let _=u[0],b=u[1];if((d.raw.toLowerCase().startsWith("tell")||d.raw.toLowerCase().startsWith("message"))&&(b=u[0],_=u[1]),!_)return{success:!1,message:"No message specified",spoken:"Please specify a message to send."};let w;if(b){const n=Eh(e,b);if(n)w=n.id;else return{success:!1,message:`Worker "${b}" not found`,spoken:`I couldn't find a worker matching "${b}".`}}else if(g)w=g;else if(e.length===1)w=e[0].id;else return{success:!1,message:"Please specify which worker",spoken:"Please specify which worker to send the message to."};o(w,_+`
`);const f=e.find(n=>n.id===w);return{success:!0,message:`Sent message to ${(f==null?void 0:f.label)||"worker"}`,spoken:`Message sent to ${(f==null?void 0:f.label)||"the worker"}.`}}case"show_status":{const _=e.filter(c=>c.status==="running"),b=e.filter(c=>c.status!=="running");if(e.length===0)return{success:!0,message:"No workers",spoken:"No workers are currently registered."};const w=[];_.length>0&&w.push(`${_.length} running`),b.length>0&&w.push(`${b.length} stopped`);const f=_.map(c=>c.label||"unnamed").join(", "),n=_.length>0?`You have ${_.length} worker${_.length>1?"s":""} running: ${f}.`:"No workers are currently running.";return{success:!0,message:`Workers: ${w.join(", ")}`,spoken:n}}default:return{success:!1,message:"Unknown command",spoken:"I didn't recognize that command."}}},[e,t,r,s,o,g]),a=I.useCallback(async d=>{const v=kh(d),u=await i(v);return S({type:u.success?"success":"warning",title:u.success?"Command Executed":"Command Failed",message:u.message,duration:3e3}),u},[i,S]);return{parseCommand:kh,executeCommand:i,processTranscript:a,availableCommands:[{name:"spawn worker",description:"Start a new worker",example:"spawn worker on strategos"},{name:"stop worker",description:"Stop a running worker",example:"stop worker"},{name:"send message",description:"Send text to a worker",example:"send hello to the worker"},{name:"show status",description:"Show worker status",example:"show status"}]}}function zv({className:e}){const{isListening:t,isSpeaking:r,transcript:s,sttSupported:o,ttsSupported:g,startListening:S,stopListening:i,clearTranscript:a,speak:d,stopSpeaking:v}=Vl(),{processTranscript:u,availableCommands:_}=Hv(),[b,w]=I.useState(!1),[f,n]=I.useState(!1),[c,l]=I.useState(!0),[h,m]=I.useState(null),[y,C]=I.useState(!1),L=I.useCallback(async()=>{if(!s.trim())return;C(!0);const k=await u(s);m(k),c&&k.spoken&&await d(k.spoken),a(),C(!1)},[s,u,c,d,a]),x=I.useCallback(()=>{r&&v(),t?(i(),L()):(a(),m(null),S())},[t,r,v,i,S,L,a]);if(I.useEffect(()=>{if(!t||!s)return;const k=setTimeout(()=>{s.trim()&&(i(),L())},2e3);return()=>clearTimeout(k)},[s,t,i,L]),I.useEffect(()=>{const k=T=>{T.ctrlKey&&T.shiftKey&&T.key==="V"&&(T.preventDefault(),x())};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[x]),!o)return null;const E=()=>y?"bg-amber-500":r?"bg-blue-500":t?"bg-red-500":"bg-thea-gold/50";return p.jsxs("div",{className:V("relative",e),children:[p.jsx("div",{className:V("bg-black/80 border border-thea-gold-dark/30 backdrop-blur-sm transition-all",b?"rounded-t-lg":"rounded-lg"),children:p.jsxs("div",{className:"flex items-center gap-2 p-2",children:[p.jsxs("button",{onClick:x,disabled:y,className:V("relative p-2.5 rounded-full transition-all",t?"bg-red-500/20 text-red-400 ring-2 ring-red-500/50 animate-pulse":r?"bg-blue-500/20 text-blue-400 ring-2 ring-blue-500/50":"bg-thea-gold/10 text-thea-gold hover:bg-thea-gold/20","disabled:opacity-50 disabled:cursor-not-allowed"),title:t?"Stop listening":"Start listening (Ctrl+Shift+V)",children:[t?p.jsx(zl,{className:"w-5 h-5"}):p.jsx(ci,{className:"w-5 h-5"}),p.jsx("span",{className:V("absolute -top-0.5 -right-0.5 w-2.5 h-2.5 rounded-full",E())})]}),p.jsx("div",{className:"flex-1 min-w-0",children:t&&s?p.jsx("p",{className:"text-sm text-thea-gold truncate animate-pulse",children:s}):t?p.jsx("p",{className:"text-sm text-red-400 animate-pulse",children:"Listening..."}):r?p.jsx("p",{className:"text-sm text-blue-400",children:"Speaking..."}):y?p.jsx("p",{className:"text-sm text-amber-400",children:"Processing..."}):h?p.jsx("p",{className:V("text-sm truncate",h.success?"text-green-400":"text-amber-400"),children:h.message}):p.jsx("p",{className:"text-xs text-thea-gold-dark/70",children:"Voice commands ready"})}),g&&p.jsx("button",{onClick:()=>l(!c),className:V("p-1.5 rounded transition-colors",c?"text-thea-gold-bright":"text-thea-gold-dark"),title:c?"Disable voice feedback":"Enable voice feedback",children:c?p.jsx(Nn,{className:"w-4 h-4"}):p.jsx(Wl,{className:"w-4 h-4"})}),p.jsx("button",{onClick:()=>n(!f),className:V("p-1.5 rounded transition-colors",f?"text-thea-gold-bright":"text-thea-gold-dark hover:text-thea-gold"),title:"Show available commands",children:p.jsx(ph,{className:"w-4 h-4"})}),p.jsx("button",{onClick:()=>w(!b),className:"p-1.5 rounded text-thea-gold-dark hover:text-thea-gold transition-colors",title:b?"Collapse":"Expand",children:b?p.jsx(mi,{className:"w-4 h-4"}):p.jsx(km,{className:"w-4 h-4"})})]})}),b&&p.jsx("div",{className:"bg-black/90 border border-t-0 border-thea-gold-dark/30 rounded-b-lg p-3 backdrop-blur-sm",children:f?p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("h4",{className:"text-xs font-rajdhani font-semibold text-thea-gold uppercase tracking-wider",children:"Voice Commands"}),p.jsx("button",{onClick:()=>n(!1),className:"text-thea-gold-dark hover:text-thea-gold",children:p.jsx(Jt,{className:"w-3.5 h-3.5"})})]}),p.jsx("div",{className:"space-y-1.5",children:_.map((k,T)=>p.jsxs("div",{className:"text-xs",children:[p.jsx("span",{className:"text-thea-gold font-mono",children:k.name}),p.jsxs("span",{className:"text-thea-gold-dark/70 ml-2",children:["- ",k.description]}),p.jsxs("div",{className:"text-thea-gold-dark/50 ml-2 italic",children:['"',k.example,'"']})]},T))}),p.jsx("div",{className:"mt-3 pt-2 border-t border-thea-gold-dark/20",children:p.jsxs("p",{className:"text-[10px] text-thea-gold-dark/50",children:["Keyboard shortcut: ",p.jsx("kbd",{className:"px-1 py-0.5 bg-black/50 rounded text-thea-gold-dark",children:"Ctrl+Shift+V"})]})})]}):p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[p.jsx(No,{label:"Status",onClick:()=>{u("show status").then(k=>{m(k),c&&k.spoken&&d(k.spoken)})}}),p.jsx(No,{label:"Spawn Worker",onClick:()=>{u("spawn worker").then(k=>{m(k),c&&k.spoken&&d(k.spoken)})}}),p.jsx(No,{label:"Stop All",onClick:()=>{u("stop all workers").then(k=>{m(k),c&&k.spoken&&d(k.spoken)})},variant:"danger"})]}),h&&p.jsx("div",{className:V("p-2 rounded text-xs",h.success?"bg-green-500/10 border border-green-500/20 text-green-400":"bg-amber-500/10 border border-amber-500/20 text-amber-400"),children:h.spoken}),p.jsxs("p",{className:"text-[10px] text-thea-gold-dark/50 text-center",children:["Click ",p.jsx(ph,{className:"w-3 h-3 inline"})," for all commands"]})]})})]})}function No({label:e,onClick:t,variant:r="default"}){return p.jsx("button",{onClick:t,className:V("px-2 py-1 text-xs font-rajdhani font-semibold rounded border transition-colors",r==="danger"?"border-red-500/30 text-red-400 hover:bg-red-500/10":"border-thea-gold-dark/30 text-thea-gold-dark hover:text-thea-gold hover:border-thea-gold/30 hover:bg-thea-gold/5"),children:e})}const Ts={pending:{icon:hf,color:"text-gray-400",label:"Pending"},running:{icon:hi,color:"text-status-success animate-pulse",label:"Running"},paused:{icon:gf,color:"text-thea-gold",label:"Paused"},completed:{icon:xs,color:"text-status-success",label:"Completed"},failed:{icon:at,color:"text-status-error",label:"Failed"},cancelled:{icon:Oa,color:"text-gray-500",label:"Cancelled"},blocked:{icon:at,color:"text-yellow-500",label:"Blocked"},max_iterations:{icon:Vs,color:"text-orange-500",label:"Max Iterations"},in_progress:{icon:hi,color:"text-status-success animate-pulse",label:"In Progress"}},Lh={pending:{icon:hf,color:"text-gray-400"},in_progress:{icon:hi,color:"text-status-success animate-pulse"},completed:{icon:xs,color:"text-status-success"},failed:{icon:at,color:"text-status-error"},blocked:{icon:at,color:"text-yellow-500"}};function $v({className:e=""}){const{workers:t,ralphPrds:r,ralphRuns:s,startRalphRun:o,pauseRalphRun:g,resumeRalphRun:S,cancelRalphRun:i,refreshRalphData:a,updateWorkerSettings:d}=_t(),v=t.filter(y=>y.ralphMode),[u,_]=I.useState(null),[b,w]=I.useState(null),f=y=>y?new Date(y).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}):"--",n=y=>{o(y)},c=y=>{g(y)},l=y=>{S(y)},h=y=>{i(y)},m=y=>s.find(C=>C.prd_id===y&&["pending","running","paused"].includes(C.status));return p.jsxs("div",{className:V("bg-gradient-to-b from-thea-nearBlack/80 to-black/60 flex flex-col",e),children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-thea-gold-dark/30 bg-black/40",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(ps,{className:"w-4 h-4 text-thea-gold animate-pulse-gold"}),p.jsx("h3",{className:"font-orbitron text-xs uppercase tracking-[0.15em] text-thea-gold-bright text-glow-gold-sm",children:"Ralph"})]}),p.jsx("button",{onClick:a,className:"p-1 hover:bg-thea-gold/10 rounded transition-colors",title:"Refresh",children:p.jsx(Ht,{className:"w-3.5 h-3.5 text-thea-gold-dark hover:text-thea-gold"})})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto",children:[v.length>0&&p.jsxs("div",{className:"border-b border-thea-gold-dark/20",children:[p.jsx("div",{className:"px-4 py-2 bg-purple-500/10",children:p.jsxs("span",{className:"text-[10px] uppercase tracking-wider text-purple-400 font-mono",children:["Ralph Workers (",v.length,")"]})}),p.jsx("ul",{className:"divide-y divide-thea-gold-dark/10",children:v.map(y=>p.jsxs("li",{className:"px-4 py-3 hover:bg-thea-gold/5 transition-colors",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(ps,{className:"w-4 h-4 text-purple-400"}),p.jsxs("div",{className:"min-w-0",children:[p.jsx("span",{className:"text-sm text-white/90 font-rajdhani block truncate",children:y.label}),p.jsx("span",{className:"text-[10px] text-thea-gold-dark font-mono",children:y.project})]})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:V("text-[10px] px-2 py-0.5 rounded",y.status==="running"?"bg-status-success/20 text-status-success":"bg-gray-500/20 text-gray-400"),children:y.status}),p.jsx("button",{onClick:()=>d(y.id,{ralphMode:!1}),className:"p-1 hover:bg-status-error/20 rounded",title:"Disable Ralph mode",children:p.jsx(Oa,{className:"w-3.5 h-3.5 text-status-error"})})]})]}),y.ralphToken&&p.jsxs("div",{className:"mt-2 text-[9px] text-thea-gold-dark/50 font-mono truncate",children:["Token: ",y.ralphToken]})]},y.id))})]}),s.filter(y=>["running","paused"].includes(y.status)).length>0&&p.jsxs("div",{className:"border-b border-thea-gold-dark/20",children:[p.jsx("div",{className:"px-4 py-2 bg-thea-gold/5",children:p.jsx("span",{className:"text-[10px] uppercase tracking-wider text-thea-gold-deep font-mono",children:"Active Runs"})}),p.jsx("ul",{className:"divide-y divide-thea-gold-dark/10",children:s.filter(y=>["running","paused"].includes(y.status)).map(y=>{const C=Ts[y.status]||Ts.pending,L=C.icon;return p.jsxs("li",{className:"px-4 py-3 hover:bg-thea-gold/5 transition-colors cursor-pointer",onClick:()=>_(u===y.id?null:y.id),children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(L,{className:V("w-4 h-4",C.color)}),p.jsx("span",{className:"text-sm text-white/90 font-rajdhani",children:y.prd_name||`PRD #${y.prd_id}`})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("span",{className:"text-[10px] text-thea-gold-dark font-mono",children:["Iter ",y.current_iteration,"/",y.max_iterations]}),y.status==="running"&&p.jsx("button",{onClick:x=>{x.stopPropagation(),c(y.id)},className:"p-1 hover:bg-thea-gold/20 rounded",title:"Pause",children:p.jsx(gf,{className:"w-3.5 h-3.5 text-thea-gold"})}),y.status==="paused"&&p.jsx("button",{onClick:x=>{x.stopPropagation(),l(y.id)},className:"p-1 hover:bg-status-success/20 rounded",title:"Resume",children:p.jsx(hi,{className:"w-3.5 h-3.5 text-status-success"})}),p.jsx("button",{onClick:x=>{x.stopPropagation(),h(y.id)},className:"p-1 hover:bg-status-error/20 rounded",title:"Cancel",children:p.jsx(Oa,{className:"w-3.5 h-3.5 text-status-error"})})]})]}),u===y.id&&y.stories&&p.jsx("div",{className:"mt-3 pl-6 space-y-1",children:y.stories.map((x,E)=>{const k=Lh[x.status]||Lh.pending,T=k.icon;return p.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[p.jsx(T,{className:V("w-3 h-3",k.color)}),p.jsxs("span",{className:"text-white/70",children:["Story ",E+1,": ",x.status]})]},E)})})]},y.id)})})]}),p.jsxs("div",{children:[p.jsx("div",{className:"px-4 py-2 bg-thea-gold/5",children:p.jsxs("span",{className:"text-[10px] uppercase tracking-wider text-thea-gold-deep font-mono",children:["PRDs (",r.length,")"]})}),r.length===0?p.jsxs("div",{className:"px-4 py-6 text-center",children:[p.jsx(Bm,{className:"w-8 h-8 text-thea-gold-dark/30 mx-auto mb-2"}),p.jsx("span",{className:"text-thea-gold-dark/50 text-sm font-mono",children:"No PRDs created yet"}),p.jsx("p",{className:"text-[10px] text-thea-gold-dark/30 mt-1",children:"Create via POST /api/ralph/prds"})]}):p.jsx("ul",{className:"divide-y divide-thea-gold-dark/10",children:r.map(y=>{var x,E,k;const C=m(y.id),L=b===y.id;return p.jsx("li",{className:"hover:bg-thea-gold/5 transition-colors",children:p.jsxs("div",{className:"px-4 py-3 cursor-pointer",onClick:()=>w(L?null:y.id),children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"text-sm text-white/90 font-rajdhani truncate",children:y.name}),p.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[p.jsxs("span",{className:"text-[10px] text-thea-gold-dark font-mono",children:[((x=y.stories)==null?void 0:x.length)||0," stories"]}),p.jsx("span",{className:"text-[10px] text-thea-gold-dark/50",children:(E=y.project_path)==null?void 0:E.split("/").pop()})]})]}),C?p.jsx("span",{className:V("text-[10px] px-2 py-0.5 rounded",C.status==="running"?"bg-status-success/20 text-status-success":"bg-thea-gold/20 text-thea-gold"),children:(k=Ts[C.status])==null?void 0:k.label}):p.jsxs("button",{onClick:T=>{T.stopPropagation(),n(y.id)},className:"flex items-center gap-1 px-2 py-1 bg-status-success/20 hover:bg-status-success/30 rounded text-status-success text-xs transition-colors",children:[p.jsx(hi,{className:"w-3 h-3"}),"Run"]})]}),L&&y.stories&&p.jsxs("div",{className:"mt-3 space-y-2",children:[y.description&&p.jsx("p",{className:"text-xs text-white/50 italic",children:y.description}),p.jsx("div",{className:"space-y-1",children:y.stories.map((T,A)=>p.jsxs("div",{className:"flex items-start gap-2 text-xs pl-2 border-l border-thea-gold-dark/20",children:[p.jsxs("span",{className:"text-thea-gold-dark font-mono",children:["P",T.priority||A+1]}),p.jsx("span",{className:"text-white/70",children:T.title})]},A))})]})]})},y.id)})})]}),s.filter(y=>["completed","failed","cancelled"].includes(y.status)).length>0&&p.jsxs("div",{className:"border-t border-thea-gold-dark/20",children:[p.jsx("div",{className:"px-4 py-2 bg-thea-gold/5",children:p.jsx("span",{className:"text-[10px] uppercase tracking-wider text-thea-gold-deep font-mono",children:"Recent Runs"})}),p.jsx("ul",{className:"divide-y divide-thea-gold-dark/10",children:s.filter(y=>["completed","failed","cancelled","max_iterations"].includes(y.status)).slice(0,5).map(y=>{const C=Ts[y.status]||Ts.pending,L=C.icon;return p.jsxs("li",{className:"px-4 py-2 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(L,{className:V("w-3.5 h-3.5",C.color)}),p.jsx("span",{className:"text-xs text-white/70",children:y.prd_name||`PRD #${y.prd_id}`})]}),p.jsx("span",{className:"text-[10px] text-thea-gold-dark font-mono",children:f(y.completed_at)})]},y.id)})})]})]})]})}const Rh="";function Uv(){const{connected:e,workers:t,toasts:r,dismissToast:s,detachFromWorker:o}=_t(),{breakpoint:g}=xm(),[S,i]=I.useState(!1),[a,d]=I.useState("workers"),[v,u]=I.useState(!1),[_,b]=I.useState("activity"),[w,f]=I.useState(!1),[n,c]=I.useState(()=>{if(typeof window<"u"){const m=localStorage.getItem("strategos-performance-mode");return m===null?!0:m==="true"}return!0}),l=t.filter(m=>m.status==="running").length;I.useEffect(()=>{n?document.body.classList.add("performance-mode"):document.body.classList.remove("performance-mode"),localStorage.setItem("strategos-performance-mode",n.toString())},[n]),I.useEffect(()=>{fetch(`${Rh}/api/settings/summaries`).then(m=>m.json()).then(m=>f(m.enabled)).catch(()=>{})},[]);const h=async()=>{const m=!w;f(m);try{const C=await(await fetch(`${Rh}/api/settings/summaries`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:m})})).json();f(C.enabled)}catch{f(!m)}};return v?p.jsxs("div",{className:"min-h-screen bg-thea-black relative z-10",children:[p.jsx(Lv,{onExit:()=>u(!1)}),p.jsx(bh,{toasts:r,onDismiss:s})]}):p.jsxs("div",{className:"min-h-screen bg-thea-black flex flex-col relative z-10 pb-mobile-nav sm:pb-0 overflow-x-hidden",children:[p.jsx("header",{className:"bg-gradient-to-r from-black/80 via-thea-nearBlack/90 to-black/80 border-b border-thea-gold-dark/50 backdrop-blur-md sticky top-0 z-50",children:p.jsx("div",{className:"max-w-7xl mx-auto px-4",children:p.jsxs("div",{className:"flex items-center justify-between h-16",children:[p.jsxs("button",{onClick:()=>{o(),d("workers"),i(!1)},className:"flex items-center gap-4 group cursor-pointer",children:[p.jsxs("div",{className:"relative",children:[p.jsx("h1",{className:"font-orbitron font-bold text-2xl text-thea-gold-bright tracking-widest text-glow-gold group-hover:text-white transition-colors",children:"STRATEGOS"}),p.jsx("div",{className:"absolute -bottom-1 left-0 w-full h-px bg-gradient-to-r from-transparent via-thea-gold to-transparent group-hover:via-white transition-colors"})]}),p.jsx("span",{className:"text-[10px] text-thea-gold-dark font-mono hidden sm:block uppercase tracking-[0.2em]",children:"// Thea Orchestrator"})]}),p.jsxs("div",{className:"flex items-center gap-2 sm:gap-5",children:[p.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 text-sm",children:[p.jsx("span",{className:"hidden sm:inline text-thea-gold-dark font-mono text-xs uppercase tracking-wider",children:"Workers:"}),p.jsx("span",{className:"font-mono text-thea-gold-bright font-bold text-lg",children:l})]}),p.jsx("div",{"data-testid":"connection-status",className:V("thea-badge flex items-center gap-1 sm:gap-2 px-2 sm:px-3",e?"thea-badge-running":"thea-badge-stopped"),children:e?p.jsxs(p.Fragment,{children:[p.jsx(Xm,{className:"w-3.5 h-3.5"}),p.jsx("span",{"data-testid":"status-text",className:"hidden sm:inline",children:"Connected"})]}):p.jsxs(p.Fragment,{children:[p.jsx(Gm,{className:"w-3.5 h-3.5"}),p.jsx("span",{"data-testid":"status-text",className:"hidden sm:inline",children:"Disconnected"})]})}),p.jsx("button",{onClick:()=>c(!n),className:V("thea-btn p-2",n&&"bg-green-500/20 border-green-500/50 text-green-400"),title:n?"Performance mode ON (animations disabled)":"Enable performance mode",children:p.jsx(Or,{className:"w-4 h-4"})}),p.jsx("button",{onClick:()=>u(!0),className:"hidden sm:block thea-btn p-2 group",title:"Enter Voice Mode",children:p.jsx(ci,{className:"w-4 h-4 group-hover:text-thea-gold-bright"})}),p.jsx("button",{"data-testid":"activity-toggle",onClick:()=>i(!S),className:V("hidden sm:block thea-btn p-2",S&&"bg-thea-gold/20 border-thea-gold shadow-gold-sm"),children:p.jsx(Ft,{className:"w-4 h-4"})})]})]})})}),p.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[p.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden",children:[p.jsx("div",{className:"bg-gradient-to-b from-black/50 to-transparent border-b border-thea-gold-dark/30 px-4",children:p.jsxs("div",{className:"flex gap-2",children:[p.jsxs("button",{"data-testid":"tab-workers",onClick:()=>d("workers"),className:V("flex items-center gap-2 px-5 py-3 text-sm font-rajdhani font-bold uppercase tracking-wider border-b-2 transition-all duration-300",a==="workers"?"border-thea-gold text-thea-gold-bright text-glow-gold-sm":"border-transparent text-thea-gold-dark hover:text-thea-gold hover:border-thea-gold/30"),children:[p.jsx(gs,{className:"w-4 h-4"}),"Workers"]}),p.jsxs("button",{"data-testid":"tab-projects",onClick:()=>d("projects"),className:V("flex items-center gap-2 px-5 py-3 text-sm font-rajdhani font-bold uppercase tracking-wider border-b-2 transition-all duration-300",a==="projects"?"border-thea-gold text-thea-gold-bright text-glow-gold-sm":"border-transparent text-thea-gold-dark hover:text-thea-gold hover:border-thea-gold/30"),children:[p.jsx(fh,{className:"w-4 h-4"}),"Projects"]}),p.jsxs("button",{"data-testid":"tab-ralph",onClick:()=>d("ralph"),className:V("flex items-center gap-2 px-5 py-3 text-sm font-rajdhani font-bold uppercase tracking-wider border-b-2 transition-all duration-300",a==="ralph"?"border-thea-gold text-thea-gold-bright text-glow-gold-sm":"border-transparent text-thea-gold-dark hover:text-thea-gold hover:border-thea-gold/30"),children:[p.jsx(ps,{className:"w-4 h-4"}),"Ralph"]})]})}),p.jsxs("div",{className:"flex-1 overflow-auto",children:[a==="workers"&&p.jsx(kv,{}),a==="projects"&&p.jsx(nv,{}),a==="ralph"&&p.jsx($v,{className:"h-full"})]})]}),p.jsx("aside",{className:V("bg-gradient-to-l from-black/95 to-thea-nearBlack/95 lg:from-black/60 lg:to-thea-nearBlack/40 border-l border-thea-gold-dark/30 transition-all duration-300 overflow-hidden backdrop-blur-sm flex flex-col",S?"fixed lg:relative inset-0 lg:inset-auto top-16 lg:top-0 z-40 lg:z-auto w-full lg:w-72":"w-0"),children:S&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"lg:hidden flex items-center justify-between px-4 py-3 bg-black/80 border-b border-thea-gold-dark/30",children:[p.jsx("span",{className:"font-orbitron text-thea-gold-bright text-sm uppercase tracking-wider",children:"Activity"}),p.jsx("button",{onClick:()=>i(!1),className:"p-2 text-thea-gold hover:text-thea-gold-bright hover:bg-thea-gold/10 rounded transition-colors",children:p.jsx(Jt,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-black/60 border-b border-thea-gold-dark/20 shrink-0",children:[p.jsx("span",{className:"text-[10px] font-mono text-thea-gold-dark uppercase tracking-wider",children:"AI Summaries"}),p.jsxs("button",{onClick:h,className:V("flex items-center gap-1.5 px-2 py-1 rounded text-[10px] font-mono transition-all",w?"bg-thea-gold/20 text-thea-gold border border-thea-gold/30":"bg-gray-800 text-gray-400 border border-gray-600"),title:w?"Click to disable Ollama summaries":"Click to enable Ollama summaries",children:[w?p.jsx(Km,{className:"w-4 h-4"}):p.jsx(qm,{className:"w-4 h-4"}),w?"ON":"OFF"]})]}),p.jsxs("div",{className:"flex border-b border-thea-gold-dark/30 bg-black/40 shrink-0",children:[p.jsxs("button",{onClick:()=>b("activity"),className:V("flex-1 flex items-center justify-center gap-1.5 px-2 py-2.5 text-[10px] font-rajdhani uppercase tracking-wider transition-all border-b-2",_==="activity"?"border-thea-gold text-thea-gold-bright bg-thea-gold/10":"border-transparent text-thea-gold-dark hover:text-thea-gold"),title:"Activity Feed",children:[p.jsx(Ft,{className:"w-3.5 h-3.5"}),p.jsx("span",{className:"hidden sm:inline",children:"Activity"})]}),p.jsxs("button",{onClick:()=>b("patterns"),className:V("flex-1 flex items-center justify-center gap-1.5 px-2 py-2.5 text-[10px] font-rajdhani uppercase tracking-wider transition-all border-b-2",_==="patterns"?"border-thea-gold text-thea-gold-bright bg-thea-gold/10":"border-transparent text-thea-gold-dark hover:text-thea-gold"),title:"Activity Patterns & Workflows",children:[p.jsx(Ba,{className:"w-3.5 h-3.5"}),p.jsx("span",{className:"hidden sm:inline",children:"Patterns"})]}),p.jsxs("button",{onClick:()=>b("adrs"),className:V("flex-1 flex items-center justify-center gap-1.5 px-2 py-2.5 text-[10px] font-rajdhani uppercase tracking-wider transition-all border-b-2",_==="adrs"?"border-thea-gold text-thea-gold-bright bg-thea-gold/10":"border-transparent text-thea-gold-dark hover:text-thea-gold"),title:"Architecture Decisions",children:[p.jsx(sn,{className:"w-3.5 h-3.5"}),p.jsx("span",{className:"hidden sm:inline",children:"ADRs"})]}),p.jsxs("button",{onClick:()=>b("metrics"),className:V("flex-1 flex items-center justify-center gap-1.5 px-2 py-2.5 text-[10px] font-rajdhani uppercase tracking-wider transition-all border-b-2",_==="metrics"?"border-thea-gold text-thea-gold-bright bg-thea-gold/10":"border-transparent text-thea-gold-dark hover:text-thea-gold"),title:"System Metrics",children:[p.jsx(cf,{className:"w-3.5 h-3.5"}),p.jsx("span",{className:"hidden sm:inline",children:"Metrics"})]})]}),p.jsxs("div",{className:"flex-1 overflow-auto",children:[_==="activity"&&p.jsx(Rv,{}),_==="patterns"&&p.jsx(Av,{}),_==="adrs"&&p.jsx(Tv,{limit:10}),_==="metrics"&&p.jsx(Mv,{})]})]})})]}),p.jsx("div",{className:"hidden xl:block fixed bottom-4 right-4 z-40 w-80",children:p.jsx(zv,{})}),p.jsx("nav",{className:"sm:hidden fixed bottom-0 left-0 right-0 bg-black/90 border-t border-thea-gold-dark/30 backdrop-blur-sm z-50",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:p.jsxs("div",{className:"flex justify-around py-2",children:[p.jsxs("button",{onClick:()=>{o(),d("workers"),i(!1)},className:V("flex flex-col items-center gap-1 px-4 py-2",a==="workers"?"text-thea-gold":"text-thea-gold-dark"),children:[p.jsx(gs,{className:"w-5 h-5"}),p.jsx("span",{className:"text-[10px] font-rajdhani",children:"Home"})]}),p.jsxs("button",{onClick:()=>d("projects"),className:V("flex flex-col items-center gap-1 px-4 py-2",a==="projects"?"text-thea-gold":"text-thea-gold-dark"),children:[p.jsx(fh,{className:"w-5 h-5"}),p.jsx("span",{className:"text-[10px] font-rajdhani",children:"Projects"})]}),p.jsxs("button",{onClick:()=>u(!0),className:"flex flex-col items-center gap-1 px-4 py-2 text-thea-gold-dark",children:[p.jsx(ci,{className:"w-5 h-5"}),p.jsx("span",{className:"text-[10px] font-rajdhani",children:"Voice"})]}),p.jsxs("button",{onClick:()=>i(!S),className:V("flex flex-col items-center gap-1 px-4 py-2",S?"text-thea-gold":"text-thea-gold-dark"),children:[p.jsx(Ft,{className:"w-5 h-5"}),p.jsx("span",{className:"text-[10px] font-rajdhani",children:"Activity"})]})]})}),p.jsx(bh,{toasts:r,onDismiss:s})]},`layout-${g}`)}jo.createRoot(document.getElementById("root")).render(p.jsx(Fh.StrictMode,{children:p.jsx(w_,{children:p.jsx(ym,{children:p.jsx(Uv,{})})})}));
