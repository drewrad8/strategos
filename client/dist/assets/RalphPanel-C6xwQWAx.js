import{c as g,u as y,j as e,a as c,B as j,E as k,k as m,g as f,e as v,C as N,p as C,n as S,H as B,D as O,z as R,G as P}from"./index-8Ufjwcey.js";import{r as b}from"./vendor-react-wGySg1uH.js";import{C as M}from"./check-circle-2-DaBelfW8.js";import"./vendor-socket-TjCxX7sJ.js";import"./vendor-terminal-CyaXSNWE.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=g("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=g("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=g("Signal",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]]),w={blocked:{label:"BLOCKED",headerColor:"text-red-400",headerBg:"bg-red-500/10 border-red-500/30",badgeColor:"text-red-400 bg-red-400/10 border-red-400/30",icon:m,countBg:"bg-red-500/20 text-red-300"},in_progress:{label:"IN PROGRESS",headerColor:"text-yellow-400",headerBg:"bg-yellow-500/10 border-yellow-500/30",badgeColor:"text-yellow-400 bg-yellow-400/10 border-yellow-400/30",icon:v,countBg:"bg-yellow-500/20 text-yellow-300"},done:{label:"DONE",headerColor:"text-green-400",headerBg:"bg-green-500/10 border-green-500/30",badgeColor:"text-green-400 bg-green-400/10 border-green-400/30",icon:M,countBg:"bg-green-500/20 text-green-300"},pending:{label:"PENDING",headerColor:"text-thea-gold-dark",headerBg:"bg-thea-gold/10 border-thea-gold-dark/30",badgeColor:"text-thea-gold-dark bg-thea-gold/10 border-thea-gold-dark/30",icon:f,countBg:"bg-thea-gold/20 text-thea-gold"}},p=["blocked","in_progress","done","pending"];function D({groups:s}){var o,l,t,a;const n=p.reduce((h,x)=>{var u;return h+(((u=s[x])==null?void 0:u.length)||0)},0),i=s.in_progress||[],r=i.length>0?Math.round(i.reduce((h,x)=>h+(x.ralphProgress||0),0)/i.length):0,d=((o=s.blocked)==null?void 0:o.length)||0;return e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 border-b border-thea-gold-dark/20 bg-black/30 text-xxs font-mono flex-wrap",children:[e.jsxs("span",{className:"text-thea-gold-dark",children:[e.jsx("span",{className:"text-thea-gold",children:n})," total"]}),(((l=s.in_progress)==null?void 0:l.length)||0)>0&&e.jsxs("span",{className:"text-yellow-400",children:[s.in_progress.length," working",e.jsxs("span",{className:"text-thea-gold-dark ml-1",children:["avg ",r,"%"]})]}),(((t=s.done)==null?void 0:t.length)||0)>0&&e.jsxs("span",{className:"text-green-400",children:[s.done.length," done"]}),d>0&&e.jsxs("span",{className:"text-red-400 animate-pulse",children:[e.jsx(m,{className:"w-3 h-3 inline-block mr-0.5 -mt-0.5"}),d," blocked"]}),(((a=s.pending)==null?void 0:a.length)||0)>0&&e.jsxs("span",{className:"text-thea-gold-dark",children:[s.pending.length," pending"]})]})}function L({status:s,workers:n,attachToWorker:i}){const r=w[s],[d,o]=b.useState(!1);if(!n||n.length===0)return null;const l=r.icon;return e.jsxs("div",{className:"border-b border-thea-gold-dark/10 last:border-b-0",children:[e.jsxs("button",{onClick:()=>o(t=>!t),className:c("w-full flex items-center gap-2 px-4 py-2 border-l-2 transition-colors hover:bg-white/5",r.headerBg),children:[e.jsx(l,{className:c("w-3.5 h-3.5 flex-shrink-0",r.headerColor,s==="in_progress"&&"animate-spin")}),e.jsx("span",{className:c("text-[11px] font-orbitron uppercase tracking-wider",r.headerColor),children:r.label}),e.jsx("span",{className:c("text-xxs px-1.5 py-0 rounded-full font-mono",r.countBg),children:n.length}),e.jsx(N,{className:c("w-3 h-3 ml-auto text-thea-gold-dark transition-transform",d&&"-rotate-90")})]}),!d&&e.jsx("div",{className:"divide-y divide-thea-gold-dark/5",children:n.map(t=>e.jsx(T,{worker:t,status:s,attachToWorker:i},t.id))})]})}function T({worker:s,status:n,attachToWorker:i}){const[r,d]=b.useState(!1),{displayName:o}=C(s.label),l=n==="blocked",t=n==="done";return e.jsxs("div",{className:c("px-4 py-3 transition-colors hover:bg-thea-gold/5",l&&"border-l-2 border-red-500 bg-red-500/5"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx(S,{label:s.label,size:"sm"}),e.jsx("button",{onClick:()=>i(s.id),className:"text-sm text-white/90 font-rajdhani truncate hover:text-thea-gold-bright transition-colors text-left min-w-0 flex-1",title:`Focus on ${s.label}`,children:o}),e.jsx(B,{score:s.healthScore,size:"sm"}),e.jsx("span",{className:c("text-xxs px-1.5 py-0.5 border font-mono uppercase flex-shrink-0",s.status==="running"?"bg-green-400/10 text-green-400 border-green-400/30":"bg-gray-500/10 text-gray-400 border-gray-500/30"),children:s.status})]}),n==="in_progress"&&s.ralphProgress!=null&&e.jsxs("div",{className:"mb-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[e.jsx("span",{className:"text-xxs font-mono text-thea-gold-dark",children:"progress"}),e.jsxs("span",{className:"text-xxs font-mono text-thea-gold",children:[s.ralphProgress,"%"]})]}),e.jsx(O,{progress:s.ralphProgress})]}),s.ralphCurrentStep&&e.jsx("p",{className:"text-xxs text-thea-gold-dark/70 font-mono truncate mb-1.5",title:s.ralphCurrentStep,children:s.ralphCurrentStep}),e.jsxs("div",{className:"flex items-center gap-3 text-xxs font-mono text-thea-gold-dark/50",children:[s.ralphSignalCount>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"w-2.5 h-2.5"}),s.ralphSignalCount," signals"]}),s.lastRalphSignalAt&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(f,{className:"w-2.5 h-2.5"}),R(s.lastRalphSignalAt)]})]}),l&&s.ralphBlockedReason&&e.jsxs("div",{className:"mt-2 px-2 py-1.5 bg-red-500/10 border border-red-500/30 text-[11px] text-red-300 font-mono flex items-start gap-1.5",children:[e.jsx(m,{className:"w-3 h-3 flex-shrink-0 mt-0.5 animate-pulse"}),e.jsx("span",{children:s.ralphBlockedReason})]}),t&&e.jsxs("div",{className:"mt-2 space-y-1.5",children:[s.ralphLearnings&&e.jsxs("div",{className:"text-xxs font-mono",children:[e.jsxs("button",{onClick:()=>d(a=>!a),className:"flex items-center gap-1 text-green-400/80 hover:text-green-400 transition-colors mb-0.5",children:[e.jsx(A,{className:"w-2.5 h-2.5"}),e.jsx("span",{children:"learnings"}),e.jsx(N,{className:c("w-2.5 h-2.5 transition-transform",r&&"rotate-180")})]}),e.jsx("p",{className:c("text-thea-gold-dark/60 whitespace-pre-wrap pl-4",!r&&"line-clamp-2"),children:s.ralphLearnings})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.ralphOutputs&&(typeof s.ralphOutputs=="string"?s.ralphOutputs.length>0:Object.keys(s.ralphOutputs).length>0)&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xxs font-mono text-thea-gold-dark/60",children:[e.jsx(E,{className:"w-2.5 h-2.5"}),(()=>{const a=typeof s.ralphOutputs=="string"?s.ralphOutputs.length:Object.keys(s.ralphOutputs).length;return`${a} output${a!==1?"s":""}`})()]}),s.ralphArtifacts&&s.ralphArtifacts.length>0&&e.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:s.ralphArtifacts.map(a=>e.jsxs("span",{className:"text-xxxs font-mono px-1.5 py-0.5 bg-purple-500/10 border border-purple-500/30 text-purple-300 truncate max-w-[120px]",title:a,children:[e.jsx(P,{className:"w-2.5 h-2.5 inline-block mr-0.5 -mt-0.5"}),typeof a=="string"?a.split("/").pop():a]},a))})]})]})]})}function q({className:s=""}){const{workers:n,attachToWorker:i}=y(),{ralphWorkers:r,groups:d}=b.useMemo(()=>{const o=n.filter(t=>t.ralphMode),l={};for(const t of p)l[t]=[];for(const t of o){const a=t.ralphStatus||"pending";l[a]?l[a].push(t):l.pending.push(t)}return l.in_progress.sort((t,a)=>(a.ralphProgress||0)-(t.ralphProgress||0)),{ralphWorkers:o,groups:l}},[n]);return e.jsxs("div",{className:c("bg-gradient-to-b from-thea-nearBlack/80 to-black/60 flex flex-col",s),children:[e.jsx("div",{className:"flex items-center justify-between px-4 py-3 border-b border-thea-gold-dark/30 bg-black/40",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4 text-thea-gold animate-pulse-gold"}),e.jsx("h3",{className:"font-orbitron text-xs uppercase tracking-[0.15em] text-thea-gold-bright text-glow-gold-sm",children:"Ralph Dashboard"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?e.jsx(k,{icon:j,message:"No Ralph-enabled workers",className:"py-6"}):e.jsxs(e.Fragment,{children:[e.jsx(D,{groups:d}),p.map(o=>e.jsx(L,{status:o,workers:d[o],attachToWorker:i},o))]})})]})}export{q as RalphPanel};
