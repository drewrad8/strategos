import{c as x,u as y,j as e,a as i,B as f,k as m,g as j,e as v,C as N,p as k,m as C,H as S,y as B}from"./index-BbaJC1Vz.js";import{r as b}from"./vendor-react-wGySg1uH.js";import{C as M}from"./check-circle-2-FFdvqJQs.js";import"./vendor-socket-TjCxX7sJ.js";import"./vendor-terminal-CyaXSNWE.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=x("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=x("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=x("Signal",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]]);function R(t){if(!t)return null;const l=Math.floor((Date.now()-new Date(t).getTime())/1e3);if(l<60)return`${l}s ago`;const o=Math.floor(l/60);if(o<60)return`${o}m ago`;const r=Math.floor(o/60);return r<24?`${r}h ago`:`${Math.floor(r/24)}d ago`}const A={blocked:{label:"BLOCKED",headerColor:"text-red-400",headerBg:"bg-red-500/10 border-red-500/30",badgeColor:"text-red-400 bg-red-400/10 border-red-400/30",icon:m,countBg:"bg-red-500/20 text-red-300"},in_progress:{label:"IN PROGRESS",headerColor:"text-yellow-400",headerBg:"bg-yellow-500/10 border-yellow-500/30",badgeColor:"text-yellow-400 bg-yellow-400/10 border-yellow-400/30",icon:v,countBg:"bg-yellow-500/20 text-yellow-300"},done:{label:"DONE",headerColor:"text-green-400",headerBg:"bg-green-500/10 border-green-500/30",badgeColor:"text-green-400 bg-green-400/10 border-green-400/30",icon:M,countBg:"bg-green-500/20 text-green-300"},pending:{label:"PENDING",headerColor:"text-thea-gold-dark",headerBg:"bg-thea-gold/10 border-thea-gold-dark/30",badgeColor:"text-thea-gold-dark bg-thea-gold/10 border-thea-gold-dark/30",icon:j,countBg:"bg-thea-gold/20 text-thea-gold"}},g=["blocked","in_progress","done","pending"];function D({groups:t}){var d,n,a,s;const l=g.reduce((h,p)=>{var u;return h+(((u=t[p])==null?void 0:u.length)||0)},0),o=t.in_progress||[],r=o.length>0?Math.round(o.reduce((h,p)=>h+(p.ralphProgress||0),0)/o.length):0,c=((d=t.blocked)==null?void 0:d.length)||0;return e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 border-b border-thea-gold-dark/20 bg-black/30 text-[10px] font-mono flex-wrap",children:[e.jsxs("span",{className:"text-thea-gold-dark",children:[e.jsx("span",{className:"text-thea-gold",children:l})," total"]}),(((n=t.in_progress)==null?void 0:n.length)||0)>0&&e.jsxs("span",{className:"text-yellow-400",children:[t.in_progress.length," working",e.jsxs("span",{className:"text-thea-gold-dark ml-1",children:["avg ",r,"%"]})]}),(((a=t.done)==null?void 0:a.length)||0)>0&&e.jsxs("span",{className:"text-green-400",children:[t.done.length," done"]}),c>0&&e.jsxs("span",{className:"text-red-400 animate-pulse",children:[e.jsx(m,{className:"w-3 h-3 inline-block mr-0.5 -mt-0.5"}),c," blocked"]}),(((s=t.pending)==null?void 0:s.length)||0)>0&&e.jsxs("span",{className:"text-thea-gold-dark",children:[t.pending.length," pending"]})]})}function _({status:t,workers:l,attachToWorker:o}){const r=A[t],[c,d]=b.useState(!1);if(!l||l.length===0)return null;const n=r.icon;return e.jsxs("div",{className:"border-b border-thea-gold-dark/10 last:border-b-0",children:[e.jsxs("button",{onClick:()=>d(a=>!a),className:i("w-full flex items-center gap-2 px-4 py-2 border-l-2 transition-colors hover:bg-white/5",r.headerBg),children:[e.jsx(n,{className:i("w-3.5 h-3.5 flex-shrink-0",r.headerColor,t==="in_progress"&&"animate-spin")}),e.jsx("span",{className:i("text-[11px] font-orbitron uppercase tracking-wider",r.headerColor),children:r.label}),e.jsx("span",{className:i("text-[10px] px-1.5 py-0 rounded-full font-mono",r.countBg),children:l.length}),e.jsx(N,{className:i("w-3 h-3 ml-auto text-thea-gold-dark transition-transform",c&&"-rotate-90")})]}),!c&&e.jsx("div",{className:"divide-y divide-thea-gold-dark/5",children:l.map(a=>e.jsx(T,{worker:a,status:t,attachToWorker:o},a.id))})]})}function T({worker:t,status:l,attachToWorker:o}){const[r,c]=b.useState(!1),{displayName:d}=k(t.label),n=l==="blocked",a=l==="done";return e.jsxs("div",{className:i("px-4 py-3 transition-colors hover:bg-thea-gold/5",n&&"border-l-2 border-red-500 bg-red-500/5"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx(C,{label:t.label,size:"sm"}),e.jsx("button",{onClick:()=>o(t.id),className:"text-sm text-white/90 font-rajdhani truncate hover:text-thea-gold-bright transition-colors text-left min-w-0 flex-1",title:`Focus on ${t.label}`,children:d}),e.jsx(S,{score:t.healthScore,size:"sm"}),e.jsx("span",{className:i("text-[10px] px-1.5 py-0.5 border font-mono uppercase flex-shrink-0",t.status==="running"?"bg-green-400/10 text-green-400 border-green-400/30":"bg-gray-500/10 text-gray-400 border-gray-500/30"),children:t.status})]}),l==="in_progress"&&t.ralphProgress!=null&&e.jsxs("div",{className:"mb-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[e.jsx("span",{className:"text-[10px] font-mono text-thea-gold-dark",children:"progress"}),e.jsxs("span",{className:"text-[10px] font-mono text-thea-gold",children:[t.ralphProgress,"%"]})]}),e.jsx("div",{className:"w-full h-1.5 bg-black/50 border border-thea-gold-dark/20 overflow-hidden",role:"progressbar","aria-valuenow":t.ralphProgress,"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Task progress",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-purple-600 to-thea-gold-bright transition-all duration-500",style:{width:`${Math.min(100,Math.max(0,t.ralphProgress))}%`}})})]}),t.ralphCurrentStep&&e.jsx("p",{className:"text-[10px] text-thea-gold-dark/70 font-mono truncate mb-1.5",title:t.ralphCurrentStep,children:t.ralphCurrentStep}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-mono text-thea-gold-dark/50",children:[t.ralphSignalCount>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"w-2.5 h-2.5"}),t.ralphSignalCount," signals"]}),t.lastRalphSignalAt&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"w-2.5 h-2.5"}),R(t.lastRalphSignalAt)]})]}),n&&t.ralphBlockedReason&&e.jsxs("div",{className:"mt-2 px-2 py-1.5 bg-red-500/10 border border-red-500/30 text-[11px] text-red-300 font-mono flex items-start gap-1.5",children:[e.jsx(m,{className:"w-3 h-3 flex-shrink-0 mt-0.5 animate-pulse"}),e.jsx("span",{children:t.ralphBlockedReason})]}),a&&e.jsxs("div",{className:"mt-2 space-y-1.5",children:[t.ralphLearnings&&e.jsxs("div",{className:"text-[10px] font-mono",children:[e.jsxs("button",{onClick:()=>c(s=>!s),className:"flex items-center gap-1 text-green-400/80 hover:text-green-400 transition-colors mb-0.5",children:[e.jsx(O,{className:"w-2.5 h-2.5"}),e.jsx("span",{children:"learnings"}),e.jsx(N,{className:i("w-2.5 h-2.5 transition-transform",r&&"rotate-180")})]}),e.jsx("p",{className:i("text-thea-gold-dark/60 whitespace-pre-wrap pl-4",!r&&"line-clamp-2"),children:t.ralphLearnings})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.ralphOutputs&&(typeof t.ralphOutputs=="string"?t.ralphOutputs.length>0:Object.keys(t.ralphOutputs).length>0)&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-[10px] font-mono text-thea-gold-dark/60",children:[e.jsx(w,{className:"w-2.5 h-2.5"}),(()=>{const s=typeof t.ralphOutputs=="string"?t.ralphOutputs.length:Object.keys(t.ralphOutputs).length;return`${s} output${s!==1?"s":""}`})()]}),t.ralphArtifacts&&t.ralphArtifacts.length>0&&e.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:t.ralphArtifacts.map(s=>e.jsxs("span",{className:"text-[9px] font-mono px-1.5 py-0.5 bg-purple-500/10 border border-purple-500/30 text-purple-300 truncate max-w-[120px]",title:s,children:[e.jsx(B,{className:"w-2.5 h-2.5 inline-block mr-0.5 -mt-0.5"}),typeof s=="string"?s.split("/").pop():s]},s))})]})]})]})}function z({className:t=""}){const{workers:l,attachToWorker:o}=y(),{ralphWorkers:r,groups:c}=b.useMemo(()=>{const d=l.filter(a=>a.ralphMode),n={};for(const a of g)n[a]=[];for(const a of d){const s=a.ralphStatus||"pending";n[s]?n[s].push(a):n.pending.push(a)}return n.in_progress.sort((a,s)=>(s.ralphProgress||0)-(a.ralphProgress||0)),{ralphWorkers:d,groups:n}},[l]);return e.jsxs("div",{className:i("bg-gradient-to-b from-thea-nearBlack/80 to-black/60 flex flex-col",t),children:[e.jsx("div",{className:"flex items-center justify-between px-4 py-3 border-b border-thea-gold-dark/30 bg-black/40",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-thea-gold animate-pulse-gold"}),e.jsx("h3",{className:"font-orbitron text-xs uppercase tracking-[0.15em] text-thea-gold-bright text-glow-gold-sm",children:"Ralph Dashboard"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?e.jsxs("div",{className:"px-4 py-6 text-center",children:[e.jsx(f,{className:"w-8 h-8 text-thea-gold-dark/30 mx-auto mb-2"}),e.jsx("span",{className:"text-thea-gold-dark/50 text-sm font-mono",children:"No Ralph-enabled workers"})]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{groups:c}),g.map(d=>e.jsx(_,{status:d,workers:c[d],attachToWorker:o},d))]})})]})}export{z as RalphPanel};
